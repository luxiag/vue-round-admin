import{b as zh,u as Gh,r as El,c as Hh,o as Vh,e as jh,f as Wh,h as Tl,i as Er,w as gs,j as ys,p as kh,k as Yh,n as Xh,l as Qh,m as qh}from"./index-8b0c8213.js";import{u as Zh}from"./useMessage-dd6bbd8e.js";import{_ as Kh}from"./plugin-vueexport-helper-c27b6911.js";(function(f,w){typeof exports=="object"&&typeof module<"u"?w(exports):typeof define=="function"&&define.amd?define(["exports"],w):(f=f||self,w(f.THREE={}))})(globalThis,function(f){function w(){}function G(e,t){this.x=e||0,this.y=t||0}function we(e,t,n,i){this._x=e||0,this._y=t||0,this._z=n||0,this._w=i!==void 0?i:1}function E(e,t,n){this.x=e||0,this.y=t||0,this.z=n||0}function be(){this.elements=[1,0,0,0,1,0,0,0,1],0<arguments.length&&console.error("THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.")}function Ae(e,t,n,i,r,o,s,a,c,u){Object.defineProperty(this,"id",{value:th++}),this.uuid=Xe.generateUUID(),this.name="",this.image=e!==void 0?e:Ae.DEFAULT_IMAGE,this.mipmaps=[],this.mapping=t!==void 0?t:Ae.DEFAULT_MAPPING,this.wrapS=n!==void 0?n:1001,this.wrapT=i!==void 0?i:1001,this.magFilter=r!==void 0?r:1006,this.minFilter=o!==void 0?o:1008,this.anisotropy=c!==void 0?c:1,this.format=s!==void 0?s:1023,this.type=a!==void 0?a:1009,this.offset=new G(0,0),this.repeat=new G(1,1),this.center=new G(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new be,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=u!==void 0?u:3e3,this.version=0,this.onUpdate=null}function _e(e,t,n,i){this.x=e||0,this.y=t||0,this.z=n||0,this.w=i!==void 0?i:1}function je(e,t,n){this.width=e,this.height=t,this.scissor=new _e(0,0,e,t),this.scissorTest=!1,this.viewport=new _e(0,0,e,t),n=n||{},this.texture=new Ae(void 0,void 0,n.wrapS,n.wrapT,n.magFilter,n.minFilter,n.format,n.type,n.anisotropy,n.encoding),this.texture.image={},this.texture.image.width=e,this.texture.image.height=t,this.texture.generateMipmaps=n.generateMipmaps!==void 0?n.generateMipmaps:!1,this.texture.minFilter=n.minFilter!==void 0?n.minFilter:1006,this.depthBuffer=n.depthBuffer!==void 0?n.depthBuffer:!0,this.stencilBuffer=n.stencilBuffer!==void 0?n.stencilBuffer:!0,this.depthTexture=n.depthTexture!==void 0?n.depthTexture:null}function Ve(e,t,n){je.call(this,e,t,n),this.samples=4}function Se(){this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],0<arguments.length&&console.error("THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.")}function ht(e,t,n,i){this._x=e||0,this._y=t||0,this._z=n||0,this._order=i||ht.DefaultOrder}function Re(){this.mask=1}function W(){Object.defineProperty(this,"id",{value:rh++}),this.uuid=Xe.generateUUID(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=W.DefaultUp.clone();var e=new E,t=new ht,n=new we,i=new E(1,1,1);t._onChange(function(){n.setFromEuler(t,!1)}),n._onChange(function(){t.setFromQuaternion(n,void 0,!1)}),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:t},quaternion:{configurable:!0,enumerable:!0,value:n},scale:{configurable:!0,enumerable:!0,value:i},modelViewMatrix:{value:new Se},normalMatrix:{value:new be}}),this.matrix=new Se,this.matrixWorld=new Se,this.matrixAutoUpdate=W.DefaultMatrixAutoUpdate,this.matrixWorldNeedsUpdate=!1,this.layers=new Re,this.visible=!0,this.receiveShadow=this.castShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.userData={}}function It(){W.call(this),this.type="Scene",this.overrideMaterial=this.fog=this.background=null,this.autoUpdate=!0,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}function pe(e,t){this.min=e!==void 0?e:new E(1/0,1/0,1/0),this.max=t!==void 0?t:new E(-1/0,-1/0,-1/0)}function wi(e,t,n,i,r){var o,s=0;for(o=e.length-3;s<=o;s+=3){ur.fromArray(e,s);var a=r.x*Math.abs(ur.x)+r.y*Math.abs(ur.y)+r.z*Math.abs(ur.z),c=t.dot(ur),u=n.dot(ur),h=i.dot(ur);if(Math.max(-Math.max(c,u,h),Math.min(c,u,h))>a)return!1}return!0}function ye(e,t){this.center=e!==void 0?e:new E,this.radius=t!==void 0?t:0}function de(e,t){this.origin=e!==void 0?e:new E,this.direction=t!==void 0?t:new E}function lt(e,t,n){this.a=e!==void 0?e:new E,this.b=t!==void 0?t:new E,this.c=n!==void 0?n:new E}function ve(e,t,n){return t===void 0&&n===void 0?this.set(e):this.setRGB(e,t,n)}function Dn(e,t,n){return 0>n&&(n+=1),1<n&&--n,n<1/6?e+6*(t-e)*n:.5>n?t:n<2/3?e+6*(t-e)*(2/3-n):e}function hn(e){return .04045>e?.0773993808*e:Math.pow(.9478672986*e+.0521327014,2.4)}function zi(e){return .0031308>e?12.92*e:1.055*Math.pow(e,.41666)-.055}function Ai(e,t,n,i,r,o){this.a=e,this.b=t,this.c=n,this.normal=i&&i.isVector3?i:new E,this.vertexNormals=Array.isArray(i)?i:[],this.color=r&&r.isColor?r:new ve,this.vertexColors=Array.isArray(r)?r:[],this.materialIndex=o!==void 0?o:0}function ie(){Object.defineProperty(this,"id",{value:hh++}),this.uuid=Xe.generateUUID(),this.name="",this.type="Material",this.fog=!0,this.blending=1,this.side=0,this.vertexTangents=this.flatShading=!1,this.vertexColors=0,this.opacity=1,this.transparent=!1,this.blendSrc=204,this.blendDst=205,this.blendEquation=100,this.blendEquationAlpha=this.blendDstAlpha=this.blendSrcAlpha=null,this.depthFunc=3,this.depthWrite=this.depthTest=!0,this.stencilWriteMask=255,this.stencilFunc=519,this.stencilRef=0,this.stencilFuncMask=255,this.stencilZPass=this.stencilZFail=this.stencilFail=7680,this.stencilWrite=!1,this.clippingPlanes=null,this.clipShadows=this.clipIntersection=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetUnits=this.polygonOffsetFactor=0,this.dithering=!1,this.alphaTest=0,this.premultipliedAlpha=!1,this.toneMapped=this.visible=!0,this.userData={},this.needsUpdate=!0}function Wt(e){ie.call(this),this.type="MeshBasicMaterial",this.color=new ve(16777215),this.lightMap=this.map=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.envMap=this.alphaMap=this.specularMap=null,this.combine=0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinejoin=this.wireframeLinecap="round",this.morphTargets=this.skinning=!1,this.setValues(e)}function Ce(e,t,n){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.name="",this.array=e,this.itemSize=t,this.count=e!==void 0?e.length/t:0,this.normalized=n===!0,this.dynamic=!1,this.updateRange={offset:0,count:-1},this.version=0}function Kn(e,t,n){Ce.call(this,new Int8Array(e),t,n)}function Mi(e,t,n){Ce.call(this,new Uint8Array(e),t,n)}function Gi(e,t,n){Ce.call(this,new Uint8ClampedArray(e),t,n)}function Jn(e,t,n){Ce.call(this,new Int16Array(e),t,n)}function Bn(e,t,n){Ce.call(this,new Uint16Array(e),t,n)}function Hi(e,t,n){Ce.call(this,new Int32Array(e),t,n)}function St(e,t,n){Ce.call(this,new Uint32Array(e),t,n)}function le(e,t,n){Ce.call(this,new Float32Array(e),t,n)}function In(e,t,n){Ce.call(this,new Float64Array(e),t,n)}function xs(){this.vertices=[],this.normals=[],this.colors=[],this.uvs=[],this.uvs2=[],this.groups=[],this.morphTargets={},this.skinWeights=[],this.skinIndices=[],this.boundingSphere=this.boundingBox=null,this.groupsNeedUpdate=this.uvsNeedUpdate=this.colorsNeedUpdate=this.normalsNeedUpdate=this.verticesNeedUpdate=!1}function Mo(e){if(e.length===0)return-1/0;for(var t=e[0],n=1,i=e.length;n<i;++n)e[n]>t&&(t=e[n]);return t}function re(){Object.defineProperty(this,"id",{value:dh+=2}),this.uuid=Xe.generateUUID(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingSphere=this.boundingBox=null,this.drawRange={start:0,count:1/0},this.userData={}}function yt(e,t){W.call(this),this.type="Mesh",this.geometry=e!==void 0?e:new re,this.material=t!==void 0?t:new Wt({color:16777215*Math.random()}),this.drawMode=0,this.updateMorphTargets()}function ws(e,t,n,i,r,o,s,a){return(t.side===1?i.intersectTriangle(s,o,r,!0,a):i.intersectTriangle(r,o,s,t.side!==2,a))===null?null:(La.copy(a),La.applyMatrix4(e.matrixWorld),t=n.ray.origin.distanceTo(La),t<n.near||t>n.far?null:{distance:t,point:La.clone(),object:e})}function Vi(e,t,n,i,r,o,s,a,c,u,h){if(pr.fromBufferAttribute(r,c),fr.fromBufferAttribute(r,u),mr.fromBufferAttribute(r,h),r=e.morphTargetInfluences,t.morphTargets&&o&&r){tl.set(0,0,0),nl.set(0,0,0),il.set(0,0,0);for(var p=0,v=o.length;p<v;p++){var x=r[p],y=o[p];x!==0&&(tu.fromBufferAttribute(y,c),nu.fromBufferAttribute(y,u),iu.fromBufferAttribute(y,h),tl.addScaledVector(tu.sub(pr),x),nl.addScaledVector(nu.sub(fr),x),il.addScaledVector(iu.sub(mr),x))}pr.add(tl),fr.add(nl),mr.add(il)}return(e=ws(e,t,n,i,pr,fr,mr,hs))&&(s&&(lo.fromBufferAttribute(s,c),uo.fromBufferAttribute(s,u),ho.fromBufferAttribute(s,h),e.uv=lt.getUV(hs,pr,fr,mr,lo,uo,ho,new G)),a&&(lo.fromBufferAttribute(a,c),uo.fromBufferAttribute(a,u),ho.fromBufferAttribute(a,h),e.uv2=lt.getUV(hs,pr,fr,mr,lo,uo,ho,new G)),s=new Ai(c,u,h),lt.getNormal(pr,fr,mr,s.normal),e.face=s),e}function he(){Object.defineProperty(this,"id",{value:ph+=2}),this.uuid=Xe.generateUUID(),this.name="",this.type="Geometry",this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingSphere=this.boundingBox=null,this.groupsNeedUpdate=this.lineDistancesNeedUpdate=this.colorsNeedUpdate=this.normalsNeedUpdate=this.uvsNeedUpdate=this.verticesNeedUpdate=this.elementsNeedUpdate=!1}function $n(e){var t={},n;for(n in e){t[n]={};for(var i in e[n]){var r=e[n][i];r&&(r.isColor||r.isMatrix3||r.isMatrix4||r.isVector2||r.isVector3||r.isVector4||r.isTexture)?t[n][i]=r.clone():Array.isArray(r)?t[n][i]=r.slice():t[n][i]=r}}return t}function zt(e){for(var t={},n=0;n<e.length;n++){var i=$n(e[n]),r;for(r in i)t[r]=i[r]}return t}function Rt(e){ie.call(this),this.type="ShaderMaterial",this.defines={},this.uniforms={},this.vertexShader=`void main() {
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,this.fragmentShader=`void main() {
	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );
}`,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.morphNormals=this.morphTargets=this.skinning=this.clipping=this.lights=this.fog=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,e!==void 0&&(e.attributes!==void 0&&console.error("THREE.ShaderMaterial: attributes should now be defined in THREE.BufferGeometry instead."),this.setValues(e))}function $t(){W.call(this),this.type="Camera",this.matrixWorldInverse=new Se,this.projectionMatrix=new Se,this.projectionMatrixInverse=new Se}function Je(e,t,n,i){$t.call(this),this.type="PerspectiveCamera",this.fov=e!==void 0?e:50,this.zoom=1,this.near=n!==void 0?n:.1,this.far=i!==void 0?i:2e3,this.focus=10,this.aspect=t!==void 0?t:1,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}function Ei(e,t,n,i){W.call(this),this.type="CubeCamera";var r=new Je(90,1,e,t);r.up.set(0,-1,0),r.lookAt(new E(1,0,0)),this.add(r);var o=new Je(90,1,e,t);o.up.set(0,-1,0),o.lookAt(new E(-1,0,0)),this.add(o);var s=new Je(90,1,e,t);s.up.set(0,0,1),s.lookAt(new E(0,1,0)),this.add(s);var a=new Je(90,1,e,t);a.up.set(0,0,-1),a.lookAt(new E(0,-1,0)),this.add(a);var c=new Je(90,1,e,t);c.up.set(0,-1,0),c.lookAt(new E(0,0,1)),this.add(c);var u=new Je(90,1,e,t);u.up.set(0,-1,0),u.lookAt(new E(0,0,-1)),this.add(u),i=i||{format:1022,magFilter:1006,minFilter:1006},this.renderTarget=new On(n,n,i),this.renderTarget.texture.name="CubeCamera",this.update=function(h,p){this.parent===null&&this.updateMatrixWorld();var v=h.getRenderTarget(),x=this.renderTarget,y=x.texture.generateMipmaps;x.texture.generateMipmaps=!1,h.setRenderTarget(x,0),h.render(p,r),h.setRenderTarget(x,1),h.render(p,o),h.setRenderTarget(x,2),h.render(p,s),h.setRenderTarget(x,3),h.render(p,a),h.setRenderTarget(x,4),h.render(p,c),x.texture.generateMipmaps=y,h.setRenderTarget(x,5),h.render(p,u),h.setRenderTarget(v)},this.clear=function(h,p,v,x){for(var y=h.getRenderTarget(),M=this.renderTarget,L=0;6>L;L++)h.setRenderTarget(M,L),h.clear(p,v,x);h.setRenderTarget(y)}}function On(e,t,n){je.call(this,e,t,n)}function ei(e,t,n,i,r,o,s,a,c,u,h,p){Ae.call(this,null,o,s,a,c,u,i,r,h,p),this.image={data:e||null,width:t||1,height:n||1},this.magFilter=c!==void 0?c:1003,this.minFilter=u!==void 0?u:1003,this.flipY=this.generateMipmaps=!1,this.unpackAlignment=1,this.needsUpdate=!0}function dn(e,t){this.normal=e!==void 0?e:new E(1,0,0),this.constant=t!==void 0?t:0}function vn(e,t,n,i,r,o){this.planes=[e!==void 0?e:new dn,t!==void 0?t:new dn,n!==void 0?n:new dn,i!==void 0?i:new dn,r!==void 0?r:new dn,o!==void 0?o:new dn]}function Sr(){function e(r,o){n!==!1&&(i(r,o),t.requestAnimationFrame(e))}var t=null,n=!1,i=null;return{start:function(){n!==!0&&i!==null&&(t.requestAnimationFrame(e),n=!0)},stop:function(){n=!1},setAnimationLoop:function(r){i=r},setContext:function(r){t=r}}}function As(e){function t(i,r){var o=i.array,s=i.dynamic?35048:35044,a=e.createBuffer();return e.bindBuffer(r,a),e.bufferData(r,o,s),i.onUploadCallback(),r=5126,o instanceof Float32Array?r=5126:o instanceof Float64Array?console.warn("THREE.WebGLAttributes: Unsupported data buffer format: Float64Array."):o instanceof Uint16Array?r=5123:o instanceof Int16Array?r=5122:o instanceof Uint32Array?r=5125:o instanceof Int32Array?r=5124:o instanceof Int8Array?r=5120:o instanceof Uint8Array&&(r=5121),{buffer:a,type:r,bytesPerElement:o.BYTES_PER_ELEMENT,version:i.version}}var n=new WeakMap;return{get:function(i){return i.isInterleavedBufferAttribute&&(i=i.data),n.get(i)},remove:function(i){i.isInterleavedBufferAttribute&&(i=i.data);var r=n.get(i);r&&(e.deleteBuffer(r.buffer),n.delete(i))},update:function(i,r){i.isInterleavedBufferAttribute&&(i=i.data);var o=n.get(i);if(o===void 0)n.set(i,t(i,r));else if(o.version<i.version){var s=i,a=s.array,c=s.updateRange;e.bindBuffer(r,o.buffer),s.dynamic===!1?e.bufferData(r,a,35044):c.count===-1?e.bufferSubData(r,0,a):c.count===0?console.error("THREE.WebGLObjects.updateBuffer: dynamic THREE.BufferAttribute marked as needsUpdate but updateRange.count is 0, ensure you are using set methods or updating manually."):(e.bufferSubData(r,c.offset*a.BYTES_PER_ELEMENT,a.subarray(c.offset,c.offset+c.count)),c.count=-1),o.version=i.version}}}}function ti(e,t,n,i){he.call(this),this.type="PlaneGeometry",this.parameters={width:e,height:t,widthSegments:n,heightSegments:i},this.fromBufferGeometry(new ni(e,t,n,i)),this.mergeVertices()}function ni(e,t,n,i){re.call(this),this.type="PlaneBufferGeometry",this.parameters={width:e,height:t,widthSegments:n,heightSegments:i},e=e||1,t=t||1;var r=e/2,o=t/2;n=Math.floor(n)||1,i=Math.floor(i)||1;var s=n+1,a=i+1,c=e/n,u=t/i,h=[],p=[],v=[],x=[];for(e=0;e<a;e++){var y=e*u-o;for(t=0;t<s;t++)p.push(t*c-r,-y,0),v.push(0,0,1),x.push(t/n),x.push(1-e/i)}for(e=0;e<i;e++)for(t=0;t<n;t++)r=t+s*(e+1),o=t+1+s*(e+1),a=t+1+s*e,h.push(t+s*e,r,a),h.push(r,o,a);this.setIndex(h),this.addAttribute("position",new le(p,3)),this.addAttribute("normal",new le(v,3)),this.addAttribute("uv",new le(x,2))}function Si(e,t,n,i){function r(p,v){t.buffers.color.setClear(p.r,p.g,p.b,v,i)}var o=new ve(0),s=0,a,c,u=null,h=0;return{getClearColor:function(){return o},setClearColor:function(p,v){o.set(p),s=v!==void 0?v:1,r(o,s)},getClearAlpha:function(){return s},setClearAlpha:function(p){s=p,r(o,s)},render:function(p,v,x,y){v=v.background,x=e.vr,(x=x.getSession&&x.getSession())&&x.environmentBlendMode==="additive"&&(v=null),v===null?(r(o,s),u=null,h=0):v&&v.isColor&&(r(v,1),y=!0,u=null,h=0),(e.autoClear||y)&&e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil),v&&(v.isCubeTexture||v.isWebGLRenderTargetCube)?(c===void 0&&(c=new yt(new ds(1,1,1),new Rt({type:"BackgroundCubeMaterial",uniforms:$n(Xn.cube.uniforms),vertexShader:Xn.cube.vertexShader,fragmentShader:Xn.cube.fragmentShader,side:1,depthTest:!1,depthWrite:!1,fog:!1})),c.geometry.removeAttribute("normal"),c.geometry.removeAttribute("uv"),c.onBeforeRender=function(M,L,O){this.matrixWorld.copyPosition(O.matrixWorld)},Object.defineProperty(c.material,"map",{get:function(){return this.uniforms.tCube.value}}),n.update(c)),y=v.isWebGLRenderTargetCube?v.texture:v,c.material.uniforms.tCube.value=y,c.material.uniforms.tFlip.value=v.isWebGLRenderTargetCube?1:-1,(u!==v||h!==y.version)&&(c.material.needsUpdate=!0,u=v,h=y.version),p.unshift(c,c.geometry,c.material,0,0,null)):v&&v.isTexture&&(a===void 0&&(a=new yt(new ni(2,2),new Rt({type:"BackgroundMaterial",uniforms:$n(Xn.background.uniforms),vertexShader:Xn.background.vertexShader,fragmentShader:Xn.background.fragmentShader,side:0,depthTest:!1,depthWrite:!1,fog:!1})),a.geometry.removeAttribute("normal"),Object.defineProperty(a.material,"map",{get:function(){return this.uniforms.t2D.value}}),n.update(a)),a.material.uniforms.t2D.value=v,v.matrixAutoUpdate===!0&&v.updateMatrix(),a.material.uniforms.uvTransform.value.copy(v.matrix),(u!==v||h!==v.version)&&(a.material.needsUpdate=!0,u=v,h=v.version),p.unshift(a,a.geometry,a.material,0,0,null))}}}function Tr(e,t,n,i){var r;this.setMode=function(o){r=o},this.render=function(o,s){e.drawArrays(r,o,s),n.update(s,r)},this.renderInstances=function(o,s,a,c){if(c!==0){if(i.isWebGL2){o=e;var u="drawArraysInstanced"}else if(o=t.get("ANGLE_instanced_arrays"),u="drawArraysInstancedANGLE",o===null){console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}o[u](r,s,a,c),n.update(a,r,c)}}}function Ms(e,t,n){function i(z){if(z==="highp"){if(0<e.getShaderPrecisionFormat(35633,36338).precision&&0<e.getShaderPrecisionFormat(35632,36338).precision)return"highp";z="mediump"}return z==="mediump"&&0<e.getShaderPrecisionFormat(35633,36337).precision&&0<e.getShaderPrecisionFormat(35632,36337).precision?"mediump":"lowp"}var r,o=typeof WebGL2RenderingContext<"u"&&e instanceof WebGL2RenderingContext,s=n.precision!==void 0?n.precision:"highp",a=i(s);a!==s&&(console.warn("THREE.WebGLRenderer:",s,"not supported, using",a,"instead."),s=a),n=n.logarithmicDepthBuffer===!0,a=e.getParameter(34930);var c=e.getParameter(35660),u=e.getParameter(3379),h=e.getParameter(34076),p=e.getParameter(34921),v=e.getParameter(36347),x=e.getParameter(36348),y=e.getParameter(36349),M=0<c,L=o||!!t.get("OES_texture_float"),O=M&&L,F=o?e.getParameter(36183):0;return{isWebGL2:o,getMaxAnisotropy:function(){if(r!==void 0)return r;var z=t.get("EXT_texture_filter_anisotropic");return r=z!==null?e.getParameter(z.MAX_TEXTURE_MAX_ANISOTROPY_EXT):0},getMaxPrecision:i,precision:s,logarithmicDepthBuffer:n,maxTextures:a,maxVertexTextures:c,maxTextureSize:u,maxCubemapSize:h,maxAttributes:p,maxVertexUniforms:v,maxVaryings:x,maxFragmentUniforms:y,vertexTextures:M,floatFragmentTextures:L,floatVertexTextures:O,maxSamples:F}}function Es(){function e(){u.value!==i&&(u.value=i,u.needsUpdate=0<r),n.numPlanes=r,n.numIntersection=0}function t(h,p,v,x){var y=h!==null?h.length:0,M=null;if(y!==0){if(M=u.value,x!==!0||M===null)for(x=v+4*y,p=p.matrixWorldInverse,c.getNormalMatrix(p),(M===null||M.length<x)&&(M=new Float32Array(x)),x=0;x!==y;++x,v+=4)a.copy(h[x]).applyMatrix4(p,c),a.normal.toArray(M,v),M[v+3]=a.constant;u.value=M,u.needsUpdate=!0}return n.numPlanes=y,M}var n=this,i=null,r=0,o=!1,s=!1,a=new dn,c=new be,u={value:null,needsUpdate:!1};this.uniform=u,this.numIntersection=this.numPlanes=0,this.init=function(h,p,v){var x=h.length!==0||p||r!==0||o;return o=p,i=t(h,v,0),r=h.length,x},this.beginShadows=function(){s=!0,t(null)},this.endShadows=function(){s=!1,e()},this.setState=function(h,p,v,x,y,M){if(!o||h===null||h.length===0||s&&!v)s?t(null):e();else{v=s?0:r;var L=4*v,O=y.clippingState||null;for(u.value=O,O=t(h,x,L,M),h=0;h!==L;++h)O[h]=i[h];y.clippingState=O,this.numIntersection=p?this.numPlanes:0,this.numPlanes+=v}}}function Ss(e){var t={};return{get:function(n){if(t[n]!==void 0)return t[n];switch(n){case"WEBGL_depth_texture":var i=e.getExtension("WEBGL_depth_texture")||e.getExtension("MOZ_WEBGL_depth_texture")||e.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":i=e.getExtension("EXT_texture_filter_anisotropic")||e.getExtension("MOZ_EXT_texture_filter_anisotropic")||e.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":i=e.getExtension("WEBGL_compressed_texture_s3tc")||e.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":i=e.getExtension("WEBGL_compressed_texture_pvrtc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:i=e.getExtension(n)}return i===null&&console.warn("THREE.WebGLRenderer: "+n+" extension not supported."),t[n]=i}}}function rt(e,t,n){function i(a){var c=a.target;a=o.get(c),a.index!==null&&t.remove(a.index);for(var u in a.attributes)t.remove(a.attributes[u]);c.removeEventListener("dispose",i),o.delete(c),(u=s.get(a))&&(t.remove(u),s.delete(a)),n.memory.geometries--}function r(a){var c=[],u=a.index,h=a.attributes.position;if(u!==null){var p=u.array;u=u.version,h=0;for(var v=p.length;h<v;h+=3){var x=p[h+0],y=p[h+1],M=p[h+2];c.push(x,y,y,M,M,x)}}else for(p=h.array,u=h.version,h=0,v=p.length/3-1;h<v;h+=3)x=h+0,y=h+1,M=h+2,c.push(x,y,y,M,M,x);c=new(65535<Mo(c)?St:Bn)(c,1),c.version=u,t.update(c,34963),(p=s.get(a))&&t.remove(p),s.set(a,c)}var o=new WeakMap,s=new WeakMap;return{get:function(a,c){var u=o.get(c);return u||(c.addEventListener("dispose",i),c.isBufferGeometry?u=c:c.isGeometry&&(c._bufferGeometry===void 0&&(c._bufferGeometry=new re().setFromObject(a)),u=c._bufferGeometry),o.set(c,u),n.memory.geometries++,u)},update:function(a){var c=a.index,u=a.attributes;c!==null&&t.update(c,34963);for(var h in u)t.update(u[h],34962);a=a.morphAttributes;for(h in a){c=a[h],u=0;for(var p=c.length;u<p;u++)t.update(c[u],34962)}},getWireframeAttribute:function(a){var c=s.get(a);if(c){var u=a.index;u!==null&&c.version<u.version&&r(a)}else r(a);return s.get(a)}}}function Ts(e,t,n,i){var r,o,s;this.setMode=function(a){r=a},this.setIndex=function(a){o=a.type,s=a.bytesPerElement},this.render=function(a,c){e.drawElements(r,c,o,a*s),n.update(c,r)},this.renderInstances=function(a,c,u,h){if(h!==0){if(i.isWebGL2){a=e;var p="drawElementsInstanced"}else if(a=t.get("ANGLE_instanced_arrays"),p="drawElementsInstancedANGLE",a===null){console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}a[p](r,u,o,c*s,h),n.update(u,r,h)}}}function Eo(e){var t={frame:0,calls:0,triangles:0,points:0,lines:0};return{memory:{geometries:0,textures:0},render:t,programs:null,autoReset:!0,reset:function(){t.frame++,t.calls=0,t.triangles=0,t.points=0,t.lines=0},update:function(n,i,r){switch(r=r||1,t.calls++,i){case 4:t.triangles+=n/3*r;break;case 5:case 6:t.triangles+=r*(n-2);break;case 1:t.lines+=n/2*r;break;case 3:t.lines+=r*(n-1);break;case 2:t.lines+=r*n;break;case 0:t.points+=r*n;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",i)}}}}function _s(e,t){return Math.abs(t[1])-Math.abs(e[1])}function Cs(e){var t={},n=new Float32Array(8);return{update:function(i,r,o,s){var a=i.morphTargetInfluences,c=a.length;if(i=t[r.id],i===void 0){i=[];for(var u=0;u<c;u++)i[u]=[u,0];t[r.id]=i}var h=o.morphTargets&&r.morphAttributes.position;for(o=o.morphNormals&&r.morphAttributes.normal,u=0;u<c;u++){var p=i[u];p[1]!==0&&(h&&r.removeAttribute("morphTarget"+u),o&&r.removeAttribute("morphNormal"+u))}for(u=0;u<c;u++)p=i[u],p[0]=u,p[1]=a[u];for(i.sort(_s),u=0;8>u;u++){if((p=i[u])&&(a=p[0],c=p[1])){h&&r.addAttribute("morphTarget"+u,h[a]),o&&r.addAttribute("morphNormal"+u,o[a]),n[u]=c;continue}n[u]=0}s.getUniforms().setValue(e,"morphTargetInfluences",n)}}}function ji(e,t,n,i){var r={};return{update:function(o){var s=i.render.frame,a=o.geometry,c=t.get(o,a);return r[c.id]!==s&&(a.isGeometry&&c.updateFromObject(o),t.update(c),r[c.id]=s),o.isInstancedMesh&&n.update(o.instanceMatrix,34962),c},dispose:function(){r={}}}}function Ct(e,t,n,i,r,o,s,a,c,u){e=e!==void 0?e:[],Ae.call(this,e,t!==void 0?t:301,n,i,r,o,s!==void 0?s:1022,a,c,u),this.flipY=!1}function en(e,t,n,i){Ae.call(this,null),this.image={data:e||null,width:t||1,height:n||1,depth:i||1},this.minFilter=this.magFilter=1003,this.wrapR=1001,this.flipY=this.generateMipmaps=!1,this.needsUpdate=!0}function Gt(e,t,n,i){Ae.call(this,null),this.image={data:e||null,width:t||1,height:n||1,depth:i||1},this.minFilter=this.magFilter=1003,this.wrapR=1001,this.flipY=this.generateMipmaps=!1,this.needsUpdate=!0}function ii(e,t,n){var i=e[0];if(0>=i||0<i)return e;var r=t*n,o=su[r];if(o===void 0&&(o=new Float32Array(r),su[r]=o),t!==0)for(i.toArray(o,0),i=1,r=0;i!==t;++i)r+=n,e[i].toArray(o,r);return o}function Qt(e,t){if(e.length!==t.length)return!1;for(var n=0,i=e.length;n<i;n++)if(e[n]!==t[n])return!1;return!0}function Tt(e,t){for(var n=0,i=t.length;n<i;n++)e[n]=t[n]}function gn(e,t){var n=au[t];n===void 0&&(n=new Int32Array(t),au[t]=n);for(var i=0;i!==t;++i)n[i]=e.allocateTextureUnit();return n}function Ls(e,t){var n=this.cache;n[0]!==t&&(e.uniform1f(this.addr,t),n[0]=t)}function Ne(e,t){var n=this.cache;t.x!==void 0?(n[0]!==t.x||n[1]!==t.y)&&(e.uniform2f(this.addr,t.x,t.y),n[0]=t.x,n[1]=t.y):Qt(n,t)||(e.uniform2fv(this.addr,t),Tt(n,t))}function $a(e,t){var n=this.cache;t.x!==void 0?(n[0]!==t.x||n[1]!==t.y||n[2]!==t.z)&&(e.uniform3f(this.addr,t.x,t.y,t.z),n[0]=t.x,n[1]=t.y,n[2]=t.z):t.r!==void 0?(n[0]!==t.r||n[1]!==t.g||n[2]!==t.b)&&(e.uniform3f(this.addr,t.r,t.g,t.b),n[0]=t.r,n[1]=t.g,n[2]=t.b):Qt(n,t)||(e.uniform3fv(this.addr,t),Tt(n,t))}function Ps(e,t){var n=this.cache;t.x!==void 0?(n[0]!==t.x||n[1]!==t.y||n[2]!==t.z||n[3]!==t.w)&&(e.uniform4f(this.addr,t.x,t.y,t.z,t.w),n[0]=t.x,n[1]=t.y,n[2]=t.z,n[3]=t.w):Qt(n,t)||(e.uniform4fv(this.addr,t),Tt(n,t))}function dt(e,t){var n=this.cache,i=t.elements;i===void 0?Qt(n,t)||(e.uniformMatrix2fv(this.addr,!1,t),Tt(n,t)):Qt(n,i)||(uu.set(i),e.uniformMatrix2fv(this.addr,!1,uu),Tt(n,i))}function Dt(e,t){var n=this.cache,i=t.elements;i===void 0?Qt(n,t)||(e.uniformMatrix3fv(this.addr,!1,t),Tt(n,t)):Qt(n,i)||(lu.set(i),e.uniformMatrix3fv(this.addr,!1,lu),Tt(n,i))}function ec(e,t){var n=this.cache,i=t.elements;i===void 0?Qt(n,t)||(e.uniformMatrix4fv(this.addr,!1,t),Tt(n,t)):Qt(n,i)||(cu.set(i),e.uniformMatrix4fv(this.addr,!1,cu),Tt(n,i))}function bs(e,t,n){var i=this.cache,r=n.allocateTextureUnit();i[0]!==r&&(e.uniform1i(this.addr,r),i[0]=r),n.safeSetTexture2D(t||ru,r)}function tc(e,t,n){var i=this.cache,r=n.allocateTextureUnit();i[0]!==r&&(e.uniform1i(this.addr,r),i[0]=r),n.setTexture2DArray(t||gh,r)}function Rs(e,t,n){var i=this.cache,r=n.allocateTextureUnit();i[0]!==r&&(e.uniform1i(this.addr,r),i[0]=r),n.setTexture3D(t||yh,r)}function sn(e,t,n){var i=this.cache,r=n.allocateTextureUnit();i[0]!==r&&(e.uniform1i(this.addr,r),i[0]=r),n.safeSetTextureCube(t||ou,r)}function nc(e,t){var n=this.cache;n[0]!==t&&(e.uniform1i(this.addr,t),n[0]=t)}function ic(e,t){var n=this.cache;Qt(n,t)||(e.uniform2iv(this.addr,t),Tt(n,t))}function So(e,t){var n=this.cache;Qt(n,t)||(e.uniform3iv(this.addr,t),Tt(n,t))}function To(e,t){var n=this.cache;Qt(n,t)||(e.uniform4iv(this.addr,t),Tt(n,t))}function Ds(e){switch(e){case 5126:return Ls;case 35664:return Ne;case 35665:return $a;case 35666:return Ps;case 35674:return dt;case 35675:return Dt;case 35676:return ec;case 35678:case 36198:return bs;case 35679:return Rs;case 35680:return sn;case 36289:return tc;case 5124:case 35670:return nc;case 35667:case 35671:return ic;case 35668:case 35672:return So;case 35669:case 35673:return To}}function rc(e,t){e.uniform1fv(this.addr,t)}function oc(e,t){e.uniform1iv(this.addr,t)}function sc(e,t){e.uniform2iv(this.addr,t)}function ac(e,t){e.uniform3iv(this.addr,t)}function cc(e,t){e.uniform4iv(this.addr,t)}function lc(e,t){t=ii(t,this.size,2),e.uniform2fv(this.addr,t)}function uc(e,t){t=ii(t,this.size,3),e.uniform3fv(this.addr,t)}function hc(e,t){t=ii(t,this.size,4),e.uniform4fv(this.addr,t)}function Bs(e,t){t=ii(t,this.size,4),e.uniformMatrix2fv(this.addr,!1,t)}function dc(e,t){t=ii(t,this.size,9),e.uniformMatrix3fv(this.addr,!1,t)}function Ti(e,t){t=ii(t,this.size,16),e.uniformMatrix4fv(this.addr,!1,t)}function _o(e,t,n){var i=t.length,r=gn(n,i);for(e.uniform1iv(this.addr,r),e=0;e!==i;++e)n.safeSetTexture2D(t[e]||ru,r[e])}function Is(e,t,n){var i=t.length,r=gn(n,i);for(e.uniform1iv(this.addr,r),e=0;e!==i;++e)n.safeSetTextureCube(t[e]||ou,r[e])}function pc(e){switch(e){case 5126:return rc;case 35664:return lc;case 35665:return uc;case 35666:return hc;case 35674:return Bs;case 35675:return dc;case 35676:return Ti;case 35678:return _o;case 35680:return Is;case 5124:case 35670:return oc;case 35667:case 35671:return sc;case 35668:case 35672:return ac;case 35669:case 35673:return cc}}function fc(e,t,n){this.id=e,this.addr=n,this.cache=[],this.setValue=Ds(t.type)}function Os(e,t,n){this.id=e,this.addr=n,this.cache=[],this.size=t.size,this.setValue=pc(t.type)}function Fs(e){this.id=e,this.seq=[],this.map={}}function Fn(e,t){this.seq=[],this.map={};for(var n=e.getProgramParameter(t,35718),i=0;i<n;++i){var r=e.getActiveUniform(t,i),o=e.getUniformLocation(t,r.name),s=this,a=r.name,c=a.length;for(al.lastIndex=0;;){var u=al.exec(a),h=al.lastIndex,p=u[1],v=u[3];if(u[2]==="]"&&(p|=0),v===void 0||v==="["&&h+2===c){a=s,r=v===void 0?new fc(p,r,o):new Os(p,r,o),a.seq.push(r),a.map[r.id]=r;break}else v=s.map[p],v===void 0&&(v=new Fs(p),p=s,s=v,p.seq.push(s),p.map[s.id]=s),s=v}}}function Ns(e,t,n){return t=e.createShader(t),e.shaderSource(t,n),e.compileShader(t),t}function Us(e){switch(e){case 3e3:return["Linear","( value )"];case 3001:return["sRGB","( value )"];case 3002:return["RGBE","( value )"];case 3004:return["RGBM","( value, 7.0 )"];case 3005:return["RGBM","( value, 16.0 )"];case 3006:return["RGBD","( value, 256.0 )"];case 3007:return["Gamma","( value, float( GAMMA_FACTOR ) )"];case 3003:return["LogLuv","( value )"];default:throw Error("unsupported encoding: "+e)}}function zs(e,t,n){var i=e.getShaderParameter(t,35713),r=e.getShaderInfoLog(t).trim();if(i&&r==="")return"";for(e=e.getShaderSource(t).split(`
`),t=0;t<e.length;t++)e[t]=t+1+": "+e[t];return e=e.join(`
`),"THREE.WebGLShader: gl.getShaderInfoLog() "+n+`
`+r+e}function Nn(e,t){return t=Us(t),"vec4 "+e+"( vec4 value ) { return "+t[0]+"ToLinear"+t[1]+"; }"}function Gs(e,t){return t=Us(t),"vec4 "+e+"( vec4 value ) { return LinearTo"+t[0]+t[1]+"; }"}function mc(e,t){switch(t){case 1:t="Linear";break;case 2:t="Reinhard";break;case 3:t="Uncharted2";break;case 4:t="OptimizedCineon";break;case 5:t="ACESFilmic";break;default:throw Error("unsupported toneMapping: "+t)}return"vec3 "+e+"( vec3 color ) { return "+t+"ToneMapping( color ); }"}function vc(e,t,n){return e=e||{},[e.derivatives||t.envMapCubeUV||t.bumpMap||t.tangentSpaceNormalMap||t.clearcoatNormalMap||t.flatShading?"#extension GL_OES_standard_derivatives : enable":"",(e.fragDepth||t.logarithmicDepthBuffer)&&n.get("EXT_frag_depth")?"#extension GL_EXT_frag_depth : enable":"",e.drawBuffers&&n.get("WEBGL_draw_buffers")?"#extension GL_EXT_draw_buffers : require":"",(e.shaderTextureLOD||t.envMap)&&n.get("EXT_shader_texture_lod")?"#extension GL_EXT_shader_texture_lod : enable":""].filter(Wi).join(`
`)}function gc(e){var t=[],n;for(n in e){var i=e[n];i!==!1&&t.push("#define "+n+" "+i)}return t.join(`
`)}function Wi(e){return e!==""}function ri(e,t){return e.replace(/NUM_DIR_LIGHTS/g,t.numDirLights).replace(/NUM_SPOT_LIGHTS/g,t.numSpotLights).replace(/NUM_RECT_AREA_LIGHTS/g,t.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,t.numPointLights).replace(/NUM_HEMI_LIGHTS/g,t.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,t.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS/g,t.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,t.numPointLightShadows)}function Hs(e,t){return e.replace(/NUM_CLIPPING_PLANES/g,t.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,t.numClippingPlanes-t.numClipIntersection)}function Co(e,t){if(e=nt[t],e===void 0)throw Error("Can not resolve #include <"+t+">");return e.replace(cl,Co)}function Vs(e,t,n,i){for(e="",t=parseInt(t);t<parseInt(n);t++)e+=i.replace(/\[ i \]/g,"[ "+t+" ]").replace(/UNROLLED_LOOP_INDEX/g,t);return e}function js(e){var t="precision "+e.precision+` float;
precision `+e.precision+" int;";return e.precision==="highp"?t+=`
#define HIGH_PRECISION`:e.precision==="mediump"?t+=`
#define MEDIUM_PRECISION`:e.precision==="lowp"&&(t+=`
#define LOW_PRECISION`),t}function ki(e){var t="SHADOWMAP_TYPE_BASIC";return e.shadowMapType===1?t="SHADOWMAP_TYPE_PCF":e.shadowMapType===2?t="SHADOWMAP_TYPE_PCF_SOFT":e.shadowMapType===3&&(t="SHADOWMAP_TYPE_VSM"),t}function _r(e,t){var n="ENVMAP_TYPE_CUBE";if(e.envMap)switch(t.envMap.mapping){case 301:case 302:n="ENVMAP_TYPE_CUBE";break;case 306:case 307:n="ENVMAP_TYPE_CUBE_UV";break;case 303:case 304:n="ENVMAP_TYPE_EQUIREC";break;case 305:n="ENVMAP_TYPE_SPHERE"}return n}function Yi(e,t){var n="ENVMAP_MODE_REFLECTION";if(e.envMap)switch(t.envMap.mapping){case 302:case 304:n="ENVMAP_MODE_REFRACTION"}return n}function _i(e,t){var n="ENVMAP_BLENDING_MULTIPLY";if(e.envMap)switch(t.combine){case 0:n="ENVMAP_BLENDING_MULTIPLY";break;case 1:n="ENVMAP_BLENDING_MIX";break;case 2:n="ENVMAP_BLENDING_ADD"}return n}function Lo(e,t,n,i,r,o){var s=e.getContext(),a=i.defines,c=r.vertexShader,u=r.fragmentShader,h=ki(o),p=_r(o,i),v=Yi(o,i),x=_i(o,i),y=0<e.gammaFactor?e.gammaFactor:1,M=o.isWebGL2?"":vc(i.extensions,o,t),L=gc(a),O=s.createProgram(),F=(a=e.getRenderTarget())&&a.isWebGLMultiviewRenderTarget?a.numViews:0;i.isRawShaderMaterial?(a=[L].filter(Wi).join(`
`),0<a.length&&(a+=`
`),t=[M,L].filter(Wi).join(`
`),0<t.length&&(t+=`
`)):(a=[js(o),"#define SHADER_NAME "+r.name,L,o.instancing?"#define USE_INSTANCING":"",o.supportsVertexTextures?"#define VERTEX_TEXTURES":"","#define GAMMA_FACTOR "+y,"#define MAX_BONES "+o.maxBones,o.useFog&&o.fog?"#define USE_FOG":"",o.useFog&&o.fogExp2?"#define FOG_EXP2":"",o.map?"#define USE_MAP":"",o.envMap?"#define USE_ENVMAP":"",o.envMap?"#define "+v:"",o.lightMap?"#define USE_LIGHTMAP":"",o.aoMap?"#define USE_AOMAP":"",o.emissiveMap?"#define USE_EMISSIVEMAP":"",o.bumpMap?"#define USE_BUMPMAP":"",o.normalMap?"#define USE_NORMALMAP":"",o.normalMap&&o.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",o.normalMap&&o.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",o.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",o.displacementMap&&o.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",o.specularMap?"#define USE_SPECULARMAP":"",o.roughnessMap?"#define USE_ROUGHNESSMAP":"",o.metalnessMap?"#define USE_METALNESSMAP":"",o.alphaMap?"#define USE_ALPHAMAP":"",o.vertexTangents?"#define USE_TANGENT":"",o.vertexColors?"#define USE_COLOR":"",o.vertexUvs?"#define USE_UV":"",o.flatShading?"#define FLAT_SHADED":"",o.skinning?"#define USE_SKINNING":"",o.useVertexTexture?"#define BONE_TEXTURE":"",o.morphTargets?"#define USE_MORPHTARGETS":"",o.morphNormals&&o.flatShading===!1?"#define USE_MORPHNORMALS":"",o.doubleSided?"#define DOUBLE_SIDED":"",o.flipSided?"#define FLIP_SIDED":"",o.shadowMapEnabled?"#define USE_SHADOWMAP":"",o.shadowMapEnabled?"#define "+h:"",o.sizeAttenuation?"#define USE_SIZEATTENUATION":"",o.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",o.logarithmicDepthBuffer&&(o.isWebGL2||t.get("EXT_frag_depth"))?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","#ifdef USE_INSTANCING"," attribute mat4 instanceMatrix;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_TANGENT","	attribute vec4 tangent;","#endif","#ifdef USE_COLOR","	attribute vec3 color;","#endif","#ifdef USE_MORPHTARGETS","	attribute vec3 morphTarget0;","	attribute vec3 morphTarget1;","	attribute vec3 morphTarget2;","	attribute vec3 morphTarget3;","	#ifdef USE_MORPHNORMALS","		attribute vec3 morphNormal0;","		attribute vec3 morphNormal1;","		attribute vec3 morphNormal2;","		attribute vec3 morphNormal3;","	#else","		attribute vec3 morphTarget4;","		attribute vec3 morphTarget5;","		attribute vec3 morphTarget6;","		attribute vec3 morphTarget7;","	#endif","#endif","#ifdef USE_SKINNING","	attribute vec4 skinIndex;","	attribute vec4 skinWeight;","#endif",`
`].filter(Wi).join(`
`),t=[M,js(o),"#define SHADER_NAME "+r.name,L,o.alphaTest?"#define ALPHATEST "+o.alphaTest+(o.alphaTest%1?"":".0"):"","#define GAMMA_FACTOR "+y,o.useFog&&o.fog?"#define USE_FOG":"",o.useFog&&o.fogExp2?"#define FOG_EXP2":"",o.map?"#define USE_MAP":"",o.matcap?"#define USE_MATCAP":"",o.envMap?"#define USE_ENVMAP":"",o.envMap?"#define "+p:"",o.envMap?"#define "+v:"",o.envMap?"#define "+x:"",o.lightMap?"#define USE_LIGHTMAP":"",o.aoMap?"#define USE_AOMAP":"",o.emissiveMap?"#define USE_EMISSIVEMAP":"",o.bumpMap?"#define USE_BUMPMAP":"",o.normalMap?"#define USE_NORMALMAP":"",o.normalMap&&o.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",o.normalMap&&o.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",o.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",o.specularMap?"#define USE_SPECULARMAP":"",o.roughnessMap?"#define USE_ROUGHNESSMAP":"",o.metalnessMap?"#define USE_METALNESSMAP":"",o.alphaMap?"#define USE_ALPHAMAP":"",o.sheen?"#define USE_SHEEN":"",o.vertexTangents?"#define USE_TANGENT":"",o.vertexColors?"#define USE_COLOR":"",o.vertexUvs?"#define USE_UV":"",o.gradientMap?"#define USE_GRADIENTMAP":"",o.flatShading?"#define FLAT_SHADED":"",o.doubleSided?"#define DOUBLE_SIDED":"",o.flipSided?"#define FLIP_SIDED":"",o.shadowMapEnabled?"#define USE_SHADOWMAP":"",o.shadowMapEnabled?"#define "+h:"",o.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",o.physicallyCorrectLights?"#define PHYSICALLY_CORRECT_LIGHTS":"",o.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",o.logarithmicDepthBuffer&&(o.isWebGL2||t.get("EXT_frag_depth"))?"#define USE_LOGDEPTHBUF_EXT":"",(i.extensions&&i.extensions.shaderTextureLOD||o.envMap)&&(o.isWebGL2||t.get("EXT_shader_texture_lod"))?"#define TEXTURE_LOD_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;",o.toneMapping!==0?"#define TONE_MAPPING":"",o.toneMapping!==0?nt.tonemapping_pars_fragment:"",o.toneMapping!==0?mc("toneMapping",o.toneMapping):"",o.dithering?"#define DITHERING":"",o.outputEncoding||o.mapEncoding||o.matcapEncoding||o.envMapEncoding||o.emissiveMapEncoding?nt.encodings_pars_fragment:"",o.mapEncoding?Nn("mapTexelToLinear",o.mapEncoding):"",o.matcapEncoding?Nn("matcapTexelToLinear",o.matcapEncoding):"",o.envMapEncoding?Nn("envMapTexelToLinear",o.envMapEncoding):"",o.emissiveMapEncoding?Nn("emissiveMapTexelToLinear",o.emissiveMapEncoding):"",o.outputEncoding?Gs("linearToOutputTexel",o.outputEncoding):"",o.depthPacking?"#define DEPTH_PACKING "+i.depthPacking:"",`
`].filter(Wi).join(`
`)),c=c.replace(cl,Co),c=ri(c,o),c=Hs(c,o),u=u.replace(cl,Co),u=ri(u,o),u=Hs(u,o),c=c.replace(hu,Vs),u=u.replace(hu,Vs),o.isWebGL2&&!i.isRawShaderMaterial&&(h=!1,p=/^\s*#version\s+300\s+es\s*\n/,i.isShaderMaterial&&c.match(p)!==null&&u.match(p)!==null&&(h=!0,c=c.replace(p,""),u=u.replace(p,"")),a=`#version 300 es

#define attribute in
#define varying out
#define texture2D texture
`+a,t=[`#version 300 es

#define varying in`,h?"":"out highp vec4 pc_fragColor;",h?"":"#define gl_FragColor pc_fragColor",`#define gl_FragDepthEXT gl_FragDepth
#define texture2D texture
#define textureCube texture
#define texture2DProj textureProj
#define texture2DLodEXT textureLod
#define texture2DProjLodEXT textureProjLod
#define textureCubeLodEXT textureLod
#define texture2DGradEXT textureGrad
#define texture2DProjGradEXT textureProjGrad
#define textureCubeGradEXT textureGrad`].join(`
`)+`
`+t,0<F&&(a=a.replace(`#version 300 es
`,[`#version 300 es

#extension GL_OVR_multiview2 : require`,"layout(num_views = "+F+") in;","#define VIEW_ID gl_ViewID_OVR"].join(`
`)),a=a.replace(`uniform mat4 modelViewMatrix;
uniform mat4 projectionMatrix;
uniform mat4 viewMatrix;
uniform mat3 normalMatrix;`,["uniform mat4 modelViewMatrices["+F+"];","uniform mat4 projectionMatrices["+F+"];","uniform mat4 viewMatrices["+F+"];","uniform mat3 normalMatrices["+F+"];",`#define modelViewMatrix modelViewMatrices[VIEW_ID]
#define projectionMatrix projectionMatrices[VIEW_ID]
#define viewMatrix viewMatrices[VIEW_ID]
#define normalMatrix normalMatrices[VIEW_ID]`].join(`
`)),t=t.replace(`#version 300 es
`,`#version 300 es

#extension GL_OVR_multiview2 : require
#define VIEW_ID gl_ViewID_OVR`),t=t.replace("uniform mat4 viewMatrix;",["uniform mat4 viewMatrices["+F+"];","#define viewMatrix viewMatrices[VIEW_ID]"].join(`
`)))),u=t+u,c=Ns(s,35633,a+c),u=Ns(s,35632,u),s.attachShader(O,c),s.attachShader(O,u),i.index0AttributeName!==void 0?s.bindAttribLocation(O,0,i.index0AttributeName):o.morphTargets===!0&&s.bindAttribLocation(O,0,"position"),s.linkProgram(O),e.debug.checkShaderErrors&&(e=s.getProgramInfoLog(O).trim(),o=s.getShaderInfoLog(c).trim(),h=s.getShaderInfoLog(u).trim(),v=p=!0,s.getProgramParameter(O,35714)===!1?(p=!1,x=zs(s,c,"vertex"),y=zs(s,u,"fragment"),console.error("THREE.WebGLProgram: shader error: ",s.getError(),"35715",s.getProgramParameter(O,35715),"gl.getProgramInfoLog",e,x,y)):e!==""?console.warn("THREE.WebGLProgram: gl.getProgramInfoLog()",e):(o===""||h==="")&&(v=!1),v&&(this.diagnostics={runnable:p,material:i,programLog:e,vertexShader:{log:o,prefix:a},fragmentShader:{log:h,prefix:t}})),s.deleteShader(c),s.deleteShader(u);var z;this.getUniforms=function(){return z===void 0&&(z=new Fn(s,O)),z};var V;return this.getAttributes=function(){if(V===void 0){for(var B={},Y=s.getProgramParameter(O,35721),Z=0;Z<Y;Z++){var fe=s.getActiveAttrib(O,Z).name;B[fe]=s.getAttribLocation(O,fe)}V=B}return V},this.destroy=function(){s.deleteProgram(O),this.program=void 0},this.name=r.name,this.id=xh++,this.code=n,this.usedTimes=1,this.program=O,this.vertexShader=c,this.fragmentShader=u,this.numMultiviewViews=F,this}function Po(e,t,n){function i(a,c){if(a)a.isTexture?u=a.encoding:a.isWebGLRenderTarget&&(console.warn("THREE.WebGLPrograms.getTextureEncodingFromMap: don't use render targets as textures. Use their .texture property instead."),u=a.texture.encoding);else var u=3e3;return u===3e3&&c&&(u=3007),u}var r=[],o={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"phong",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"},s="precision supportsVertexTextures instancing map mapEncoding matcap matcapEncoding envMap envMapMode envMapEncoding lightMap aoMap emissiveMap emissiveMapEncoding bumpMap normalMap objectSpaceNormalMap tangentSpaceNormalMap clearcoatNormalMap displacementMap specularMap roughnessMap metalnessMap gradientMap alphaMap combine vertexColors vertexTangents fog useFog fogExp2 flatShading sizeAttenuation logarithmicDepthBuffer skinning maxBones useVertexTexture morphTargets morphNormals maxMorphTargets maxMorphNormals premultipliedAlpha numDirLights numPointLights numSpotLights numHemiLights numRectAreaLights shadowMapEnabled shadowMapType toneMapping physicallyCorrectLights alphaTest doubleSided flipSided numClippingPlanes numClipIntersection depthPacking dithering sheen".split(" ");this.getParameters=function(a,c,u,h,p,v,x){var y=o[a.type];if(x.isSkinnedMesh){var M=x.skeleton.bones;if(n.floatVertexTextures)M=1024;else{var L=Math.min(Math.floor((n.maxVertexUniforms-20)/4),M.length);L<M.length?(console.warn("THREE.WebGLRenderer: Skeleton has "+M.length+" bones. This GPU supports "+L+"."),M=0):M=L}}else M=0;L=n.precision,a.precision!==null&&(L=n.getMaxPrecision(a.precision),L!==a.precision&&console.warn("THREE.WebGLProgram.getParameters:",a.precision,"not supported, using",L,"instead."));var O=e.getRenderTarget();return{isWebGL2:n.isWebGL2,shaderID:y,precision:L,instancing:x.isInstancedMesh===!0,supportsVertexTextures:n.vertexTextures,outputEncoding:i(O?O.texture:null,e.gammaOutput),map:!!a.map,mapEncoding:i(a.map,e.gammaInput),matcap:!!a.matcap,matcapEncoding:i(a.matcap,e.gammaInput),envMap:!!a.envMap,envMapMode:a.envMap&&a.envMap.mapping,envMapEncoding:i(a.envMap,e.gammaInput),envMapCubeUV:!!a.envMap&&(a.envMap.mapping===306||a.envMap.mapping===307),lightMap:!!a.lightMap,aoMap:!!a.aoMap,emissiveMap:!!a.emissiveMap,emissiveMapEncoding:i(a.emissiveMap,e.gammaInput),bumpMap:!!a.bumpMap,normalMap:!!a.normalMap,objectSpaceNormalMap:a.normalMapType===1,tangentSpaceNormalMap:a.normalMapType===0,clearcoatNormalMap:!!a.clearcoatNormalMap,displacementMap:!!a.displacementMap,roughnessMap:!!a.roughnessMap,metalnessMap:!!a.metalnessMap,specularMap:!!a.specularMap,alphaMap:!!a.alphaMap,gradientMap:!!a.gradientMap,sheen:!!a.sheen,combine:a.combine,vertexTangents:a.normalMap&&a.vertexTangents,vertexColors:a.vertexColors,vertexUvs:!!a.map||!!a.bumpMap||!!a.normalMap||!!a.specularMap||!!a.alphaMap||!!a.emissiveMap||!!a.roughnessMap||!!a.metalnessMap||!!a.clearcoatNormalMap,fog:!!h,useFog:a.fog,fogExp2:h&&h.isFogExp2,flatShading:a.flatShading,sizeAttenuation:a.sizeAttenuation,logarithmicDepthBuffer:n.logarithmicDepthBuffer,skinning:a.skinning&&0<M,maxBones:M,useVertexTexture:n.floatVertexTextures,morphTargets:a.morphTargets,morphNormals:a.morphNormals,maxMorphTargets:e.maxMorphTargets,maxMorphNormals:e.maxMorphNormals,numDirLights:c.directional.length,numPointLights:c.point.length,numSpotLights:c.spot.length,numRectAreaLights:c.rectArea.length,numHemiLights:c.hemi.length,numDirLightShadows:c.directionalShadowMap.length,numPointLightShadows:c.pointShadowMap.length,numSpotLightShadows:c.spotShadowMap.length,numClippingPlanes:p,numClipIntersection:v,dithering:a.dithering,shadowMapEnabled:e.shadowMap.enabled&&0<u.length,shadowMapType:e.shadowMap.type,toneMapping:a.toneMapped?e.toneMapping:0,physicallyCorrectLights:e.physicallyCorrectLights,premultipliedAlpha:a.premultipliedAlpha,alphaTest:a.alphaTest,doubleSided:a.side===2,flipSided:a.side===1,depthPacking:a.depthPacking!==void 0?a.depthPacking:!1}},this.getProgramCode=function(a,c){var u=[];if(c.shaderID?u.push(c.shaderID):(u.push(a.fragmentShader),u.push(a.vertexShader)),a.defines!==void 0)for(var h in a.defines)u.push(h),u.push(a.defines[h]);for(h=0;h<s.length;h++)u.push(c[s[h]]);return u.push(a.onBeforeCompile.toString()),u.push(e.gammaOutput),u.push(e.gammaFactor),u.join()},this.acquireProgram=function(a,c,u,h){for(var p,v=0,x=r.length;v<x;v++){var y=r[v];if(y.code===h){p=y,++p.usedTimes;break}}return p===void 0&&(p=new Lo(e,t,h,a,c,u),r.push(p)),p},this.releaseProgram=function(a){if(--a.usedTimes===0){var c=r.indexOf(a);r[c]=r[r.length-1],r.pop(),a.destroy()}},this.programs=r}function Ws(){var e=new WeakMap;return{get:function(t){var n=e.get(t);return n===void 0&&(n={},e.set(t,n)),n},remove:function(t){e.delete(t)},update:function(t,n,i){e.get(t)[n]=i},dispose:function(){e=new WeakMap}}}function yc(e,t){return e.groupOrder!==t.groupOrder?e.groupOrder-t.groupOrder:e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:e.program!==t.program?e.program.id-t.program.id:e.material.id!==t.material.id?e.material.id-t.material.id:e.z!==t.z?e.z-t.z:e.id-t.id}function ks(e,t){return e.groupOrder!==t.groupOrder?e.groupOrder-t.groupOrder:e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:e.z!==t.z?t.z-e.z:e.id-t.id}function Ys(){function e(s,a,c,u,h,p){var v=t[n];return v===void 0?(v={id:s.id,object:s,geometry:a,material:c,program:c.program||o,groupOrder:u,renderOrder:s.renderOrder,z:h,group:p},t[n]=v):(v.id=s.id,v.object=s,v.geometry=a,v.material=c,v.program=c.program||o,v.groupOrder=u,v.renderOrder=s.renderOrder,v.z=h,v.group=p),n++,v}var t=[],n=0,i=[],r=[],o={id:-1};return{opaque:i,transparent:r,init:function(){n=0,i.length=0,r.length=0},push:function(s,a,c,u,h,p){s=e(s,a,c,u,h,p),(c.transparent===!0?r:i).push(s)},unshift:function(s,a,c,u,h,p){s=e(s,a,c,u,h,p),(c.transparent===!0?r:i).unshift(s)},sort:function(){1<i.length&&i.sort(yc),1<r.length&&r.sort(ks)}}}function Cr(){function e(n){n=n.target,n.removeEventListener("dispose",e),t.delete(n)}var t=new WeakMap;return{get:function(n,i){var r=t.get(n);if(r===void 0){var o=new Ys;t.set(n,new WeakMap),t.get(n).set(i,o),n.addEventListener("dispose",e)}else o=r.get(i),o===void 0&&(o=new Ys,r.set(i,o));return o},dispose:function(){t=new WeakMap}}}function xc(){var e={};return{get:function(t){if(e[t.id]!==void 0)return e[t.id];switch(t.type){case"DirectionalLight":var n={direction:new E,color:new ve,shadow:!1,shadowBias:0,shadowRadius:1,shadowMapSize:new G};break;case"SpotLight":n={position:new E,direction:new E,color:new ve,distance:0,coneCos:0,penumbraCos:0,decay:0,shadow:!1,shadowBias:0,shadowRadius:1,shadowMapSize:new G};break;case"PointLight":n={position:new E,color:new ve,distance:0,decay:0,shadow:!1,shadowBias:0,shadowRadius:1,shadowMapSize:new G,shadowCameraNear:1,shadowCameraFar:1e3};break;case"HemisphereLight":n={direction:new E,skyColor:new ve,groundColor:new ve};break;case"RectAreaLight":n={color:new ve,position:new E,halfWidth:new E,halfHeight:new E}}return e[t.id]=n}}}function C(e,t){return(t.castShadow?1:0)-(e.castShadow?1:0)}function m(){for(var e=new xc,t={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotShadowMap:[],spotShadowMatrix:[],rectArea:[],point:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1},n=0;9>n;n++)t.probe.push(new E);var i=new E,r=new Se,o=new Se;return{setup:function(s,a,c){for(var u=0,h=0,p=0,v=0;9>v;v++)t.probe[v].set(0,0,0);var x=a=0,y=0,M=0,L=0,O=0,F=0,z=0;c=c.matrixWorldInverse,s.sort(C),v=0;for(var V=s.length;v<V;v++){var B=s[v],Y=B.color,Z=B.intensity,fe=B.distance,X=B.shadow&&B.shadow.map?B.shadow.map.texture:null;if(B.isAmbientLight)u+=Y.r*Z,h+=Y.g*Z,p+=Y.b*Z;else if(B.isLightProbe)for(X=0;9>X;X++)t.probe[X].addScaledVector(B.sh.coefficients[X],Z);else if(B.isDirectionalLight){var j=e.get(B);j.color.copy(B.color).multiplyScalar(B.intensity),j.direction.setFromMatrixPosition(B.matrixWorld),i.setFromMatrixPosition(B.target.matrixWorld),j.direction.sub(i),j.direction.transformDirection(c),(j.shadow=B.castShadow)&&(Z=B.shadow,j.shadowBias=Z.bias,j.shadowRadius=Z.radius,j.shadowMapSize=Z.mapSize,t.directionalShadowMap[a]=X,t.directionalShadowMatrix[a]=B.shadow.matrix,O++),t.directional[a]=j,a++}else B.isSpotLight?(j=e.get(B),j.position.setFromMatrixPosition(B.matrixWorld),j.position.applyMatrix4(c),j.color.copy(Y).multiplyScalar(Z),j.distance=fe,j.direction.setFromMatrixPosition(B.matrixWorld),i.setFromMatrixPosition(B.target.matrixWorld),j.direction.sub(i),j.direction.transformDirection(c),j.coneCos=Math.cos(B.angle),j.penumbraCos=Math.cos(B.angle*(1-B.penumbra)),j.decay=B.decay,(j.shadow=B.castShadow)&&(Z=B.shadow,j.shadowBias=Z.bias,j.shadowRadius=Z.radius,j.shadowMapSize=Z.mapSize,t.spotShadowMap[y]=X,t.spotShadowMatrix[y]=B.shadow.matrix,z++),t.spot[y]=j,y++):B.isRectAreaLight?(j=e.get(B),j.color.copy(Y).multiplyScalar(Z),j.position.setFromMatrixPosition(B.matrixWorld),j.position.applyMatrix4(c),o.identity(),r.copy(B.matrixWorld),r.premultiply(c),o.extractRotation(r),j.halfWidth.set(.5*B.width,0,0),j.halfHeight.set(0,.5*B.height,0),j.halfWidth.applyMatrix4(o),j.halfHeight.applyMatrix4(o),t.rectArea[M]=j,M++):B.isPointLight?(j=e.get(B),j.position.setFromMatrixPosition(B.matrixWorld),j.position.applyMatrix4(c),j.color.copy(B.color).multiplyScalar(B.intensity),j.distance=B.distance,j.decay=B.decay,(j.shadow=B.castShadow)&&(Z=B.shadow,j.shadowBias=Z.bias,j.shadowRadius=Z.radius,j.shadowMapSize=Z.mapSize,j.shadowCameraNear=Z.camera.near,j.shadowCameraFar=Z.camera.far,t.pointShadowMap[x]=X,t.pointShadowMatrix[x]=B.shadow.matrix,F++),t.point[x]=j,x++):B.isHemisphereLight&&(j=e.get(B),j.direction.setFromMatrixPosition(B.matrixWorld),j.direction.transformDirection(c),j.direction.normalize(),j.skyColor.copy(B.color).multiplyScalar(Z),j.groundColor.copy(B.groundColor).multiplyScalar(Z),t.hemi[L]=j,L++)}t.ambient[0]=u,t.ambient[1]=h,t.ambient[2]=p,s=t.hash,(s.directionalLength!==a||s.pointLength!==x||s.spotLength!==y||s.rectAreaLength!==M||s.hemiLength!==L||s.numDirectionalShadows!==O||s.numPointShadows!==F||s.numSpotShadows!==z)&&(t.directional.length=a,t.spot.length=y,t.rectArea.length=M,t.point.length=x,t.hemi.length=L,t.directionalShadowMap.length=O,t.pointShadowMap.length=F,t.spotShadowMap.length=z,t.directionalShadowMatrix.length=O,t.pointShadowMatrix.length=F,t.spotShadowMatrix.length=z,s.directionalLength=a,s.pointLength=x,s.spotLength=y,s.rectAreaLength=M,s.hemiLength=L,s.numDirectionalShadows=O,s.numPointShadows=F,s.numSpotShadows=z,t.version=wh++)},state:t}}function l(){var e=new m,t=[],n=[];return{init:function(){t.length=0,n.length=0},state:{lightsArray:t,shadowsArray:n,lights:e},setupLights:function(i){e.setup(t,n,i)},pushLight:function(i){t.push(i)},pushShadow:function(i){n.push(i)}}}function d(){function e(n){n=n.target,n.removeEventListener("dispose",e),t.delete(n)}var t=new WeakMap;return{get:function(n,i){if(t.has(n)===!1){var r=new l;t.set(n,new WeakMap),t.get(n).set(i,r),n.addEventListener("dispose",e)}else t.get(n).has(i)===!1?(r=new l,t.get(n).set(i,r)):r=t.get(n).get(i);return r},dispose:function(){t=new WeakMap}}}function g(e){ie.call(this),this.type="MeshDepthMaterial",this.depthPacking=3200,this.morphTargets=this.skinning=!1,this.displacementMap=this.alphaMap=this.map=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.setValues(e)}function A(e){ie.call(this),this.type="MeshDistanceMaterial",this.referencePosition=new E,this.nearDistance=1,this.farDistance=1e3,this.morphTargets=this.skinning=!1,this.displacementMap=this.alphaMap=this.map=null,this.displacementScale=1,this.displacementBias=0,this.fog=!1,this.setValues(e)}function S(e,t,n){function i(B,Y,Z,fe,X,j){var J=B.geometry,te=u,ze=B.customDepthMaterial;return Z.isPointLight&&(te=h,ze=B.customDistanceMaterial),ze?te=ze:(ze=!1,Y.morphTargets&&(J&&J.isBufferGeometry?ze=J.morphAttributes&&J.morphAttributes.position&&0<J.morphAttributes.position.length:J&&J.isGeometry&&(ze=J.morphTargets&&0<J.morphTargets.length)),B.isSkinnedMesh&&Y.skinning===!1&&console.warn("THREE.WebGLShadowMap: THREE.SkinnedMesh with material.skinning set to false:",B),B=B.isSkinnedMesh&&Y.skinning,J=0,ze&&(J|=1),B&&(J|=2),te=te[J]),e.localClippingEnabled&&Y.clipShadows===!0&&Y.clippingPlanes.length!==0&&(J=te.uuid,ze=Y.uuid,B=p[J],B===void 0&&(B={},p[J]=B),J=B[ze],J===void 0&&(J=te.clone(),B[ze]=J),te=J),te.visible=Y.visible,te.wireframe=Y.wireframe,te.side=j===3?Y.shadowSide!=null?Y.shadowSide:Y.side:Y.shadowSide!=null?Y.shadowSide:v[Y.side],te.clipShadows=Y.clipShadows,te.clippingPlanes=Y.clippingPlanes,te.clipIntersection=Y.clipIntersection,te.wireframeLinewidth=Y.wireframeLinewidth,te.linewidth=Y.linewidth,Z.isPointLight&&te.isMeshDistanceMaterial&&(te.referencePosition.setFromMatrixPosition(Z.matrixWorld),te.nearDistance=fe,te.farDistance=X),te}function r(B,Y,Z,fe,X){if(B.visible!==!1){if(B.layers.test(Y.layers)&&(B.isMesh||B.isLine||B.isPoints)&&(B.castShadow||B.receiveShadow&&X===3)&&(!B.frustumCulled||o.intersectsObject(B))){B.modelViewMatrix.multiplyMatrices(Z.matrixWorldInverse,B.matrixWorld);var j=t.update(B),J=B.material;if(Array.isArray(J))for(var te=j.groups,ze=0,We=te.length;ze<We;ze++){var _=te[ze],b=J[_.materialIndex];b&&b.visible&&(b=i(B,b,fe,Z.near,Z.far,X),e.renderBufferDirect(Z,null,j,b,B,_))}else J.visible&&(b=i(B,J,fe,Z.near,Z.far,X),e.renderBufferDirect(Z,null,j,b,B,null))}for(B=B.children,j=0,J=B.length;j<J;j++)r(B[j],Y,Z,fe,X)}}var o=new vn,s=new G,a=new G,c=new _e,u=Array(4),h=Array(4),p={},v={0:1,1:0,2:2},x=new Rt({defines:{SAMPLE_RATE:.25,HALF_SAMPLE_RATE:.125},uniforms:{shadow_pass:{value:null},resolution:{value:new G},radius:{value:4}},vertexShader:`void main() {
	gl_Position = vec4( position, 1.0 );
}`,fragmentShader:`uniform sampler2D shadow_pass;
uniform vec2 resolution;
uniform float radius;
#include <packing>
void main() {
  float mean = 0.0;
  float squared_mean = 0.0;
  
	float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy  ) / resolution ) );
  for ( float i = -1.0; i < 1.0 ; i += SAMPLE_RATE) {
    #ifdef HORIZONAL_PASS
      vec2 distribution = decodeHalfRGBA ( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( i, 0.0 ) * radius ) / resolution ) );
      mean += distribution.x;
      squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;
    #else
      float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0,  i )  * radius ) / resolution ) );
      mean += depth;
      squared_mean += depth * depth;
    #endif
  }
  mean = mean * HALF_SAMPLE_RATE;
  squared_mean = squared_mean * HALF_SAMPLE_RATE;
  float std_dev = pow( squared_mean - mean * mean, 0.5 );
  gl_FragColor = encodeHalfRGBA( vec2( mean, std_dev ) );
}`}),y=x.clone();y.defines.HORIZONAL_PASS=1;var M=new re;M.addAttribute("position",new Ce(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));var L=new yt(M,x);for(M=0;M!==4;++M){var O=(M&1)!==0,F=(M&2)!==0,z=new g({depthPacking:3201,morphTargets:O,skinning:F});u[M]=z,O=new A({morphTargets:O,skinning:F}),h[M]=O}var V=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=1,this.render=function(B,Y,Z){if(V.enabled!==!1&&(V.autoUpdate!==!1||V.needsUpdate!==!1)&&B.length!==0){var fe=e.getRenderTarget(),X=e.getActiveCubeFace(),j=e.getActiveMipmapLevel(),J=e.state;J.setBlending(0),J.buffers.color.setClear(1,1,1,1),J.buffers.depth.setTest(!0),J.setScissorTest(!1);for(var te=0,ze=B.length;te<ze;te++){var We=B[te],_=We.shadow;if(_===void 0)console.warn("THREE.WebGLShadowMap:",We,"has no shadow.");else{s.copy(_.mapSize);var b=_.getFrameExtents();s.multiply(b),a.copy(_.mapSize),(s.x>n||s.y>n)&&(console.warn("THREE.WebGLShadowMap:",We,"has shadow exceeding max texture size, reducing"),s.x>n&&(a.x=Math.floor(n/b.x),s.x=a.x*b.x,_.mapSize.x=a.x),s.y>n&&(a.y=Math.floor(n/b.y),s.y=a.y*b.y,_.mapSize.y=a.y)),_.map!==null||_.isPointLightShadow||this.type!==3||(b={minFilter:1006,magFilter:1006,format:1023},_.map=new je(s.x,s.y,b),_.map.texture.name=We.name+".shadowMap",_.mapPass=new je(s.x,s.y,b),_.camera.updateProjectionMatrix()),_.map===null&&(b={minFilter:1003,magFilter:1003,format:1023},_.map=new je(s.x,s.y,b),_.map.texture.name=We.name+".shadowMap",_.camera.updateProjectionMatrix()),e.setRenderTarget(_.map),e.clear(),b=_.getViewportCount();for(var H=0;H<b;H++){var K=_.getViewport(H);c.set(a.x*K.x,a.y*K.y,a.x*K.z,a.y*K.w),J.viewport(c),_.updateMatrices(We,Z,H),o=_.getFrustum(),r(Y,Z,_.camera,We,this.type)}_.isPointLightShadow||this.type!==3||(We=_,_=Z,b=t.update(L),x.uniforms.shadow_pass.value=We.map.texture,x.uniforms.resolution.value=We.mapSize,x.uniforms.radius.value=We.radius,e.setRenderTarget(We.mapPass),e.clear(),e.renderBufferDirect(_,null,b,x,L,null),y.uniforms.shadow_pass.value=We.mapPass.texture,y.uniforms.resolution.value=We.mapSize,y.uniforms.radius.value=We.radius,e.setRenderTarget(We.map),e.clear(),e.renderBufferDirect(_,null,b,y,L,null))}}V.needsUpdate=!1,e.setRenderTarget(fe,X,j)}}}function R(e,t,n,i){function r(U,ue,Ge){var st=new Uint8Array(4),De=e.createTexture();for(e.bindTexture(U,De),e.texParameteri(U,10241,9728),e.texParameteri(U,10240,9728),U=0;U<Ge;U++)e.texImage2D(ue+U,0,6408,1,1,0,6408,5121,st);return De}function o(U,ue){O[U]=1,F[U]===0&&(e.enableVertexAttribArray(U),F[U]=1),z[U]!==ue&&((i.isWebGL2?e:t.get("ANGLE_instanced_arrays"))[i.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](U,ue),z[U]=ue)}function s(U){V[U]!==!0&&(e.enable(U),V[U]=!0)}function a(U){V[U]!==!1&&(e.disable(U),V[U]=!1)}function c(U,ue,Ge,st,De,Ze,me,Ie){if(U===0)Z&&(a(3042),Z=!1);else if(Z||(s(3042),Z=!0),U!==5){if(U!==fe||Ie!==_){if((X!==100||te!==100)&&(e.blendEquation(32774),te=X=100),Ie)switch(U){case 1:e.blendFuncSeparate(1,771,1,771);break;case 2:e.blendFunc(1,1);break;case 3:e.blendFuncSeparate(0,0,769,771);break;case 4:e.blendFuncSeparate(0,768,0,770);break;default:console.error("THREE.WebGLState: Invalid blending: ",U)}else switch(U){case 1:e.blendFuncSeparate(770,771,1,771);break;case 2:e.blendFunc(770,1);break;case 3:e.blendFunc(0,769);break;case 4:e.blendFunc(0,768);break;default:console.error("THREE.WebGLState: Invalid blending: ",U)}We=ze=J=j=null,fe=U,_=Ie}}else De=De||ue,Ze=Ze||Ge,me=me||st,(ue!==X||De!==te)&&(e.blendEquationSeparate(n.convert(ue),n.convert(De)),X=ue,te=De),(Ge!==j||st!==J||Ze!==ze||me!==We)&&(e.blendFuncSeparate(n.convert(Ge),n.convert(st),n.convert(Ze),n.convert(me)),j=Ge,J=st,ze=Ze,We=me),fe=U,_=null}function u(U){b!==U&&(U?e.frontFace(2304):e.frontFace(2305),b=U)}function h(U){U!==0?(s(2884),U!==H&&(U===1?e.cullFace(1029):U===2?e.cullFace(1028):e.cullFace(1032))):a(2884),H=U}function p(U,ue,Ge){U?(s(32823),(se!==ue||ae!==Ge)&&(e.polygonOffset(ue,Ge),se=ue,ae=Ge)):a(32823)}function v(U){U===void 0&&(U=33984+et-1),Te!==U&&(e.activeTexture(U),Te=U)}var x=new function(){var U=!1,ue=new _e,Ge=null,st=new _e(0,0,0,0);return{setMask:function(De){Ge===De||U||(e.colorMask(De,De,De,De),Ge=De)},setLocked:function(De){U=De},setClear:function(De,Ze,me,Ie,Mt){Mt===!0&&(De*=Ie,Ze*=Ie,me*=Ie),ue.set(De,Ze,me,Ie),st.equals(ue)===!1&&(e.clearColor(De,Ze,me,Ie),st.copy(ue))},reset:function(){U=!1,Ge=null,st.set(-1,0,0,0)}}},y=new function(){var U=!1,ue=null,Ge=null,st=null;return{setTest:function(De){De?s(2929):a(2929)},setMask:function(De){ue===De||U||(e.depthMask(De),ue=De)},setFunc:function(De){if(Ge!==De){if(De)switch(De){case 0:e.depthFunc(512);break;case 1:e.depthFunc(519);break;case 2:e.depthFunc(513);break;case 3:e.depthFunc(515);break;case 4:e.depthFunc(514);break;case 5:e.depthFunc(518);break;case 6:e.depthFunc(516);break;case 7:e.depthFunc(517);break;default:e.depthFunc(515)}else e.depthFunc(515);Ge=De}},setLocked:function(De){U=De},setClear:function(De){st!==De&&(e.clearDepth(De),st=De)},reset:function(){U=!1,st=Ge=ue=null}}},M=new function(){var U=!1,ue=null,Ge=null,st=null,De=null,Ze=null,me=null,Ie=null,Mt=null;return{setTest:function(He){U||(He?s(2960):a(2960))},setMask:function(He){ue===He||U||(e.stencilMask(He),ue=He)},setFunc:function(He,Ke,$){(Ge!==He||st!==Ke||De!==$)&&(e.stencilFunc(He,Ke,$),Ge=He,st=Ke,De=$)},setOp:function(He,Ke,$){(Ze!==He||me!==Ke||Ie!==$)&&(e.stencilOp(He,Ke,$),Ze=He,me=Ke,Ie=$)},setLocked:function(He){U=He},setClear:function(He){Mt!==He&&(e.clearStencil(He),Mt=He)},reset:function(){U=!1,Mt=Ie=me=Ze=De=st=Ge=ue=null}}},L=e.getParameter(34921),O=new Uint8Array(L),F=new Uint8Array(L),z=new Uint8Array(L),V={},B=null,Y=null,Z=null,fe=null,X=null,j=null,J=null,te=null,ze=null,We=null,_=!1,b=null,H=null,K=null,se=null,ae=null,et=e.getParameter(35661),Le=!1;L=0,L=e.getParameter(7938),L.indexOf("WebGL")!==-1?(L=parseFloat(/^WebGL ([0-9])/.exec(L)[1]),Le=1<=L):L.indexOf("OpenGL ES")!==-1&&(L=parseFloat(/^OpenGL ES ([0-9])/.exec(L)[1]),Le=2<=L);var Te=null,Be={},qe=new _e,mt=new _e,oe={};return oe[3553]=r(3553,3553,1),oe[34067]=r(34067,34069,6),x.setClear(0,0,0,1),y.setClear(1),M.setClear(0),s(2929),y.setFunc(3),u(!1),h(1),s(2884),c(0),{buffers:{color:x,depth:y,stencil:M},initAttributes:function(){for(var U=0,ue=O.length;U<ue;U++)O[U]=0},enableAttribute:function(U){o(U,0)},enableAttributeAndDivisor:o,disableUnusedAttributes:function(){for(var U=0,ue=F.length;U!==ue;++U)F[U]!==O[U]&&(e.disableVertexAttribArray(U),F[U]=0)},enable:s,disable:a,getCompressedTextureFormats:function(){if(B===null&&(B=[],t.get("WEBGL_compressed_texture_pvrtc")||t.get("WEBGL_compressed_texture_s3tc")||t.get("WEBGL_compressed_texture_etc1")||t.get("WEBGL_compressed_texture_astc")))for(var U=e.getParameter(34467),ue=0;ue<U.length;ue++)B.push(U[ue]);return B},useProgram:function(U){return Y!==U?(e.useProgram(U),Y=U,!0):!1},setBlending:c,setMaterial:function(U,ue){U.side===2?a(2884):s(2884);var Ge=U.side===1;ue&&(Ge=!Ge),u(Ge),U.blending===1&&U.transparent===!1?c(0):c(U.blending,U.blendEquation,U.blendSrc,U.blendDst,U.blendEquationAlpha,U.blendSrcAlpha,U.blendDstAlpha,U.premultipliedAlpha),y.setFunc(U.depthFunc),y.setTest(U.depthTest),y.setMask(U.depthWrite),x.setMask(U.colorWrite),ue=U.stencilWrite,M.setTest(ue),ue&&(M.setMask(U.stencilWriteMask),M.setFunc(U.stencilFunc,U.stencilRef,U.stencilFuncMask),M.setOp(U.stencilFail,U.stencilZFail,U.stencilZPass)),p(U.polygonOffset,U.polygonOffsetFactor,U.polygonOffsetUnits)},setFlipSided:u,setCullFace:h,setLineWidth:function(U){U!==K&&(Le&&e.lineWidth(U),K=U)},setPolygonOffset:p,setScissorTest:function(U){U?s(3089):a(3089)},activeTexture:v,bindTexture:function(U,ue){Te===null&&v();var Ge=Be[Te];Ge===void 0&&(Ge={type:void 0,texture:void 0},Be[Te]=Ge),(Ge.type!==U||Ge.texture!==ue)&&(e.bindTexture(U,ue||oe[U]),Ge.type=U,Ge.texture=ue)},compressedTexImage2D:function(){try{e.compressedTexImage2D.apply(e,arguments)}catch(U){console.error("THREE.WebGLState:",U)}},texImage2D:function(){try{e.texImage2D.apply(e,arguments)}catch(U){console.error("THREE.WebGLState:",U)}},texImage3D:function(){try{e.texImage3D.apply(e,arguments)}catch(U){console.error("THREE.WebGLState:",U)}},scissor:function(U){qe.equals(U)===!1&&(e.scissor(U.x,U.y,U.z,U.w),qe.copy(U))},viewport:function(U){mt.equals(U)===!1&&(e.viewport(U.x,U.y,U.z,U.w),mt.copy(U))},reset:function(){for(var U=0;U<F.length;U++)F[U]===1&&(e.disableVertexAttribArray(U),F[U]=0);V={},Te=B=null,Be={},H=b=fe=Y=null,x.reset(),y.reset(),M.reset()}}}function D(e,t,n,i,r,o,s){function a(_,b){return J?new OffscreenCanvas(_,b):document.createElementNS("http://www.w3.org/1999/xhtml","canvas")}function c(_,b,H,K){var se=1;if((_.width>K||_.height>K)&&(se=K/Math.max(_.width,_.height)),1>se||b===!0){if(typeof HTMLImageElement<"u"&&_ instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&_ instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&_ instanceof ImageBitmap)return K=b?Xe.floorPowerOfTwo:Math.floor,b=K(se*_.width),se=K(se*_.height),j===void 0&&(j=a(b,se)),H=H?a(b,se):j,H.width=b,H.height=se,H.getContext("2d").drawImage(_,0,0,b,se),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+_.width+"x"+_.height+") to ("+b+"x"+se+")."),H;"data"in _&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+_.width+"x"+_.height+").")}return _}function u(_){return Xe.isPowerOfTwo(_.width)&&Xe.isPowerOfTwo(_.height)}function h(_,b){return _.generateMipmaps&&b&&_.minFilter!==1003&&_.minFilter!==1006}function p(_,b,H,K){e.generateMipmap(_),i.get(b).__maxMipLevel=Math.log(Math.max(H,K))*Math.LOG2E}function v(_,b){if(!r.isWebGL2)return _;var H=_;return _===6403&&(b===5126&&(H=33326),b===5131&&(H=33325),b===5121&&(H=33321)),_===6407&&(b===5126&&(H=34837),b===5131&&(H=34843),b===5121&&(H=32849)),_===6408&&(b===5126&&(H=34836),b===5131&&(H=34842),b===5121&&(H=32856)),H===33325||H===33326||H===34842||H===34836?t.get("EXT_color_buffer_float"):(H===34843||H===34837)&&console.warn("THREE.WebGLRenderer: Floating point textures with RGB format not supported. Please use RGBA instead."),H}function x(_){return _===1003||_===1004||_===1005?9728:9729}function y(_){_=_.target,_.removeEventListener("dispose",y);var b=i.get(_);b.__webglInit!==void 0&&(e.deleteTexture(b.__webglTexture),i.remove(_)),_.isVideoTexture&&X.delete(_),s.memory.textures--}function M(_){_=_.target,_.removeEventListener("dispose",M);var b=i.get(_),H=i.get(_.texture);if(_){if(H.__webglTexture!==void 0&&e.deleteTexture(H.__webglTexture),_.depthTexture&&_.depthTexture.dispose(),_.isWebGLRenderTargetCube)for(H=0;6>H;H++)e.deleteFramebuffer(b.__webglFramebuffer[H]),b.__webglDepthbuffer&&e.deleteRenderbuffer(b.__webglDepthbuffer[H]);else e.deleteFramebuffer(b.__webglFramebuffer),b.__webglDepthbuffer&&e.deleteRenderbuffer(b.__webglDepthbuffer);if(_.isWebGLMultiviewRenderTarget){e.deleteTexture(b.__webglColorTexture),e.deleteTexture(b.__webglDepthStencilTexture),s.memory.textures-=2,H=0;for(var K=b.__webglViewFramebuffers.length;H<K;H++)e.deleteFramebuffer(b.__webglViewFramebuffers[H])}i.remove(_.texture),i.remove(_)}s.memory.textures--}function L(_,b){var H=i.get(_);if(_.isVideoTexture){var K=s.render.frame;X.get(_)!==K&&(X.set(_,K),_.update())}if(0<_.version&&H.__version!==_.version)if(K=_.image,K===void 0)console.warn("THREE.WebGLRenderer: Texture marked for update but image is undefined");else if(K.complete===!1)console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete");else{B(H,_,b);return}n.activeTexture(33984+b),n.bindTexture(3553,H.__webglTexture)}function O(_,b){if(_.image.length===6){var H=i.get(_);if(0<_.version&&H.__version!==_.version){V(H,_),n.activeTexture(33984+b),n.bindTexture(34067,H.__webglTexture),e.pixelStorei(37440,_.flipY);var K=_&&_.isCompressedTexture;b=_.image[0]&&_.image[0].isDataTexture;for(var se=[],ae=0;6>ae;ae++)se[ae]=K||b?b?_.image[ae].image:_.image[ae]:c(_.image[ae],!1,!0,r.maxCubemapSize);var et=se[0],Le=u(et)||r.isWebGL2,Te=o.convert(_.format),Be=o.convert(_.type),qe=v(Te,Be);if(z(34067,_,Le),K){for(ae=0;6>ae;ae++){var mt=se[ae].mipmaps;for(K=0;K<mt.length;K++){var oe=mt[K];_.format!==1023&&_.format!==1022?-1<n.getCompressedTextureFormats().indexOf(Te)?n.compressedTexImage2D(34069+ae,K,qe,oe.width,oe.height,0,oe.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):n.texImage2D(34069+ae,K,qe,oe.width,oe.height,0,Te,Be,oe.data)}}H.__maxMipLevel=mt.length-1}else{for(mt=_.mipmaps,ae=0;6>ae;ae++)if(b)for(n.texImage2D(34069+ae,0,qe,se[ae].width,se[ae].height,0,Te,Be,se[ae].data),K=0;K<mt.length;K++)oe=mt[K],oe=oe.image[ae].image,n.texImage2D(34069+ae,K+1,qe,oe.width,oe.height,0,Te,Be,oe.data);else for(n.texImage2D(34069+ae,0,qe,Te,Be,se[ae]),K=0;K<mt.length;K++)oe=mt[K],n.texImage2D(34069+ae,K+1,qe,Te,Be,oe.image[ae]);H.__maxMipLevel=mt.length}h(_,Le)&&p(34067,_,et.width,et.height),H.__version=_.version,_.onUpdate&&_.onUpdate(_)}else n.activeTexture(33984+b),n.bindTexture(34067,H.__webglTexture)}}function F(_,b){n.activeTexture(33984+b),n.bindTexture(34067,i.get(_).__webglTexture)}function z(_,b,H){H?(e.texParameteri(_,10242,o.convert(b.wrapS)),e.texParameteri(_,10243,o.convert(b.wrapT)),_!==32879&&_!==35866||e.texParameteri(_,32882,o.convert(b.wrapR)),e.texParameteri(_,10240,o.convert(b.magFilter)),e.texParameteri(_,10241,o.convert(b.minFilter))):(e.texParameteri(_,10242,33071),e.texParameteri(_,10243,33071),_!==32879&&_!==35866||e.texParameteri(_,32882,33071),b.wrapS===1001&&b.wrapT===1001||console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),e.texParameteri(_,10240,x(b.magFilter)),e.texParameteri(_,10241,x(b.minFilter)),b.minFilter!==1003&&b.minFilter!==1006&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.")),!(H=t.get("EXT_texture_filter_anisotropic"))||b.type===1015&&t.get("OES_texture_float_linear")===null||b.type===1016&&(r.isWebGL2||t.get("OES_texture_half_float_linear"))===null||!(1<b.anisotropy||i.get(b).__currentAnisotropy)||(e.texParameterf(_,H.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(b.anisotropy,r.getMaxAnisotropy())),i.get(b).__currentAnisotropy=b.anisotropy)}function V(_,b){_.__webglInit===void 0&&(_.__webglInit=!0,b.addEventListener("dispose",y),_.__webglTexture=e.createTexture(),s.memory.textures++)}function B(_,b,H){var K=3553;b.isDataTexture2DArray&&(K=35866),b.isDataTexture3D&&(K=32879),V(_,b),n.activeTexture(33984+H),n.bindTexture(K,_.__webglTexture),e.pixelStorei(37440,b.flipY),e.pixelStorei(37441,b.premultiplyAlpha),e.pixelStorei(3317,b.unpackAlignment),H=r.isWebGL2?!1:b.wrapS!==1001||b.wrapT!==1001||b.minFilter!==1003&&b.minFilter!==1006,H=H&&u(b.image)===!1,H=c(b.image,H,!1,r.maxTextureSize);var se=u(H)||r.isWebGL2,ae=o.convert(b.format),et=o.convert(b.type),Le=v(ae,et);z(K,b,se);var Te=b.mipmaps;if(b.isDepthTexture){if(Le=6402,b.type===1015){if(!r.isWebGL2)throw Error("Float Depth Texture only supported in WebGL2.0");Le=36012}else r.isWebGL2&&(Le=33189);b.format===1026&&Le===6402&&b.type!==1012&&b.type!==1014&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),b.type=1012,et=o.convert(b.type)),b.format===1027&&(Le=34041,b.type!==1020&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),b.type=1020,et=o.convert(b.type))),n.texImage2D(3553,0,Le,H.width,H.height,0,ae,et,null)}else if(b.isDataTexture)if(0<Te.length&&se){for(var Be=0,qe=Te.length;Be<qe;Be++)K=Te[Be],n.texImage2D(3553,Be,Le,K.width,K.height,0,ae,et,K.data);b.generateMipmaps=!1,_.__maxMipLevel=Te.length-1}else n.texImage2D(3553,0,Le,H.width,H.height,0,ae,et,H.data),_.__maxMipLevel=0;else if(b.isCompressedTexture){for(Be=0,qe=Te.length;Be<qe;Be++)K=Te[Be],b.format!==1023&&b.format!==1022?-1<n.getCompressedTextureFormats().indexOf(ae)?n.compressedTexImage2D(3553,Be,Le,K.width,K.height,0,K.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):n.texImage2D(3553,Be,Le,K.width,K.height,0,ae,et,K.data);_.__maxMipLevel=Te.length-1}else if(b.isDataTexture2DArray)n.texImage3D(35866,0,Le,H.width,H.height,H.depth,0,ae,et,H.data),_.__maxMipLevel=0;else if(b.isDataTexture3D)n.texImage3D(32879,0,Le,H.width,H.height,H.depth,0,ae,et,H.data),_.__maxMipLevel=0;else if(0<Te.length&&se){for(Be=0,qe=Te.length;Be<qe;Be++)K=Te[Be],n.texImage2D(3553,Be,Le,ae,et,K);b.generateMipmaps=!1,_.__maxMipLevel=Te.length-1}else n.texImage2D(3553,0,Le,ae,et,H),_.__maxMipLevel=0;h(b,se)&&p(3553,b,H.width,H.height),_.__version=b.version,b.onUpdate&&b.onUpdate(b)}function Y(_,b,H,K){var se=o.convert(b.texture.format),ae=o.convert(b.texture.type),et=v(se,ae);n.texImage2D(K,0,et,b.width,b.height,0,se,ae,null),e.bindFramebuffer(36160,_),e.framebufferTexture2D(36160,H,K,i.get(b.texture).__webglTexture,0),e.bindFramebuffer(36160,null)}function Z(_,b,H){if(e.bindRenderbuffer(36161,_),b.depthBuffer&&!b.stencilBuffer)H?(H=fe(b),e.renderbufferStorageMultisample(36161,H,33189,b.width,b.height)):e.renderbufferStorage(36161,33189,b.width,b.height),e.framebufferRenderbuffer(36160,36096,36161,_);else if(b.depthBuffer&&b.stencilBuffer)H?(H=fe(b),e.renderbufferStorageMultisample(36161,H,35056,b.width,b.height)):e.renderbufferStorage(36161,34041,b.width,b.height),e.framebufferRenderbuffer(36160,33306,36161,_);else{_=o.convert(b.texture.format);var K=o.convert(b.texture.type);_=v(_,K),H?(H=fe(b),e.renderbufferStorageMultisample(36161,H,_,b.width,b.height)):e.renderbufferStorage(36161,_,b.width,b.height)}e.bindRenderbuffer(36161,null)}function fe(_){return r.isWebGL2&&_.isWebGLMultisampleRenderTarget?Math.min(r.maxSamples,_.samples):0}var X=new WeakMap,j,J=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")!==null,te=0,ze=!1,We=!1;this.allocateTextureUnit=function(){var _=te;return _>=r.maxTextures&&console.warn("THREE.WebGLTextures: Trying to use "+_+" texture units while this GPU supports only "+r.maxTextures),te+=1,_},this.resetTextureUnits=function(){te=0},this.setTexture2D=L,this.setTexture2DArray=function(_,b){var H=i.get(_);0<_.version&&H.__version!==_.version?B(H,_,b):(n.activeTexture(33984+b),n.bindTexture(35866,H.__webglTexture))},this.setTexture3D=function(_,b){var H=i.get(_);0<_.version&&H.__version!==_.version?B(H,_,b):(n.activeTexture(33984+b),n.bindTexture(32879,H.__webglTexture))},this.setTextureCube=O,this.setTextureCubeDynamic=F,this.setupRenderTarget=function(_){var b=i.get(_),H=i.get(_.texture);_.addEventListener("dispose",M),H.__webglTexture=e.createTexture(),s.memory.textures++;var K=_.isWebGLRenderTargetCube===!0,se=_.isWebGLMultisampleRenderTarget===!0,ae=_.isWebGLMultiviewRenderTarget===!0,et=u(_)||r.isWebGL2;if(K){b.__webglFramebuffer=[];for(var Le=0;6>Le;Le++)b.__webglFramebuffer[Le]=e.createFramebuffer()}else if(b.__webglFramebuffer=e.createFramebuffer(),se)if(r.isWebGL2){b.__webglMultisampledFramebuffer=e.createFramebuffer(),b.__webglColorRenderbuffer=e.createRenderbuffer(),e.bindRenderbuffer(36161,b.__webglColorRenderbuffer),se=o.convert(_.texture.format);var Te=o.convert(_.texture.type);se=v(se,Te),Te=fe(_),e.renderbufferStorageMultisample(36161,Te,se,_.width,_.height),e.bindFramebuffer(36160,b.__webglMultisampledFramebuffer),e.framebufferRenderbuffer(36160,36064,36161,b.__webglColorRenderbuffer),e.bindRenderbuffer(36161,null),_.depthBuffer&&(b.__webglDepthRenderbuffer=e.createRenderbuffer(),Z(b.__webglDepthRenderbuffer,_,!0)),e.bindFramebuffer(36160,null)}else console.warn("THREE.WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2.");else if(ae){Le=_.width;var Be=_.height;se=_.numViews,e.bindFramebuffer(36160,b.__webglFramebuffer);var qe=t.get("OVR_multiview2");s.memory.textures+=2,Te=e.createTexture(),e.bindTexture(35866,Te),e.texParameteri(35866,10240,9728),e.texParameteri(35866,10241,9728),e.texImage3D(35866,0,32856,Le,Be,se,0,6408,5121,null),qe.framebufferTextureMultiviewOVR(36160,36064,Te,0,0,se);var mt=e.createTexture();for(e.bindTexture(35866,mt),e.texParameteri(35866,10240,9728),e.texParameteri(35866,10241,9728),e.texImage3D(35866,0,35056,Le,Be,se,0,34041,34042,null),qe.framebufferTextureMultiviewOVR(36160,33306,mt,0,0,se),Be=Array(se),Le=0;Le<se;++Le)Be[Le]=e.createFramebuffer(),e.bindFramebuffer(36160,Be[Le]),e.framebufferTextureLayer(36160,36064,Te,0,Le);b.__webglColorTexture=Te,b.__webglDepthStencilTexture=mt,b.__webglViewFramebuffers=Be,e.bindFramebuffer(36160,null),e.bindTexture(35866,null)}if(K){for(n.bindTexture(34067,H.__webglTexture),z(34067,_.texture,et),Le=0;6>Le;Le++)Y(b.__webglFramebuffer[Le],_,36064,34069+Le);h(_.texture,et)&&p(34067,_.texture,_.width,_.height),n.bindTexture(34067,null)}else ae||(n.bindTexture(3553,H.__webglTexture),z(3553,_.texture,et),Y(b.__webglFramebuffer,_,36064,3553),h(_.texture,et)&&p(3553,_.texture,_.width,_.height),n.bindTexture(3553,null));if(_.depthBuffer){if(b=i.get(_),H=_.isWebGLRenderTargetCube===!0,_.depthTexture){if(H)throw Error("target.depthTexture not supported in Cube render targets");if(_&&_.isWebGLRenderTargetCube)throw Error("Depth Texture with cube render targets is not supported");if(e.bindFramebuffer(36160,b.__webglFramebuffer),!_.depthTexture||!_.depthTexture.isDepthTexture)throw Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");if(i.get(_.depthTexture).__webglTexture&&_.depthTexture.image.width===_.width&&_.depthTexture.image.height===_.height||(_.depthTexture.image.width=_.width,_.depthTexture.image.height=_.height,_.depthTexture.needsUpdate=!0),L(_.depthTexture,0),b=i.get(_.depthTexture).__webglTexture,_.depthTexture.format===1026)e.framebufferTexture2D(36160,36096,3553,b,0);else if(_.depthTexture.format===1027)e.framebufferTexture2D(36160,33306,3553,b,0);else throw Error("Unknown depthTexture format")}else if(H)for(b.__webglDepthbuffer=[],H=0;6>H;H++)e.bindFramebuffer(36160,b.__webglFramebuffer[H]),b.__webglDepthbuffer[H]=e.createRenderbuffer(),Z(b.__webglDepthbuffer[H],_);else e.bindFramebuffer(36160,b.__webglFramebuffer),b.__webglDepthbuffer=e.createRenderbuffer(),Z(b.__webglDepthbuffer,_);e.bindFramebuffer(36160,null)}},this.updateRenderTargetMipmap=function(_){var b=_.texture,H=u(_)||r.isWebGL2;if(h(b,H)){H=_.isWebGLRenderTargetCube?34067:3553;var K=i.get(b).__webglTexture;n.bindTexture(H,K),p(H,b,_.width,_.height),n.bindTexture(H,null)}},this.updateMultisampleRenderTarget=function(_){if(_.isWebGLMultisampleRenderTarget)if(r.isWebGL2){var b=i.get(_);e.bindFramebuffer(36008,b.__webglMultisampledFramebuffer),e.bindFramebuffer(36009,b.__webglFramebuffer),b=_.width;var H=_.height,K=16384;_.depthBuffer&&(K|=256),_.stencilBuffer&&(K|=1024),e.blitFramebuffer(0,0,b,H,0,0,b,H,K,9728)}else console.warn("THREE.WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2.")},this.safeSetTexture2D=function(_,b){_&&_.isWebGLRenderTarget&&(ze===!1&&(console.warn("THREE.WebGLTextures.safeSetTexture2D: don't use render targets as textures. Use their .texture property instead."),ze=!0),_=_.texture),L(_,b)},this.safeSetTextureCube=function(_,b){_&&_.isWebGLRenderTargetCube&&(We===!1&&(console.warn("THREE.WebGLTextures.safeSetTextureCube: don't use cube render targets as textures. Use their .texture property instead."),We=!0),_=_.texture),_&&_.isCubeTexture||Array.isArray(_.image)&&_.image.length===6?O(_,b):F(_,b)}}function I(e,t,n){return{convert:function(i){if(i===1e3)return 10497;if(i===1001)return 33071;if(i===1002)return 33648;if(i===1003)return 9728;if(i===1004)return 9984;if(i===1005)return 9986;if(i===1006)return 9729;if(i===1007)return 9985;if(i===1008)return 9987;if(i===1009)return 5121;if(i===1017)return 32819;if(i===1018)return 32820;if(i===1019)return 33635;if(i===1010)return 5120;if(i===1011)return 5122;if(i===1012)return 5123;if(i===1013)return 5124;if(i===1014)return 5125;if(i===1015)return 5126;if(i===1016){if(n.isWebGL2)return 5131;var r=t.get("OES_texture_half_float");if(r!==null)return r.HALF_FLOAT_OES}if(i===1021)return 6406;if(i===1022)return 6407;if(i===1023)return 6408;if(i===1024)return 6409;if(i===1025)return 6410;if(i===1026)return 6402;if(i===1027)return 34041;if(i===1028)return 6403;if(i===100)return 32774;if(i===101)return 32778;if(i===102)return 32779;if(i===200)return 0;if(i===201)return 1;if(i===202)return 768;if(i===203)return 769;if(i===204)return 770;if(i===205)return 771;if(i===206)return 772;if(i===207)return 773;if(i===208)return 774;if(i===209)return 775;if(i===210)return 776;if((i===33776||i===33777||i===33778||i===33779)&&(r=t.get("WEBGL_compressed_texture_s3tc"),r!==null)){if(i===33776)return r.COMPRESSED_RGB_S3TC_DXT1_EXT;if(i===33777)return r.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(i===33778)return r.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(i===33779)return r.COMPRESSED_RGBA_S3TC_DXT5_EXT}if((i===35840||i===35841||i===35842||i===35843)&&(r=t.get("WEBGL_compressed_texture_pvrtc"),r!==null)){if(i===35840)return r.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(i===35841)return r.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(i===35842)return r.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(i===35843)return r.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(i===36196&&(r=t.get("WEBGL_compressed_texture_etc1"),r!==null))return r.COMPRESSED_RGB_ETC1_WEBGL;if((i===37808||i===37809||i===37810||i===37811||i===37812||i===37813||i===37814||i===37815||i===37816||i===37817||i===37818||i===37819||i===37820||i===37821)&&(r=t.get("WEBGL_compressed_texture_astc"),r!==null))return i;if(i===103||i===104){if(n.isWebGL2){if(i===103)return 32775;if(i===104)return 32776}if(r=t.get("EXT_blend_minmax"),r!==null){if(i===103)return r.MIN_EXT;if(i===104)return r.MAX_EXT}}if(i===1020){if(n.isWebGL2)return 34042;if(r=t.get("WEBGL_depth_texture"),r!==null)return r.UNSIGNED_INT_24_8_WEBGL}return 0}}}function k(e,t,n,i){je.call(this,e,t,i),this.stencilBuffer=this.depthBuffer=!1,this.numViews=n}function q(e,t){function n(y){return y.isArrayCamera?y.cameras:(h[0]=y,h)}function i(y){if(y.isArrayCamera===void 0)return!0;if(y=y.cameras,y.length>x)return!1;for(var M=1,L=y.length;M<L;M++)if(y[0].viewport.z!==y[M].viewport.z||y[0].viewport.w!==y[M].viewport.w)return!1;return!0}var r=e.extensions,o=e.properties,s,a,c,u,h,p,v,x=0;this.isAvailable=function(){if(v===void 0){var y=r.get("OVR_multiview2");if(v=y!==null&&t.getContextAttributes().antialias===!1)for(x=t.getParameter(y.MAX_VIEWS_OVR),s=new k(0,0,2),p=new G,u=[],c=[],h=[],y=0;y<x;y++)u[y]=new Se,c[y]=new be}return v},this.attachCamera=function(y){if(i(y)!==!1){if((a=e.getRenderTarget())?p.set(a.width,a.height):e.getDrawingBufferSize(p),y.isArrayCamera){var M=y.cameras[0].viewport;s.setSize(M.z,M.w),s.setNumViews(y.cameras.length)}else s.setSize(p.x,p.y),s.setNumViews(2);e.setRenderTarget(s)}},this.detachCamera=function(y){if(s===e.getRenderTarget()){e.setRenderTarget(a);var M=s,L=M.numViews,O=o.get(M).__webglViewFramebuffers,F=M.width;if(M=M.height,y.isArrayCamera)for(var z=0;z<L;z++){var V=y.cameras[z].viewport,B=V.x,Y=V.y,Z=B+V.z;V=Y+V.w,t.bindFramebuffer(36008,O[z]),t.blitFramebuffer(0,0,F,M,B,Y,Z,V,16384,9728)}else t.bindFramebuffer(36008,O[0]),t.blitFramebuffer(0,0,F,M,0,0,p.x,p.y,16384,9728)}},this.updateCameraProjectionMatricesUniform=function(y,M){y=n(y);for(var L=0;L<y.length;L++)u[L].copy(y[L].projectionMatrix);M.setValue(t,"projectionMatrices",u)},this.updateCameraViewMatricesUniform=function(y,M){y=n(y);for(var L=0;L<y.length;L++)u[L].copy(y[L].matrixWorldInverse);M.setValue(t,"viewMatrices",u)},this.updateObjectMatricesUniforms=function(y,M,L){M=n(M);for(var O=0;O<M.length;O++)u[O].multiplyMatrices(M[O].matrixWorldInverse,y.matrixWorld),c[O].getNormalMatrix(u[O]);L.setValue(t,"modelViewMatrices",u),L.setValue(t,"normalMatrices",c)}}function Q(){W.call(this),this.type="Group"}function xe(e){Je.call(this),this.cameras=e||[]}function Me(e,t,n){du.setFromMatrixPosition(t.matrixWorld),pu.setFromMatrixPosition(n.matrixWorld);var i=du.distanceTo(pu),r=t.projectionMatrix.elements,o=n.projectionMatrix.elements,s=r[14]/(r[10]-1);n=r[14]/(r[10]+1);var a=(r[9]+1)/r[5],c=(r[9]-1)/r[5],u=(r[8]-1)/r[0],h=(o[8]+1)/o[0];r=s*u,o=s*h,h=i/(-u+h),u=h*-u,t.matrixWorld.decompose(e.position,e.quaternion,e.scale),e.translateX(u),e.translateZ(h),e.matrixWorld.compose(e.position,e.quaternion,e.scale),e.matrixWorldInverse.getInverse(e.matrixWorld),t=s+h,s=n+h,e.projectionMatrix.makePerspective(r-u,o+(i-u),a*n/s*t,c*n/s*t,t,s)}function Ue(e){function t(){return a!==null&&a.isPresenting===!0}function n(){if(t()){var X=a.getEyeParameters("left");r=2*X.renderWidth*x,o=X.renderHeight*x,Y=e.getPixelRatio(),e.getSize(B),e.setDrawingBufferSize(r,o,1),F.viewport.set(0,0,r/2,o),z.viewport.set(r/2,0,r/2,o),fe.start(),s.dispatchEvent({type:"sessionstart"})}else s.enabled&&e.setDrawingBufferSize(B.width,B.height,Y),fe.stop(),s.dispatchEvent({type:"sessionend"})}function i(X,j){j!==null&&j.length===4&&X.set(j[0]*r,j[1]*o,j[2]*r,j[3]*o)}var r,o,s=this,a=null,c=null,u=null,h=[],p=new Se,v=new Se,x=1,y="local-floor";typeof window<"u"&&"VRFrameData"in window&&(c=new window.VRFrameData,window.addEventListener("vrdisplaypresentchange",n,!1));var M=new Se,L=new we,O=new E,F=new Je;F.viewport=new _e,F.layers.enable(1);var z=new Je;z.viewport=new _e,z.layers.enable(2);var V=new xe([F,z]);V.layers.enable(1),V.layers.enable(2);var B=new G,Y,Z=[];this.enabled=!1,this.getController=function(X){var j=h[X];return j===void 0&&(j=new Q,j.matrixAutoUpdate=!1,j.visible=!1,h[X]=j),j},this.getDevice=function(){return a},this.setDevice=function(X){X!==void 0&&(a=X),fe.setContext(X)},this.setFramebufferScaleFactor=function(X){x=X},this.setReferenceSpaceType=function(X){y=X},this.setPoseTarget=function(X){X!==void 0&&(u=X)},this.getCamera=function(X){var j=y==="local-floor"?1.6:0;if(t()===!1)return X.position.set(0,j,0),X.rotation.set(0,0,0),X;if(a.depthNear=X.near,a.depthFar=X.far,a.getFrameData(c),y==="local-floor"){var J=a.stageParameters;J?p.fromArray(J.sittingToStandingTransform):p.makeTranslation(0,j,0)}j=c.pose,J=u!==null?u:X,J.matrix.copy(p),J.matrix.decompose(J.position,J.quaternion,J.scale),j.orientation!==null&&(L.fromArray(j.orientation),J.quaternion.multiply(L)),j.position!==null&&(L.setFromRotationMatrix(p),O.fromArray(j.position),O.applyQuaternion(L),J.position.add(O)),J.updateMatrixWorld(),F.near=X.near,z.near=X.near,F.far=X.far,z.far=X.far,F.matrixWorldInverse.fromArray(c.leftViewMatrix),z.matrixWorldInverse.fromArray(c.rightViewMatrix),v.getInverse(p),y==="local-floor"&&(F.matrixWorldInverse.multiply(v),z.matrixWorldInverse.multiply(v)),X=J.parent,X!==null&&(M.getInverse(X.matrixWorld),F.matrixWorldInverse.multiply(M),z.matrixWorldInverse.multiply(M)),F.matrixWorld.getInverse(F.matrixWorldInverse),z.matrixWorld.getInverse(z.matrixWorldInverse),F.projectionMatrix.fromArray(c.leftProjectionMatrix),z.projectionMatrix.fromArray(c.rightProjectionMatrix),Me(V,F,z),X=a.getLayers(),X.length&&(X=X[0],i(F.viewport,X.leftBounds),i(z.viewport,X.rightBounds));e:for(X=0;X<h.length;X++){j=h[X];t:{J=X;for(var te=navigator.getGamepads&&navigator.getGamepads(),ze=0,We=0,_=te.length;ze<_;ze++){var b=te[ze];if(b&&(b.id==="Daydream Controller"||b.id==="Gear VR Controller"||b.id==="Oculus Go Controller"||b.id==="OpenVR Gamepad"||b.id.startsWith("Oculus Touch")||b.id.startsWith("HTC Vive Focus")||b.id.startsWith("Spatial Controller"))){if(We===J){J=b;break t}We++}}J=void 0}if(J!==void 0&&J.pose!==void 0){if(J.pose===null)break e;te=J.pose,te.hasPosition===!1&&j.position.set(.2,-.6,-.05),te.position!==null&&j.position.fromArray(te.position),te.orientation!==null&&j.quaternion.fromArray(te.orientation),j.matrix.compose(j.position,j.quaternion,j.scale),j.matrix.premultiply(p),j.matrix.decompose(j.position,j.quaternion,j.scale),j.matrixWorldNeedsUpdate=!0,j.visible=!0,te=J.id==="Daydream Controller"?0:1,Z[X]===void 0&&(Z[X]=!1),Z[X]!==J.buttons[te].pressed&&(Z[X]=J.buttons[te].pressed,Z[X]===!0?j.dispatchEvent({type:"selectstart"}):(j.dispatchEvent({type:"selectend"}),j.dispatchEvent({type:"select"})))}else j.visible=!1}return V},this.getStandingMatrix=function(){return p},this.isPresenting=t;var fe=new Sr;this.setAnimationLoop=function(X){fe.setAnimationLoop(X),t()&&fe.start()},this.submitFrame=function(){t()&&a.submitFrame()},this.dispose=function(){typeof window<"u"&&window.removeEventListener("vrdisplaypresentchange",n)},this.setFrameOfReferenceType=function(){console.warn("THREE.WebVRManager: setFrameOfReferenceType() has been deprecated.")}}function Qe(e,t){function n(){return c!==null&&u!==null}function i(z){for(var V=0;V<v.length;V++)x[V]===z.inputSource&&v[V].dispatchEvent({type:z.type})}function r(){e.setFramebuffer(null),e.setRenderTarget(e.getRenderTarget()),F.stop(),a.dispatchEvent({type:"sessionend"})}function o(z){u=z,F.setContext(c),F.start(),a.dispatchEvent({type:"sessionstart"})}function s(z,V){V===null?z.matrixWorld.copy(z.matrix):z.matrixWorld.multiplyMatrices(V.matrixWorld,z.matrix),z.matrixWorldInverse.getInverse(z.matrixWorld)}var a=this,c=null,u=null,h="local-floor",p=null,v=[],x=[],y=new Je;y.layers.enable(1),y.viewport=new _e;var M=new Je;M.layers.enable(2),M.viewport=new _e;var L=new xe([y,M]);L.layers.enable(1),L.layers.enable(2),this.enabled=!1,this.getController=function(z){var V=v[z];return V===void 0&&(V=new Q,V.matrixAutoUpdate=!1,V.visible=!1,v[z]=V),V},this.setFramebufferScaleFactor=function(){},this.setReferenceSpaceType=function(z){h=z},this.getSession=function(){return c},this.setSession=function(z){c=z,c!==null&&(c.addEventListener("select",i),c.addEventListener("selectstart",i),c.addEventListener("selectend",i),c.addEventListener("end",r),c.updateRenderState({baseLayer:new XRWebGLLayer(c,t)}),c.requestReferenceSpace(h).then(o),x=c.inputSources,c.addEventListener("inputsourceschange",function(){x=c.inputSources,console.log(x);for(var V=0;V<v.length;V++)v[V].userData.inputSource=x[V]}))},this.getCamera=function(z){if(n()){var V=z.parent,B=L.cameras;s(L,V);for(var Y=0;Y<B.length;Y++)s(B[Y],V);for(z.matrixWorld.copy(L.matrixWorld),z=z.children,Y=0,V=z.length;Y<V;Y++)z[Y].updateMatrixWorld(!0);return Me(L,y,M),L}return z},this.isPresenting=n;var O=null,F=new Sr;F.setAnimationLoop(function(z,V){if(p=V.getViewerPose(u),p!==null){var B=p.views,Y=c.renderState.baseLayer;e.setFramebuffer(Y.framebuffer);for(var Z=0;Z<B.length;Z++){var fe=B[Z],X=Y.getViewport(fe),j=L.cameras[Z];j.matrix.fromArray(fe.transform.inverse.matrix).getInverse(j.matrix),j.projectionMatrix.fromArray(fe.projectionMatrix),j.viewport.set(X.x,X.y,X.width,X.height),Z===0&&L.matrix.copy(j.matrix)}}for(Z=0;Z<v.length;Z++){if(B=v[Z],(Y=x[Z])&&(Y=V.getPose(Y.targetRaySpace,u),Y!==null)){B.matrix.fromArray(Y.transform.matrix),B.matrix.decompose(B.position,B.rotation,B.scale),B.visible=!0;continue}B.visible=!1}O&&O(z)}),this.setAnimationLoop=function(z){O=z},this.dispose=function(){},this.getStandingMatrix=function(){return console.warn("THREE.WebXRManager: getStandingMatrix() is no longer needed."),new Se},this.getDevice=function(){console.warn("THREE.WebXRManager: getDevice() has been deprecated.")},this.setDevice=function(){console.warn("THREE.WebXRManager: setDevice() has been deprecated.")},this.setFrameOfReferenceType=function(){console.warn("THREE.WebXRManager: setFrameOfReferenceType() has been deprecated.")},this.submitFrame=function(){}}function at(e){var t;function n(){Oe=new Ss($),pt=new Ms($,Oe,e),pt.isWebGL2===!1&&(Oe.get("WEBGL_depth_texture"),Oe.get("OES_texture_float"),Oe.get("OES_texture_half_float"),Oe.get("OES_texture_half_float_linear"),Oe.get("OES_standard_derivatives"),Oe.get("OES_element_index_uint"),Oe.get("ANGLE_instanced_arrays")),Oe.get("OES_texture_float_linear"),Zn=new I($,Oe,pt),ke=new R($,Oe,Zn,pt),ke.scissor(qe.copy(st).multiplyScalar(ue).floor()),ke.viewport(Be.copy(Ge).multiplyScalar(ue).floor()),Kt=new Eo,Jt=new Ws,qn=new D($,Oe,ke,Jt,pt,Zn,Kt),yo=new As($),Al=new rt($,yo,Kt),xo=new ji($,Al,yo,Kt),zu=new Cs($),Ar=new Po(te,Oe,pt),qa=new Cr,wo=new d,Ni=new Si(te,ke,xo,Y),Gu=new Tr($,Oe,Kt,pt),Hu=new Ts($,Oe,Kt,pt),Kt.programs=Ar.programs,te.capabilities=pt,te.extensions=Oe,te.properties=Jt,te.renderLists=qa,te.state=ke,te.info=Kt}function i(T){T.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),ze=!0}function r(){console.log("THREE.WebGLRenderer: Context Restored."),ze=!1,n()}function o(T){T=T.target,T.removeEventListener("dispose",o),s(T),Jt.remove(T)}function s(T){var N=Jt.get(T).program;T.program=void 0,N!==void 0&&Ar.releaseProgram(N)}function a(T,N){T.render(function(P){te.renderBufferImmediate(P,N)})}function c(T,N,P,ne){if(T.visible!==!1){if(T.layers.test(N.layers)){if(T.isGroup)P=T.renderOrder;else if(T.isLOD)T.autoUpdate===!0&&T.update(N);else if(T.isLight)J.pushLight(T),T.castShadow&&J.pushShadow(T);else if(T.isSprite){if(!T.frustumCulled||Ze.intersectsSprite(T)){ne&&Ke.setFromMatrixPosition(T.matrixWorld).applyMatrix4(He);var ce=xo.update(T),Ye=T.material;Ye.visible&&j.push(T,ce,Ye,P,Ke.z,null)}}else if(T.isImmediateRenderObject)ne&&Ke.setFromMatrixPosition(T.matrixWorld).applyMatrix4(He),j.push(T,null,T.material,P,Ke.z,null);else if((T.isMesh||T.isLine||T.isPoints)&&(T.isSkinnedMesh&&T.skeleton.frame!==Kt.render.frame&&(T.skeleton.update(),T.skeleton.frame=Kt.render.frame),!T.frustumCulled||Ze.intersectsObject(T)))if(ne&&Ke.setFromMatrixPosition(T.matrixWorld).applyMatrix4(He),ce=xo.update(T),Ye=T.material,Array.isArray(Ye))for(var ge=ce.groups,Fe=0,Et=ge.length;Fe<Et;Fe++){var it=ge[Fe],ee=Ye[it.materialIndex];ee&&ee.visible&&j.push(T,ce,ee,P,Ke.z,it)}else Ye.visible&&j.push(T,ce,Ye,P,Ke.z,null)}for(T=T.children,Fe=0,Et=T.length;Fe<Et;Fe++)c(T[Fe],N,P,ne)}}function u(T,N,P,ne){for(var ce=0,Ye=T.length;ce<Ye;ce++){var ge=T[ce],Fe=ge.object,Et=ge.geometry,it=ne===void 0?ge.material:ne;if(ge=ge.group,P.isArrayCamera)if(Te=P,bn.enabled&&Ui.isAvailable())h(Fe,N,P,Et,it,ge);else for(var ee=P.cameras,Ut=0,vt=ee.length;Ut<vt;Ut++){var bt=ee[Ut];Fe.layers.test(bt.layers)&&(ke.viewport(Be.copy(bt.viewport)),J.setupLights(bt),h(Fe,N,bt,Et,it,ge))}else Te=null,h(Fe,N,P,Et,it,ge)}}function h(T,N,P,ne,ce,Ye){if(T.onBeforeRender(te,N,P,ne,ce,Ye),J=wo.get(N,Te||P),T.modelViewMatrix.multiplyMatrices(P.matrixWorldInverse,T.matrixWorld),T.normalMatrix.getNormalMatrix(T.modelViewMatrix),T.isImmediateRenderObject){ke.setMaterial(ce);var ge=v(P,N.fog,ce,T);ae=t=null,et=!1,a(T,ge)}else te.renderBufferDirect(P,N.fog,ne,ce,T,Ye);T.onAfterRender(te,N,P,ne,ce,Ye),J=wo.get(N,Te||P)}function p(T,N,P){var ne=Jt.get(T),ce=J.state.lights,Ye=ce.state.version;P=Ar.getParameters(T,ce.state,J.state.shadowsArray,N,me.numPlanes,me.numIntersection,P);var ge=Ar.getProgramCode(T,P),Fe=ne.program,Et=!0;if(Fe===void 0)T.addEventListener("dispose",o);else if(Fe.code!==ge)s(T);else{if(ne.lightsStateVersion!==Ye)ne.lightsStateVersion=Ye;else if(P.shaderID!==void 0)return;Et=!1}if(Et&&(P.shaderID?(ge=Xn[P.shaderID],ne.shader={name:T.type,uniforms:$n(ge.uniforms),vertexShader:ge.vertexShader,fragmentShader:ge.fragmentShader}):ne.shader={name:T.type,uniforms:T.uniforms,vertexShader:T.vertexShader,fragmentShader:T.fragmentShader},T.onBeforeCompile(ne.shader,te),ge=Ar.getProgramCode(T,P),Fe=Ar.acquireProgram(T,ne.shader,P,ge),ne.program=Fe,T.program=Fe),P=Fe.getAttributes(),T.morphTargets)for(ge=T.numSupportedMorphTargets=0;ge<te.maxMorphTargets;ge++)0<=P["morphTarget"+ge]&&T.numSupportedMorphTargets++;if(T.morphNormals)for(ge=T.numSupportedMorphNormals=0;ge<te.maxMorphNormals;ge++)0<=P["morphNormal"+ge]&&T.numSupportedMorphNormals++;P=ne.shader.uniforms,(!T.isShaderMaterial&&!T.isRawShaderMaterial||T.clipping===!0)&&(ne.numClippingPlanes=me.numPlanes,ne.numIntersection=me.numIntersection,P.clippingPlanes=me.uniform),ne.fog=N,ne.needsLights=T.isMeshLambertMaterial||T.isMeshPhongMaterial||T.isMeshStandardMaterial||T.isShadowMaterial||T.isShaderMaterial&&T.lights===!0,ne.lightsStateVersion=Ye,ne.needsLights&&(P.ambientLightColor.value=ce.state.ambient,P.lightProbe.value=ce.state.probe,P.directionalLights.value=ce.state.directional,P.spotLights.value=ce.state.spot,P.rectAreaLights.value=ce.state.rectArea,P.pointLights.value=ce.state.point,P.hemisphereLights.value=ce.state.hemi,P.directionalShadowMap.value=ce.state.directionalShadowMap,P.directionalShadowMatrix.value=ce.state.directionalShadowMatrix,P.spotShadowMap.value=ce.state.spotShadowMap,P.spotShadowMatrix.value=ce.state.spotShadowMatrix,P.pointShadowMap.value=ce.state.pointShadowMap,P.pointShadowMatrix.value=ce.state.pointShadowMatrix),T=ne.program.getUniforms(),T=Fn.seqWithValue(T.seq,P),ne.uniformsList=T}function v(T,N,P,ne){qn.resetTextureUnits();var ce=Jt.get(P),Ye=J.state.lights;Ie&&(Mt||T!==Le)&&me.setState(P.clippingPlanes,P.clipIntersection,P.clipShadows,T,ce,T===Le&&P.id===se),P.needsUpdate===!1&&(ce.program===void 0||P.fog&&ce.fog!==N||ce.needsLights&&ce.lightsStateVersion!==Ye.state.version?P.needsUpdate=!0:ce.numClippingPlanes===void 0||ce.numClippingPlanes===me.numPlanes&&ce.numIntersection===me.numIntersection||(P.needsUpdate=!0)),P.needsUpdate&&(p(P,N,ne),P.needsUpdate=!1);var ge=!1,Fe=!1,Et=!1;Ye=ce.program;var it=Ye.getUniforms(),ee=ce.shader.uniforms;if(ke.useProgram(Ye.program)&&(Et=Fe=ge=!0),P.id!==se&&(se=P.id,Fe=!0),(ge||Le!==T)&&(0<Ye.numMultiviewViews?Ui.updateCameraProjectionMatricesUniform(T,it):it.setValue($,"projectionMatrix",T.projectionMatrix),pt.logarithmicDepthBuffer&&it.setValue($,"logDepthBufFC",2/(Math.log(T.far+1)/Math.LN2)),Le!==T&&(Le=T,Et=Fe=!0),(P.isShaderMaterial||P.isMeshPhongMaterial||P.isMeshStandardMaterial||P.envMap)&&(ge=it.map.cameraPosition,ge!==void 0&&ge.setValue($,Ke.setFromMatrixPosition(T.matrixWorld))),(P.isMeshPhongMaterial||P.isMeshLambertMaterial||P.isMeshBasicMaterial||P.isMeshStandardMaterial||P.isShaderMaterial||P.skinning)&&(0<Ye.numMultiviewViews?Ui.updateCameraViewMatricesUniform(T,it):it.setValue($,"viewMatrix",T.matrixWorldInverse))),P.skinning&&(it.setOptional($,ne,"bindMatrix"),it.setOptional($,ne,"bindMatrixInverse"),ge=ne.skeleton)){var Ut=ge.bones;if(pt.floatVertexTextures){if(ge.boneTexture===void 0){Ut=Math.sqrt(4*Ut.length),Ut=Xe.ceilPowerOfTwo(Ut),Ut=Math.max(Ut,4);var vt=new Float32Array(Ut*Ut*4);vt.set(ge.boneMatrices);var bt=new ei(vt,Ut,Ut,1023,1015);ge.boneMatrices=vt,ge.boneTexture=bt,ge.boneTextureSize=Ut}it.setValue($,"boneTexture",ge.boneTexture,qn),it.setValue($,"boneTextureSize",ge.boneTextureSize)}else it.setOptional($,ge,"boneMatrices")}return(Fe||ce.receiveShadow!==ne.receiveShadow)&&(ce.receiveShadow=ne.receiveShadow,it.setValue($,"receiveShadow",ne.receiveShadow)),Fe&&(it.setValue($,"toneMappingExposure",te.toneMappingExposure),it.setValue($,"toneMappingWhitePoint",te.toneMappingWhitePoint),ce.needsLights&&(Fe=Et,ee.ambientLightColor.needsUpdate=Fe,ee.lightProbe.needsUpdate=Fe,ee.directionalLights.needsUpdate=Fe,ee.pointLights.needsUpdate=Fe,ee.spotLights.needsUpdate=Fe,ee.rectAreaLights.needsUpdate=Fe,ee.hemisphereLights.needsUpdate=Fe),N&&P.fog&&(ee.fogColor.value.copy(N.color),N.isFog?(ee.fogNear.value=N.near,ee.fogFar.value=N.far):N.isFogExp2&&(ee.fogDensity.value=N.density)),P.isMeshBasicMaterial?x(ee,P):P.isMeshLambertMaterial?(x(ee,P),P.emissiveMap&&(ee.emissiveMap.value=P.emissiveMap)):P.isMeshPhongMaterial?(x(ee,P),P.isMeshToonMaterial?(y(ee,P),P.gradientMap&&(ee.gradientMap.value=P.gradientMap)):y(ee,P)):P.isMeshStandardMaterial?(x(ee,P),P.isMeshPhysicalMaterial?(M(ee,P),ee.reflectivity.value=P.reflectivity,ee.clearcoat.value=P.clearcoat,ee.clearcoatRoughness.value=P.clearcoatRoughness,P.sheen&&ee.sheen.value.copy(P.sheen),P.clearcoatNormalMap&&(ee.clearcoatNormalScale.value.copy(P.clearcoatNormalScale),ee.clearcoatNormalMap.value=P.clearcoatNormalMap,P.side===1&&ee.clearcoatNormalScale.value.negate()),ee.transparency.value=P.transparency):M(ee,P)):P.isMeshMatcapMaterial?(x(ee,P),P.matcap&&(ee.matcap.value=P.matcap),P.bumpMap&&(ee.bumpMap.value=P.bumpMap,ee.bumpScale.value=P.bumpScale,P.side===1&&(ee.bumpScale.value*=-1)),P.normalMap&&(ee.normalMap.value=P.normalMap,ee.normalScale.value.copy(P.normalScale),P.side===1&&ee.normalScale.value.negate()),P.displacementMap&&(ee.displacementMap.value=P.displacementMap,ee.displacementScale.value=P.displacementScale,ee.displacementBias.value=P.displacementBias)):P.isMeshDepthMaterial?(x(ee,P),P.displacementMap&&(ee.displacementMap.value=P.displacementMap,ee.displacementScale.value=P.displacementScale,ee.displacementBias.value=P.displacementBias)):P.isMeshDistanceMaterial?(x(ee,P),P.displacementMap&&(ee.displacementMap.value=P.displacementMap,ee.displacementScale.value=P.displacementScale,ee.displacementBias.value=P.displacementBias),ee.referencePosition.value.copy(P.referencePosition),ee.nearDistance.value=P.nearDistance,ee.farDistance.value=P.farDistance):P.isMeshNormalMaterial?(x(ee,P),P.bumpMap&&(ee.bumpMap.value=P.bumpMap,ee.bumpScale.value=P.bumpScale,P.side===1&&(ee.bumpScale.value*=-1)),P.normalMap&&(ee.normalMap.value=P.normalMap,ee.normalScale.value.copy(P.normalScale),P.side===1&&ee.normalScale.value.negate()),P.displacementMap&&(ee.displacementMap.value=P.displacementMap,ee.displacementScale.value=P.displacementScale,ee.displacementBias.value=P.displacementBias)):P.isLineBasicMaterial?(ee.diffuse.value.copy(P.color),ee.opacity.value=P.opacity,P.isLineDashedMaterial&&(ee.dashSize.value=P.dashSize,ee.totalSize.value=P.dashSize+P.gapSize,ee.scale.value=P.scale)):P.isPointsMaterial?(ee.diffuse.value.copy(P.color),ee.opacity.value=P.opacity,ee.size.value=P.size*ue,ee.scale.value=.5*U,ee.map.value=P.map,P.map!==null&&(P.map.matrixAutoUpdate===!0&&P.map.updateMatrix(),ee.uvTransform.value.copy(P.map.matrix))):P.isSpriteMaterial?(ee.diffuse.value.copy(P.color),ee.opacity.value=P.opacity,ee.rotation.value=P.rotation,ee.map.value=P.map,P.map!==null&&(P.map.matrixAutoUpdate===!0&&P.map.updateMatrix(),ee.uvTransform.value.copy(P.map.matrix))):P.isShadowMaterial&&(ee.color.value.copy(P.color),ee.opacity.value=P.opacity),ee.ltc_1!==void 0&&(ee.ltc_1.value=Ee.LTC_1),ee.ltc_2!==void 0&&(ee.ltc_2.value=Ee.LTC_2),Fn.upload($,ce.uniformsList,ee,qn)),P.isShaderMaterial&&P.uniformsNeedUpdate===!0&&(Fn.upload($,ce.uniformsList,ee,qn),P.uniformsNeedUpdate=!1),P.isSpriteMaterial&&it.setValue($,"center",ne.center),0<Ye.numMultiviewViews?Ui.updateObjectMatricesUniforms(ne,T,it):(it.setValue($,"modelViewMatrix",ne.modelViewMatrix),it.setValue($,"normalMatrix",ne.normalMatrix)),it.setValue($,"modelMatrix",ne.matrixWorld),Ye}function x(T,N){if(T.opacity.value=N.opacity,N.color&&T.diffuse.value.copy(N.color),N.emissive&&T.emissive.value.copy(N.emissive).multiplyScalar(N.emissiveIntensity),N.map&&(T.map.value=N.map),N.alphaMap&&(T.alphaMap.value=N.alphaMap),N.specularMap&&(T.specularMap.value=N.specularMap),N.envMap&&(T.envMap.value=N.envMap,T.flipEnvMap.value=N.envMap.isCubeTexture?-1:1,T.reflectivity.value=N.reflectivity,T.refractionRatio.value=N.refractionRatio,T.maxMipLevel.value=Jt.get(N.envMap).__maxMipLevel),N.lightMap&&(T.lightMap.value=N.lightMap,T.lightMapIntensity.value=N.lightMapIntensity),N.aoMap&&(T.aoMap.value=N.aoMap,T.aoMapIntensity.value=N.aoMapIntensity),N.map)var P=N.map;else N.specularMap?P=N.specularMap:N.displacementMap?P=N.displacementMap:N.normalMap?P=N.normalMap:N.bumpMap?P=N.bumpMap:N.roughnessMap?P=N.roughnessMap:N.metalnessMap?P=N.metalnessMap:N.alphaMap?P=N.alphaMap:N.emissiveMap&&(P=N.emissiveMap);P!==void 0&&(P.isWebGLRenderTarget&&(P=P.texture),P.matrixAutoUpdate===!0&&P.updateMatrix(),T.uvTransform.value.copy(P.matrix))}function y(T,N){T.specular.value.copy(N.specular),T.shininess.value=Math.max(N.shininess,1e-4),N.emissiveMap&&(T.emissiveMap.value=N.emissiveMap),N.bumpMap&&(T.bumpMap.value=N.bumpMap,T.bumpScale.value=N.bumpScale,N.side===1&&(T.bumpScale.value*=-1)),N.normalMap&&(T.normalMap.value=N.normalMap,T.normalScale.value.copy(N.normalScale),N.side===1&&T.normalScale.value.negate()),N.displacementMap&&(T.displacementMap.value=N.displacementMap,T.displacementScale.value=N.displacementScale,T.displacementBias.value=N.displacementBias)}function M(T,N){T.roughness.value=N.roughness,T.metalness.value=N.metalness,N.roughnessMap&&(T.roughnessMap.value=N.roughnessMap),N.metalnessMap&&(T.metalnessMap.value=N.metalnessMap),N.emissiveMap&&(T.emissiveMap.value=N.emissiveMap),N.bumpMap&&(T.bumpMap.value=N.bumpMap,T.bumpScale.value=N.bumpScale,N.side===1&&(T.bumpScale.value*=-1)),N.normalMap&&(T.normalMap.value=N.normalMap,T.normalScale.value.copy(N.normalScale),N.side===1&&T.normalScale.value.negate()),N.displacementMap&&(T.displacementMap.value=N.displacementMap,T.displacementScale.value=N.displacementScale,T.displacementBias.value=N.displacementBias),N.envMap&&(T.envMapIntensity.value=N.envMapIntensity)}e=e||{};var L=e.canvas!==void 0?e.canvas:document.createElementNS("http://www.w3.org/1999/xhtml","canvas"),O=e.context!==void 0?e.context:null,F=e.alpha!==void 0?e.alpha:!1,z=e.depth!==void 0?e.depth:!0,V=e.stencil!==void 0?e.stencil:!0,B=e.antialias!==void 0?e.antialias:!1,Y=e.premultipliedAlpha!==void 0?e.premultipliedAlpha:!0,Z=e.preserveDrawingBuffer!==void 0?e.preserveDrawingBuffer:!1,fe=e.powerPreference!==void 0?e.powerPreference:"default",X=e.failIfMajorPerformanceCaveat!==void 0?e.failIfMajorPerformanceCaveat:!1,j=null,J=null;this.domElement=L,this.debug={checkShaderErrors:!0},this.sortObjects=this.autoClearStencil=this.autoClearDepth=this.autoClearColor=this.autoClear=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.gammaFactor=2,this.physicallyCorrectLights=this.gammaOutput=this.gammaInput=!1,this.toneMappingWhitePoint=this.toneMappingExposure=this.toneMapping=1,this.maxMorphTargets=8,this.maxMorphNormals=4;var te=this,ze=!1,We=null,_=0,b=0,H=null,K=null,se=-1,ae=t=null,et=!1,Le=null,Te=null,Be=new _e,qe=new _e,mt=null,oe=L.width,U=L.height,ue=1,Ge=new _e(0,0,oe,U),st=new _e(0,0,oe,U),De=!1,Ze=new vn,me=new Es,Ie=!1,Mt=!1,He=new Se,Ke=new E;try{F={alpha:F,depth:z,stencil:V,antialias:B,premultipliedAlpha:Y,preserveDrawingBuffer:Z,powerPreference:fe,failIfMajorPerformanceCaveat:X,xrCompatible:!0},L.addEventListener("webglcontextlost",i,!1),L.addEventListener("webglcontextrestored",r,!1);var $=O||L.getContext("webgl",F)||L.getContext("experimental-webgl",F);if($===null)throw L.getContext("webgl")!==null?Error("Error creating WebGL context with your selected attributes."):Error("Error creating WebGL context.");$.getShaderPrecisionFormat===void 0&&($.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(T){throw console.error("THREE.WebGLRenderer: "+T.message),T}var Oe,pt,ke,Kt,Jt,qn,yo,Al,xo,Ar,qa,wo,Ni,zu,Gu,Hu,Zn;n();var bn=typeof navigator<"u"&&"xr"in navigator&&"supportsSession"in navigator.xr?new Qe(te,$):new Ue(te);this.vr=bn;var Ui=new q(te,$),Vu=new S(te,xo,pt.maxTextureSize);this.shadowMap=Vu,this.getContext=function(){return $},this.getContextAttributes=function(){return $.getContextAttributes()},this.forceContextLoss=function(){var T=Oe.get("WEBGL_lose_context");T&&T.loseContext()},this.forceContextRestore=function(){var T=Oe.get("WEBGL_lose_context");T&&T.restoreContext()},this.getPixelRatio=function(){return ue},this.setPixelRatio=function(T){T!==void 0&&(ue=T,this.setSize(oe,U,!1))},this.getSize=function(T){return T===void 0&&(console.warn("WebGLRenderer: .getsize() now requires a Vector2 as an argument"),T=new G),T.set(oe,U)},this.setSize=function(T,N,P){bn.isPresenting()?console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting."):(oe=T,U=N,L.width=Math.floor(T*ue),L.height=Math.floor(N*ue),P!==!1&&(L.style.width=T+"px",L.style.height=N+"px"),this.setViewport(0,0,T,N))},this.getDrawingBufferSize=function(T){return T===void 0&&(console.warn("WebGLRenderer: .getdrawingBufferSize() now requires a Vector2 as an argument"),T=new G),T.set(oe*ue,U*ue).floor()},this.setDrawingBufferSize=function(T,N,P){oe=T,U=N,ue=P,L.width=Math.floor(T*P),L.height=Math.floor(N*P),this.setViewport(0,0,T,N)},this.getCurrentViewport=function(T){return T===void 0&&(console.warn("WebGLRenderer: .getCurrentViewport() now requires a Vector4 as an argument"),T=new _e),T.copy(Be)},this.getViewport=function(T){return T.copy(Ge)},this.setViewport=function(T,N,P,ne){T.isVector4?Ge.set(T.x,T.y,T.z,T.w):Ge.set(T,N,P,ne),ke.viewport(Be.copy(Ge).multiplyScalar(ue).floor())},this.getScissor=function(T){return T.copy(st)},this.setScissor=function(T,N,P,ne){T.isVector4?st.set(T.x,T.y,T.z,T.w):st.set(T,N,P,ne),ke.scissor(qe.copy(st).multiplyScalar(ue).floor())},this.getScissorTest=function(){return De},this.setScissorTest=function(T){ke.setScissorTest(De=T)},this.getClearColor=function(){return Ni.getClearColor()},this.setClearColor=function(){Ni.setClearColor.apply(Ni,arguments)},this.getClearAlpha=function(){return Ni.getClearAlpha()},this.setClearAlpha=function(){Ni.setClearAlpha.apply(Ni,arguments)},this.clear=function(T,N,P){var ne=0;(T===void 0||T)&&(ne|=16384),(N===void 0||N)&&(ne|=256),(P===void 0||P)&&(ne|=1024),$.clear(ne)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){L.removeEventListener("webglcontextlost",i,!1),L.removeEventListener("webglcontextrestored",r,!1),qa.dispose(),wo.dispose(),Jt.dispose(),xo.dispose(),bn.dispose(),Za.stop()},this.renderBufferImmediate=function(T,N){ke.initAttributes();var P=Jt.get(T);T.hasPositions&&!P.position&&(P.position=$.createBuffer()),T.hasNormals&&!P.normal&&(P.normal=$.createBuffer()),T.hasUvs&&!P.uv&&(P.uv=$.createBuffer()),T.hasColors&&!P.color&&(P.color=$.createBuffer()),N=N.getAttributes(),T.hasPositions&&($.bindBuffer(34962,P.position),$.bufferData(34962,T.positionArray,35048),ke.enableAttribute(N.position),$.vertexAttribPointer(N.position,3,5126,!1,0,0)),T.hasNormals&&($.bindBuffer(34962,P.normal),$.bufferData(34962,T.normalArray,35048),ke.enableAttribute(N.normal),$.vertexAttribPointer(N.normal,3,5126,!1,0,0)),T.hasUvs&&($.bindBuffer(34962,P.uv),$.bufferData(34962,T.uvArray,35048),ke.enableAttribute(N.uv),$.vertexAttribPointer(N.uv,2,5126,!1,0,0)),T.hasColors&&($.bindBuffer(34962,P.color),$.bufferData(34962,T.colorArray,35048),ke.enableAttribute(N.color),$.vertexAttribPointer(N.color,3,5126,!1,0,0)),ke.disableUnusedAttributes(),$.drawArrays(4,0,T.count),T.count=0},this.renderBufferDirect=function(T,N,P,ne,ce,Ye){var ge=ce.isMesh&&0>ce.matrixWorld.determinant();ke.setMaterial(ne,ge);var Fe=v(T,N,ne,ce),Et=!1;(t!==P.id||ae!==Fe.id||et!==(ne.wireframe===!0))&&(t=P.id,ae=Fe.id,et=ne.wireframe===!0,Et=!0),ce.morphTargetInfluences&&(zu.update(ce,P,ne,Fe),Et=!0),ge=P.index;var it=P.attributes.position;if(N=1,ne.wireframe===!0&&(ge=Al.getWireframeAttribute(P),N=2),T=Gu,ge!==null){var ee=yo.get(ge);T=Hu,T.setIndex(ee)}if(Et){if(pt.isWebGL2!==!1||!ce.isInstancedMesh&&!P.isInstancedBufferGeometry||Oe.get("ANGLE_instanced_arrays")!==null){ke.initAttributes(),Et=P.attributes,Fe=Fe.getAttributes();var Ut=ne.defaultAttributeValues;for(yi in Fe){var vt=Fe[yi];if(0<=vt){var bt=Et[yi];if(bt!==void 0){var gi=bt.normalized,ju=bt.itemSize,Rn=yo.get(bt);if(Rn!==void 0){var Ka=Rn.buffer,Mr=Rn.type;if(Rn=Rn.bytesPerElement,bt.isInterleavedBufferAttribute){var Ao=bt.data,Uh=Ao.stride;bt=bt.offset,Ao&&Ao.isInstancedInterleavedBuffer?(ke.enableAttributeAndDivisor(vt,Ao.meshPerAttribute),P.maxInstancedCount===void 0&&(P.maxInstancedCount=Ao.meshPerAttribute*Ao.count)):ke.enableAttribute(vt),$.bindBuffer(34962,Ka),$.vertexAttribPointer(vt,ju,Mr,gi,Uh*Rn,bt*Rn)}else bt.isInstancedBufferAttribute?(ke.enableAttributeAndDivisor(vt,bt.meshPerAttribute),P.maxInstancedCount===void 0&&(P.maxInstancedCount=bt.meshPerAttribute*bt.count)):ke.enableAttribute(vt),$.bindBuffer(34962,Ka),$.vertexAttribPointer(vt,ju,Mr,gi,0,0)}}else if(yi==="instanceMatrix")Rn=yo.get(ce.instanceMatrix),Rn!==void 0&&(Ka=Rn.buffer,Mr=Rn.type,ke.enableAttributeAndDivisor(vt+0,1),ke.enableAttributeAndDivisor(vt+1,1),ke.enableAttributeAndDivisor(vt+2,1),ke.enableAttributeAndDivisor(vt+3,1),$.bindBuffer(34962,Ka),$.vertexAttribPointer(vt+0,4,Mr,!1,64,0),$.vertexAttribPointer(vt+1,4,Mr,!1,64,16),$.vertexAttribPointer(vt+2,4,Mr,!1,64,32),$.vertexAttribPointer(vt+3,4,Mr,!1,64,48));else if(Ut!==void 0&&(gi=Ut[yi],gi!==void 0))switch(gi.length){case 2:$.vertexAttrib2fv(vt,gi);break;case 3:$.vertexAttrib3fv(vt,gi);break;case 4:$.vertexAttrib4fv(vt,gi);break;default:$.vertexAttrib1fv(vt,gi)}}}ke.disableUnusedAttributes()}ge!==null&&$.bindBuffer(34963,ee.buffer)}ee=1/0,ge!==null?ee=ge.count:it!==void 0&&(ee=it.count),ge=P.drawRange.start*N,it=Ye!==null?Ye.start*N:0;var yi=Math.max(ge,it);if(Ye=Math.max(0,Math.min(ee,ge+P.drawRange.count*N,it+(Ye!==null?Ye.count*N:1/0))-1-yi+1),Ye!==0){if(ce.isMesh)if(ne.wireframe===!0)ke.setLineWidth(ne.wireframeLinewidth*(H===null?ue:1)),T.setMode(1);else switch(ce.drawMode){case 0:T.setMode(4);break;case 1:T.setMode(5);break;case 2:T.setMode(6)}else ce.isLine?(ne=ne.linewidth,ne===void 0&&(ne=1),ke.setLineWidth(ne*(H===null?ue:1)),ce.isLineSegments?T.setMode(1):ce.isLineLoop?T.setMode(2):T.setMode(3)):ce.isPoints?T.setMode(0):ce.isSprite&&T.setMode(4);ce.isInstancedMesh?T.renderInstances(P,yi,Ye,ce.count):P.isInstancedBufferGeometry?T.renderInstances(P,yi,Ye,P.maxInstancedCount):T.render(yi,Ye)}},this.compile=function(T,N){J=wo.get(T,N),J.init(),T.traverse(function(P){P.isLight&&(J.pushLight(P),P.castShadow&&J.pushShadow(P))}),J.setupLights(N),T.traverse(function(P){if(P.material)if(Array.isArray(P.material))for(var ne=0;ne<P.material.length;ne++)p(P.material[ne],T.fog,P);else p(P.material,T.fog,P)})};var Ml=null,Za=new Sr;Za.setAnimationLoop(function(T){bn.isPresenting()||Ml&&Ml(T)}),typeof window<"u"&&Za.setContext(window),this.setAnimationLoop=function(T){Ml=T,bn.setAnimationLoop(T),Za.start()},this.render=function(T,N,P,ne){if(P!==void 0){console.warn("THREE.WebGLRenderer.render(): the renderTarget argument has been removed. Use .setRenderTarget() instead.");var ce=P}if(ne!==void 0){console.warn("THREE.WebGLRenderer.render(): the forceClear argument has been removed. Use .clear() instead.");var Ye=ne}N&&N.isCamera?ze||(ae=t=null,et=!1,se=-1,Le=null,T.autoUpdate===!0&&T.updateMatrixWorld(),N.parent===null&&N.updateMatrixWorld(),bn.enabled&&(N=bn.getCamera(N)),J=wo.get(T,N),J.init(),T.onBeforeRender(te,T,N,ce||H),He.multiplyMatrices(N.projectionMatrix,N.matrixWorldInverse),Ze.setFromMatrix(He),Mt=this.localClippingEnabled,Ie=me.init(this.clippingPlanes,Mt,N),j=qa.get(T,N),j.init(),c(T,N,0,te.sortObjects),te.sortObjects===!0&&j.sort(),Ie&&me.beginShadows(),Vu.render(J.state.shadowsArray,T,N),J.setupLights(N),Ie&&me.endShadows(),this.info.autoReset&&this.info.reset(),ce!==void 0&&this.setRenderTarget(ce),bn.enabled&&Ui.isAvailable()&&Ui.attachCamera(N),Ni.render(j,T,N,Ye),P=j.opaque,ne=j.transparent,T.overrideMaterial?(ce=T.overrideMaterial,P.length&&u(P,T,N,ce),ne.length&&u(ne,T,N,ce)):(P.length&&u(P,T,N),ne.length&&u(ne,T,N)),T.onAfterRender(te,T,N),H!==null&&(qn.updateRenderTargetMipmap(H),qn.updateMultisampleRenderTarget(H)),ke.buffers.depth.setTest(!0),ke.buffers.depth.setMask(!0),ke.buffers.color.setMask(!0),ke.setPolygonOffset(!1),bn.enabled&&(Ui.isAvailable()&&Ui.detachCamera(N),bn.submitFrame()),J=j=null):console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.")},this.setFramebuffer=function(T){We!==T&&$.bindFramebuffer(36160,T),We=T},this.getActiveCubeFace=function(){return _},this.getActiveMipmapLevel=function(){return b},this.getRenderTarget=function(){return H},this.setRenderTarget=function(T,N,P){H=T,_=N,b=P,T&&Jt.get(T).__webglFramebuffer===void 0&&qn.setupRenderTarget(T);var ne=We,ce=!1;T?(ne=Jt.get(T).__webglFramebuffer,T.isWebGLRenderTargetCube?(ne=ne[N||0],ce=!0):ne=T.isWebGLMultisampleRenderTarget?Jt.get(T).__webglMultisampledFramebuffer:ne,Be.copy(T.viewport),qe.copy(T.scissor),mt=T.scissorTest):(Be.copy(Ge).multiplyScalar(ue).floor(),qe.copy(st).multiplyScalar(ue).floor(),mt=De),K!==ne&&($.bindFramebuffer(36160,ne),K=ne),ke.viewport(Be),ke.scissor(qe),ke.setScissorTest(mt),ce&&(T=Jt.get(T.texture),$.framebufferTexture2D(36160,36064,34069+(N||0),T.__webglTexture,P||0))},this.readRenderTargetPixels=function(T,N,P,ne,ce,Ye,ge){if(T&&T.isWebGLRenderTarget){var Fe=Jt.get(T).__webglFramebuffer;if(T.isWebGLRenderTargetCube&&ge!==void 0&&(Fe=Fe[ge]),Fe){ge=!1,Fe!==K&&($.bindFramebuffer(36160,Fe),ge=!0);try{var Et=T.texture,it=Et.format,ee=Et.type;it!==1023&&Zn.convert(it)!==$.getParameter(35739)?console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format."):ee===1009||Zn.convert(ee)===$.getParameter(35738)||ee===1015&&(pt.isWebGL2||Oe.get("OES_texture_float")||Oe.get("WEBGL_color_buffer_float"))||ee===1016&&(pt.isWebGL2?Oe.get("EXT_color_buffer_float"):Oe.get("EXT_color_buffer_half_float"))?$.checkFramebufferStatus(36160)===36053?0<=N&&N<=T.width-ne&&0<=P&&P<=T.height-ce&&$.readPixels(N,P,ne,ce,Zn.convert(it),Zn.convert(ee),Ye):console.error("THREE.WebGLRenderer.readRenderTargetPixels: readPixels from renderTarget failed. Framebuffer not complete."):console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.")}finally{ge&&$.bindFramebuffer(36160,K)}}}else console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.")},this.copyFramebufferToTexture=function(T,N,P){var ne=N.image.width,ce=N.image.height,Ye=Zn.convert(N.format);qn.setTexture2D(N,0),$.copyTexImage2D(3553,P||0,Ye,T.x,T.y,ne,ce,0)},this.copyTextureToTexture=function(T,N,P,ne){var ce=N.image.width,Ye=N.image.height,ge=Zn.convert(P.format),Fe=Zn.convert(P.type);qn.setTexture2D(P,0),N.isDataTexture?$.texSubImage2D(3553,ne||0,T.x,T.y,ce,Ye,ge,Fe,N.image.data):$.texSubImage2D(3553,ne||0,T.x,T.y,ge,Fe,N.image)},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}function tt(e,t){this.name="",this.color=new ve(e),this.density=t!==void 0?t:25e-5}function xt(e,t,n){this.name="",this.color=new ve(e),this.near=t!==void 0?t:1,this.far=n!==void 0?n:1e3}function ct(e,t){this.array=e,this.stride=t,this.count=e!==void 0?e.length/t:0,this.dynamic=!1,this.updateRange={offset:0,count:-1},this.version=0}function gt(e,t,n,i){this.data=e,this.itemSize=t,this.offset=n,this.normalized=i===!0}function wt(e){ie.call(this),this.type="SpriteMaterial",this.color=new ve(16777215),this.map=null,this.rotation=0,this.transparent=this.sizeAttenuation=!0,this.setValues(e)}function kt(e){if(W.call(this),this.type="Sprite",fo===void 0){fo=new re;var t=new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]);t=new ct(t,5),fo.setIndex([0,1,2,0,2,3]),fo.addAttribute("position",new gt(t,3,0,!1)),fo.addAttribute("uv",new gt(t,2,3,!1))}this.geometry=fo,this.material=e!==void 0?e:new wt,this.center=new G(.5,.5)}function Bt(e,t,n,i,r,o){go.subVectors(e,n).addScalar(.5).multiply(i),r!==void 0?(fs.x=o*go.x-r*go.y,fs.y=r*go.x+o*go.y):fs.copy(go),e.copy(t),e.x+=fs.x,e.y+=fs.y,e.applyMatrix4(fu)}function Ot(){W.call(this),this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]}}),this.autoUpdate=!0}function Lt(e,t){e&&e.isGeometry&&console.error("THREE.SkinnedMesh no longer supports THREE.Geometry. Use THREE.BufferGeometry instead."),yt.call(this,e,t),this.type="SkinnedMesh",this.bindMode="attached",this.bindMatrix=new Se,this.bindMatrixInverse=new Se}function tn(e,t){if(e=e||[],this.bones=e.slice(0),this.boneMatrices=new Float32Array(16*this.bones.length),this.frame=-1,t===void 0)this.calculateInverses();else if(this.bones.length===t.length)this.boneInverses=t.slice(0);else for(console.warn("THREE.Skeleton boneInverses is the wrong length."),this.boneInverses=[],e=0,t=this.bones.length;e<t;e++)this.boneInverses.push(new Se)}function pn(){W.call(this),this.type="Bone"}function Ft(e,t,n){yt.call(this,e,t),this.instanceMatrix=new Ce(new Float32Array(16*n),16),this.count=n}function $e(e){ie.call(this),this.type="LineBasicMaterial",this.color=new ve(16777215),this.linewidth=1,this.linejoin=this.linecap="round",this.setValues(e)}function At(e,t,n){n===1&&console.error("THREE.Line: parameter THREE.LinePieces no longer supported. Use THREE.LineSegments instead."),W.call(this),this.type="Line",this.geometry=e!==void 0?e:new re,this.material=t!==void 0?t:new $e({color:16777215*Math.random()})}function ot(e,t){At.call(this,e,t),this.type="LineSegments"}function Ci(e,t){At.call(this,e,t),this.type="LineLoop"}function nn(e){ie.call(this),this.type="PointsMaterial",this.color=new ve(16777215),this.map=null,this.size=1,this.sizeAttenuation=!0,this.morphTargets=!1,this.setValues(e)}function oi(e,t){W.call(this),this.type="Points",this.geometry=e!==void 0?e:new re,this.material=t!==void 0?t:new nn({color:16777215*Math.random()}),this.updateMorphTargets()}function Lr(e,t,n,i,r,o,s){var a=ul.distanceSqToPoint(e);a<n&&(n=new E,ul.closestPointToPoint(e,n),n.applyMatrix4(i),e=r.ray.origin.distanceTo(n),e<r.near||e>r.far||o.push({distance:e,distanceToRay:Math.sqrt(a),point:n,index:t,face:null,object:s}))}function Pr(e,t,n,i,r,o,s,a,c){Ae.call(this,e,t,n,i,r,o,s,a,c),this.format=s!==void 0?s:1022,this.minFilter=o!==void 0?o:1006,this.magFilter=r!==void 0?r:1006,this.generateMipmaps=!1}function Un(e,t,n,i,r,o,s,a,c,u,h,p){Ae.call(this,null,o,s,a,c,u,i,r,h,p),this.image={width:t,height:n},this.mipmaps=e,this.generateMipmaps=this.flipY=!1}function qt(e,t,n,i,r,o,s,a,c){Ae.call(this,e,t,n,i,r,o,s,a,c),this.needsUpdate=!0}function Xi(e,t,n,i,r,o,s,a,c,u){if(u=u!==void 0?u:1026,u!==1026&&u!==1027)throw Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");n===void 0&&u===1026&&(n=1012),n===void 0&&u===1027&&(n=1020),Ae.call(this,null,i,r,o,s,a,u,n,c),this.image={width:e,height:t},this.magFilter=s!==void 0?s:1003,this.minFilter=a!==void 0?a:1003,this.generateMipmaps=this.flipY=!1}function Li(e){re.call(this),this.type="WireframeGeometry";var t=[],n,i,r,o=[0,0],s={},a=["a","b","c"];if(e&&e.isGeometry){var c=e.faces,u=0;for(i=c.length;u<i;u++){var h=c[u];for(n=0;3>n;n++){var p=h[a[n]],v=h[a[(n+1)%3]];o[0]=Math.min(p,v),o[1]=Math.max(p,v),p=o[0]+","+o[1],s[p]===void 0&&(s[p]={index1:o[0],index2:o[1]})}}for(p in s)u=s[p],a=e.vertices[u.index1],t.push(a.x,a.y,a.z),a=e.vertices[u.index2],t.push(a.x,a.y,a.z)}else if(e&&e.isBufferGeometry)if(a=new E,e.index!==null){c=e.attributes.position,h=e.index;var x=e.groups;for(x.length===0&&(x=[{start:0,count:h.count,materialIndex:0}]),e=0,r=x.length;e<r;++e)for(u=x[e],n=u.start,i=u.count,u=n,i=n+i;u<i;u+=3)for(n=0;3>n;n++)p=h.getX(u+n),v=h.getX(u+(n+1)%3),o[0]=Math.min(p,v),o[1]=Math.max(p,v),p=o[0]+","+o[1],s[p]===void 0&&(s[p]={index1:o[0],index2:o[1]});for(p in s)u=s[p],a.fromBufferAttribute(c,u.index1),t.push(a.x,a.y,a.z),a.fromBufferAttribute(c,u.index2),t.push(a.x,a.y,a.z)}else for(c=e.attributes.position,u=0,i=c.count/3;u<i;u++)for(n=0;3>n;n++)s=3*u+n,a.fromBufferAttribute(c,s),t.push(a.x,a.y,a.z),s=3*u+(n+1)%3,a.fromBufferAttribute(c,s),t.push(a.x,a.y,a.z);this.addAttribute("position",new le(t,3))}function bo(e,t,n){he.call(this),this.type="ParametricGeometry",this.parameters={func:e,slices:t,stacks:n},this.fromBufferGeometry(new br(e,t,n)),this.mergeVertices()}function br(e,t,n){re.call(this),this.type="ParametricBufferGeometry",this.parameters={func:e,slices:t,stacks:n};var i=[],r=[],o=[],s=[],a=new E,c=new E,u=new E,h=new E,p=new E,v,x;3>e.length&&console.error("THREE.ParametricGeometry: Function must now modify a Vector3 as third parameter.");var y=t+1;for(v=0;v<=n;v++){var M=v/n;for(x=0;x<=t;x++){var L=x/t;e(L,M,c),r.push(c.x,c.y,c.z),0<=L-1e-5?(e(L-1e-5,M,u),h.subVectors(c,u)):(e(L+1e-5,M,u),h.subVectors(u,c)),0<=M-1e-5?(e(L,M-1e-5,u),p.subVectors(c,u)):(e(L,M+1e-5,u),p.subVectors(u,c)),a.crossVectors(h,p).normalize(),o.push(a.x,a.y,a.z),s.push(L,M)}}for(v=0;v<n;v++)for(x=0;x<t;x++)e=v*y+x+1,a=(v+1)*y+x+1,c=(v+1)*y+x,i.push(v*y+x,e,c),i.push(e,a,c);this.setIndex(i),this.addAttribute("position",new le(r,3)),this.addAttribute("normal",new le(o,3)),this.addAttribute("uv",new le(s,2))}function Ro(e,t,n,i){he.call(this),this.type="PolyhedronGeometry",this.parameters={vertices:e,indices:t,radius:n,detail:i},this.fromBufferGeometry(new rn(e,t,n,i)),this.mergeVertices()}function rn(e,t,n,i){function r(u){a.push(u.x,u.y,u.z)}function o(u,h){u*=3,h.x=e[u+0],h.y=e[u+1],h.z=e[u+2]}function s(u,h,p,v){0>v&&u.x===1&&(c[h]=u.x-1),p.x===0&&p.z===0&&(c[h]=v/2/Math.PI+.5)}re.call(this),this.type="PolyhedronBufferGeometry",this.parameters={vertices:e,indices:t,radius:n,detail:i},n=n||1,i=i||0;var a=[],c=[];(function(u){for(var h=new E,p=new E,v=new E,x=0;x<t.length;x+=3){o(t[x+0],h),o(t[x+1],p),o(t[x+2],v);var y,M,L=h,O=p,F=v,z=Math.pow(2,u),V=[];for(M=0;M<=z;M++){V[M]=[];var B=L.clone().lerp(F,M/z),Y=O.clone().lerp(F,M/z),Z=z-M;for(y=0;y<=Z;y++)V[M][y]=y===0&&M===z?B:B.clone().lerp(Y,y/Z)}for(M=0;M<z;M++)for(y=0;y<2*(z-M)-1;y++)L=Math.floor(y/2),y%2===0?(r(V[M][L+1]),r(V[M+1][L]),r(V[M][L])):(r(V[M][L+1]),r(V[M+1][L+1]),r(V[M+1][L]))}})(i),function(u){for(var h=new E,p=0;p<a.length;p+=3)h.x=a[p+0],h.y=a[p+1],h.z=a[p+2],h.normalize().multiplyScalar(u),a[p+0]=h.x,a[p+1]=h.y,a[p+2]=h.z}(n),function(){for(var u=new E,h=0;h<a.length;h+=3)u.x=a[h+0],u.y=a[h+1],u.z=a[h+2],c.push(Math.atan2(u.z,-u.x)/2/Math.PI+.5,1-(Math.atan2(-u.y,Math.sqrt(u.x*u.x+u.z*u.z))/Math.PI+.5));u=new E,h=new E;for(var p=new E,v=new E,x=new G,y=new G,M=new G,L=0,O=0;L<a.length;L+=9,O+=6){u.set(a[L+0],a[L+1],a[L+2]),h.set(a[L+3],a[L+4],a[L+5]),p.set(a[L+6],a[L+7],a[L+8]),x.set(c[O+0],c[O+1]),y.set(c[O+2],c[O+3]),M.set(c[O+4],c[O+5]),v.copy(u).add(h).add(p).divideScalar(3);var F=Math.atan2(v.z,-v.x);s(x,O+0,u,F),s(y,O+2,h,F),s(M,O+4,p,F)}for(u=0;u<c.length;u+=6)h=c[u+0],p=c[u+2],v=c[u+4],x=Math.min(h,p,v),.9<Math.max(h,p,v)&&.1>x&&(.2>h&&(c[u+0]+=1),.2>p&&(c[u+2]+=1),.2>v&&(c[u+4]+=1))}(),this.addAttribute("position",new le(a,3)),this.addAttribute("normal",new le(a.slice(),3)),this.addAttribute("uv",new le(c,2)),i===0?this.computeVertexNormals():this.normalizeNormals()}function Do(e,t){he.call(this),this.type="TetrahedronGeometry",this.parameters={radius:e,detail:t},this.fromBufferGeometry(new Rr(e,t)),this.mergeVertices()}function Rr(e,t){rn.call(this,[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],[2,1,0,0,3,2,1,3,0,2,3,1],e,t),this.type="TetrahedronBufferGeometry",this.parameters={radius:e,detail:t}}function Bo(e,t){he.call(this),this.type="OctahedronGeometry",this.parameters={radius:e,detail:t},this.fromBufferGeometry(new Qi(e,t)),this.mergeVertices()}function Qi(e,t){rn.call(this,[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2],e,t),this.type="OctahedronBufferGeometry",this.parameters={radius:e,detail:t}}function Io(e,t){he.call(this),this.type="IcosahedronGeometry",this.parameters={radius:e,detail:t},this.fromBufferGeometry(new Dr(e,t)),this.mergeVertices()}function Dr(e,t){var n=(1+Math.sqrt(5))/2;rn.call(this,[-1,n,0,1,n,0,-1,-n,0,1,-n,0,0,-1,n,0,1,n,0,-1,-n,0,1,-n,n,0,-1,n,0,1,-n,0,-1,-n,0,1],[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1],e,t),this.type="IcosahedronBufferGeometry",this.parameters={radius:e,detail:t}}function Oo(e,t){he.call(this),this.type="DodecahedronGeometry",this.parameters={radius:e,detail:t},this.fromBufferGeometry(new Br(e,t)),this.mergeVertices()}function Br(e,t){var n=(1+Math.sqrt(5))/2,i=1/n;rn.call(this,[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-i,-n,0,-i,n,0,i,-n,0,i,n,-i,-n,0,-i,n,0,i,-n,0,i,n,0,-n,0,-i,n,0,-i,-n,0,i,n,0,i],[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9],e,t),this.type="DodecahedronBufferGeometry",this.parameters={radius:e,detail:t}}function Fo(e,t,n,i,r,o){he.call(this),this.type="TubeGeometry",this.parameters={path:e,tubularSegments:t,radius:n,radialSegments:i,closed:r},o!==void 0&&console.warn("THREE.TubeGeometry: taper has been removed."),e=new qi(e,t,n,i,r),this.tangents=e.tangents,this.normals=e.normals,this.binormals=e.binormals,this.fromBufferGeometry(e),this.mergeVertices()}function qi(e,t,n,i,r){function o(O){h=e.getPointAt(O/t,h);var F=s.normals[O];for(O=s.binormals[O],v=0;v<=i;v++){var z=v/i*Math.PI*2,V=Math.sin(z);z=-Math.cos(z),c.x=z*F.x+V*O.x,c.y=z*F.y+V*O.y,c.z=z*F.z+V*O.z,c.normalize(),y.push(c.x,c.y,c.z),a.x=h.x+n*c.x,a.y=h.y+n*c.y,a.z=h.z+n*c.z,x.push(a.x,a.y,a.z)}}re.call(this),this.type="TubeBufferGeometry",this.parameters={path:e,tubularSegments:t,radius:n,radialSegments:i,closed:r},t=t||64,n=n||1,i=i||8,r=r||!1;var s=e.computeFrenetFrames(t,r);this.tangents=s.tangents,this.normals=s.normals,this.binormals=s.binormals;var a=new E,c=new E,u=new G,h=new E,p,v,x=[],y=[],M=[],L=[];for(p=0;p<t;p++)o(p);for(o(r===!1?t:0),p=0;p<=t;p++)for(v=0;v<=i;v++)u.x=p/t,u.y=v/i,M.push(u.x,u.y);(function(){for(v=1;v<=t;v++)for(p=1;p<=i;p++){var O=(i+1)*v+(p-1),F=(i+1)*v+p,z=(i+1)*(v-1)+p;L.push((i+1)*(v-1)+(p-1),O,z),L.push(O,F,z)}})(),this.setIndex(L),this.addAttribute("position",new le(x,3)),this.addAttribute("normal",new le(y,3)),this.addAttribute("uv",new le(M,2))}function No(e,t,n,i,r,o,s){he.call(this),this.type="TorusKnotGeometry",this.parameters={radius:e,tube:t,tubularSegments:n,radialSegments:i,p:r,q:o},s!==void 0&&console.warn("THREE.TorusKnotGeometry: heightScale has been deprecated. Use .scale( x, y, z ) instead."),this.fromBufferGeometry(new Ir(e,t,n,i,r,o)),this.mergeVertices()}function Ir(e,t,n,i,r,o){function s(Y,Z,fe,X,j){var J=Math.sin(Y);Z=fe/Z*Y,fe=Math.cos(Z),j.x=X*(2+fe)*.5*Math.cos(Y),j.y=X*(2+fe)*J*.5,j.z=X*Math.sin(Z)*.5}re.call(this),this.type="TorusKnotBufferGeometry",this.parameters={radius:e,tube:t,tubularSegments:n,radialSegments:i,p:r,q:o},e=e||1,t=t||.4,n=Math.floor(n)||64,i=Math.floor(i)||8,r=r||2,o=o||3;var a=[],c=[],u=[],h=[],p,v=new E,x=new E,y=new E,M=new E,L=new E,O=new E,F=new E;for(p=0;p<=n;++p){var z=p/n*r*Math.PI*2;for(s(z,r,o,e,y),s(z+.01,r,o,e,M),O.subVectors(M,y),F.addVectors(M,y),L.crossVectors(O,F),F.crossVectors(L,O),L.normalize(),F.normalize(),z=0;z<=i;++z){var V=z/i*Math.PI*2,B=-t*Math.cos(V);V=t*Math.sin(V),v.x=y.x+(B*F.x+V*L.x),v.y=y.y+(B*F.y+V*L.y),v.z=y.z+(B*F.z+V*L.z),c.push(v.x,v.y,v.z),x.subVectors(v,y).normalize(),u.push(x.x,x.y,x.z),h.push(p/n),h.push(z/i)}}for(z=1;z<=n;z++)for(p=1;p<=i;p++)e=(i+1)*z+(p-1),t=(i+1)*z+p,r=(i+1)*(z-1)+p,a.push((i+1)*(z-1)+(p-1),e,r),a.push(e,t,r);this.setIndex(a),this.addAttribute("position",new le(c,3)),this.addAttribute("normal",new le(u,3)),this.addAttribute("uv",new le(h,2))}function Uo(e,t,n,i,r){he.call(this),this.type="TorusGeometry",this.parameters={radius:e,tube:t,radialSegments:n,tubularSegments:i,arc:r},this.fromBufferGeometry(new Or(e,t,n,i,r)),this.mergeVertices()}function Or(e,t,n,i,r){re.call(this),this.type="TorusBufferGeometry",this.parameters={radius:e,tube:t,radialSegments:n,tubularSegments:i,arc:r},e=e||1,t=t||.4,n=Math.floor(n)||8,i=Math.floor(i)||6,r=r||2*Math.PI;var o=[],s=[],a=[],c=[],u=new E,h=new E,p=new E,v,x;for(v=0;v<=n;v++)for(x=0;x<=i;x++){var y=x/i*r,M=v/n*Math.PI*2;h.x=(e+t*Math.cos(M))*Math.cos(y),h.y=(e+t*Math.cos(M))*Math.sin(y),h.z=t*Math.sin(M),s.push(h.x,h.y,h.z),u.x=e*Math.cos(y),u.y=e*Math.sin(y),p.subVectors(h,u).normalize(),a.push(p.x,p.y,p.z),c.push(x/i),c.push(v/n)}for(v=1;v<=n;v++)for(x=1;x<=i;x++)e=(i+1)*(v-1)+x-1,t=(i+1)*(v-1)+x,r=(i+1)*v+x,o.push((i+1)*v+x-1,e,r),o.push(e,t,r);this.setIndex(o),this.addAttribute("position",new le(s,3)),this.addAttribute("normal",new le(a,3)),this.addAttribute("uv",new le(c,2))}function _l(e,t,n,i,r){for(var o,s=0,a=t,c=n-i;a<n;a+=i)s+=(e[c]-e[a])*(e[a+1]+e[c+1]),c=a;if(r===0<s)for(r=t;r<n;r+=i)o=Pl(r,e[r],e[r+1],o);else for(r=n-i;r>=t;r-=i)o=Pl(r,e[r],e[r+1],o);return o&&Zi(o,o.next)&&(Vo(o),o=o.next),o}function zo(e,t){if(!e)return e;t||(t=e);do{var n=!1;if(e.steiner||!Zi(e,e.next)&&Ht(e.prev,e,e.next)!==0)e=e.next;else{if(Vo(e),e=t=e.prev,e===e.next)break;n=!0}}while(n||e!==t);return t}function Go(e,t,n,i,r,o,s){if(e){if(!s&&o){var a=e,c=a;do c.z===null&&(c.z=wc(c.x,c.y,i,r,o)),c.prevZ=c.prev,c=c.nextZ=c.next;while(c!==a);c.prevZ.nextZ=null,c.prevZ=null,a=c;var u,h,p,v,x=1;do{c=a;var y=a=null;for(h=0;c;){h++;var M=c;for(u=p=0;u<x&&(p++,M=M.nextZ,M);u++);for(v=x;0<p||0<v&&M;)p!==0&&(v===0||!M||c.z<=M.z)?(u=c,c=c.nextZ,p--):(u=M,M=M.nextZ,v--),y?y.nextZ=u:a=u,u.prevZ=y,y=u;c=M}y.nextZ=null,x*=2}while(1<h)}for(a=e;e.prev!==e.next;){if(c=e.prev,M=e.next,o)y=qu(e,i,r,o);else e:if(y=e,h=y.prev,p=y,x=y.next,0<=Ht(h,p,x))y=!1;else{for(u=y.next.next;u!==y.prev;){if(Fr(h.x,h.y,p.x,p.y,x.x,x.y,u.x,u.y)&&0<=Ht(u.prev,u,u.next)){y=!1;break e}u=u.next}y=!0}if(y)t.push(c.i/n),t.push(e.i/n),t.push(M.i/n),Vo(e),a=e=M.next;else if(e=M,e===a){if(!s)Go(zo(e),t,n,i,r,o,1);else if(s===1){s=t,a=n,c=e;do M=c.prev,y=c.next.next,!Zi(M,y)&&Cl(M,c,c.next,y)&&Ho(M,y)&&Ho(y,M)&&(s.push(M.i/a),s.push(c.i/a),s.push(y.i/a),Vo(c),Vo(c.next),c=e=y),c=c.next;while(c!==e);e=c,Go(e,t,n,i,r,o,2)}else if(s===2)e:{s=e;do{for(a=s.next.next;a!==s.prev;){if(c=s.i!==a.i){if(c=s,M=a,y=c.next.i!==M.i&&c.prev.i!==M.i){t:{y=c;do{if(y.i!==c.i&&y.next.i!==c.i&&y.i!==M.i&&y.next.i!==M.i&&Cl(y,y.next,c,M)){y=!0;break t}y=y.next}while(y!==c);y=!1}y=!y}if(y=y&&Ho(c,M)&&Ho(M,c)){y=c,h=!1,p=(c.x+M.x)/2,M=(c.y+M.y)/2;do y.y>M!=y.next.y>M&&y.next.y!==y.y&&p<(y.next.x-y.x)*(M-y.y)/(y.next.y-y.y)+y.x&&(h=!h),y=y.next;while(y!==c);y=h}c=y}if(c){e=Ll(s,a),s=zo(s,s.next),e=zo(e,e.next),Go(s,t,n,i,r,o),Go(e,t,n,i,r,o);break e}a=a.next}s=s.next}while(s!==e)}break}}}}function qu(e,t,n,i){var r=e.prev,o=e.next;if(0<=Ht(r,e,o))return!1;var s=r.x>e.x?r.x>o.x?r.x:o.x:e.x>o.x?e.x:o.x,a=r.y>e.y?r.y>o.y?r.y:o.y:e.y>o.y?e.y:o.y,c=wc(r.x<e.x?r.x<o.x?r.x:o.x:e.x<o.x?e.x:o.x,r.y<e.y?r.y<o.y?r.y:o.y:e.y<o.y?e.y:o.y,t,n,i);for(t=wc(s,a,t,n,i),n=e.prevZ,i=e.nextZ;n&&n.z>=c&&i&&i.z<=t;){if(n!==e.prev&&n!==e.next&&Fr(r.x,r.y,e.x,e.y,o.x,o.y,n.x,n.y)&&0<=Ht(n.prev,n,n.next)||(n=n.prevZ,i!==e.prev&&i!==e.next&&Fr(r.x,r.y,e.x,e.y,o.x,o.y,i.x,i.y)&&0<=Ht(i.prev,i,i.next)))return!1;i=i.nextZ}for(;n&&n.z>=c;){if(n!==e.prev&&n!==e.next&&Fr(r.x,r.y,e.x,e.y,o.x,o.y,n.x,n.y)&&0<=Ht(n.prev,n,n.next))return!1;n=n.prevZ}for(;i&&i.z<=t;){if(i!==e.prev&&i!==e.next&&Fr(r.x,r.y,e.x,e.y,o.x,o.y,i.x,i.y)&&0<=Ht(i.prev,i,i.next))return!1;i=i.nextZ}return!0}function Zu(e,t){return e.x-t.x}function Ku(e,t){var n=t,i=e.x,r=e.y,o=-1/0;do{if(r<=n.y&&r>=n.next.y&&n.next.y!==n.y){var s=n.x+(r-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(s<=i&&s>o){if(o=s,s===i){if(r===n.y)return n;if(r===n.next.y)return n.next}var a=n.x<n.next.x?n:n.next}}n=n.next}while(n!==t);if(!a)return null;if(i===o)return a.prev;t=a,s=a.x;var c=a.y,u=1/0;for(n=a.next;n!==t;){if(i>=n.x&&n.x>=s&&i!==n.x&&Fr(r<c?i:o,r,s,c,r<c?o:i,r,n.x,n.y)){var h=Math.abs(r-n.y)/(i-n.x);(h<u||h===u&&n.x>a.x)&&Ho(n,e)&&(a=n,u=h)}n=n.next}return a}function wc(e,t,n,i,r){return e=32767*(e-n)*r,t=32767*(t-i)*r,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,t=(t|t<<8)&16711935,t=(t|t<<4)&252645135,t=(t|t<<2)&858993459,(e|e<<1)&1431655765|((t|t<<1)&1431655765)<<1}function Ju(e){var t=e,n=e;do(t.x<n.x||t.x===n.x&&t.y<n.y)&&(n=t),t=t.next;while(t!==e);return n}function Fr(e,t,n,i,r,o,s,a){return 0<=(r-s)*(t-a)-(e-s)*(o-a)&&0<=(e-s)*(i-a)-(n-s)*(t-a)&&0<=(n-s)*(o-a)-(r-s)*(i-a)}function Ht(e,t,n){return(t.y-e.y)*(n.x-t.x)-(t.x-e.x)*(n.y-t.y)}function Zi(e,t){return e.x===t.x&&e.y===t.y}function Cl(e,t,n,i){return Zi(e,n)&&Zi(t,i)||Zi(e,i)&&Zi(n,t)?!0:0<Ht(e,t,n)!=0<Ht(e,t,i)&&0<Ht(n,i,e)!=0<Ht(n,i,t)}function Ho(e,t){return 0>Ht(e.prev,e,e.next)?0<=Ht(e,t,e.next)&&0<=Ht(e,e.prev,t):0>Ht(e,t,e.prev)||0>Ht(e,e.next,t)}function Ll(e,t){var n=new Ac(e.i,e.x,e.y),i=new Ac(t.i,t.x,t.y),r=e.next,o=t.prev;return e.next=t,t.prev=e,n.next=r,r.prev=n,i.next=n,n.prev=i,o.next=i,i.prev=o,i}function Pl(e,t,n,i){return e=new Ac(e,t,n),i?(e.next=i.next,e.prev=i,i.next.prev=e,i.next=e):(e.prev=e,e.next=e),e}function Vo(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function Ac(e,t,n){this.i=e,this.x=t,this.y=n,this.nextZ=this.prevZ=this.z=this.next=this.prev=null,this.steiner=!1}function bl(e){var t=e.length;2<t&&e[t-1].equals(e[0])&&e.pop()}function Rl(e,t){for(var n=0;n<t.length;n++)e.push(t[n].x),e.push(t[n].y)}function Ki(e,t){he.call(this),this.type="ExtrudeGeometry",this.parameters={shapes:e,options:t},this.fromBufferGeometry(new zn(e,t)),this.mergeVertices()}function zn(e,t){function n(c){function u(me,Ie,Mt){return Ie||console.error("THREE.ExtrudeGeometry: vec does not exist"),Ie.clone().multiplyScalar(Mt).add(me)}function h(me,Ie,Mt){var He=me.x-Ie.x,Ke=me.y-Ie.y,$=Mt.x-me.x,Oe=Mt.y-me.y,pt=He*He+Ke*Ke;if(Math.abs(He*Oe-Ke*$)>Number.EPSILON){var ke=Math.sqrt(pt),Kt=Math.sqrt($*$+Oe*Oe);if(pt=Ie.x-Ke/ke,Ie=Ie.y+He/ke,Oe=((Mt.x-Oe/Kt-pt)*Oe-(Mt.y+$/Kt-Ie)*$)/(He*Oe-Ke*$),$=pt+He*Oe-me.x,He=Ie+Ke*Oe-me.y,Ke=$*$+He*He,2>=Ke)return new G($,He);Ke=Math.sqrt(Ke/2)}else me=!1,He>Number.EPSILON?$>Number.EPSILON&&(me=!0):He<-Number.EPSILON?$<-Number.EPSILON&&(me=!0):Math.sign(Ke)===Math.sign(Oe)&&(me=!0),me?($=-Ke,Ke=Math.sqrt(pt)):($=He,He=Ke,Ke=Math.sqrt(pt/2));return new G($/Ke,He/Ke)}function p(me,Ie){for(oe=me.length;0<=--oe;){var Mt=oe,He=oe-1;0>He&&(He=me.length-1);var Ke,$=F+2*fe;for(Ke=0;Ke<$;Ke++){var Oe=Be*Ke,pt=Be*(Ke+1),ke=Ie+He+Oe,Kt=Ie+He+pt;pt=Ie+Mt+pt,y(Ie+Mt+Oe),y(ke),y(pt),y(ke),y(Kt),y(pt),Oe=r.length/3,Oe=j.generateSideWallUV(i,r,Oe-6,Oe-3,Oe-2,Oe-1),M(Oe[0]),M(Oe[1]),M(Oe[3]),M(Oe[1]),M(Oe[2]),M(Oe[3])}}}function v(me,Ie,Mt){L.push(me),L.push(Ie),L.push(Mt)}function x(me,Ie,Mt){y(me),y(Ie),y(Mt),me=r.length/3,me=j.generateTopUV(i,r,me-3,me-2,me-1),M(me[0]),M(me[1]),M(me[2])}function y(me){r.push(L[3*me]),r.push(L[3*me+1]),r.push(L[3*me+2])}function M(me){o.push(me.x),o.push(me.y)}var L=[],O=t.curveSegments!==void 0?t.curveSegments:12,F=t.steps!==void 0?t.steps:1,z=t.depth!==void 0?t.depth:100,V=t.bevelEnabled!==void 0?t.bevelEnabled:!0,B=t.bevelThickness!==void 0?t.bevelThickness:6,Y=t.bevelSize!==void 0?t.bevelSize:B-2,Z=t.bevelOffset!==void 0?t.bevelOffset:0,fe=t.bevelSegments!==void 0?t.bevelSegments:3,X=t.extrudePath,j=t.UVGenerator!==void 0?t.UVGenerator:Eh;t.amount!==void 0&&(console.warn("THREE.ExtrudeBufferGeometry: amount has been renamed to depth."),z=t.amount);var J=!1;if(X){var te=X.getSpacedPoints(F);J=!0,V=!1;var ze=X.computeFrenetFrames(F,!1),We=new E,_=new E,b=new E}V||(Z=Y=B=fe=0);var H;O=c.extractPoints(O),c=O.shape;var K=O.holes;if(!mi.isClockWise(c)){c=c.reverse();var se=0;for(H=K.length;se<H;se++){var ae=K[se];mi.isClockWise(ae)&&(K[se]=ae.reverse())}}var et=mi.triangulateShape(c,K),Le=c;for(se=0,H=K.length;se<H;se++)ae=K[se],c=c.concat(ae);var Te,Be=c.length,qe,mt=et.length;O=[];var oe=0,U=Le.length,ue=U-1;for(Te=oe+1;oe<U;oe++,ue++,Te++)ue===U&&(ue=0),Te===U&&(Te=0),O[oe]=h(Le[oe],Le[ue],Le[Te]);X=[];var Ge=O.concat();for(se=0,H=K.length;se<H;se++){ae=K[se];var st=[];for(oe=0,U=ae.length,ue=U-1,Te=oe+1;oe<U;oe++,ue++,Te++)ue===U&&(ue=0),Te===U&&(Te=0),st[oe]=h(ae[oe],ae[ue],ae[Te]);X.push(st),Ge=Ge.concat(st)}for(ue=0;ue<fe;ue++){U=ue/fe;var De=B*Math.cos(U*Math.PI/2);for(Te=Y*Math.sin(U*Math.PI/2)+Z,oe=0,U=Le.length;oe<U;oe++){var Ze=u(Le[oe],O[oe],Te);v(Ze.x,Ze.y,-De)}for(se=0,H=K.length;se<H;se++)for(ae=K[se],st=X[se],oe=0,U=ae.length;oe<U;oe++)Ze=u(ae[oe],st[oe],Te),v(Ze.x,Ze.y,-De)}for(Te=Y+Z,oe=0;oe<Be;oe++)Ze=V?u(c[oe],Ge[oe],Te):c[oe],J?(_.copy(ze.normals[0]).multiplyScalar(Ze.x),We.copy(ze.binormals[0]).multiplyScalar(Ze.y),b.copy(te[0]).add(_).add(We),v(b.x,b.y,b.z)):v(Ze.x,Ze.y,0);for(U=1;U<=F;U++)for(oe=0;oe<Be;oe++)Ze=V?u(c[oe],Ge[oe],Te):c[oe],J?(_.copy(ze.normals[U]).multiplyScalar(Ze.x),We.copy(ze.binormals[U]).multiplyScalar(Ze.y),b.copy(te[U]).add(_).add(We),v(b.x,b.y,b.z)):v(Ze.x,Ze.y,z/F*U);for(ue=fe-1;0<=ue;ue--){for(U=ue/fe,De=B*Math.cos(U*Math.PI/2),Te=Y*Math.sin(U*Math.PI/2)+Z,oe=0,U=Le.length;oe<U;oe++)Ze=u(Le[oe],O[oe],Te),v(Ze.x,Ze.y,z+De);for(se=0,H=K.length;se<H;se++)for(ae=K[se],st=X[se],oe=0,U=ae.length;oe<U;oe++)Ze=u(ae[oe],st[oe],Te),J?v(Ze.x,Ze.y+te[F-1].y,te[F-1].x+De):v(Ze.x,Ze.y,z+De)}(function(){var me=r.length/3;if(V){var Ie=0*Be;for(oe=0;oe<mt;oe++)qe=et[oe],x(qe[2]+Ie,qe[1]+Ie,qe[0]+Ie);for(Ie=Be*(F+2*fe),oe=0;oe<mt;oe++)qe=et[oe],x(qe[0]+Ie,qe[1]+Ie,qe[2]+Ie)}else{for(oe=0;oe<mt;oe++)qe=et[oe],x(qe[2],qe[1],qe[0]);for(oe=0;oe<mt;oe++)qe=et[oe],x(qe[0]+Be*F,qe[1]+Be*F,qe[2]+Be*F)}i.addGroup(me,r.length/3-me,0)})(),function(){var me=r.length/3,Ie=0;for(p(Le,Ie),Ie+=Le.length,se=0,H=K.length;se<H;se++)ae=K[se],p(ae,Ie),Ie+=ae.length;i.addGroup(me,r.length/3-me,1)}()}re.call(this),this.type="ExtrudeBufferGeometry",this.parameters={shapes:e,options:t},e=Array.isArray(e)?e:[e];for(var i=this,r=[],o=[],s=0,a=e.length;s<a;s++)n(e[s]);this.addAttribute("position",new le(r,3)),this.addAttribute("uv",new le(o,2)),this.computeVertexNormals()}function Dl(e,t,n){if(n.shapes=[],Array.isArray(e))for(var i=0,r=e.length;i<r;i++)n.shapes.push(e[i].uuid);else n.shapes.push(e.uuid);return t.extrudePath!==void 0&&(n.options.extrudePath=t.extrudePath.toJSON()),n}function jo(e,t){he.call(this),this.type="TextGeometry",this.parameters={text:e,parameters:t},this.fromBufferGeometry(new Nr(e,t)),this.mergeVertices()}function Nr(e,t){t=t||{};var n=t.font;if(!n||!n.isFont)return console.error("THREE.TextGeometry: font parameter is not an instance of THREE.Font."),new he;e=n.generateShapes(e,t.size),t.depth=t.height!==void 0?t.height:50,t.bevelThickness===void 0&&(t.bevelThickness=10),t.bevelSize===void 0&&(t.bevelSize=8),t.bevelEnabled===void 0&&(t.bevelEnabled=!1),zn.call(this,e,t),this.type="TextBufferGeometry"}function Wo(e,t,n,i,r,o,s){he.call(this),this.type="SphereGeometry",this.parameters={radius:e,widthSegments:t,heightSegments:n,phiStart:i,phiLength:r,thetaStart:o,thetaLength:s},this.fromBufferGeometry(new Pi(e,t,n,i,r,o,s)),this.mergeVertices()}function Pi(e,t,n,i,r,o,s){re.call(this),this.type="SphereBufferGeometry",this.parameters={radius:e,widthSegments:t,heightSegments:n,phiStart:i,phiLength:r,thetaStart:o,thetaLength:s},e=e||1,t=Math.max(3,Math.floor(t)||8),n=Math.max(2,Math.floor(n)||6),i=i!==void 0?i:0,r=r!==void 0?r:2*Math.PI,o=o!==void 0?o:0,s=s!==void 0?s:Math.PI;var a=Math.min(o+s,Math.PI),c,u,h=0,p=[],v=new E,x=new E,y=[],M=[],L=[],O=[];for(u=0;u<=n;u++){var F=[],z=u/n,V=0;for(u==0&&o==0?V=.5/t:u==n&&a==Math.PI&&(V=-.5/t),c=0;c<=t;c++){var B=c/t;v.x=-e*Math.cos(i+B*r)*Math.sin(o+z*s),v.y=e*Math.cos(o+z*s),v.z=e*Math.sin(i+B*r)*Math.sin(o+z*s),M.push(v.x,v.y,v.z),x.copy(v).normalize(),L.push(x.x,x.y,x.z),O.push(B+V,1-z),F.push(h++)}p.push(F)}for(u=0;u<n;u++)for(c=0;c<t;c++)e=p[u][c+1],i=p[u][c],r=p[u+1][c],s=p[u+1][c+1],(u!==0||0<o)&&y.push(e,i,s),(u!==n-1||a<Math.PI)&&y.push(i,r,s);this.setIndex(y),this.addAttribute("position",new le(M,3)),this.addAttribute("normal",new le(L,3)),this.addAttribute("uv",new le(O,2))}function ko(e,t,n,i,r,o){he.call(this),this.type="RingGeometry",this.parameters={innerRadius:e,outerRadius:t,thetaSegments:n,phiSegments:i,thetaStart:r,thetaLength:o},this.fromBufferGeometry(new Ur(e,t,n,i,r,o)),this.mergeVertices()}function Ur(e,t,n,i,r,o){re.call(this),this.type="RingBufferGeometry",this.parameters={innerRadius:e,outerRadius:t,thetaSegments:n,phiSegments:i,thetaStart:r,thetaLength:o},e=e||.5,t=t||1,r=r!==void 0?r:0,o=o!==void 0?o:2*Math.PI,n=n!==void 0?Math.max(3,n):8,i=i!==void 0?Math.max(1,i):1;var s=[],a=[],c=[],u=[],h=e,p=(t-e)/i,v=new E,x=new G,y,M;for(y=0;y<=i;y++){for(M=0;M<=n;M++)e=r+M/n*o,v.x=h*Math.cos(e),v.y=h*Math.sin(e),a.push(v.x,v.y,v.z),c.push(0,0,1),x.x=(v.x/t+1)/2,x.y=(v.y/t+1)/2,u.push(x.x,x.y);h+=p}for(y=0;y<i;y++)for(t=y*(n+1),M=0;M<n;M++)e=M+t,r=e+n+1,o=e+n+2,h=e+1,s.push(e,r,h),s.push(r,o,h);this.setIndex(s),this.addAttribute("position",new le(a,3)),this.addAttribute("normal",new le(c,3)),this.addAttribute("uv",new le(u,2))}function Yo(e,t,n,i){he.call(this),this.type="LatheGeometry",this.parameters={points:e,segments:t,phiStart:n,phiLength:i},this.fromBufferGeometry(new zr(e,t,n,i)),this.mergeVertices()}function zr(e,t,n,i){re.call(this),this.type="LatheBufferGeometry",this.parameters={points:e,segments:t,phiStart:n,phiLength:i},t=Math.floor(t)||12,n=n||0,i=i||2*Math.PI,i=Xe.clamp(i,0,2*Math.PI);var r=[],o=[],s=[],a=1/t,c=new E,u=new G,h;for(h=0;h<=t;h++){var p=n+h*a*i,v=Math.sin(p),x=Math.cos(p);for(p=0;p<=e.length-1;p++)c.x=e[p].x*v,c.y=e[p].y,c.z=e[p].x*x,o.push(c.x,c.y,c.z),u.x=h/t,u.y=p/(e.length-1),s.push(u.x,u.y)}for(h=0;h<t;h++)for(p=0;p<e.length-1;p++)n=p+h*e.length,a=n+e.length,c=n+e.length+1,u=n+1,r.push(n,a,u),r.push(a,c,u);if(this.setIndex(r),this.addAttribute("position",new le(o,3)),this.addAttribute("uv",new le(s,2)),this.computeVertexNormals(),i===2*Math.PI)for(i=this.attributes.normal.array,r=new E,o=new E,s=new E,n=t*e.length*3,p=h=0;h<e.length;h++,p+=3)r.x=i[p+0],r.y=i[p+1],r.z=i[p+2],o.x=i[n+p+0],o.y=i[n+p+1],o.z=i[n+p+2],s.addVectors(r,o).normalize(),i[p+0]=i[n+p+0]=s.x,i[p+1]=i[n+p+1]=s.y,i[p+2]=i[n+p+2]=s.z}function Ji(e,t){he.call(this),this.type="ShapeGeometry",typeof t=="object"&&(console.warn("THREE.ShapeGeometry: Options parameter has been removed."),t=t.curveSegments),this.parameters={shapes:e,curveSegments:t},this.fromBufferGeometry(new $i(e,t)),this.mergeVertices()}function $i(e,t){function n(h){var p,v=r.length/3;h=h.extractPoints(t);var x=h.shape,y=h.holes;for(mi.isClockWise(x)===!1&&(x=x.reverse()),h=0,p=y.length;h<p;h++){var M=y[h];mi.isClockWise(M)===!0&&(y[h]=M.reverse())}var L=mi.triangulateShape(x,y);for(h=0,p=y.length;h<p;h++)M=y[h],x=x.concat(M);for(h=0,p=x.length;h<p;h++)M=x[h],r.push(M.x,M.y,0),o.push(0,0,1),s.push(M.x,M.y);for(h=0,p=L.length;h<p;h++)x=L[h],i.push(x[0]+v,x[1]+v,x[2]+v),c+=3}re.call(this),this.type="ShapeBufferGeometry",this.parameters={shapes:e,curveSegments:t},t=t||12;var i=[],r=[],o=[],s=[],a=0,c=0;if(Array.isArray(e)===!1)n(e);else for(var u=0;u<e.length;u++)n(e[u]),this.addGroup(a,c,u),a+=c,c=0;this.setIndex(i),this.addAttribute("position",new le(r,3)),this.addAttribute("normal",new le(o,3)),this.addAttribute("uv",new le(s,2))}function Bl(e,t){if(t.shapes=[],Array.isArray(e))for(var n=0,i=e.length;n<i;n++)t.shapes.push(e[n].uuid);else t.shapes.push(e.uuid);return t}function Gr(e,t){re.call(this),this.type="EdgesGeometry",this.parameters={thresholdAngle:t};var n=[];t=Math.cos(Xe.DEG2RAD*(t!==void 0?t:1));var i=[0,0],r={},o=["a","b","c"];if(e.isBufferGeometry){var s=new he;s.fromBufferGeometry(e)}else s=e.clone();s.mergeVertices(),s.computeFaceNormals(),e=s.vertices,s=s.faces;for(var a=0,c=s.length;a<c;a++)for(var u=s[a],h=0;3>h;h++){var p=u[o[h]],v=u[o[(h+1)%3]];i[0]=Math.min(p,v),i[1]=Math.max(p,v),p=i[0]+","+i[1],r[p]===void 0?r[p]={index1:i[0],index2:i[1],face1:a,face2:void 0}:r[p].face2=a}for(p in r)i=r[p],(i.face2===void 0||s[i.face1].normal.dot(s[i.face2].normal)<=t)&&(o=e[i.index1],n.push(o.x,o.y,o.z),o=e[i.index2],n.push(o.x,o.y,o.z));this.addAttribute("position",new le(n,3))}function er(e,t,n,i,r,o,s,a){he.call(this),this.type="CylinderGeometry",this.parameters={radiusTop:e,radiusBottom:t,height:n,radialSegments:i,heightSegments:r,openEnded:o,thetaStart:s,thetaLength:a},this.fromBufferGeometry(new si(e,t,n,i,r,o,s,a)),this.mergeVertices()}function si(e,t,n,i,r,o,s,a){function c(F){var z,V=new G,B=new E,Y=0,Z=F===!0?e:t,fe=F===!0?1:-1,X=y;for(z=1;z<=i;z++)p.push(0,L*fe,0),v.push(0,fe,0),x.push(.5,.5),y++;var j=y;for(z=0;z<=i;z++){var J=z/i*a+s,te=Math.cos(J);J=Math.sin(J),B.x=Z*J,B.y=L*fe,B.z=Z*te,p.push(B.x,B.y,B.z),v.push(0,fe,0),V.x=.5*te+.5,V.y=.5*J*fe+.5,x.push(V.x,V.y),y++}for(z=0;z<i;z++)V=X+z,B=j+z,F===!0?h.push(B,B+1,V):h.push(B+1,B,V),Y+=3;u.addGroup(O,Y,F===!0?1:2),O+=Y}re.call(this),this.type="CylinderBufferGeometry",this.parameters={radiusTop:e,radiusBottom:t,height:n,radialSegments:i,heightSegments:r,openEnded:o,thetaStart:s,thetaLength:a};var u=this;e=e!==void 0?e:1,t=t!==void 0?t:1,n=n||1,i=Math.floor(i)||8,r=Math.floor(r)||1,o=o!==void 0?o:!1,s=s!==void 0?s:0,a=a!==void 0?a:2*Math.PI;var h=[],p=[],v=[],x=[],y=0,M=[],L=n/2,O=0;(function(){var F,z,V=new E,B=new E,Y=0,Z=(t-e)/n;for(z=0;z<=r;z++){var fe=[],X=z/r,j=X*(t-e)+e;for(F=0;F<=i;F++){var J=F/i,te=J*a+s,ze=Math.sin(te);te=Math.cos(te),B.x=j*ze,B.y=-X*n+L,B.z=j*te,p.push(B.x,B.y,B.z),V.set(ze,Z,te).normalize(),v.push(V.x,V.y,V.z),x.push(J,1-X),fe.push(y++)}M.push(fe)}for(F=0;F<i;F++)for(z=0;z<r;z++)V=M[z+1][F],B=M[z+1][F+1],Z=M[z][F+1],h.push(M[z][F],V,Z),h.push(V,B,Z),Y+=6;u.addGroup(O,Y,0),O+=Y})(),o===!1&&(0<e&&c(!0),0<t&&c(!1)),this.setIndex(h),this.addAttribute("position",new le(p,3)),this.addAttribute("normal",new le(v,3)),this.addAttribute("uv",new le(x,2))}function Xo(e,t,n,i,r,o,s){er.call(this,0,e,t,n,i,r,o,s),this.type="ConeGeometry",this.parameters={radius:e,height:t,radialSegments:n,heightSegments:i,openEnded:r,thetaStart:o,thetaLength:s}}function Qo(e,t,n,i,r,o,s){si.call(this,0,e,t,n,i,r,o,s),this.type="ConeBufferGeometry",this.parameters={radius:e,height:t,radialSegments:n,heightSegments:i,openEnded:r,thetaStart:o,thetaLength:s}}function qo(e,t,n,i){he.call(this),this.type="CircleGeometry",this.parameters={radius:e,segments:t,thetaStart:n,thetaLength:i},this.fromBufferGeometry(new Hr(e,t,n,i)),this.mergeVertices()}function Hr(e,t,n,i){re.call(this),this.type="CircleBufferGeometry",this.parameters={radius:e,segments:t,thetaStart:n,thetaLength:i},e=e||1,t=t!==void 0?Math.max(3,t):8,n=n!==void 0?n:0,i=i!==void 0?i:2*Math.PI;var r=[],o=[],s=[],a=[],c,u=new E,h=new G;o.push(0,0,0),s.push(0,0,1),a.push(.5,.5);var p=0;for(c=3;p<=t;p++,c+=3){var v=n+p/t*i;u.x=e*Math.cos(v),u.y=e*Math.sin(v),o.push(u.x,u.y,u.z),s.push(0,0,1),h.x=(o[c]/e+1)/2,h.y=(o[c+1]/e+1)/2,a.push(h.x,h.y)}for(c=1;c<=t;c++)r.push(c,c+1,0);this.setIndex(r),this.addAttribute("position",new le(o,3)),this.addAttribute("normal",new le(s,3)),this.addAttribute("uv",new le(a,2))}function tr(e){ie.call(this),this.type="ShadowMaterial",this.color=new ve(0),this.transparent=!0,this.setValues(e)}function Vr(e){Rt.call(this,e),this.type="RawShaderMaterial"}function Gn(e){ie.call(this),this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new ve(16777215),this.metalness=this.roughness=.5,this.lightMap=this.map=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new ve(0),this.emissiveIntensity=1,this.bumpMap=this.emissiveMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new G(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.envMap=this.alphaMap=this.metalnessMap=this.roughnessMap=null,this.envMapIntensity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinejoin=this.wireframeLinecap="round",this.morphNormals=this.morphTargets=this.skinning=!1,this.setValues(e)}function nr(e){Gn.call(this),this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.reflectivity=.5,this.clearcoatRoughness=this.clearcoat=0,this.sheen=null,this.clearcoatNormalScale=new G(1,1),this.clearcoatNormalMap=null,this.transparency=0,this.setValues(e)}function yn(e){ie.call(this),this.type="MeshPhongMaterial",this.color=new ve(16777215),this.specular=new ve(1118481),this.shininess=30,this.lightMap=this.map=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new ve(0),this.emissiveIntensity=1,this.bumpMap=this.emissiveMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new G(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.envMap=this.alphaMap=this.specularMap=null,this.combine=0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinejoin=this.wireframeLinecap="round",this.morphNormals=this.morphTargets=this.skinning=!1,this.setValues(e)}function ir(e){yn.call(this),this.defines={TOON:""},this.type="MeshToonMaterial",this.gradientMap=null,this.setValues(e)}function rr(e){ie.call(this),this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new G(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.morphNormals=this.morphTargets=this.skinning=this.fog=!1,this.setValues(e)}function or(e){ie.call(this),this.type="MeshLambertMaterial",this.color=new ve(16777215),this.lightMap=this.map=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new ve(0),this.emissiveIntensity=1,this.envMap=this.alphaMap=this.specularMap=this.emissiveMap=null,this.combine=0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinejoin=this.wireframeLinecap="round",this.morphNormals=this.morphTargets=this.skinning=!1,this.setValues(e)}function sr(e){ie.call(this),this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new ve(16777215),this.bumpMap=this.map=this.matcap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new G(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.morphNormals=this.morphTargets=this.skinning=!1,this.setValues(e)}function ar(e){$e.call(this),this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(e)}function an(e,t,n,i){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=i!==void 0?i:new t.constructor(n),this.sampleValues=t,this.valueSize=n}function Xs(e,t,n,i){an.call(this,e,t,n,i),this._offsetNext=this._weightNext=this._offsetPrev=this._weightPrev=-0}function Zo(e,t,n,i){an.call(this,e,t,n,i)}function Qs(e,t,n,i){an.call(this,e,t,n,i)}function Vt(e,t,n,i){if(e===void 0)throw Error("THREE.KeyframeTrack: track name is undefined");if(t===void 0||t.length===0)throw Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=Nt.convertArray(t,this.TimeBufferType),this.values=Nt.convertArray(n,this.ValueBufferType),this.setInterpolation(i||this.DefaultInterpolation)}function qs(e,t,n){Vt.call(this,e,t,n)}function Zs(e,t,n,i){Vt.call(this,e,t,n,i)}function jr(e,t,n,i){Vt.call(this,e,t,n,i)}function Ks(e,t,n,i){an.call(this,e,t,n,i)}function Ko(e,t,n,i){Vt.call(this,e,t,n,i)}function Js(e,t,n,i){Vt.call(this,e,t,n,i)}function Wr(e,t,n,i){Vt.call(this,e,t,n,i)}function fn(e,t,n){this.name=e,this.tracks=n,this.duration=t!==void 0?t:-1,this.uuid=Xe.generateUUID(),0>this.duration&&this.resetDuration()}function $u(e){switch(e.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return jr;case"vector":case"vector2":case"vector3":case"vector4":return Wr;case"color":return Zs;case"quaternion":return Ko;case"bool":case"boolean":return qs;case"string":return Js}throw Error("THREE.KeyframeTrack: Unsupported typeName: "+e)}function eh(e){if(e.type===void 0)throw Error("THREE.KeyframeTrack: track type undefined, can not parse");var t=$u(e.type);if(e.times===void 0){var n=[],i=[];Nt.flattenJSON(e.keys,n,i,"value"),e.times=n,e.values=i}return t.parse!==void 0?t.parse(e):new t(e.name,e.times,e.values,e.interpolation)}function Mc(e,t,n){var i=this,r=!1,o=0,s=0,a=void 0,c=[];this.onStart=void 0,this.onLoad=e,this.onProgress=t,this.onError=n,this.itemStart=function(u){s++,r===!1&&i.onStart!==void 0&&i.onStart(u,o,s),r=!0},this.itemEnd=function(u){o++,i.onProgress!==void 0&&i.onProgress(u,o,s),o===s&&(r=!1,i.onLoad!==void 0)&&i.onLoad()},this.itemError=function(u){i.onError!==void 0&&i.onError(u)},this.resolveURL=function(u){return a?a(u):u},this.setURLModifier=function(u){return a=u,this},this.addHandler=function(u,h){return c.push(u,h),this},this.removeHandler=function(u){return u=c.indexOf(u),u!==-1&&c.splice(u,2),this},this.getHandler=function(u){for(var h=0,p=c.length;h<p;h+=2){var v=c[h+1];if(c[h].test(u))return v}return null}}function ut(e){this.manager=e!==void 0?e:Eu,this.crossOrigin="anonymous",this.resourcePath=this.path=""}function mn(e){ut.call(this,e)}function Ec(e){ut.call(this,e)}function Sc(e){ut.call(this,e)}function $s(e){ut.call(this,e)}function kr(e){ut.call(this,e)}function ea(e){ut.call(this,e)}function ta(e){ut.call(this,e)}function Pe(){this.type="Curve",this.arcLengthDivisions=200}function cn(e,t,n,i,r,o,s,a){Pe.call(this),this.type="EllipseCurve",this.aX=e||0,this.aY=t||0,this.xRadius=n||1,this.yRadius=i||1,this.aStartAngle=r||0,this.aEndAngle=o||2*Math.PI,this.aClockwise=s||!1,this.aRotation=a||0}function Yr(e,t,n,i,r,o){cn.call(this,e,t,n,n,i,r,o),this.type="ArcCurve"}function Tc(){var e=0,t=0,n=0,i=0;return{initCatmullRom:function(r,o,s,a,c){r=c*(s-r),a=c*(a-o),e=o,t=r,n=-3*o+3*s-2*r-a,i=2*o-2*s+r+a},initNonuniformCatmullRom:function(r,o,s,a,c,u,h){r=((o-r)/c-(s-r)/(c+u)+(s-o)/u)*u,a=((s-o)/u-(a-o)/(u+h)+(a-s)/h)*u,e=o,t=r,n=-3*o+3*s-2*r-a,i=2*o-2*s+r+a},calc:function(r){var o=r*r;return e+t*r+n*o+i*o*r}}}function Yt(e,t,n,i){Pe.call(this),this.type="CatmullRomCurve3",this.points=e||[],this.closed=t||!1,this.curveType=n||"centripetal",this.tension=i||.5}function Il(e,t,n,i,r){t=.5*(i-t),r=.5*(r-n);var o=e*e;return(2*n-2*i+t+r)*e*o+(-3*n+3*i-2*t-r)*o+t*e+n}function Jo(e,t,n,i){var r=1-e;return r*r*t+2*(1-e)*e*n+e*e*i}function $o(e,t,n,i,r){var o=1-e,s=1-e;return o*o*o*t+3*s*s*e*n+3*(1-e)*e*e*i+e*e*e*r}function xn(e,t,n,i){Pe.call(this),this.type="CubicBezierCurve",this.v0=e||new G,this.v1=t||new G,this.v2=n||new G,this.v3=i||new G}function Hn(e,t,n,i){Pe.call(this),this.type="CubicBezierCurve3",this.v0=e||new E,this.v1=t||new E,this.v2=n||new E,this.v3=i||new E}function on(e,t){Pe.call(this),this.type="LineCurve",this.v1=e||new G,this.v2=t||new G}function wn(e,t){Pe.call(this),this.type="LineCurve3",this.v1=e||new E,this.v2=t||new E}function An(e,t,n){Pe.call(this),this.type="QuadraticBezierCurve",this.v0=e||new G,this.v1=t||new G,this.v2=n||new G}function Vn(e,t,n){Pe.call(this),this.type="QuadraticBezierCurve3",this.v0=e||new E,this.v1=t||new E,this.v2=n||new E}function Mn(e){Pe.call(this),this.type="SplineCurve",this.points=e||[]}function ai(){Pe.call(this),this.type="CurvePath",this.curves=[],this.autoClose=!1}function En(e){ai.call(this),this.type="Path",this.currentPoint=new G,e&&this.setFromPoints(e)}function bi(e){En.call(this,e),this.uuid=Xe.generateUUID(),this.type="Shape",this.holes=[]}function ft(e,t){W.call(this),this.type="Light",this.color=new ve(e),this.intensity=t!==void 0?t:1,this.receiveShadow=void 0}function na(e,t,n){ft.call(this,e,n),this.type="HemisphereLight",this.castShadow=void 0,this.position.copy(W.DefaultUp),this.updateMatrix(),this.groundColor=new ve(t)}function jn(e){this.camera=e,this.bias=0,this.radius=1,this.mapSize=new G(512,512),this.mapPass=this.map=null,this.matrix=new Se,this._frustum=new vn,this._frameExtents=new G(1,1),this._viewportCount=1,this._viewports=[new _e(0,0,1,1)]}function ia(){jn.call(this,new Je(50,1,.5,500))}function ra(e,t,n,i,r,o){ft.call(this,e,t),this.type="SpotLight",this.position.copy(W.DefaultUp),this.updateMatrix(),this.target=new W,Object.defineProperty(this,"power",{get:function(){return this.intensity*Math.PI},set:function(s){this.intensity=s/Math.PI}}),this.distance=n!==void 0?n:0,this.angle=i!==void 0?i:Math.PI/3,this.penumbra=r!==void 0?r:0,this.decay=o!==void 0?o:1,this.shadow=new ia}function _c(){jn.call(this,new Je(90,1,.5,500)),this._frameExtents=new G(4,2),this._viewportCount=6,this._viewports=[new _e(2,1,1,1),new _e(0,1,1,1),new _e(3,1,1,1),new _e(1,1,1,1),new _e(3,0,1,1),new _e(1,0,1,1)],this._cubeDirections=[new E(1,0,0),new E(-1,0,0),new E(0,0,1),new E(0,0,-1),new E(0,1,0),new E(0,-1,0)],this._cubeUps=[new E(0,1,0),new E(0,1,0),new E(0,1,0),new E(0,1,0),new E(0,0,1),new E(0,0,-1)]}function oa(e,t,n,i){ft.call(this,e,t),this.type="PointLight",Object.defineProperty(this,"power",{get:function(){return 4*this.intensity*Math.PI},set:function(r){this.intensity=r/(4*Math.PI)}}),this.distance=n!==void 0?n:0,this.decay=i!==void 0?i:1,this.shadow=new _c}function es(e,t,n,i,r,o){$t.call(this),this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e!==void 0?e:-1,this.right=t!==void 0?t:1,this.top=n!==void 0?n:1,this.bottom=i!==void 0?i:-1,this.near=r!==void 0?r:.1,this.far=o!==void 0?o:2e3,this.updateProjectionMatrix()}function sa(){jn.call(this,new es(-5,5,5,-5,.5,500))}function aa(e,t){ft.call(this,e,t),this.type="DirectionalLight",this.position.copy(W.DefaultUp),this.updateMatrix(),this.target=new W,this.shadow=new sa}function ca(e,t){ft.call(this,e,t),this.type="AmbientLight",this.castShadow=void 0}function la(e,t,n,i){ft.call(this,e,t),this.type="RectAreaLight",this.width=n!==void 0?n:10,this.height=i!==void 0?i:10}function ua(e){ut.call(this,e),this.textures={}}function ha(){re.call(this),this.type="InstancedBufferGeometry",this.maxInstancedCount=void 0}function da(e,t,n,i){typeof n=="number"&&(i=n,n=!1,console.error("THREE.InstancedBufferAttribute: The constructor now expects normalized as the third argument.")),Ce.call(this,e,t,n),this.meshPerAttribute=i||1}function pa(e){ut.call(this,e)}function fa(e){ut.call(this,e)}function Cc(e){typeof createImageBitmap>"u"&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),typeof fetch>"u"&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),ut.call(this,e),this.options=void 0}function Lc(){this.type="ShapePath",this.color=new ve,this.subPaths=[],this.currentPath=null}function Pc(e){this.type="Font",this.data=e}function bc(e){ut.call(this,e)}function ma(e){ut.call(this,e)}function va(){this.coefficients=[];for(var e=0;9>e;e++)this.coefficients.push(new E)}function Sn(e,t){ft.call(this,void 0,t),this.sh=e!==void 0?e:new va}function Rc(e,t,n){Sn.call(this,void 0,n),e=new ve().set(e),n=new ve().set(t),t=new E(e.r,e.g,e.b),e=new E(n.r,n.g,n.b),n=Math.sqrt(Math.PI);var i=n*Math.sqrt(.75);this.sh.coefficients[0].copy(t).add(e).multiplyScalar(n),this.sh.coefficients[1].copy(t).sub(e).multiplyScalar(i)}function Dc(e,t){Sn.call(this,void 0,t),e=new ve().set(e),this.sh.coefficients[0].set(e.r,e.g,e.b).multiplyScalar(2*Math.sqrt(Math.PI))}function Ol(){this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new Je,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new Je,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1,this._cache={focus:null,fov:null,aspect:null,near:null,far:null,zoom:null,eyeSep:null}}function Bc(e){this.autoStart=e!==void 0?e:!0,this.elapsedTime=this.oldTime=this.startTime=0,this.running=!1}function Ic(){W.call(this),this.type="AudioListener",this.context=gl.getContext(),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.filter=null,this.timeDelta=0,this._clock=new Bc}function Xr(e){W.call(this),this.type="Audio",this.listener=e,this.context=e.context,this.gain=this.context.createGain(),this.gain.connect(e.getInput()),this.autoplay=!1,this.buffer=null,this.detune=0,this.loop=!1,this.offset=this.startTime=0,this.duration=void 0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.sourceType="empty",this.filters=[]}function Oc(e){Xr.call(this,e),this.panner=this.context.createPanner(),this.panner.panningModel="HRTF",this.panner.connect(this.gain)}function Fc(e,t){this.analyser=e.context.createAnalyser(),this.analyser.fftSize=t!==void 0?t:2048,this.data=new Uint8Array(this.analyser.frequencyBinCount),e.getOutput().connect(this.analyser)}function Nc(e,t,n){switch(this.binding=e,this.valueSize=n,e=Float64Array,t){case"quaternion":t=this._slerp;break;case"string":case"bool":e=Array,t=this._select;break;default:t=this._lerp}this.buffer=new e(4*n),this._mixBufferRegion=t,this.referenceCount=this.useCount=this.cumulativeWeight=0}function Fl(e,t,n){n=n||Xt.parseTrackName(t),this._targetGroup=e,this._bindings=e.subscribe_(t,n)}function Xt(e,t,n){this.path=t,this.parsedPath=n||Xt.parseTrackName(t),this.node=Xt.findNode(e,this.parsedPath.nodeName)||e,this.rootNode=e}function Nl(){this.uuid=Xe.generateUUID(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;var e={};this._indicesByUUID=e;for(var t=0,n=arguments.length;t!==n;++t)e[arguments[t].uuid]=t;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};var i=this;this.stats={objects:{get total(){return i._objects.length},get inUse(){return this.total-i.nCachedObjects_}},get bindingsPerObject(){return i._bindings.length}}}function Ul(e,t,n){this._mixer=e,this._clip=t,this._localRoot=n||null,e=t.tracks,t=e.length,n=Array(t);for(var i={endingStart:2400,endingEnd:2400},r=0;r!==t;++r){var o=e[r].createInterpolant(null);n[r]=o,o.settings=i}this._interpolantSettings=i,this._interpolants=n,this._propertyBindings=Array(t),this._weightInterpolant=this._timeScaleInterpolant=this._byClipCacheIndex=this._cacheIndex=null,this.loop=2201,this._loopCount=-1,this._startTime=null,this.time=0,this._effectiveWeight=this.weight=this._effectiveTimeScale=this.timeScale=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtEnd=this.zeroSlopeAtStart=!0}function Uc(e){this._root=e,this._initMemoryManager(),this.time=this._accuIndex=0,this.timeScale=1}function ga(e,t){typeof e=="string"&&(console.warn("THREE.Uniform: Type parameter is no longer needed."),e=t),this.value=e}function zc(e,t,n){ct.call(this,e,t),this.meshPerAttribute=n||1}function zl(e,t,n,i){this.ray=new de(e,t),this.near=n||0,this.far=i||1/0,this.camera=null,this.params={Mesh:{},Line:{},LOD:{},Points:{threshold:1},Sprite:{}},Object.defineProperties(this.params,{PointCloud:{get:function(){return console.warn("THREE.Raycaster: params.PointCloud has been renamed to params.Points."),this.Points}}})}function Gl(e,t){return e.distance-t.distance}function Gc(e,t,n,i){if(e.visible!==!1&&(e.raycast(t,n),i===!0)){e=e.children,i=0;for(var r=e.length;i<r;i++)Gc(e[i],t,n,!0)}}function Hl(e,t,n){return this.radius=e!==void 0?e:1,this.phi=t!==void 0?t:0,this.theta=n!==void 0?n:0,this}function Vl(e,t,n){return this.radius=e!==void 0?e:1,this.theta=t!==void 0?t:0,this.y=n!==void 0?n:0,this}function Hc(e,t){this.min=e!==void 0?e:new G(1/0,1/0),this.max=t!==void 0?t:new G(-1/0,-1/0)}function Vc(e,t){this.start=e!==void 0?e:new E,this.end=t!==void 0?t:new E}function ts(e){W.call(this),this.material=e,this.render=function(){}}function ns(e,t,n,i){this.object=e,this.size=t!==void 0?t:1,e=n!==void 0?n:16711680,i=i!==void 0?i:1,t=0,(n=this.object.geometry)&&n.isGeometry?t=3*n.faces.length:n&&n.isBufferGeometry&&(t=n.attributes.normal.count),n=new re,t=new le(6*t,3),n.addAttribute("position",t),ot.call(this,n,new $e({color:e,linewidth:i})),this.matrixAutoUpdate=!1,this.update()}function Qr(e,t){W.call(this),this.light=e,this.light.updateMatrixWorld(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=t,e=new re,t=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1];for(var n=0,i=1;32>n;n++,i++){var r=n/32*Math.PI*2,o=i/32*Math.PI*2;t.push(Math.cos(r),Math.sin(r),1,Math.cos(o),Math.sin(o),1)}e.addAttribute("position",new le(t,3)),t=new $e({fog:!1}),this.cone=new ot(e,t),this.add(this.cone),this.update()}function jl(e){var t=[];e&&e.isBone&&t.push(e);for(var n=0;n<e.children.length;n++)t.push.apply(t,jl(e.children[n]));return t}function qr(e){for(var t=jl(e),n=new re,i=[],r=[],o=new ve(0,0,1),s=new ve(0,1,0),a=0;a<t.length;a++){var c=t[a];c.parent&&c.parent.isBone&&(i.push(0,0,0),i.push(0,0,0),r.push(o.r,o.g,o.b),r.push(s.r,s.g,s.b))}n.addAttribute("position",new le(i,3)),n.addAttribute("color",new le(r,3)),i=new $e({vertexColors:2,depthTest:!1,depthWrite:!1,transparent:!0}),ot.call(this,n,i),this.root=e,this.bones=t,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1}function Zr(e,t,n){this.light=e,this.light.updateMatrixWorld(),this.color=n,e=new Pi(t,4,2),t=new Wt({wireframe:!0,fog:!1}),yt.call(this,e,t),this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1,this.update()}function Kr(e,t){this.type="RectAreaLightHelper",this.light=e,this.color=t,e=new re,e.addAttribute("position",new le([1,1,0,-1,1,0,-1,-1,0,1,-1,0,1,1,0],3)),e.computeBoundingSphere(),t=new $e({fog:!1}),At.call(this,e,t),e=new re,e.addAttribute("position",new le([1,1,0,-1,1,0,-1,-1,0,1,1,0,-1,-1,0,1,-1,0],3)),e.computeBoundingSphere(),this.add(new yt(e,new Wt({side:1,fog:!1}))),this.update()}function Jr(e,t,n){W.call(this),this.light=e,this.light.updateMatrixWorld(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=n,e=new Qi(t),e.rotateY(.5*Math.PI),this.material=new Wt({wireframe:!0,fog:!1}),this.color===void 0&&(this.material.vertexColors=2),t=e.getAttribute("position"),t=new Float32Array(3*t.count),e.addAttribute("color",new Ce(t,3)),this.add(new yt(e,this.material)),this.update()}function $r(e,t){this.lightProbe=e,this.size=t,e=new Rt({defines:{GAMMA_OUTPUT:""},uniforms:{sh:{value:this.lightProbe.sh.coefficients},intensity:{value:this.lightProbe.intensity}},vertexShader:`varying vec3 vNormal;
void main() {
	vNormal = normalize( normalMatrix * normal );
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,fragmentShader:`#define RECIPROCAL_PI 0.318309886
vec3 inverseTransformDirection( in vec3 normal, in mat4 matrix ) {
	// matrix is assumed to be orthogonal
	return normalize( ( vec4( normal, 0.0 ) * matrix ).xyz );
}
vec3 linearToOutput( in vec3 a ) {
	#ifdef GAMMA_OUTPUT
		return pow( a, vec3( 1.0 / float( GAMMA_FACTOR ) ) );
	#else
		return a;
	#endif
}
// source: https://graphics.stanford.edu/papers/envmap/envmap.pdf
vec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {
	// normal is assumed to have unit length
	float x = normal.x, y = normal.y, z = normal.z;
	// band 0
	vec3 result = shCoefficients[ 0 ] * 0.886227;
	// band 1
	result += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;
	result += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;
	result += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;
	// band 2
	result += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;
	result += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;
	result += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );
	result += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;
	result += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );
	return result;
}
uniform vec3 sh[ 9 ]; // sh coefficients
uniform float intensity; // light probe intensity
varying vec3 vNormal;
void main() {
	vec3 normal = normalize( vNormal );
	vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
	vec3 irradiance = shGetIrradianceAt( worldNormal, sh );
	vec3 outgoingLight = RECIPROCAL_PI * irradiance * intensity;
	outgoingLight = linearToOutput( outgoingLight );
	gl_FragColor = vec4( outgoingLight, 1.0 );
}`}),t=new Pi(1,32,16),yt.call(this,t,e),this.onBeforeRender()}function ya(e,t,n,i){e=e||10,t=t||10,n=new ve(n!==void 0?n:4473924),i=new ve(i!==void 0?i:8947848);var r=t/2,o=e/t,s=e/2;e=[];for(var a=[],c=0,u=0,h=-s;c<=t;c++,h+=o){e.push(-s,0,h,s,0,h),e.push(h,0,-s,h,0,s);var p=c===r?n:i;p.toArray(a,u),u+=3,p.toArray(a,u),u+=3,p.toArray(a,u),u+=3,p.toArray(a,u),u+=3}t=new re,t.addAttribute("position",new le(e,3)),t.addAttribute("color",new le(a,3)),n=new $e({vertexColors:2}),ot.call(this,t,n)}function xa(e,t,n,i,r,o){e=e||10,t=t||16,n=n||8,i=i||64,r=new ve(r!==void 0?r:4473924),o=new ve(o!==void 0?o:8947848);var s=[],a=[],c;for(c=0;c<=t;c++){var u=c/t*2*Math.PI,h=Math.sin(u)*e;u=Math.cos(u)*e,s.push(0,0,0),s.push(h,0,u);var p=c&1?r:o;a.push(p.r,p.g,p.b),a.push(p.r,p.g,p.b)}for(c=0;c<=n;c++){p=c&1?r:o;var v=e-e/n*c;for(t=0;t<i;t++)u=t/i*2*Math.PI,h=Math.sin(u)*v,u=Math.cos(u)*v,s.push(h,0,u),a.push(p.r,p.g,p.b),u=(t+1)/i*2*Math.PI,h=Math.sin(u)*v,u=Math.cos(u)*v,s.push(h,0,u),a.push(p.r,p.g,p.b)}e=new re,e.addAttribute("position",new le(s,3)),e.addAttribute("color",new le(a,3)),s=new $e({vertexColors:2}),ot.call(this,e,s)}function eo(e,t,n,i){this.audio=e,this.range=t||1,this.divisionsInnerAngle=n||16,this.divisionsOuterAngle=i||2,e=new re,t=new Float32Array(3*(3*(this.divisionsInnerAngle+2*this.divisionsOuterAngle)+3)),e.addAttribute("position",new Ce(t,3)),t=new $e({color:65280}),n=new $e({color:16776960}),At.call(this,e,[n,t]),this.update()}function is(e,t,n,i){this.object=e,this.size=t!==void 0?t:1,e=n!==void 0?n:16776960,i=i!==void 0?i:1,t=0,(n=this.object.geometry)&&n.isGeometry?t=n.faces.length:console.warn("THREE.FaceNormalsHelper: only THREE.Geometry is supported. Use THREE.VertexNormalsHelper, instead."),n=new re,t=new le(6*t,3),n.addAttribute("position",t),ot.call(this,n,new $e({color:e,linewidth:i})),this.matrixAutoUpdate=!1,this.update()}function to(e,t,n){W.call(this),this.light=e,this.light.updateMatrixWorld(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=n,t===void 0&&(t=1),e=new re,e.addAttribute("position",new le([-t,t,0,t,t,0,t,-t,0,-t,-t,0,-t,t,0],3)),t=new $e({fog:!1}),this.lightPlane=new At(e,t),this.add(this.lightPlane),e=new re,e.addAttribute("position",new le([0,0,0,0,0,1],3)),this.targetLine=new At(e,t),this.add(this.targetLine),this.update()}function rs(e){function t(x,y,M){n(x,M),n(y,M)}function n(x,y){o.push(0,0,0),s.push(y.r,y.g,y.b),a[x]===void 0&&(a[x]=[]),a[x].push(o.length/3-1)}var i=new re,r=new $e({color:16777215,vertexColors:1}),o=[],s=[],a={},c=new ve(16755200),u=new ve(16711680),h=new ve(43775),p=new ve(16777215),v=new ve(3355443);t("n1","n2",c),t("n2","n4",c),t("n4","n3",c),t("n3","n1",c),t("f1","f2",c),t("f2","f4",c),t("f4","f3",c),t("f3","f1",c),t("n1","f1",c),t("n2","f2",c),t("n3","f3",c),t("n4","f4",c),t("p","n1",u),t("p","n2",u),t("p","n3",u),t("p","n4",u),t("u1","u2",h),t("u2","u3",h),t("u3","u1",h),t("c","t",p),t("p","c",v),t("cn1","cn2",v),t("cn3","cn4",v),t("cf1","cf2",v),t("cf3","cf4",v),i.addAttribute("position",new le(o,3)),i.addAttribute("color",new le(s,3)),ot.call(this,i,r),this.camera=e,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=a,this.update()}function Pt(e,t,n,i,r,o,s){if(Ya.set(r,o,s).unproject(i),e=t[e],e!==void 0)for(n=n.getAttribute("position"),t=0,i=e.length;t<i;t++)n.setXYZ(e[t],Ya.x,Ya.y,Ya.z)}function ci(e,t){this.object=e,t===void 0&&(t=16776960),e=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]);var n=new Float32Array(24),i=new re;i.setIndex(new Ce(e,1)),i.addAttribute("position",new Ce(n,3)),ot.call(this,i,new $e({color:t})),this.matrixAutoUpdate=!1,this.update()}function os(e,t){this.type="Box3Helper",this.box=e,t=t||16776960,e=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]);var n=new re;n.setIndex(new Ce(e,1)),n.addAttribute("position",new le([1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],3)),ot.call(this,n,new $e({color:t})),this.geometry.computeBoundingSphere()}function ss(e,t,n){this.type="PlaneHelper",this.plane=e,this.size=t===void 0?1:t,e=n!==void 0?n:16776960,t=new re,t.addAttribute("position",new le([1,-1,1,-1,1,1,-1,-1,1,1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,1,0,0,1,0,0,0],3)),t.computeBoundingSphere(),At.call(this,t,new $e({color:e})),t=new re,t.addAttribute("position",new le([1,1,1,-1,1,1,-1,-1,1,1,1,1,-1,-1,1,1,-1,1],3)),t.computeBoundingSphere(),this.add(new yt(t,new Wt({color:e,opacity:.2,transparent:!0,depthWrite:!1})))}function li(e,t,n,i,r,o){W.call(this),e===void 0&&(e=new E(0,0,1)),t===void 0&&(t=new E(0,0,0)),n===void 0&&(n=1),i===void 0&&(i=16776960),r===void 0&&(r=.2*n),o===void 0&&(o=.2*r),Qa===void 0&&(Qa=new re,Qa.addAttribute("position",new le([0,0,0,0,1,0],3)),wl=new si(0,.5,1,5,1),wl.translate(0,-.5,0)),this.position.copy(t),this.line=new At(Qa,new $e({color:i})),this.line.matrixAutoUpdate=!1,this.add(this.line),this.cone=new yt(wl,new Wt({color:i})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(e),this.setLength(n,r,o)}function as(e){e=e||1;var t=[0,0,0,e,0,0,0,0,0,0,e,0,0,0,0,0,0,e];e=new re,e.addAttribute("position",new le(t,3)),e.addAttribute("color",new le([1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],3)),t=new $e({vertexColors:2}),ot.call(this,e,t)}function Wl(e){console.warn("THREE.ClosedSplineCurve3 has been deprecated. Use THREE.CatmullRomCurve3 instead."),Yt.call(this,e),this.type="catmullrom",this.closed=!0}function kl(e){console.warn("THREE.SplineCurve3 has been deprecated. Use THREE.CatmullRomCurve3 instead."),Yt.call(this,e),this.type="catmullrom"}function jc(e){console.warn("THREE.Spline has been removed. Use THREE.CatmullRomCurve3 instead."),Yt.call(this,e),this.type="catmullrom"}Number.EPSILON===void 0&&(Number.EPSILON=Math.pow(2,-52)),Number.isInteger===void 0&&(Number.isInteger=function(e){return typeof e=="number"&&isFinite(e)&&Math.floor(e)===e}),Math.sign===void 0&&(Math.sign=function(e){return 0>e?-1:0<e?1:+e}),!("name"in Function.prototype)&&Object.defineProperty(Function.prototype,"name",{get:function(){return this.toString().match(/^\s*function\s*([^\(\s]*)/)[1]}}),Object.assign===void 0&&(Object.assign=function(e){if(e==null)throw new TypeError("Cannot convert undefined or null to object");for(var t=Object(e),n=1;n<arguments.length;n++){var i=arguments[n];if(i!=null)for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(t[r]=i[r])}return t}),Object.assign(w.prototype,{addEventListener:function(e,t){this._listeners===void 0&&(this._listeners={});var n=this._listeners;n[e]===void 0&&(n[e]=[]),n[e].indexOf(t)===-1&&n[e].push(t)},hasEventListener:function(e,t){if(this._listeners===void 0)return!1;var n=this._listeners;return n[e]!==void 0&&n[e].indexOf(t)!==-1},removeEventListener:function(e,t){this._listeners!==void 0&&(e=this._listeners[e],e!==void 0&&(t=e.indexOf(t),t!==-1&&e.splice(t,1)))},dispatchEvent:function(e){if(this._listeners!==void 0){var t=this._listeners[e.type];if(t!==void 0){e.target=this,t=t.slice(0);for(var n=0,i=t.length;n<i;n++)t[n].call(this,e)}}}});for(var jt=[],cs=0;256>cs;cs++)jt[cs]=(16>cs?"0":"")+cs.toString(16);var Xe={DEG2RAD:Math.PI/180,RAD2DEG:180/Math.PI,generateUUID:function(){var e=4294967295*Math.random()|0,t=4294967295*Math.random()|0,n=4294967295*Math.random()|0,i=4294967295*Math.random()|0;return(jt[e&255]+jt[e>>8&255]+jt[e>>16&255]+jt[e>>24&255]+"-"+jt[t&255]+jt[t>>8&255]+"-"+jt[t>>16&15|64]+jt[t>>24&255]+"-"+jt[n&63|128]+jt[n>>8&255]+"-"+jt[n>>16&255]+jt[n>>24&255]+jt[i&255]+jt[i>>8&255]+jt[i>>16&255]+jt[i>>24&255]).toUpperCase()},clamp:function(e,t,n){return Math.max(t,Math.min(n,e))},euclideanModulo:function(e,t){return(e%t+t)%t},mapLinear:function(e,t,n,i,r){return i+(e-t)*(r-i)/(n-t)},lerp:function(e,t,n){return(1-n)*e+n*t},smoothstep:function(e,t,n){return e<=t?0:e>=n?1:(e=(e-t)/(n-t),e*e*(3-2*e))},smootherstep:function(e,t,n){return e<=t?0:e>=n?1:(e=(e-t)/(n-t),e*e*e*(e*(6*e-15)+10))},randInt:function(e,t){return e+Math.floor(Math.random()*(t-e+1))},randFloat:function(e,t){return e+Math.random()*(t-e)},randFloatSpread:function(e){return e*(.5-Math.random())},degToRad:function(e){return e*Xe.DEG2RAD},radToDeg:function(e){return e*Xe.RAD2DEG},isPowerOfTwo:function(e){return(e&e-1)===0&&e!==0},ceilPowerOfTwo:function(e){return Math.pow(2,Math.ceil(Math.log(e)/Math.LN2))},floorPowerOfTwo:function(e){return Math.pow(2,Math.floor(Math.log(e)/Math.LN2))}};Object.defineProperties(G.prototype,{width:{get:function(){return this.x},set:function(e){this.x=e}},height:{get:function(){return this.y},set:function(e){this.y=e}}}),Object.assign(G.prototype,{isVector2:!0,set:function(e,t){return this.x=e,this.y=t,this},setScalar:function(e){return this.y=this.x=e,this},setX:function(e){return this.x=e,this},setY:function(e){return this.y=e,this},setComponent:function(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw Error("index is out of range: "+e)}return this},getComponent:function(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw Error("index is out of range: "+e)}},clone:function(){return new this.constructor(this.x,this.y)},copy:function(e){return this.x=e.x,this.y=e.y,this},add:function(e,t){return t!==void 0?(console.warn("THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this)},addScalar:function(e){return this.x+=e,this.y+=e,this},addVectors:function(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this},addScaledVector:function(e,t){return this.x+=e.x*t,this.y+=e.y*t,this},sub:function(e,t){return t!==void 0?(console.warn("THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this)},subScalar:function(e){return this.x-=e,this.y-=e,this},subVectors:function(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this},multiply:function(e){return this.x*=e.x,this.y*=e.y,this},multiplyScalar:function(e){return this.x*=e,this.y*=e,this},divide:function(e){return this.x/=e.x,this.y/=e.y,this},divideScalar:function(e){return this.multiplyScalar(1/e)},applyMatrix3:function(e){var t=this.x,n=this.y;return e=e.elements,this.x=e[0]*t+e[3]*n+e[6],this.y=e[1]*t+e[4]*n+e[7],this},min:function(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this},max:function(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this},clamp:function(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this},clampScalar:function(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this},clampLength:function(e,t){var n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},roundToZero:function(){return this.x=0>this.x?Math.ceil(this.x):Math.floor(this.x),this.y=0>this.y?Math.ceil(this.y):Math.floor(this.y),this},negate:function(){return this.x=-this.x,this.y=-this.y,this},dot:function(e){return this.x*e.x+this.y*e.y},cross:function(e){return this.x*e.y-this.y*e.x},lengthSq:function(){return this.x*this.x+this.y*this.y},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)},normalize:function(){return this.divideScalar(this.length()||1)},angle:function(){var e=Math.atan2(this.y,this.x);return 0>e&&(e+=2*Math.PI),e},distanceTo:function(e){return Math.sqrt(this.distanceToSquared(e))},distanceToSquared:function(e){var t=this.x-e.x;return e=this.y-e.y,t*t+e*e},manhattanDistanceTo:function(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)},setLength:function(e){return this.normalize().multiplyScalar(e)},lerp:function(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this},lerpVectors:function(e,t,n){return this.subVectors(t,e).multiplyScalar(n).add(e)},equals:function(e){return e.x===this.x&&e.y===this.y},fromArray:function(e,t){return t===void 0&&(t=0),this.x=e[t],this.y=e[t+1],this},toArray:function(e,t){return e===void 0&&(e=[]),t===void 0&&(t=0),e[t]=this.x,e[t+1]=this.y,e},fromBufferAttribute:function(e,t,n){return n!==void 0&&console.warn("THREE.Vector2: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(t),this.y=e.getY(t),this},rotateAround:function(e,t){var n=Math.cos(t);t=Math.sin(t);var i=this.x-e.x,r=this.y-e.y;return this.x=i*n-r*t+e.x,this.y=i*t+r*n+e.y,this}}),Object.assign(we,{slerp:function(e,t,n,i){return n.copy(e).slerp(t,i)},slerpFlat:function(e,t,n,i,r,o,s){var a=n[i+0],c=n[i+1],u=n[i+2];n=n[i+3],i=r[o+0];var h=r[o+1],p=r[o+2];if(r=r[o+3],n!==r||a!==i||c!==h||u!==p){o=1-s;var v=a*i+c*h+u*p+n*r,x=0<=v?1:-1,y=1-v*v;y>Number.EPSILON&&(y=Math.sqrt(y),v=Math.atan2(y,v*x),o=Math.sin(o*v)/y,s=Math.sin(s*v)/y),x*=s,a=a*o+i*x,c=c*o+h*x,u=u*o+p*x,n=n*o+r*x,o===1-s&&(s=1/Math.sqrt(a*a+c*c+u*u+n*n),a*=s,c*=s,u*=s,n*=s)}e[t]=a,e[t+1]=c,e[t+2]=u,e[t+3]=n}}),Object.defineProperties(we.prototype,{x:{get:function(){return this._x},set:function(e){this._x=e,this._onChangeCallback()}},y:{get:function(){return this._y},set:function(e){this._y=e,this._onChangeCallback()}},z:{get:function(){return this._z},set:function(e){this._z=e,this._onChangeCallback()}},w:{get:function(){return this._w},set:function(e){this._w=e,this._onChangeCallback()}}}),Object.assign(we.prototype,{isQuaternion:!0,set:function(e,t,n,i){return this._x=e,this._y=t,this._z=n,this._w=i,this._onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._w)},copy:function(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this},setFromEuler:function(e,t){if(!e||!e.isEuler)throw Error("THREE.Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.");var n=e._x,i=e._y,r=e._z;e=e.order;var o=Math.cos,s=Math.sin,a=o(n/2),c=o(i/2);return o=o(r/2),n=s(n/2),i=s(i/2),r=s(r/2),e==="XYZ"?(this._x=n*c*o+a*i*r,this._y=a*i*o-n*c*r,this._z=a*c*r+n*i*o,this._w=a*c*o-n*i*r):e==="YXZ"?(this._x=n*c*o+a*i*r,this._y=a*i*o-n*c*r,this._z=a*c*r-n*i*o,this._w=a*c*o+n*i*r):e==="ZXY"?(this._x=n*c*o-a*i*r,this._y=a*i*o+n*c*r,this._z=a*c*r+n*i*o,this._w=a*c*o-n*i*r):e==="ZYX"?(this._x=n*c*o-a*i*r,this._y=a*i*o+n*c*r,this._z=a*c*r-n*i*o,this._w=a*c*o+n*i*r):e==="YZX"?(this._x=n*c*o+a*i*r,this._y=a*i*o+n*c*r,this._z=a*c*r-n*i*o,this._w=a*c*o-n*i*r):e==="XZY"&&(this._x=n*c*o-a*i*r,this._y=a*i*o-n*c*r,this._z=a*c*r+n*i*o,this._w=a*c*o+n*i*r),t!==!1&&this._onChangeCallback(),this},setFromAxisAngle:function(e,t){t/=2;var n=Math.sin(t);return this._x=e.x*n,this._y=e.y*n,this._z=e.z*n,this._w=Math.cos(t),this._onChangeCallback(),this},setFromRotationMatrix:function(e){var t=e.elements,n=t[0];e=t[4];var i=t[8],r=t[1],o=t[5],s=t[9],a=t[2],c=t[6];t=t[10];var u=n+o+t;return 0<u?(n=.5/Math.sqrt(u+1),this._w=.25/n,this._x=(c-s)*n,this._y=(i-a)*n,this._z=(r-e)*n):n>o&&n>t?(n=2*Math.sqrt(1+n-o-t),this._w=(c-s)/n,this._x=.25*n,this._y=(e+r)/n,this._z=(i+a)/n):o>t?(n=2*Math.sqrt(1+o-n-t),this._w=(i-a)/n,this._x=(e+r)/n,this._y=.25*n,this._z=(s+c)/n):(n=2*Math.sqrt(1+t-n-o),this._w=(r-e)/n,this._x=(i+a)/n,this._y=(s+c)/n,this._z=.25*n),this._onChangeCallback(),this},setFromUnitVectors:function(e,t){var n=e.dot(t)+1;return 1e-6>n?(n=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0):(this._x=0,this._y=-e.z,this._z=e.y)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x),this._w=n,this.normalize()},angleTo:function(e){return 2*Math.acos(Math.abs(Xe.clamp(this.dot(e),-1,1)))},rotateTowards:function(e,t){var n=this.angleTo(e);return n===0?this:(this.slerp(e,Math.min(1,t/n)),this)},inverse:function(){return this.conjugate()},conjugate:function(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this},dot:function(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w},lengthSq:function(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w},length:function(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)},normalize:function(){var e=this.length();return e===0?(this._z=this._y=this._x=0,this._w=1):(e=1/e,this._x*=e,this._y*=e,this._z*=e,this._w*=e),this._onChangeCallback(),this},multiply:function(e,t){return t!==void 0?(console.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(e,t)):this.multiplyQuaternions(this,e)},premultiply:function(e){return this.multiplyQuaternions(e,this)},multiplyQuaternions:function(e,t){var n=e._x,i=e._y,r=e._z;e=e._w;var o=t._x,s=t._y,a=t._z;return t=t._w,this._x=n*t+e*o+i*a-r*s,this._y=i*t+e*s+r*o-n*a,this._z=r*t+e*a+n*s-i*o,this._w=e*t-n*o-i*s-r*a,this._onChangeCallback(),this},slerp:function(e,t){if(t===0)return this;if(t===1)return this.copy(e);var n=this._x,i=this._y,r=this._z,o=this._w,s=o*e._w+n*e._x+i*e._y+r*e._z;if(0>s?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,s=-s):this.copy(e),1<=s)return this._w=o,this._x=n,this._y=i,this._z=r,this;if(e=1-s*s,e<=Number.EPSILON)return s=1-t,this._w=s*o+t*this._w,this._x=s*n+t*this._x,this._y=s*i+t*this._y,this._z=s*r+t*this._z,this.normalize(),this._onChangeCallback(),this;e=Math.sqrt(e);var a=Math.atan2(e,s);return s=Math.sin((1-t)*a)/e,t=Math.sin(t*a)/e,this._w=o*s+this._w*t,this._x=n*s+this._x*t,this._y=i*s+this._y*t,this._z=r*s+this._z*t,this._onChangeCallback(),this},equals:function(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w},fromArray:function(e,t){return t===void 0&&(t=0),this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this._onChangeCallback(),this},toArray:function(e,t){return e===void 0&&(e=[]),t===void 0&&(t=0),e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e},_onChange:function(e){return this._onChangeCallback=e,this},_onChangeCallback:function(){}});var Wc=new E,Yl=new we;Object.assign(E.prototype,{isVector3:!0,set:function(e,t,n){return this.x=e,this.y=t,this.z=n,this},setScalar:function(e){return this.z=this.y=this.x=e,this},setX:function(e){return this.x=e,this},setY:function(e){return this.y=e,this},setZ:function(e){return this.z=e,this},setComponent:function(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw Error("index is out of range: "+e)}return this},getComponent:function(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw Error("index is out of range: "+e)}},clone:function(){return new this.constructor(this.x,this.y,this.z)},copy:function(e){return this.x=e.x,this.y=e.y,this.z=e.z,this},add:function(e,t){return t!==void 0?(console.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this.z+=e.z,this)},addScalar:function(e){return this.x+=e,this.y+=e,this.z+=e,this},addVectors:function(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this},addScaledVector:function(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this},sub:function(e,t){return t!==void 0?(console.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this.z-=e.z,this)},subScalar:function(e){return this.x-=e,this.y-=e,this.z-=e,this},subVectors:function(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this},multiply:function(e,t){return t!==void 0?(console.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(e,t)):(this.x*=e.x,this.y*=e.y,this.z*=e.z,this)},multiplyScalar:function(e){return this.x*=e,this.y*=e,this.z*=e,this},multiplyVectors:function(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this},applyEuler:function(e){return e&&e.isEuler||console.error("THREE.Vector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order."),this.applyQuaternion(Yl.setFromEuler(e))},applyAxisAngle:function(e,t){return this.applyQuaternion(Yl.setFromAxisAngle(e,t))},applyMatrix3:function(e){var t=this.x,n=this.y,i=this.z;return e=e.elements,this.x=e[0]*t+e[3]*n+e[6]*i,this.y=e[1]*t+e[4]*n+e[7]*i,this.z=e[2]*t+e[5]*n+e[8]*i,this},applyMatrix4:function(e){var t=this.x,n=this.y,i=this.z;e=e.elements;var r=1/(e[3]*t+e[7]*n+e[11]*i+e[15]);return this.x=(e[0]*t+e[4]*n+e[8]*i+e[12])*r,this.y=(e[1]*t+e[5]*n+e[9]*i+e[13])*r,this.z=(e[2]*t+e[6]*n+e[10]*i+e[14])*r,this},applyQuaternion:function(e){var t=this.x,n=this.y,i=this.z,r=e.x,o=e.y,s=e.z;e=e.w;var a=e*t+o*i-s*n,c=e*n+s*t-r*i,u=e*i+r*n-o*t;return t=-r*t-o*n-s*i,this.x=a*e+t*-r+c*-s-u*-o,this.y=c*e+t*-o+u*-r-a*-s,this.z=u*e+t*-s+a*-o-c*-r,this},project:function(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)},unproject:function(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)},transformDirection:function(e){var t=this.x,n=this.y,i=this.z;return e=e.elements,this.x=e[0]*t+e[4]*n+e[8]*i,this.y=e[1]*t+e[5]*n+e[9]*i,this.z=e[2]*t+e[6]*n+e[10]*i,this.normalize()},divide:function(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this},divideScalar:function(e){return this.multiplyScalar(1/e)},min:function(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this},max:function(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this},clamp:function(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this},clampScalar:function(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this},clampLength:function(e,t){var n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this},roundToZero:function(){return this.x=0>this.x?Math.ceil(this.x):Math.floor(this.x),this.y=0>this.y?Math.ceil(this.y):Math.floor(this.y),this.z=0>this.z?Math.ceil(this.z):Math.floor(this.z),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},dot:function(e){return this.x*e.x+this.y*e.y+this.z*e.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},normalize:function(){return this.divideScalar(this.length()||1)},setLength:function(e){return this.normalize().multiplyScalar(e)},lerp:function(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this},lerpVectors:function(e,t,n){return this.subVectors(t,e).multiplyScalar(n).add(e)},cross:function(e,t){return t!==void 0?(console.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(e,t)):this.crossVectors(this,e)},crossVectors:function(e,t){var n=e.x,i=e.y;e=e.z;var r=t.x,o=t.y;return t=t.z,this.x=i*t-e*o,this.y=e*r-n*t,this.z=n*o-i*r,this},projectOnVector:function(e){var t=e.dot(this)/e.lengthSq();return this.copy(e).multiplyScalar(t)},projectOnPlane:function(e){return Wc.copy(this).projectOnVector(e),this.sub(Wc)},reflect:function(e){return this.sub(Wc.copy(e).multiplyScalar(2*this.dot(e)))},angleTo:function(e){var t=Math.sqrt(this.lengthSq()*e.lengthSq());return t===0&&console.error("THREE.Vector3: angleTo() can't handle zero length vectors."),e=this.dot(e)/t,Math.acos(Xe.clamp(e,-1,1))},distanceTo:function(e){return Math.sqrt(this.distanceToSquared(e))},distanceToSquared:function(e){var t=this.x-e.x,n=this.y-e.y;return e=this.z-e.z,t*t+n*n+e*e},manhattanDistanceTo:function(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)},setFromSpherical:function(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)},setFromSphericalCoords:function(e,t,n){var i=Math.sin(t)*e;return this.x=i*Math.sin(n),this.y=Math.cos(t)*e,this.z=i*Math.cos(n),this},setFromCylindrical:function(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)},setFromCylindricalCoords:function(e,t,n){return this.x=e*Math.sin(t),this.y=n,this.z=e*Math.cos(t),this},setFromMatrixPosition:function(e){return e=e.elements,this.x=e[12],this.y=e[13],this.z=e[14],this},setFromMatrixScale:function(e){var t=this.setFromMatrixColumn(e,0).length(),n=this.setFromMatrixColumn(e,1).length();return e=this.setFromMatrixColumn(e,2).length(),this.x=t,this.y=n,this.z=e,this},setFromMatrixColumn:function(e,t){return this.fromArray(e.elements,4*t)},equals:function(e){return e.x===this.x&&e.y===this.y&&e.z===this.z},fromArray:function(e,t){return t===void 0&&(t=0),this.x=e[t],this.y=e[t+1],this.z=e[t+2],this},toArray:function(e,t){return e===void 0&&(e=[]),t===void 0&&(t=0),e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e},fromBufferAttribute:function(e,t,n){return n!==void 0&&console.warn("THREE.Vector3: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}});var cr=new E;Object.assign(be.prototype,{isMatrix3:!0,set:function(e,t,n,i,r,o,s,a,c){var u=this.elements;return u[0]=e,u[1]=i,u[2]=s,u[3]=t,u[4]=r,u[5]=a,u[6]=n,u[7]=o,u[8]=c,this},identity:function(){return this.set(1,0,0,0,1,0,0,0,1),this},clone:function(){return new this.constructor().fromArray(this.elements)},copy:function(e){var t=this.elements;return e=e.elements,t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],this},setFromMatrix4:function(e){return e=e.elements,this.set(e[0],e[4],e[8],e[1],e[5],e[9],e[2],e[6],e[10]),this},applyToBufferAttribute:function(e){for(var t=0,n=e.count;t<n;t++)cr.x=e.getX(t),cr.y=e.getY(t),cr.z=e.getZ(t),cr.applyMatrix3(this),e.setXYZ(t,cr.x,cr.y,cr.z);return e},multiply:function(e){return this.multiplyMatrices(this,e)},premultiply:function(e){return this.multiplyMatrices(e,this)},multiplyMatrices:function(e,t){var n=e.elements,i=t.elements;t=this.elements,e=n[0];var r=n[3],o=n[6],s=n[1],a=n[4],c=n[7],u=n[2],h=n[5];n=n[8];var p=i[0],v=i[3],x=i[6],y=i[1],M=i[4],L=i[7],O=i[2],F=i[5];return i=i[8],t[0]=e*p+r*y+o*O,t[3]=e*v+r*M+o*F,t[6]=e*x+r*L+o*i,t[1]=s*p+a*y+c*O,t[4]=s*v+a*M+c*F,t[7]=s*x+a*L+c*i,t[2]=u*p+h*y+n*O,t[5]=u*v+h*M+n*F,t[8]=u*x+h*L+n*i,this},multiplyScalar:function(e){var t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this},determinant:function(){var e=this.elements,t=e[0],n=e[1],i=e[2],r=e[3],o=e[4],s=e[5],a=e[6],c=e[7];return e=e[8],t*o*e-t*s*c-n*r*e+n*s*a+i*r*c-i*o*a},getInverse:function(e,t){e&&e.isMatrix4&&console.error("THREE.Matrix3: .getInverse() no longer takes a Matrix4 argument.");var n=e.elements;e=this.elements;var i=n[0],r=n[1],o=n[2],s=n[3],a=n[4],c=n[5],u=n[6],h=n[7];n=n[8];var p=n*a-c*h,v=c*u-n*s,x=h*s-a*u,y=i*p+r*v+o*x;if(y===0){if(t===!0)throw Error("THREE.Matrix3: .getInverse() can't invert matrix, determinant is 0");return console.warn("THREE.Matrix3: .getInverse() can't invert matrix, determinant is 0"),this.identity()}return t=1/y,e[0]=p*t,e[1]=(o*h-n*r)*t,e[2]=(c*r-o*a)*t,e[3]=v*t,e[4]=(n*i-o*u)*t,e[5]=(o*s-c*i)*t,e[6]=x*t,e[7]=(r*u-h*i)*t,e[8]=(a*i-r*s)*t,this},transpose:function(){var e=this.elements,t=e[1];return e[1]=e[3],e[3]=t,t=e[2],e[2]=e[6],e[6]=t,t=e[5],e[5]=e[7],e[7]=t,this},getNormalMatrix:function(e){return this.setFromMatrix4(e).getInverse(this).transpose()},transposeIntoArray:function(e){var t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this},setUvTransform:function(e,t,n,i,r,o,s){var a=Math.cos(r);r=Math.sin(r),this.set(n*a,n*r,-n*(a*o+r*s)+o+e,-i*r,i*a,-i*(-r*o+a*s)+s+t,0,0,1)},scale:function(e,t){var n=this.elements;return n[0]*=e,n[3]*=e,n[6]*=e,n[1]*=t,n[4]*=t,n[7]*=t,this},rotate:function(e){var t=Math.cos(e);e=Math.sin(e);var n=this.elements,i=n[0],r=n[3],o=n[6],s=n[1],a=n[4],c=n[7];return n[0]=t*i+e*s,n[3]=t*r+e*a,n[6]=t*o+e*c,n[1]=-e*i+t*s,n[4]=-e*r+t*a,n[7]=-e*o+t*c,this},translate:function(e,t){var n=this.elements;return n[0]+=e*n[2],n[3]+=e*n[5],n[6]+=e*n[8],n[1]+=t*n[2],n[4]+=t*n[5],n[7]+=t*n[8],this},equals:function(e){var t=this.elements;e=e.elements;for(var n=0;9>n;n++)if(t[n]!==e[n])return!1;return!0},fromArray:function(e,t){t===void 0&&(t=0);for(var n=0;9>n;n++)this.elements[n]=e[n+t];return this},toArray:function(e,t){e===void 0&&(e=[]),t===void 0&&(t=0);var n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e}});var no,Ri={getDataURL:function(e){if(typeof HTMLCanvasElement>"u")return e.src;if(!(e instanceof HTMLCanvasElement)){no===void 0&&(no=document.createElementNS("http://www.w3.org/1999/xhtml","canvas")),no.width=e.width,no.height=e.height;var t=no.getContext("2d");e instanceof ImageData?t.putImageData(e,0,0):t.drawImage(e,0,0,e.width,e.height),e=no}return 2048<e.width||2048<e.height?e.toDataURL("image/jpeg",.6):e.toDataURL("image/png")}},th=0;Ae.DEFAULT_IMAGE=void 0,Ae.DEFAULT_MAPPING=300,Ae.prototype=Object.assign(Object.create(w.prototype),{constructor:Ae,isTexture:!0,updateMatrix:function(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)},clone:function(){return new this.constructor().copy(this)},copy:function(e){return this.name=e.name,this.image=e.image,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.encoding=e.encoding,this},toJSON:function(e){var t=e===void 0||typeof e=="string";if(!t&&e.textures[this.uuid]!==void 0)return e.textures[this.uuid];var n={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,type:this.type,encoding:this.encoding,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};if(this.image!==void 0){var i=this.image;if(i.uuid===void 0&&(i.uuid=Xe.generateUUID()),!t&&e.images[i.uuid]===void 0){if(Array.isArray(i))for(var r=[],o=0,s=i.length;o<s;o++)r.push(Ri.getDataURL(i[o]));else r=Ri.getDataURL(i);e.images[i.uuid]={uuid:i.uuid,url:r}}n.image=i.uuid}return t||(e.textures[this.uuid]=n),n},dispose:function(){this.dispatchEvent({type:"dispose"})},transformUv:function(e){if(this.mapping!==300)return e;if(e.applyMatrix3(this.matrix),0>e.x||1<e.x)switch(this.wrapS){case 1e3:e.x-=Math.floor(e.x);break;case 1001:e.x=0>e.x?0:1;break;case 1002:e.x=Math.abs(Math.floor(e.x)%2)===1?Math.ceil(e.x)-e.x:e.x-Math.floor(e.x)}if(0>e.y||1<e.y)switch(this.wrapT){case 1e3:e.y-=Math.floor(e.y);break;case 1001:e.y=0>e.y?0:1;break;case 1002:e.y=Math.abs(Math.floor(e.y)%2)===1?Math.ceil(e.y)-e.y:e.y-Math.floor(e.y)}return this.flipY&&(e.y=1-e.y),e}}),Object.defineProperty(Ae.prototype,"needsUpdate",{set:function(e){e===!0&&this.version++}}),Object.defineProperties(_e.prototype,{width:{get:function(){return this.z},set:function(e){this.z=e}},height:{get:function(){return this.w},set:function(e){this.w=e}}}),Object.assign(_e.prototype,{isVector4:!0,set:function(e,t,n,i){return this.x=e,this.y=t,this.z=n,this.w=i,this},setScalar:function(e){return this.w=this.z=this.y=this.x=e,this},setX:function(e){return this.x=e,this},setY:function(e){return this.y=e,this},setZ:function(e){return this.z=e,this},setW:function(e){return this.w=e,this},setComponent:function(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw Error("index is out of range: "+e)}return this},getComponent:function(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw Error("index is out of range: "+e)}},clone:function(){return new this.constructor(this.x,this.y,this.z,this.w)},copy:function(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w!==void 0?e.w:1,this},add:function(e,t){return t!==void 0?(console.warn("THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this)},addScalar:function(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this},addVectors:function(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this},addScaledVector:function(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this},sub:function(e,t){return t!==void 0?(console.warn("THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this)},subScalar:function(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this},subVectors:function(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this},multiplyScalar:function(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this},applyMatrix4:function(e){var t=this.x,n=this.y,i=this.z,r=this.w;return e=e.elements,this.x=e[0]*t+e[4]*n+e[8]*i+e[12]*r,this.y=e[1]*t+e[5]*n+e[9]*i+e[13]*r,this.z=e[2]*t+e[6]*n+e[10]*i+e[14]*r,this.w=e[3]*t+e[7]*n+e[11]*i+e[15]*r,this},divideScalar:function(e){return this.multiplyScalar(1/e)},setAxisAngleFromQuaternion:function(e){this.w=2*Math.acos(e.w);var t=Math.sqrt(1-e.w*e.w);return 1e-4>t?(this.x=1,this.z=this.y=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this},setAxisAngleFromRotationMatrix:function(e){e=e.elements;var t=e[0],n=e[4],i=e[8],r=e[1],o=e[5],s=e[9],a=e[2],c=e[6],u=e[10];return .01>Math.abs(n-r)&&.01>Math.abs(i-a)&&.01>Math.abs(s-c)?.1>Math.abs(n+r)&&.1>Math.abs(i+a)&&.1>Math.abs(s+c)&&.1>Math.abs(t+o+u-3)?(this.set(1,0,0,0),this):(e=Math.PI,t=(t+1)/2,o=(o+1)/2,u=(u+1)/2,n=(n+r)/4,i=(i+a)/4,s=(s+c)/4,t>o&&t>u?.01>t?(c=0,n=a=.707106781):(c=Math.sqrt(t),a=n/c,n=i/c):o>u?.01>o?(c=.707106781,a=0,n=.707106781):(a=Math.sqrt(o),c=n/a,n=s/a):.01>u?(a=c=.707106781,n=0):(n=Math.sqrt(u),c=i/n,a=s/n),this.set(c,a,n,e),this):(e=Math.sqrt((c-s)*(c-s)+(i-a)*(i-a)+(r-n)*(r-n)),.001>Math.abs(e)&&(e=1),this.x=(c-s)/e,this.y=(i-a)/e,this.z=(r-n)/e,this.w=Math.acos((t+o+u-1)/2),this)},min:function(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this},max:function(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this},clamp:function(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this.w=Math.max(e.w,Math.min(t.w,this.w)),this},clampScalar:function(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this.w=Math.max(e,Math.min(t,this.w)),this},clampLength:function(e,t){var n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this},roundToZero:function(){return this.x=0>this.x?Math.ceil(this.x):Math.floor(this.x),this.y=0>this.y?Math.ceil(this.y):Math.floor(this.y),this.z=0>this.z?Math.ceil(this.z):Math.floor(this.z),this.w=0>this.w?Math.ceil(this.w):Math.floor(this.w),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this},dot:function(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)},normalize:function(){return this.divideScalar(this.length()||1)},setLength:function(e){return this.normalize().multiplyScalar(e)},lerp:function(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this},lerpVectors:function(e,t,n){return this.subVectors(t,e).multiplyScalar(n).add(e)},equals:function(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w},fromArray:function(e,t){return t===void 0&&(t=0),this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this},toArray:function(e,t){return e===void 0&&(e=[]),t===void 0&&(t=0),e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e},fromBufferAttribute:function(e,t,n){return n!==void 0&&console.warn("THREE.Vector4: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}}),je.prototype=Object.assign(Object.create(w.prototype),{constructor:je,isWebGLRenderTarget:!0,setSize:function(e,t){(this.width!==e||this.height!==t)&&(this.width=e,this.height=t,this.texture.image.width=e,this.texture.image.height=t,this.dispose()),this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)},clone:function(){return new this.constructor().copy(this)},copy:function(e){return this.width=e.width,this.height=e.height,this.viewport.copy(e.viewport),this.texture=e.texture.clone(),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,this.depthTexture=e.depthTexture,this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),Ve.prototype=Object.assign(Object.create(je.prototype),{constructor:Ve,isWebGLMultisampleRenderTarget:!0,copy:function(e){return je.prototype.copy.call(this,e),this.samples=e.samples,this}});var ln=new E,Tn=new Se,nh=new E(0,0,0),ih=new E(1,1,1),Di=new E,wa=new E,un=new E;Object.assign(Se.prototype,{isMatrix4:!0,set:function(e,t,n,i,r,o,s,a,c,u,h,p,v,x,y,M){var L=this.elements;return L[0]=e,L[4]=t,L[8]=n,L[12]=i,L[1]=r,L[5]=o,L[9]=s,L[13]=a,L[2]=c,L[6]=u,L[10]=h,L[14]=p,L[3]=v,L[7]=x,L[11]=y,L[15]=M,this},identity:function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this},clone:function(){return new Se().fromArray(this.elements)},copy:function(e){var t=this.elements;return e=e.elements,t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],this},copyPosition:function(e){var t=this.elements;return e=e.elements,t[12]=e[12],t[13]=e[13],t[14]=e[14],this},extractBasis:function(e,t,n){return e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),n.setFromMatrixColumn(this,2),this},makeBasis:function(e,t,n){return this.set(e.x,t.x,n.x,0,e.y,t.y,n.y,0,e.z,t.z,n.z,0,0,0,0,1),this},extractRotation:function(e){var t=this.elements,n=e.elements,i=1/ln.setFromMatrixColumn(e,0).length(),r=1/ln.setFromMatrixColumn(e,1).length();return e=1/ln.setFromMatrixColumn(e,2).length(),t[0]=n[0]*i,t[1]=n[1]*i,t[2]=n[2]*i,t[3]=0,t[4]=n[4]*r,t[5]=n[5]*r,t[6]=n[6]*r,t[7]=0,t[8]=n[8]*e,t[9]=n[9]*e,t[10]=n[10]*e,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this},makeRotationFromEuler:function(e){e&&e.isEuler||console.error("THREE.Matrix4: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.");var t=this.elements,n=e.x,i=e.y,r=e.z,o=Math.cos(n);n=Math.sin(n);var s=Math.cos(i);i=Math.sin(i);var a=Math.cos(r);if(r=Math.sin(r),e.order==="XYZ"){e=o*a;var c=o*r,u=n*a,h=n*r;t[0]=s*a,t[4]=-s*r,t[8]=i,t[1]=c+u*i,t[5]=e-h*i,t[9]=-n*s,t[2]=h-e*i,t[6]=u+c*i,t[10]=o*s}else e.order==="YXZ"?(e=s*a,c=s*r,u=i*a,h=i*r,t[0]=e+h*n,t[4]=u*n-c,t[8]=o*i,t[1]=o*r,t[5]=o*a,t[9]=-n,t[2]=c*n-u,t[6]=h+e*n,t[10]=o*s):e.order==="ZXY"?(e=s*a,c=s*r,u=i*a,h=i*r,t[0]=e-h*n,t[4]=-o*r,t[8]=u+c*n,t[1]=c+u*n,t[5]=o*a,t[9]=h-e*n,t[2]=-o*i,t[6]=n,t[10]=o*s):e.order==="ZYX"?(e=o*a,c=o*r,u=n*a,h=n*r,t[0]=s*a,t[4]=u*i-c,t[8]=e*i+h,t[1]=s*r,t[5]=h*i+e,t[9]=c*i-u,t[2]=-i,t[6]=n*s,t[10]=o*s):e.order==="YZX"?(e=o*s,c=o*i,u=n*s,h=n*i,t[0]=s*a,t[4]=h-e*r,t[8]=u*r+c,t[1]=r,t[5]=o*a,t[9]=-n*a,t[2]=-i*a,t[6]=c*r+u,t[10]=e-h*r):e.order==="XZY"&&(e=o*s,c=o*i,u=n*s,h=n*i,t[0]=s*a,t[4]=-r,t[8]=i*a,t[1]=e*r+h,t[5]=o*a,t[9]=c*r-u,t[2]=u*r-c,t[6]=n*a,t[10]=h*r+e);return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this},makeRotationFromQuaternion:function(e){return this.compose(nh,e,ih)},lookAt:function(e,t,n){var i=this.elements;return un.subVectors(e,t),un.lengthSq()===0&&(un.z=1),un.normalize(),Di.crossVectors(n,un),Di.lengthSq()===0&&(Math.abs(n.z)===1?un.x+=1e-4:un.z+=1e-4,un.normalize(),Di.crossVectors(n,un)),Di.normalize(),wa.crossVectors(un,Di),i[0]=Di.x,i[4]=wa.x,i[8]=un.x,i[1]=Di.y,i[5]=wa.y,i[9]=un.y,i[2]=Di.z,i[6]=wa.z,i[10]=un.z,this},multiply:function(e,t){return t!==void 0?(console.warn("THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(e,t)):this.multiplyMatrices(this,e)},premultiply:function(e){return this.multiplyMatrices(e,this)},multiplyMatrices:function(e,t){var n=e.elements,i=t.elements;t=this.elements,e=n[0];var r=n[4],o=n[8],s=n[12],a=n[1],c=n[5],u=n[9],h=n[13],p=n[2],v=n[6],x=n[10],y=n[14],M=n[3],L=n[7],O=n[11];n=n[15];var F=i[0],z=i[4],V=i[8],B=i[12],Y=i[1],Z=i[5],fe=i[9],X=i[13],j=i[2],J=i[6],te=i[10],ze=i[14],We=i[3],_=i[7],b=i[11];return i=i[15],t[0]=e*F+r*Y+o*j+s*We,t[4]=e*z+r*Z+o*J+s*_,t[8]=e*V+r*fe+o*te+s*b,t[12]=e*B+r*X+o*ze+s*i,t[1]=a*F+c*Y+u*j+h*We,t[5]=a*z+c*Z+u*J+h*_,t[9]=a*V+c*fe+u*te+h*b,t[13]=a*B+c*X+u*ze+h*i,t[2]=p*F+v*Y+x*j+y*We,t[6]=p*z+v*Z+x*J+y*_,t[10]=p*V+v*fe+x*te+y*b,t[14]=p*B+v*X+x*ze+y*i,t[3]=M*F+L*Y+O*j+n*We,t[7]=M*z+L*Z+O*J+n*_,t[11]=M*V+L*fe+O*te+n*b,t[15]=M*B+L*X+O*ze+n*i,this},multiplyScalar:function(e){var t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this},applyToBufferAttribute:function(e){for(var t=0,n=e.count;t<n;t++)ln.x=e.getX(t),ln.y=e.getY(t),ln.z=e.getZ(t),ln.applyMatrix4(this),e.setXYZ(t,ln.x,ln.y,ln.z);return e},determinant:function(){var e=this.elements,t=e[0],n=e[4],i=e[8],r=e[12],o=e[1],s=e[5],a=e[9],c=e[13],u=e[2],h=e[6],p=e[10],v=e[14];return e[3]*(+r*a*h-i*c*h-r*s*p+n*c*p+i*s*v-n*a*v)+e[7]*(+t*a*v-t*c*p+r*o*p-i*o*v+i*c*u-r*a*u)+e[11]*(+t*c*h-t*s*v-r*o*h+n*o*v+r*s*u-n*c*u)+e[15]*(-i*s*u-t*a*h+t*s*p+i*o*h-n*o*p+n*a*u)},transpose:function(){var e=this.elements,t=e[1];return e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this},setPosition:function(e,t,n){var i=this.elements;return e.isVector3?(i[12]=e.x,i[13]=e.y,i[14]=e.z):(i[12]=e,i[13]=t,i[14]=n),this},getInverse:function(e,t){var n=this.elements,i=e.elements;e=i[0];var r=i[1],o=i[2],s=i[3],a=i[4],c=i[5],u=i[6],h=i[7],p=i[8],v=i[9],x=i[10],y=i[11],M=i[12],L=i[13],O=i[14];i=i[15];var F=v*O*h-L*x*h+L*u*y-c*O*y-v*u*i+c*x*i,z=M*x*h-p*O*h-M*u*y+a*O*y+p*u*i-a*x*i,V=p*L*h-M*v*h+M*c*y-a*L*y-p*c*i+a*v*i,B=M*v*u-p*L*u-M*c*x+a*L*x+p*c*O-a*v*O,Y=e*F+r*z+o*V+s*B;if(Y===0){if(t===!0)throw Error("THREE.Matrix4: .getInverse() can't invert matrix, determinant is 0");return console.warn("THREE.Matrix4: .getInverse() can't invert matrix, determinant is 0"),this.identity()}return t=1/Y,n[0]=F*t,n[1]=(L*x*s-v*O*s-L*o*y+r*O*y+v*o*i-r*x*i)*t,n[2]=(c*O*s-L*u*s+L*o*h-r*O*h-c*o*i+r*u*i)*t,n[3]=(v*u*s-c*x*s-v*o*h+r*x*h+c*o*y-r*u*y)*t,n[4]=z*t,n[5]=(p*O*s-M*x*s+M*o*y-e*O*y-p*o*i+e*x*i)*t,n[6]=(M*u*s-a*O*s-M*o*h+e*O*h+a*o*i-e*u*i)*t,n[7]=(a*x*s-p*u*s+p*o*h-e*x*h-a*o*y+e*u*y)*t,n[8]=V*t,n[9]=(M*v*s-p*L*s-M*r*y+e*L*y+p*r*i-e*v*i)*t,n[10]=(a*L*s-M*c*s+M*r*h-e*L*h-a*r*i+e*c*i)*t,n[11]=(p*c*s-a*v*s-p*r*h+e*v*h+a*r*y-e*c*y)*t,n[12]=B*t,n[13]=(p*L*o-M*v*o+M*r*x-e*L*x-p*r*O+e*v*O)*t,n[14]=(M*c*o-a*L*o-M*r*u+e*L*u+a*r*O-e*c*O)*t,n[15]=(a*v*o-p*c*o+p*r*u-e*v*u-a*r*x+e*c*x)*t,this},scale:function(e){var t=this.elements,n=e.x,i=e.y;return e=e.z,t[0]*=n,t[4]*=i,t[8]*=e,t[1]*=n,t[5]*=i,t[9]*=e,t[2]*=n,t[6]*=i,t[10]*=e,t[3]*=n,t[7]*=i,t[11]*=e,this},getMaxScaleOnAxis:function(){var e=this.elements;return Math.sqrt(Math.max(e[0]*e[0]+e[1]*e[1]+e[2]*e[2],e[4]*e[4]+e[5]*e[5]+e[6]*e[6],e[8]*e[8]+e[9]*e[9]+e[10]*e[10]))},makeTranslation:function(e,t,n){return this.set(1,0,0,e,0,1,0,t,0,0,1,n,0,0,0,1),this},makeRotationX:function(e){var t=Math.cos(e);return e=Math.sin(e),this.set(1,0,0,0,0,t,-e,0,0,e,t,0,0,0,0,1),this},makeRotationY:function(e){var t=Math.cos(e);return e=Math.sin(e),this.set(t,0,e,0,0,1,0,0,-e,0,t,0,0,0,0,1),this},makeRotationZ:function(e){var t=Math.cos(e);return e=Math.sin(e),this.set(t,-e,0,0,e,t,0,0,0,0,1,0,0,0,0,1),this},makeRotationAxis:function(e,t){var n=Math.cos(t);t=Math.sin(t);var i=1-n,r=e.x,o=e.y;e=e.z;var s=i*r,a=i*o;return this.set(s*r+n,s*o-t*e,s*e+t*o,0,s*o+t*e,a*o+n,a*e-t*r,0,s*e-t*o,a*e+t*r,i*e*e+n,0,0,0,0,1),this},makeScale:function(e,t,n){return this.set(e,0,0,0,0,t,0,0,0,0,n,0,0,0,0,1),this},makeShear:function(e,t,n){return this.set(1,t,n,0,e,1,n,0,e,t,1,0,0,0,0,1),this},compose:function(e,t,n){var i=this.elements,r=t._x,o=t._y,s=t._z,a=t._w,c=r+r,u=o+o,h=s+s;t=r*c;var p=r*u;r*=h;var v=o*u;o*=h,s*=h,c*=a,u*=a,a*=h,h=n.x;var x=n.y;return n=n.z,i[0]=(1-(v+s))*h,i[1]=(p+a)*h,i[2]=(r-u)*h,i[3]=0,i[4]=(p-a)*x,i[5]=(1-(t+s))*x,i[6]=(o+c)*x,i[7]=0,i[8]=(r+u)*n,i[9]=(o-c)*n,i[10]=(1-(t+v))*n,i[11]=0,i[12]=e.x,i[13]=e.y,i[14]=e.z,i[15]=1,this},decompose:function(e,t,n){var i=this.elements,r=ln.set(i[0],i[1],i[2]).length(),o=ln.set(i[4],i[5],i[6]).length(),s=ln.set(i[8],i[9],i[10]).length();0>this.determinant()&&(r=-r),e.x=i[12],e.y=i[13],e.z=i[14],Tn.copy(this),e=1/r,i=1/o;var a=1/s;return Tn.elements[0]*=e,Tn.elements[1]*=e,Tn.elements[2]*=e,Tn.elements[4]*=i,Tn.elements[5]*=i,Tn.elements[6]*=i,Tn.elements[8]*=a,Tn.elements[9]*=a,Tn.elements[10]*=a,t.setFromRotationMatrix(Tn),n.x=r,n.y=o,n.z=s,this},makePerspective:function(e,t,n,i,r,o){o===void 0&&console.warn("THREE.Matrix4: .makePerspective() has been redefined and has a new signature. Please check the docs.");var s=this.elements;return s[0]=2*r/(t-e),s[4]=0,s[8]=(t+e)/(t-e),s[12]=0,s[1]=0,s[5]=2*r/(n-i),s[9]=(n+i)/(n-i),s[13]=0,s[2]=0,s[6]=0,s[10]=-(o+r)/(o-r),s[14]=-2*o*r/(o-r),s[3]=0,s[7]=0,s[11]=-1,s[15]=0,this},makeOrthographic:function(e,t,n,i,r,o){var s=this.elements,a=1/(t-e),c=1/(n-i),u=1/(o-r);return s[0]=2*a,s[4]=0,s[8]=0,s[12]=-((t+e)*a),s[1]=0,s[5]=2*c,s[9]=0,s[13]=-((n+i)*c),s[2]=0,s[6]=0,s[10]=-2*u,s[14]=-((o+r)*u),s[3]=0,s[7]=0,s[11]=0,s[15]=1,this},equals:function(e){var t=this.elements;e=e.elements;for(var n=0;16>n;n++)if(t[n]!==e[n])return!1;return!0},fromArray:function(e,t){t===void 0&&(t=0);for(var n=0;16>n;n++)this.elements[n]=e[n+t];return this},toArray:function(e,t){e===void 0&&(e=[]),t===void 0&&(t=0);var n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e[t+9]=n[9],e[t+10]=n[10],e[t+11]=n[11],e[t+12]=n[12],e[t+13]=n[13],e[t+14]=n[14],e[t+15]=n[15],e}});var Xl=new Se,Ql=new we;ht.RotationOrders="XYZ YZX ZXY XZY YXZ ZYX".split(" "),ht.DefaultOrder="XYZ",Object.defineProperties(ht.prototype,{x:{get:function(){return this._x},set:function(e){this._x=e,this._onChangeCallback()}},y:{get:function(){return this._y},set:function(e){this._y=e,this._onChangeCallback()}},z:{get:function(){return this._z},set:function(e){this._z=e,this._onChangeCallback()}},order:{get:function(){return this._order},set:function(e){this._order=e,this._onChangeCallback()}}}),Object.assign(ht.prototype,{isEuler:!0,set:function(e,t,n,i){return this._x=e,this._y=t,this._z=n,this._order=i||this._order,this._onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._order)},copy:function(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this},setFromRotationMatrix:function(e,t,n){var i=Xe.clamp,r=e.elements;e=r[0];var o=r[4],s=r[8],a=r[1],c=r[5],u=r[9],h=r[2],p=r[6];return r=r[10],t=t||this._order,t==="XYZ"?(this._y=Math.asin(i(s,-1,1)),.9999999>Math.abs(s)?(this._x=Math.atan2(-u,r),this._z=Math.atan2(-o,e)):(this._x=Math.atan2(p,c),this._z=0)):t==="YXZ"?(this._x=Math.asin(-i(u,-1,1)),.9999999>Math.abs(u)?(this._y=Math.atan2(s,r),this._z=Math.atan2(a,c)):(this._y=Math.atan2(-h,e),this._z=0)):t==="ZXY"?(this._x=Math.asin(i(p,-1,1)),.9999999>Math.abs(p)?(this._y=Math.atan2(-h,r),this._z=Math.atan2(-o,c)):(this._y=0,this._z=Math.atan2(a,e))):t==="ZYX"?(this._y=Math.asin(-i(h,-1,1)),.9999999>Math.abs(h)?(this._x=Math.atan2(p,r),this._z=Math.atan2(a,e)):(this._x=0,this._z=Math.atan2(-o,c))):t==="YZX"?(this._z=Math.asin(i(a,-1,1)),.9999999>Math.abs(a)?(this._x=Math.atan2(-u,c),this._y=Math.atan2(-h,e)):(this._x=0,this._y=Math.atan2(s,r))):t==="XZY"?(this._z=Math.asin(-i(o,-1,1)),.9999999>Math.abs(o)?(this._x=Math.atan2(p,c),this._y=Math.atan2(s,e)):(this._x=Math.atan2(-u,r),this._y=0)):console.warn("THREE.Euler: .setFromRotationMatrix() given unsupported order: "+t),this._order=t,n!==!1&&this._onChangeCallback(),this},setFromQuaternion:function(e,t,n){return Xl.makeRotationFromQuaternion(e),this.setFromRotationMatrix(Xl,t,n)},setFromVector3:function(e,t){return this.set(e.x,e.y,e.z,t||this._order)},reorder:function(e){return Ql.setFromEuler(this),this.setFromQuaternion(Ql,e)},equals:function(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order},fromArray:function(e){return this._x=e[0],this._y=e[1],this._z=e[2],e[3]!==void 0&&(this._order=e[3]),this._onChangeCallback(),this},toArray:function(e,t){return e===void 0&&(e=[]),t===void 0&&(t=0),e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._order,e},toVector3:function(e){return e?e.set(this._x,this._y,this._z):new E(this._x,this._y,this._z)},_onChange:function(e){return this._onChangeCallback=e,this},_onChangeCallback:function(){}}),Object.assign(Re.prototype,{set:function(e){this.mask=1<<e|0},enable:function(e){this.mask=this.mask|1<<e|0},enableAll:function(){this.mask=-1},toggle:function(e){this.mask^=1<<e|0},disable:function(e){this.mask&=~(1<<e|0)},disableAll:function(){this.mask=0},test:function(e){return(this.mask&e.mask)!==0}});var rh=0,ql=new E,io=new we,ui=new Se,Aa=new E,ls=new E,oh=new E,sh=new we,Zl=new E(1,0,0),Kl=new E(0,1,0),Jl=new E(0,0,1),ah={type:"added"},ch={type:"removed"};W.DefaultUp=new E(0,1,0),W.DefaultMatrixAutoUpdate=!0,W.prototype=Object.assign(Object.create(w.prototype),{constructor:W,isObject3D:!0,onBeforeRender:function(){},onAfterRender:function(){},applyMatrix:function(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)},applyQuaternion:function(e){return this.quaternion.premultiply(e),this},setRotationFromAxisAngle:function(e,t){this.quaternion.setFromAxisAngle(e,t)},setRotationFromEuler:function(e){this.quaternion.setFromEuler(e,!0)},setRotationFromMatrix:function(e){this.quaternion.setFromRotationMatrix(e)},setRotationFromQuaternion:function(e){this.quaternion.copy(e)},rotateOnAxis:function(e,t){return io.setFromAxisAngle(e,t),this.quaternion.multiply(io),this},rotateOnWorldAxis:function(e,t){return io.setFromAxisAngle(e,t),this.quaternion.premultiply(io),this},rotateX:function(e){return this.rotateOnAxis(Zl,e)},rotateY:function(e){return this.rotateOnAxis(Kl,e)},rotateZ:function(e){return this.rotateOnAxis(Jl,e)},translateOnAxis:function(e,t){return ql.copy(e).applyQuaternion(this.quaternion),this.position.add(ql.multiplyScalar(t)),this},translateX:function(e){return this.translateOnAxis(Zl,e)},translateY:function(e){return this.translateOnAxis(Kl,e)},translateZ:function(e){return this.translateOnAxis(Jl,e)},localToWorld:function(e){return e.applyMatrix4(this.matrixWorld)},worldToLocal:function(e){return e.applyMatrix4(ui.getInverse(this.matrixWorld))},lookAt:function(e,t,n){e.isVector3?Aa.copy(e):Aa.set(e,t,n),e=this.parent,this.updateWorldMatrix(!0,!1),ls.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?ui.lookAt(ls,Aa,this.up):ui.lookAt(Aa,ls,this.up),this.quaternion.setFromRotationMatrix(ui),e&&(ui.extractRotation(e.matrixWorld),io.setFromRotationMatrix(ui),this.quaternion.premultiply(io.inverse()))},add:function(e){if(1<arguments.length){for(var t=0;t<arguments.length;t++)this.add(arguments[t]);return this}return e===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(e.parent!==null&&e.parent.remove(e),e.parent=this,this.children.push(e),e.dispatchEvent(ah)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e),this)},remove:function(e){if(1<arguments.length){for(var t=0;t<arguments.length;t++)this.remove(arguments[t]);return this}return t=this.children.indexOf(e),t!==-1&&(e.parent=null,this.children.splice(t,1),e.dispatchEvent(ch)),this},attach:function(e){return this.updateWorldMatrix(!0,!1),ui.getInverse(this.matrixWorld),e.parent!==null&&(e.parent.updateWorldMatrix(!0,!1),ui.multiply(e.parent.matrixWorld)),e.applyMatrix(ui),e.updateWorldMatrix(!1,!1),this.add(e),this},getObjectById:function(e){return this.getObjectByProperty("id",e)},getObjectByName:function(e){return this.getObjectByProperty("name",e)},getObjectByProperty:function(e,t){if(this[e]===t)return this;for(var n=0,i=this.children.length;n<i;n++){var r=this.children[n].getObjectByProperty(e,t);if(r!==void 0)return r}},getWorldPosition:function(e){return e===void 0&&(console.warn("THREE.Object3D: .getWorldPosition() target is now required"),e=new E),this.updateMatrixWorld(!0),e.setFromMatrixPosition(this.matrixWorld)},getWorldQuaternion:function(e){return e===void 0&&(console.warn("THREE.Object3D: .getWorldQuaternion() target is now required"),e=new we),this.updateMatrixWorld(!0),this.matrixWorld.decompose(ls,e,oh),e},getWorldScale:function(e){return e===void 0&&(console.warn("THREE.Object3D: .getWorldScale() target is now required"),e=new E),this.updateMatrixWorld(!0),this.matrixWorld.decompose(ls,sh,e),e},getWorldDirection:function(e){e===void 0&&(console.warn("THREE.Object3D: .getWorldDirection() target is now required"),e=new E),this.updateMatrixWorld(!0);var t=this.matrixWorld.elements;return e.set(t[8],t[9],t[10]).normalize()},raycast:function(){},traverse:function(e){e(this);for(var t=this.children,n=0,i=t.length;n<i;n++)t[n].traverse(e)},traverseVisible:function(e){if(this.visible!==!1){e(this);for(var t=this.children,n=0,i=t.length;n<i;n++)t[n].traverseVisible(e)}},traverseAncestors:function(e){var t=this.parent;t!==null&&(e(t),t.traverseAncestors(e))},updateMatrix:function(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0},updateMatrixWorld:function(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,e=!0);for(var t=this.children,n=0,i=t.length;n<i;n++)t[n].updateMatrixWorld(e)},updateWorldMatrix:function(e,t){var n=this.parent;if(e===!0&&n!==null&&n.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),t===!0)for(e=this.children,t=0,n=e.length;t<n;t++)e[t].updateWorldMatrix(!1,!0)},toJSON:function(e){function t(h,p){return h[p.uuid]===void 0&&(h[p.uuid]=p.toJSON(e)),p.uuid}function n(h){var p=[],v;for(v in h){var x=h[v];delete x.metadata,p.push(x)}return p}var i=e===void 0||typeof e=="string",r={};i&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{}},r.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});var o={};if(o.uuid=this.uuid,o.type=this.type,this.name!==""&&(o.name=this.name),this.castShadow===!0&&(o.castShadow=!0),this.receiveShadow===!0&&(o.receiveShadow=!0),this.visible===!1&&(o.visible=!1),this.frustumCulled===!1&&(o.frustumCulled=!1),this.renderOrder!==0&&(o.renderOrder=this.renderOrder),JSON.stringify(this.userData)!=="{}"&&(o.userData=this.userData),o.layers=this.layers.mask,o.matrix=this.matrix.toArray(),this.matrixAutoUpdate===!1&&(o.matrixAutoUpdate=!1),this.isMesh&&this.drawMode!==0&&(o.drawMode=this.drawMode),this.isMesh||this.isLine||this.isPoints){o.geometry=t(e.geometries,this.geometry);var s=this.geometry.parameters;if(s!==void 0&&s.shapes!==void 0)if(s=s.shapes,Array.isArray(s))for(var a=0,c=s.length;a<c;a++)t(e.shapes,s[a]);else t(e.shapes,s)}if(this.material!==void 0)if(Array.isArray(this.material)){for(s=[],a=0,c=this.material.length;a<c;a++)s.push(t(e.materials,this.material[a]));o.material=s}else o.material=t(e.materials,this.material);if(0<this.children.length)for(o.children=[],a=0;a<this.children.length;a++)o.children.push(this.children[a].toJSON(e).object);if(i){i=n(e.geometries),a=n(e.materials),c=n(e.textures);var u=n(e.images);s=n(e.shapes),0<i.length&&(r.geometries=i),0<a.length&&(r.materials=a),0<c.length&&(r.textures=c),0<u.length&&(r.images=u),0<s.length&&(r.shapes=s)}return r.object=o,r},clone:function(e){return new this.constructor().copy(this,e)},copy:function(e,t){if(t===void 0&&(t=!0),this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.userData=JSON.parse(JSON.stringify(e.userData)),t===!0)for(t=0;t<e.children.length;t++)this.add(e.children[t].clone());return this}}),It.prototype=Object.assign(Object.create(W.prototype),{constructor:It,isScene:!0,copy:function(e,t){return W.prototype.copy.call(this,e,t),e.background!==null&&(this.background=e.background.clone()),e.fog!==null&&(this.fog=e.fog.clone()),e.overrideMaterial!==null&&(this.overrideMaterial=e.overrideMaterial.clone()),this.autoUpdate=e.autoUpdate,this.matrixAutoUpdate=e.matrixAutoUpdate,this},toJSON:function(e){var t=W.prototype.toJSON.call(this,e);return this.background!==null&&(t.object.background=this.background.toJSON(e)),this.fog!==null&&(t.object.fog=this.fog.toJSON()),t},dispose:function(){this.dispatchEvent({type:"dispose"})}});var hi=[new E,new E,new E,new E,new E,new E,new E,new E],Wn=new E,ro=new E,oo=new E,so=new E,Bi=new E,Ii=new E,lr=new E,us=new E,Ma=new E,Ea=new E,ur=new E;Object.assign(pe.prototype,{isBox3:!0,set:function(e,t){return this.min.copy(e),this.max.copy(t),this},setFromArray:function(e){for(var t=1/0,n=1/0,i=1/0,r=-1/0,o=-1/0,s=-1/0,a=0,c=e.length;a<c;a+=3){var u=e[a],h=e[a+1],p=e[a+2];u<t&&(t=u),h<n&&(n=h),p<i&&(i=p),u>r&&(r=u),h>o&&(o=h),p>s&&(s=p)}return this.min.set(t,n,i),this.max.set(r,o,s),this},setFromBufferAttribute:function(e){for(var t=1/0,n=1/0,i=1/0,r=-1/0,o=-1/0,s=-1/0,a=0,c=e.count;a<c;a++){var u=e.getX(a),h=e.getY(a),p=e.getZ(a);u<t&&(t=u),h<n&&(n=h),p<i&&(i=p),u>r&&(r=u),h>o&&(o=h),p>s&&(s=p)}return this.min.set(t,n,i),this.max.set(r,o,s),this},setFromPoints:function(e){this.makeEmpty();for(var t=0,n=e.length;t<n;t++)this.expandByPoint(e[t]);return this},setFromCenterAndSize:function(e,t){return t=Wn.copy(t).multiplyScalar(.5),this.min.copy(e).sub(t),this.max.copy(e).add(t),this},setFromObject:function(e){return this.makeEmpty(),this.expandByObject(e)},clone:function(){return new this.constructor().copy(this)},copy:function(e){return this.min.copy(e.min),this.max.copy(e.max),this},makeEmpty:function(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z},getCenter:function(e){return e===void 0&&(console.warn("THREE.Box3: .getCenter() target is now required"),e=new E),this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)},getSize:function(e){return e===void 0&&(console.warn("THREE.Box3: .getSize() target is now required"),e=new E),this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)},expandByPoint:function(e){return this.min.min(e),this.max.max(e),this},expandByVector:function(e){return this.min.sub(e),this.max.add(e),this},expandByScalar:function(e){return this.min.addScalar(-e),this.max.addScalar(e),this},expandByObject:function(e){var t;e.updateWorldMatrix(!1,!1);var n=e.geometry;if(n!==void 0){if(n.isGeometry){var i=n.vertices;for(n=0,t=i.length;n<t;n++)Wn.copy(i[n]),Wn.applyMatrix4(e.matrixWorld),this.expandByPoint(Wn)}else if(n.isBufferGeometry&&(i=n.attributes.position,i!==void 0))for(n=0,t=i.count;n<t;n++)Wn.fromBufferAttribute(i,n).applyMatrix4(e.matrixWorld),this.expandByPoint(Wn)}for(e=e.children,n=0,t=e.length;n<t;n++)this.expandByObject(e[n]);return this},containsPoint:function(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y||e.z<this.min.z||e.z>this.max.z)},containsBox:function(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z},getParameter:function(e,t){return t===void 0&&(console.warn("THREE.Box3: .getParameter() target is now required"),t=new E),t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))},intersectsBox:function(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y||e.max.z<this.min.z||e.min.z>this.max.z)},intersectsSphere:function(e){return this.clampPoint(e.center,Wn),Wn.distanceToSquared(e.center)<=e.radius*e.radius},intersectsPlane:function(e){if(0<e.normal.x)var t=e.normal.x*this.min.x,n=e.normal.x*this.max.x;else t=e.normal.x*this.max.x,n=e.normal.x*this.min.x;return 0<e.normal.y?(t+=e.normal.y*this.min.y,n+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,n+=e.normal.y*this.min.y),0<e.normal.z?(t+=e.normal.z*this.min.z,n+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,n+=e.normal.z*this.min.z),t<=-e.constant&&n>=-e.constant},intersectsTriangle:function(e){return this.isEmpty()||(this.getCenter(us),Ma.subVectors(this.max,us),ro.subVectors(e.a,us),oo.subVectors(e.b,us),so.subVectors(e.c,us),Bi.subVectors(oo,ro),Ii.subVectors(so,oo),lr.subVectors(ro,so),e=[0,-Bi.z,Bi.y,0,-Ii.z,Ii.y,0,-lr.z,lr.y,Bi.z,0,-Bi.x,Ii.z,0,-Ii.x,lr.z,0,-lr.x,-Bi.y,Bi.x,0,-Ii.y,Ii.x,0,-lr.y,lr.x,0],!wi(e,ro,oo,so,Ma))||(e=[1,0,0,0,1,0,0,0,1],!wi(e,ro,oo,so,Ma))?!1:(Ea.crossVectors(Bi,Ii),e=[Ea.x,Ea.y,Ea.z],wi(e,ro,oo,so,Ma))},clampPoint:function(e,t){return t===void 0&&(console.warn("THREE.Box3: .clampPoint() target is now required"),t=new E),t.copy(e).clamp(this.min,this.max)},distanceToPoint:function(e){return Wn.copy(e).clamp(this.min,this.max).sub(e).length()},getBoundingSphere:function(e){return e===void 0&&console.error("THREE.Box3: .getBoundingSphere() target is now required"),this.getCenter(e.center),e.radius=.5*this.getSize(Wn).length(),e},intersect:function(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this},union:function(e){return this.min.min(e.min),this.max.max(e.max),this},applyMatrix4:function(e){return this.isEmpty()?this:(hi[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),hi[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),hi[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),hi[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),hi[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),hi[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),hi[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),hi[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(hi),this)},translate:function(e){return this.min.add(e),this.max.add(e),this},equals:function(e){return e.min.equals(this.min)&&e.max.equals(this.max)}});var lh=new pe;Object.assign(ye.prototype,{set:function(e,t){return this.center.copy(e),this.radius=t,this},setFromPoints:function(e,t){var n=this.center;t!==void 0?n.copy(t):lh.setFromPoints(e).getCenter(n);for(var i=t=0,r=e.length;i<r;i++)t=Math.max(t,n.distanceToSquared(e[i]));return this.radius=Math.sqrt(t),this},clone:function(){return new this.constructor().copy(this)},copy:function(e){return this.center.copy(e.center),this.radius=e.radius,this},empty:function(){return 0>=this.radius},containsPoint:function(e){return e.distanceToSquared(this.center)<=this.radius*this.radius},distanceToPoint:function(e){return e.distanceTo(this.center)-this.radius},intersectsSphere:function(e){var t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t},intersectsBox:function(e){return e.intersectsSphere(this)},intersectsPlane:function(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius},clampPoint:function(e,t){var n=this.center.distanceToSquared(e);return t===void 0&&(console.warn("THREE.Sphere: .clampPoint() target is now required"),t=new E),t.copy(e),n>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t},getBoundingBox:function(e){return e===void 0&&(console.warn("THREE.Sphere: .getBoundingBox() target is now required"),e=new pe),e.set(this.center,this.center),e.expandByScalar(this.radius),e},applyMatrix4:function(e){return this.center.applyMatrix4(e),this.radius*=e.getMaxScaleOnAxis(),this},translate:function(e){return this.center.add(e),this},equals:function(e){return e.center.equals(this.center)&&e.radius===this.radius}});var di=new E,kc=new E,Sa=new E,Oi=new E,Yc=new E,Ta=new E,Xc=new E;Object.assign(de.prototype,{set:function(e,t){return this.origin.copy(e),this.direction.copy(t),this},clone:function(){return new this.constructor().copy(this)},copy:function(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this},at:function(e,t){return t===void 0&&(console.warn("THREE.Ray: .at() target is now required"),t=new E),t.copy(this.direction).multiplyScalar(e).add(this.origin)},lookAt:function(e){return this.direction.copy(e).sub(this.origin).normalize(),this},recast:function(e){return this.origin.copy(this.at(e,di)),this},closestPointToPoint:function(e,t){return t===void 0&&(console.warn("THREE.Ray: .closestPointToPoint() target is now required"),t=new E),t.subVectors(e,this.origin),e=t.dot(this.direction),0>e?t.copy(this.origin):t.copy(this.direction).multiplyScalar(e).add(this.origin)},distanceToPoint:function(e){return Math.sqrt(this.distanceSqToPoint(e))},distanceSqToPoint:function(e){var t=di.subVectors(e,this.origin).dot(this.direction);return 0>t?this.origin.distanceToSquared(e):(di.copy(this.direction).multiplyScalar(t).add(this.origin),di.distanceToSquared(e))},distanceSqToSegment:function(e,t,n,i){kc.copy(e).add(t).multiplyScalar(.5),Sa.copy(t).sub(e).normalize(),Oi.copy(this.origin).sub(kc);var r=.5*e.distanceTo(t),o=-this.direction.dot(Sa),s=Oi.dot(this.direction),a=-Oi.dot(Sa),c=Oi.lengthSq(),u=Math.abs(1-o*o);if(0<u){e=o*a-s,t=o*s-a;var h=r*u;0<=e?t>=-h?t<=h?(r=1/u,e*=r,t*=r,o=e*(e+o*t+2*s)+t*(o*e+t+2*a)+c):(t=r,e=Math.max(0,-(o*t+s)),o=-e*e+t*(t+2*a)+c):(t=-r,e=Math.max(0,-(o*t+s)),o=-e*e+t*(t+2*a)+c):t<=-h?(e=Math.max(0,-(-o*r+s)),t=0<e?-r:Math.min(Math.max(-r,-a),r),o=-e*e+t*(t+2*a)+c):t<=h?(e=0,t=Math.min(Math.max(-r,-a),r),o=t*(t+2*a)+c):(e=Math.max(0,-(o*r+s)),t=0<e?r:Math.min(Math.max(-r,-a),r),o=-e*e+t*(t+2*a)+c)}else t=0<o?-r:r,e=Math.max(0,-(o*t+s)),o=-e*e+t*(t+2*a)+c;return n&&n.copy(this.direction).multiplyScalar(e).add(this.origin),i&&i.copy(Sa).multiplyScalar(t).add(kc),o},intersectSphere:function(e,t){di.subVectors(e.center,this.origin);var n=di.dot(this.direction),i=di.dot(di)-n*n;return e=e.radius*e.radius,i>e?null:(e=Math.sqrt(e-i),i=n-e,n+=e,0>i&&0>n?null:0>i?this.at(n,t):this.at(i,t))},intersectsSphere:function(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius},distanceToPlane:function(e){var t=e.normal.dot(this.direction);return t===0?e.distanceToPoint(this.origin)===0?0:null:(e=-(this.origin.dot(e.normal)+e.constant)/t,0<=e?e:null)},intersectPlane:function(e,t){return e=this.distanceToPlane(e),e===null?null:this.at(e,t)},intersectsPlane:function(e){var t=e.distanceToPoint(this.origin);return t===0||0>e.normal.dot(this.direction)*t},intersectBox:function(e,t){var n=1/this.direction.x,i=1/this.direction.y,r=1/this.direction.z,o=this.origin;if(0<=n){var s=(e.min.x-o.x)*n;n*=e.max.x-o.x}else s=(e.max.x-o.x)*n,n*=e.min.x-o.x;if(0<=i){var a=(e.min.y-o.y)*i;i*=e.max.y-o.y}else a=(e.max.y-o.y)*i,i*=e.min.y-o.y;return s>i||a>n||((a>s||s!==s)&&(s=a),(i<n||n!==n)&&(n=i),0<=r?(a=(e.min.z-o.z)*r,e=(e.max.z-o.z)*r):(a=(e.max.z-o.z)*r,e=(e.min.z-o.z)*r),s>e||a>n)?null:((a>s||s!==s)&&(s=a),(e<n||n!==n)&&(n=e),0>n?null:this.at(0<=s?s:n,t))},intersectsBox:function(e){return this.intersectBox(e,di)!==null},intersectTriangle:function(e,t,n,i,r){if(Yc.subVectors(t,e),Ta.subVectors(n,e),Xc.crossVectors(Yc,Ta),t=this.direction.dot(Xc),0<t){if(i)return null;i=1}else if(0>t)i=-1,t=-t;else return null;return Oi.subVectors(this.origin,e),e=i*this.direction.dot(Ta.crossVectors(Oi,Ta)),0>e||(n=i*this.direction.dot(Yc.cross(Oi)),0>n||e+n>t)?null:(e=-i*Oi.dot(Xc),0>e?null:this.at(e/t,r))},applyMatrix4:function(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this},equals:function(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}});var _n=new E,pi=new E,Qc=new E,fi=new E,ao=new E,co=new E,$l=new E,qc=new E,Zc=new E,Kc=new E;Object.assign(lt,{getNormal:function(e,t,n,i){return i===void 0&&(console.warn("THREE.Triangle: .getNormal() target is now required"),i=new E),i.subVectors(n,t),_n.subVectors(e,t),i.cross(_n),e=i.lengthSq(),0<e?i.multiplyScalar(1/Math.sqrt(e)):i.set(0,0,0)},getBarycoord:function(e,t,n,i,r){_n.subVectors(i,t),pi.subVectors(n,t),Qc.subVectors(e,t),e=_n.dot(_n),t=_n.dot(pi),n=_n.dot(Qc);var o=pi.dot(pi);i=pi.dot(Qc);var s=e*o-t*t;return r===void 0&&(console.warn("THREE.Triangle: .getBarycoord() target is now required"),r=new E),s===0?r.set(-2,-1,-1):(s=1/s,o=(o*n-t*i)*s,e=(e*i-t*n)*s,r.set(1-o-e,e,o))},containsPoint:function(e,t,n,i){return lt.getBarycoord(e,t,n,i,fi),0<=fi.x&&0<=fi.y&&1>=fi.x+fi.y},getUV:function(e,t,n,i,r,o,s,a){return this.getBarycoord(e,t,n,i,fi),a.set(0,0),a.addScaledVector(r,fi.x),a.addScaledVector(o,fi.y),a.addScaledVector(s,fi.z),a},isFrontFacing:function(e,t,n,i){return _n.subVectors(n,t),pi.subVectors(e,t),0>_n.cross(pi).dot(i)}}),Object.assign(lt.prototype,{set:function(e,t,n){return this.a.copy(e),this.b.copy(t),this.c.copy(n),this},setFromPointsAndIndices:function(e,t,n,i){return this.a.copy(e[t]),this.b.copy(e[n]),this.c.copy(e[i]),this},clone:function(){return new this.constructor().copy(this)},copy:function(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this},getArea:function(){return _n.subVectors(this.c,this.b),pi.subVectors(this.a,this.b),.5*_n.cross(pi).length()},getMidpoint:function(e){return e===void 0&&(console.warn("THREE.Triangle: .getMidpoint() target is now required"),e=new E),e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)},getNormal:function(e){return lt.getNormal(this.a,this.b,this.c,e)},getPlane:function(e){return e===void 0&&(console.warn("THREE.Triangle: .getPlane() target is now required"),e=new E),e.setFromCoplanarPoints(this.a,this.b,this.c)},getBarycoord:function(e,t){return lt.getBarycoord(e,this.a,this.b,this.c,t)},getUV:function(e,t,n,i,r){return lt.getUV(e,this.a,this.b,this.c,t,n,i,r)},containsPoint:function(e){return lt.containsPoint(e,this.a,this.b,this.c)},isFrontFacing:function(e){return lt.isFrontFacing(this.a,this.b,this.c,e)},intersectsBox:function(e){return e.intersectsTriangle(this)},closestPointToPoint:function(e,t){t===void 0&&(console.warn("THREE.Triangle: .closestPointToPoint() target is now required"),t=new E);var n=this.a,i=this.b,r=this.c;ao.subVectors(i,n),co.subVectors(r,n),qc.subVectors(e,n);var o=ao.dot(qc),s=co.dot(qc);if(0>=o&&0>=s)return t.copy(n);Zc.subVectors(e,i);var a=ao.dot(Zc),c=co.dot(Zc);if(0<=a&&c<=a)return t.copy(i);var u=o*c-a*s;if(0>=u&&0<=o&&0>=a)return i=o/(o-a),t.copy(n).addScaledVector(ao,i);Kc.subVectors(e,r),e=ao.dot(Kc);var h=co.dot(Kc);return 0<=h&&e<=h?t.copy(r):(o=e*s-o*h,0>=o&&0<=s&&0>=h?(u=s/(s-h),t.copy(n).addScaledVector(co,u)):(s=a*h-e*c,0>=s&&0<=c-a&&0<=e-h?($l.subVectors(r,i),u=(c-a)/(c-a+(e-h)),t.copy(i).addScaledVector($l,u)):(r=1/(s+o+u),i=o*r,u*=r,t.copy(n).addScaledVector(ao,i).addScaledVector(co,u))))},equals:function(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}});var uh={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},Cn={h:0,s:0,l:0},_a={h:0,s:0,l:0};Object.assign(ve.prototype,{isColor:!0,r:1,g:1,b:1,set:function(e){return e&&e.isColor?this.copy(e):typeof e=="number"?this.setHex(e):typeof e=="string"&&this.setStyle(e),this},setScalar:function(e){return this.b=this.g=this.r=e,this},setHex:function(e){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(e&255)/255,this},setRGB:function(e,t,n){return this.r=e,this.g=t,this.b=n,this},setHSL:function(e,t,n){return e=Xe.euclideanModulo(e,1),t=Xe.clamp(t,0,1),n=Xe.clamp(n,0,1),t===0?this.r=this.g=this.b=n:(t=.5>=n?n*(1+t):n+t-n*t,n=2*n-t,this.r=Dn(n,t,e+1/3),this.g=Dn(n,t,e),this.b=Dn(n,t,e-1/3)),this},setStyle:function(e){function t(s){s!==void 0&&1>parseFloat(s)&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}var n;if(n=/^((?:rgb|hsl)a?)\(\s*([^\)]*)\)/.exec(e)){var i=n[2];switch(n[1]){case"rgb":case"rgba":if(n=/^(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(i))return this.r=Math.min(255,parseInt(n[1],10))/255,this.g=Math.min(255,parseInt(n[2],10))/255,this.b=Math.min(255,parseInt(n[3],10))/255,t(n[5]),this;if(n=/^(\d+)%\s*,\s*(\d+)%\s*,\s*(\d+)%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(i))return this.r=Math.min(100,parseInt(n[1],10))/100,this.g=Math.min(100,parseInt(n[2],10))/100,this.b=Math.min(100,parseInt(n[3],10))/100,t(n[5]),this;break;case"hsl":case"hsla":if(n=/^([0-9]*\.?[0-9]+)\s*,\s*(\d+)%\s*,\s*(\d+)%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(i)){i=parseFloat(n[1])/360;var r=parseInt(n[2],10)/100,o=parseInt(n[3],10)/100;return t(n[5]),this.setHSL(i,r,o)}}}else if(n=/^#([A-Fa-f0-9]+)$/.exec(e)){if(n=n[1],i=n.length,i===3)return this.r=parseInt(n.charAt(0)+n.charAt(0),16)/255,this.g=parseInt(n.charAt(1)+n.charAt(1),16)/255,this.b=parseInt(n.charAt(2)+n.charAt(2),16)/255,this;if(i===6)return this.r=parseInt(n.charAt(0)+n.charAt(1),16)/255,this.g=parseInt(n.charAt(2)+n.charAt(3),16)/255,this.b=parseInt(n.charAt(4)+n.charAt(5),16)/255,this}return e&&0<e.length&&(n=uh[e],n!==void 0?this.setHex(n):console.warn("THREE.Color: Unknown color "+e)),this},clone:function(){return new this.constructor(this.r,this.g,this.b)},copy:function(e){return this.r=e.r,this.g=e.g,this.b=e.b,this},copyGammaToLinear:function(e,t){return t===void 0&&(t=2),this.r=Math.pow(e.r,t),this.g=Math.pow(e.g,t),this.b=Math.pow(e.b,t),this},copyLinearToGamma:function(e,t){return t===void 0&&(t=2),t=0<t?1/t:1,this.r=Math.pow(e.r,t),this.g=Math.pow(e.g,t),this.b=Math.pow(e.b,t),this},convertGammaToLinear:function(e){return this.copyGammaToLinear(this,e),this},convertLinearToGamma:function(e){return this.copyLinearToGamma(this,e),this},copySRGBToLinear:function(e){return this.r=hn(e.r),this.g=hn(e.g),this.b=hn(e.b),this},copyLinearToSRGB:function(e){return this.r=zi(e.r),this.g=zi(e.g),this.b=zi(e.b),this},convertSRGBToLinear:function(){return this.copySRGBToLinear(this),this},convertLinearToSRGB:function(){return this.copyLinearToSRGB(this),this},getHex:function(){return 255*this.r<<16^255*this.g<<8^255*this.b<<0},getHexString:function(){return("000000"+this.getHex().toString(16)).slice(-6)},getHSL:function(e){e===void 0&&(console.warn("THREE.Color: .getHSL() target is now required"),e={h:0,s:0,l:0});var t=this.r,n=this.g,i=this.b,r=Math.max(t,n,i),o=Math.min(t,n,i),s,a=(o+r)/2;if(o===r)o=s=0;else{var c=r-o;switch(o=.5>=a?c/(r+o):c/(2-r-o),r){case t:s=(n-i)/c+(n<i?6:0);break;case n:s=(i-t)/c+2;break;case i:s=(t-n)/c+4}s/=6}return e.h=s,e.s=o,e.l=a,e},getStyle:function(){return"rgb("+(255*this.r|0)+","+(255*this.g|0)+","+(255*this.b|0)+")"},offsetHSL:function(e,t,n){return this.getHSL(Cn),Cn.h+=e,Cn.s+=t,Cn.l+=n,this.setHSL(Cn.h,Cn.s,Cn.l),this},add:function(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this},addColors:function(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this},addScalar:function(e){return this.r+=e,this.g+=e,this.b+=e,this},sub:function(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this},multiply:function(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this},multiplyScalar:function(e){return this.r*=e,this.g*=e,this.b*=e,this},lerp:function(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this},lerpHSL:function(e,t){this.getHSL(Cn),e.getHSL(_a),e=Xe.lerp(Cn.h,_a.h,t);var n=Xe.lerp(Cn.s,_a.s,t);return t=Xe.lerp(Cn.l,_a.l,t),this.setHSL(e,n,t),this},equals:function(e){return e.r===this.r&&e.g===this.g&&e.b===this.b},fromArray:function(e,t){return t===void 0&&(t=0),this.r=e[t],this.g=e[t+1],this.b=e[t+2],this},toArray:function(e,t){return e===void 0&&(e=[]),t===void 0&&(t=0),e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e},toJSON:function(){return this.getHex()}}),Object.assign(Ai.prototype,{clone:function(){return new this.constructor().copy(this)},copy:function(e){this.a=e.a,this.b=e.b,this.c=e.c,this.normal.copy(e.normal),this.color.copy(e.color),this.materialIndex=e.materialIndex;for(var t=0,n=e.vertexNormals.length;t<n;t++)this.vertexNormals[t]=e.vertexNormals[t].clone();for(t=0,n=e.vertexColors.length;t<n;t++)this.vertexColors[t]=e.vertexColors[t].clone();return this}});var hh=0;ie.prototype=Object.assign(Object.create(w.prototype),{constructor:ie,isMaterial:!0,onBeforeCompile:function(){},setValues:function(e){if(e!==void 0)for(var t in e){var n=e[t];if(n===void 0)console.warn("THREE.Material: '"+t+"' parameter is undefined.");else if(t==="shading")console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=n===1;else{var i=this[t];i===void 0?console.warn("THREE."+this.type+": '"+t+"' is not a property of this material."):i&&i.isColor?i.set(n):i&&i.isVector3&&n&&n.isVector3?i.copy(n):this[t]=n}}},toJSON:function(e){function t(r){var o=[],s;for(s in r){var a=r[s];delete a.metadata,o.push(a)}return o}var n=e===void 0||typeof e=="string";n&&(e={textures:{},images:{}});var i={metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}};return i.uuid=this.uuid,i.type=this.type,this.name!==""&&(i.name=this.name),this.color&&this.color.isColor&&(i.color=this.color.getHex()),this.roughness!==void 0&&(i.roughness=this.roughness),this.metalness!==void 0&&(i.metalness=this.metalness),this.sheen&&this.sheen.isColor&&(i.sheen=this.sheen.getHex()),this.emissive&&this.emissive.isColor&&(i.emissive=this.emissive.getHex()),this.emissiveIntensity&&this.emissiveIntensity!==1&&(i.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(i.specular=this.specular.getHex()),this.shininess!==void 0&&(i.shininess=this.shininess),this.clearcoat!==void 0&&(i.clearcoat=this.clearcoat),this.clearcoatRoughness!==void 0&&(i.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(i.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,i.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.map&&this.map.isTexture&&(i.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(i.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(i.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(i.lightMap=this.lightMap.toJSON(e).uuid),this.aoMap&&this.aoMap.isTexture&&(i.aoMap=this.aoMap.toJSON(e).uuid,i.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(i.bumpMap=this.bumpMap.toJSON(e).uuid,i.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(i.normalMap=this.normalMap.toJSON(e).uuid,i.normalMapType=this.normalMapType,i.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(i.displacementMap=this.displacementMap.toJSON(e).uuid,i.displacementScale=this.displacementScale,i.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(i.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(i.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(i.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(i.specularMap=this.specularMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(i.envMap=this.envMap.toJSON(e).uuid,i.reflectivity=this.reflectivity,i.refractionRatio=this.refractionRatio,this.combine!==void 0&&(i.combine=this.combine),this.envMapIntensity!==void 0&&(i.envMapIntensity=this.envMapIntensity)),this.gradientMap&&this.gradientMap.isTexture&&(i.gradientMap=this.gradientMap.toJSON(e).uuid),this.size!==void 0&&(i.size=this.size),this.sizeAttenuation!==void 0&&(i.sizeAttenuation=this.sizeAttenuation),this.blending!==1&&(i.blending=this.blending),this.flatShading===!0&&(i.flatShading=this.flatShading),this.side!==0&&(i.side=this.side),this.vertexColors!==0&&(i.vertexColors=this.vertexColors),1>this.opacity&&(i.opacity=this.opacity),this.transparent===!0&&(i.transparent=this.transparent),i.depthFunc=this.depthFunc,i.depthTest=this.depthTest,i.depthWrite=this.depthWrite,i.stencilWrite=this.stencilWrite,i.stencilWriteMask=this.stencilWriteMask,i.stencilFunc=this.stencilFunc,i.stencilRef=this.stencilRef,i.stencilFuncMask=this.stencilFuncMask,i.stencilFail=this.stencilFail,i.stencilZFail=this.stencilZFail,i.stencilZPass=this.stencilZPass,this.rotation&&this.rotation!==0&&(i.rotation=this.rotation),this.polygonOffset===!0&&(i.polygonOffset=!0),this.polygonOffsetFactor!==0&&(i.polygonOffsetFactor=this.polygonOffsetFactor),this.polygonOffsetUnits!==0&&(i.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth&&this.linewidth!==1&&(i.linewidth=this.linewidth),this.dashSize!==void 0&&(i.dashSize=this.dashSize),this.gapSize!==void 0&&(i.gapSize=this.gapSize),this.scale!==void 0&&(i.scale=this.scale),this.dithering===!0&&(i.dithering=!0),0<this.alphaTest&&(i.alphaTest=this.alphaTest),this.premultipliedAlpha===!0&&(i.premultipliedAlpha=this.premultipliedAlpha),this.wireframe===!0&&(i.wireframe=this.wireframe),1<this.wireframeLinewidth&&(i.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!=="round"&&(i.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!=="round"&&(i.wireframeLinejoin=this.wireframeLinejoin),this.morphTargets===!0&&(i.morphTargets=!0),this.morphNormals===!0&&(i.morphNormals=!0),this.skinning===!0&&(i.skinning=!0),this.visible===!1&&(i.visible=!1),this.toneMapped===!1&&(i.toneMapped=!1),JSON.stringify(this.userData)!=="{}"&&(i.userData=this.userData),n&&(n=t(e.textures),e=t(e.images),0<n.length&&(i.textures=n),0<e.length&&(i.images=e)),i},clone:function(){return new this.constructor().copy(this)},copy:function(e){this.name=e.name,this.fog=e.fog,this.blending=e.blending,this.side=e.side,this.flatShading=e.flatShading,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWrite=e.stencilWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.premultipliedAlpha=e.premultipliedAlpha,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this.clipShadows=e.clipShadows,this.clipIntersection=e.clipIntersection;var t=e.clippingPlanes,n=null;if(t!==null){var i=t.length;n=Array(i);for(var r=0;r!==i;++r)n[r]=t[r].clone()}return this.clippingPlanes=n,this.shadowSide=e.shadowSide,this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),Wt.prototype=Object.create(ie.prototype),Wt.prototype.constructor=Wt,Wt.prototype.isMeshBasicMaterial=!0,Wt.prototype.copy=function(e){return ie.prototype.copy.call(this,e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this},Object.defineProperty(Ce.prototype,"needsUpdate",{set:function(e){e===!0&&this.version++}}),Object.assign(Ce.prototype,{isBufferAttribute:!0,onUploadCallback:function(){},setDynamic:function(e){return this.dynamic=e,this},copy:function(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.dynamic=e.dynamic,this},copyAt:function(e,t,n){e*=this.itemSize,n*=t.itemSize;for(var i=0,r=this.itemSize;i<r;i++)this.array[e+i]=t.array[n+i];return this},copyArray:function(e){return this.array.set(e),this},copyColorsArray:function(e){for(var t=this.array,n=0,i=0,r=e.length;i<r;i++){var o=e[i];o===void 0&&(console.warn("THREE.BufferAttribute.copyColorsArray(): color is undefined",i),o=new ve),t[n++]=o.r,t[n++]=o.g,t[n++]=o.b}return this},copyVector2sArray:function(e){for(var t=this.array,n=0,i=0,r=e.length;i<r;i++){var o=e[i];o===void 0&&(console.warn("THREE.BufferAttribute.copyVector2sArray(): vector is undefined",i),o=new G),t[n++]=o.x,t[n++]=o.y}return this},copyVector3sArray:function(e){for(var t=this.array,n=0,i=0,r=e.length;i<r;i++){var o=e[i];o===void 0&&(console.warn("THREE.BufferAttribute.copyVector3sArray(): vector is undefined",i),o=new E),t[n++]=o.x,t[n++]=o.y,t[n++]=o.z}return this},copyVector4sArray:function(e){for(var t=this.array,n=0,i=0,r=e.length;i<r;i++){var o=e[i];o===void 0&&(console.warn("THREE.BufferAttribute.copyVector4sArray(): vector is undefined",i),o=new _e),t[n++]=o.x,t[n++]=o.y,t[n++]=o.z,t[n++]=o.w}return this},set:function(e,t){return t===void 0&&(t=0),this.array.set(e,t),this},getX:function(e){return this.array[e*this.itemSize]},setX:function(e,t){return this.array[e*this.itemSize]=t,this},getY:function(e){return this.array[e*this.itemSize+1]},setY:function(e,t){return this.array[e*this.itemSize+1]=t,this},getZ:function(e){return this.array[e*this.itemSize+2]},setZ:function(e,t){return this.array[e*this.itemSize+2]=t,this},getW:function(e){return this.array[e*this.itemSize+3]},setW:function(e,t){return this.array[e*this.itemSize+3]=t,this},setXY:function(e,t,n){return e*=this.itemSize,this.array[e+0]=t,this.array[e+1]=n,this},setXYZ:function(e,t,n,i){return e*=this.itemSize,this.array[e+0]=t,this.array[e+1]=n,this.array[e+2]=i,this},setXYZW:function(e,t,n,i,r){return e*=this.itemSize,this.array[e+0]=t,this.array[e+1]=n,this.array[e+2]=i,this.array[e+3]=r,this},onUpload:function(e){return this.onUploadCallback=e,this},clone:function(){return new this.constructor(this.array,this.itemSize).copy(this)},toJSON:function(){return{itemSize:this.itemSize,type:this.array.constructor.name,array:Array.prototype.slice.call(this.array),normalized:this.normalized}}}),Kn.prototype=Object.create(Ce.prototype),Kn.prototype.constructor=Kn,Mi.prototype=Object.create(Ce.prototype),Mi.prototype.constructor=Mi,Gi.prototype=Object.create(Ce.prototype),Gi.prototype.constructor=Gi,Jn.prototype=Object.create(Ce.prototype),Jn.prototype.constructor=Jn,Bn.prototype=Object.create(Ce.prototype),Bn.prototype.constructor=Bn,Hi.prototype=Object.create(Ce.prototype),Hi.prototype.constructor=Hi,St.prototype=Object.create(Ce.prototype),St.prototype.constructor=St,le.prototype=Object.create(Ce.prototype),le.prototype.constructor=le,In.prototype=Object.create(Ce.prototype),In.prototype.constructor=In,Object.assign(xs.prototype,{computeGroups:function(e){var t=[],n=void 0;e=e.faces;for(var i=0;i<e.length;i++){var r=e[i];if(r.materialIndex!==n){n=r.materialIndex,o!==void 0&&(o.count=3*i-o.start,t.push(o));var o={start:3*i,materialIndex:n}}}o!==void 0&&(o.count=3*i-o.start,t.push(o)),this.groups=t},fromGeometry:function(e){var t=e.faces,n=e.vertices,i=e.faceVertexUvs,r=i[0]&&0<i[0].length,o=i[1]&&0<i[1].length,s=e.morphTargets,a=s.length;if(0<a){for(var c=[],u=0;u<a;u++)c[u]={name:s[u].name,data:[]};this.morphTargets.position=c}var h=e.morphNormals,p=h.length;if(0<p){var v=[];for(u=0;u<p;u++)v[u]={name:h[u].name,data:[]};this.morphTargets.normal=v}var x=e.skinIndices,y=e.skinWeights,M=x.length===n.length,L=y.length===n.length;for(0<n.length&&t.length===0&&console.error("THREE.DirectGeometry: Faceless geometries are not supported."),u=0;u<t.length;u++){var O=t[u];this.vertices.push(n[O.a],n[O.b],n[O.c]);var F=O.vertexNormals;for(F.length===3?this.normals.push(F[0],F[1],F[2]):(F=O.normal,this.normals.push(F,F,F)),F=O.vertexColors,F.length===3?this.colors.push(F[0],F[1],F[2]):(F=O.color,this.colors.push(F,F,F)),r===!0&&(F=i[0][u],F!==void 0?this.uvs.push(F[0],F[1],F[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv ",u),this.uvs.push(new G,new G,new G))),o===!0&&(F=i[1][u],F!==void 0?this.uvs2.push(F[0],F[1],F[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv2 ",u),this.uvs2.push(new G,new G,new G))),F=0;F<a;F++){var z=s[F].vertices;c[F].data.push(z[O.a],z[O.b],z[O.c])}for(F=0;F<p;F++)z=h[F].vertexNormals[u],v[F].data.push(z.a,z.b,z.c);M&&this.skinIndices.push(x[O.a],x[O.b],x[O.c]),L&&this.skinWeights.push(y[O.a],y[O.b],y[O.c])}return this.computeGroups(e),this.verticesNeedUpdate=e.verticesNeedUpdate,this.normalsNeedUpdate=e.normalsNeedUpdate,this.colorsNeedUpdate=e.colorsNeedUpdate,this.uvsNeedUpdate=e.uvsNeedUpdate,this.groupsNeedUpdate=e.groupsNeedUpdate,e.boundingSphere!==null&&(this.boundingSphere=e.boundingSphere.clone()),e.boundingBox!==null&&(this.boundingBox=e.boundingBox.clone()),this}});var dh=1,kn=new Se,Jc=new W,Ca=new E,hr=new pe,$c=new pe,Ln=new E;re.prototype=Object.assign(Object.create(w.prototype),{constructor:re,isBufferGeometry:!0,getIndex:function(){return this.index},setIndex:function(e){Array.isArray(e)?this.index=new(65535<Mo(e)?St:Bn)(e,1):this.index=e},addAttribute:function(e,t,n){return t&&t.isBufferAttribute||t&&t.isInterleavedBufferAttribute?e==="index"?(console.warn("THREE.BufferGeometry.addAttribute: Use .setIndex() for index attribute."),this.setIndex(t),this):this.setAttribute(e,t):(console.warn("THREE.BufferGeometry: .addAttribute() now expects ( name, attribute )."),this.addAttribute(e,new Ce(t,n)))},getAttribute:function(e){return this.attributes[e]},setAttribute:function(e,t){return this.attributes[e]=t,this},removeAttribute:function(e){return delete this.attributes[e],this},addGroup:function(e,t,n){this.groups.push({start:e,count:t,materialIndex:n!==void 0?n:0})},clearGroups:function(){this.groups=[]},setDrawRange:function(e,t){this.drawRange.start=e,this.drawRange.count=t},applyMatrix:function(e){var t=this.attributes.position;t!==void 0&&(e.applyToBufferAttribute(t),t.needsUpdate=!0);var n=this.attributes.normal;return n!==void 0&&(t=new be().getNormalMatrix(e),t.applyToBufferAttribute(n),n.needsUpdate=!0),n=this.attributes.tangent,n!==void 0&&(t=new be().getNormalMatrix(e),t.applyToBufferAttribute(n),n.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this},rotateX:function(e){return kn.makeRotationX(e),this.applyMatrix(kn),this},rotateY:function(e){return kn.makeRotationY(e),this.applyMatrix(kn),this},rotateZ:function(e){return kn.makeRotationZ(e),this.applyMatrix(kn),this},translate:function(e,t,n){return kn.makeTranslation(e,t,n),this.applyMatrix(kn),this},scale:function(e,t,n){return kn.makeScale(e,t,n),this.applyMatrix(kn),this},lookAt:function(e){return Jc.lookAt(e),Jc.updateMatrix(),this.applyMatrix(Jc.matrix),this},center:function(){return this.computeBoundingBox(),this.boundingBox.getCenter(Ca).negate(),this.translate(Ca.x,Ca.y,Ca.z),this},setFromObject:function(e){var t=e.geometry;if(e.isPoints||e.isLine){e=new le(3*t.vertices.length,3);var n=new le(3*t.colors.length,3);this.addAttribute("position",e.copyVector3sArray(t.vertices)),this.addAttribute("color",n.copyColorsArray(t.colors)),t.lineDistances&&t.lineDistances.length===t.vertices.length&&(e=new le(t.lineDistances.length,1),this.addAttribute("lineDistance",e.copyArray(t.lineDistances))),t.boundingSphere!==null&&(this.boundingSphere=t.boundingSphere.clone()),t.boundingBox!==null&&(this.boundingBox=t.boundingBox.clone())}else e.isMesh&&t&&t.isGeometry&&this.fromGeometry(t);return this},setFromPoints:function(e){for(var t=[],n=0,i=e.length;n<i;n++){var r=e[n];t.push(r.x,r.y,r.z||0)}return this.addAttribute("position",new le(t,3)),this},updateFromObject:function(e){var t=e.geometry;if(e.isMesh){var n=t.__directGeometry;if(t.elementsNeedUpdate===!0&&(n=void 0,t.elementsNeedUpdate=!1),n===void 0)return this.fromGeometry(t);n.verticesNeedUpdate=t.verticesNeedUpdate,n.normalsNeedUpdate=t.normalsNeedUpdate,n.colorsNeedUpdate=t.colorsNeedUpdate,n.uvsNeedUpdate=t.uvsNeedUpdate,n.groupsNeedUpdate=t.groupsNeedUpdate,t.verticesNeedUpdate=!1,t.normalsNeedUpdate=!1,t.colorsNeedUpdate=!1,t.uvsNeedUpdate=!1,t.groupsNeedUpdate=!1,t=n}return t.verticesNeedUpdate===!0&&(n=this.attributes.position,n!==void 0&&(n.copyVector3sArray(t.vertices),n.needsUpdate=!0),t.verticesNeedUpdate=!1),t.normalsNeedUpdate===!0&&(n=this.attributes.normal,n!==void 0&&(n.copyVector3sArray(t.normals),n.needsUpdate=!0),t.normalsNeedUpdate=!1),t.colorsNeedUpdate===!0&&(n=this.attributes.color,n!==void 0&&(n.copyColorsArray(t.colors),n.needsUpdate=!0),t.colorsNeedUpdate=!1),t.uvsNeedUpdate&&(n=this.attributes.uv,n!==void 0&&(n.copyVector2sArray(t.uvs),n.needsUpdate=!0),t.uvsNeedUpdate=!1),t.lineDistancesNeedUpdate&&(n=this.attributes.lineDistance,n!==void 0&&(n.copyArray(t.lineDistances),n.needsUpdate=!0),t.lineDistancesNeedUpdate=!1),t.groupsNeedUpdate&&(t.computeGroups(e.geometry),this.groups=t.groups,t.groupsNeedUpdate=!1),this},fromGeometry:function(e){return e.__directGeometry=new xs().fromGeometry(e),this.fromDirectGeometry(e.__directGeometry)},fromDirectGeometry:function(e){var t=new Float32Array(3*e.vertices.length);this.addAttribute("position",new Ce(t,3).copyVector3sArray(e.vertices)),0<e.normals.length&&(t=new Float32Array(3*e.normals.length),this.addAttribute("normal",new Ce(t,3).copyVector3sArray(e.normals))),0<e.colors.length&&(t=new Float32Array(3*e.colors.length),this.addAttribute("color",new Ce(t,3).copyColorsArray(e.colors))),0<e.uvs.length&&(t=new Float32Array(2*e.uvs.length),this.addAttribute("uv",new Ce(t,2).copyVector2sArray(e.uvs))),0<e.uvs2.length&&(t=new Float32Array(2*e.uvs2.length),this.addAttribute("uv2",new Ce(t,2).copyVector2sArray(e.uvs2))),this.groups=e.groups;for(var n in e.morphTargets){t=[];for(var i=e.morphTargets[n],r=0,o=i.length;r<o;r++){var s=i[r],a=new le(3*s.data.length,3);a.name=s.name,t.push(a.copyVector3sArray(s.data))}this.morphAttributes[n]=t}return 0<e.skinIndices.length&&(n=new le(4*e.skinIndices.length,4),this.addAttribute("skinIndex",n.copyVector4sArray(e.skinIndices))),0<e.skinWeights.length&&(n=new le(4*e.skinWeights.length,4),this.addAttribute("skinWeight",n.copyVector4sArray(e.skinWeights))),e.boundingSphere!==null&&(this.boundingSphere=e.boundingSphere.clone()),e.boundingBox!==null&&(this.boundingBox=e.boundingBox.clone()),this},computeBoundingBox:function(){this.boundingBox===null&&(this.boundingBox=new pe);var e=this.attributes.position,t=this.morphAttributes.position;if(e!==void 0){if(this.boundingBox.setFromBufferAttribute(e),t){e=0;for(var n=t.length;e<n;e++)hr.setFromBufferAttribute(t[e]),this.boundingBox.expandByPoint(hr.min),this.boundingBox.expandByPoint(hr.max)}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox: Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)},computeBoundingSphere:function(){this.boundingSphere===null&&(this.boundingSphere=new ye);var e=this.attributes.position,t=this.morphAttributes.position;if(e){var n=this.boundingSphere.center;if(hr.setFromBufferAttribute(e),t)for(var i=0,r=t.length;i<r;i++){var o=t[i];$c.setFromBufferAttribute(o),hr.expandByPoint($c.min),hr.expandByPoint($c.max)}hr.getCenter(n);var s=0;for(i=0,r=e.count;i<r;i++)Ln.fromBufferAttribute(e,i),s=Math.max(s,n.distanceToSquared(Ln));if(t)for(i=0,r=t.length;i<r;i++){o=t[i],e=0;for(var a=o.count;e<a;e++)Ln.fromBufferAttribute(o,e),s=Math.max(s,n.distanceToSquared(Ln))}this.boundingSphere.radius=Math.sqrt(s),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}},computeFaceNormals:function(){},computeVertexNormals:function(){var e=this.index,t=this.attributes;if(t.position){var n=t.position.array;if(t.normal===void 0)this.addAttribute("normal",new Ce(new Float32Array(n.length),3));else for(var i=t.normal.array,r=0,o=i.length;r<o;r++)i[r]=0;i=t.normal.array;var s=new E,a=new E,c=new E,u=new E,h=new E;if(e){var p=e.array;for(r=0,o=e.count;r<o;r+=3){e=3*p[r+0];var v=3*p[r+1],x=3*p[r+2];s.fromArray(n,e),a.fromArray(n,v),c.fromArray(n,x),u.subVectors(c,a),h.subVectors(s,a),u.cross(h),i[e]+=u.x,i[e+1]+=u.y,i[e+2]+=u.z,i[v]+=u.x,i[v+1]+=u.y,i[v+2]+=u.z,i[x]+=u.x,i[x+1]+=u.y,i[x+2]+=u.z}}else for(r=0,o=n.length;r<o;r+=9)s.fromArray(n,r),a.fromArray(n,r+3),c.fromArray(n,r+6),u.subVectors(c,a),h.subVectors(s,a),u.cross(h),i[r]=u.x,i[r+1]=u.y,i[r+2]=u.z,i[r+3]=u.x,i[r+4]=u.y,i[r+5]=u.z,i[r+6]=u.x,i[r+7]=u.y,i[r+8]=u.z;this.normalizeNormals(),t.normal.needsUpdate=!0}},merge:function(e,t){if(e&&e.isBufferGeometry){t===void 0&&(t=0,console.warn("THREE.BufferGeometry.merge(): Overwriting original geometry, starting at offset=0. Use BufferGeometryUtils.mergeBufferGeometries() for lossless merge."));var n=this.attributes,i;for(i in n)if(e.attributes[i]!==void 0){var r=n[i].array,o=e.attributes[i],s=o.array,a=o.itemSize*t;o=Math.min(s.length,r.length-a);for(var c=0;c<o;c++,a++)r[a]=s[c]}return this}console.error("THREE.BufferGeometry.merge(): geometry not an instance of THREE.BufferGeometry.",e)},normalizeNormals:function(){for(var e=this.attributes.normal,t=0,n=e.count;t<n;t++)Ln.x=e.getX(t),Ln.y=e.getY(t),Ln.z=e.getZ(t),Ln.normalize(),e.setXYZ(t,Ln.x,Ln.y,Ln.z)},toNonIndexed:function(){function e(h,p){var v=h.array;h=h.itemSize;for(var x=new v.constructor(p.length*h),y,M=0,L=0,O=p.length;L<O;L++){y=p[L]*h;for(var F=0;F<h;F++)x[M++]=v[y++]}return new Ce(x,h)}if(this.index===null)return console.warn("THREE.BufferGeometry.toNonIndexed(): Geometry is already non-indexed."),this;var t=new re,n=this.index.array,i=this.attributes,r;for(r in i){var o=i[r];o=e(o,n),t.addAttribute(r,o)}var s=this.morphAttributes;for(r in s){var a=[],c=s[r];i=0;for(var u=c.length;i<u;i++)o=c[i],o=e(o,n),a.push(o);t.morphAttributes[r]=a}for(n=this.groups,i=0,r=n.length;i<r;i++)o=n[i],t.addGroup(o.start,o.count,o.materialIndex);return t},toJSON:function(){var e={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,this.name!==""&&(e.name=this.name),0<Object.keys(this.userData).length&&(e.userData=this.userData),this.parameters!==void 0){var t=this.parameters;for(u in t)t[u]!==void 0&&(e[u]=t[u]);return e}e.data={attributes:{}},t=this.index,t!==null&&(e.data.index={type:t.array.constructor.name,array:Array.prototype.slice.call(t.array)});var n=this.attributes;for(u in n){t=n[u];var i=t.toJSON();t.name!==""&&(i.name=t.name),e.data.attributes[u]=i}n={};var r=!1;for(u in this.morphAttributes){for(var o=this.morphAttributes[u],s=[],a=0,c=o.length;a<c;a++)t=o[a],i=t.toJSON(),t.name!==""&&(i.name=t.name),s.push(i);0<s.length&&(n[u]=s,r=!0)}r&&(e.data.morphAttributes=n);var u=this.groups;return 0<u.length&&(e.data.groups=JSON.parse(JSON.stringify(u))),u=this.boundingSphere,u!==null&&(e.data.boundingSphere={center:u.center.toArray(),radius:u.radius}),e},clone:function(){return new re().copy(this)},copy:function(e){var t;this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingSphere=this.boundingBox=null,this.name=e.name;var n=e.index;n!==null&&this.setIndex(n.clone()),n=e.attributes;for(s in n)this.addAttribute(s,n[s].clone());var i=e.morphAttributes;for(s in i){var r=[],o=i[s];for(n=0,t=o.length;n<t;n++)r.push(o[n].clone());this.morphAttributes[s]=r}var s=e.groups;for(n=0,t=s.length;n<t;n++)i=s[n],this.addGroup(i.start,i.count,i.materialIndex);return s=e.boundingBox,s!==null&&(this.boundingBox=s.clone()),s=e.boundingSphere,s!==null&&(this.boundingSphere=s.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,this},dispose:function(){this.dispatchEvent({type:"dispose"})}});var eu=new Se,dr=new de,el=new ye,pr=new E,fr=new E,mr=new E,tu=new E,nu=new E,iu=new E,tl=new E,nl=new E,il=new E,lo=new G,uo=new G,ho=new G,hs=new E,La=new E;yt.prototype=Object.assign(Object.create(W.prototype),{constructor:yt,isMesh:!0,setDrawMode:function(e){this.drawMode=e},copy:function(e){return W.prototype.copy.call(this,e),this.drawMode=e.drawMode,e.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),e.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this},updateMorphTargets:function(){var e=this.geometry;if(e.isBufferGeometry){e=e.morphAttributes;var t=Object.keys(e);if(0<t.length){var n=e[t[0]];if(n!==void 0)for(this.morphTargetInfluences=[],this.morphTargetDictionary={},e=0,t=n.length;e<t;e++){var i=n[e].name||String(e);this.morphTargetInfluences.push(0),this.morphTargetDictionary[i]=e}}}else e=e.morphTargets,e!==void 0&&0<e.length&&console.error("THREE.Mesh.updateMorphTargets() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")},raycast:function(e,t){var n=this.geometry,i=this.material,r=this.matrixWorld;if(i!==void 0&&(n.boundingSphere===null&&n.computeBoundingSphere(),el.copy(n.boundingSphere),el.applyMatrix4(r),e.ray.intersectsSphere(el)!==!1&&(eu.getInverse(r),dr.copy(e.ray).applyMatrix4(eu),n.boundingBox===null||dr.intersectsBox(n.boundingBox)!==!1))){if(n.isBufferGeometry){var o=n.index;r=n.attributes.position;var s=n.morphAttributes.position,a=n.attributes.uv,c=n.attributes.uv2,u=n.groups,h=n.drawRange,p,v;if(o!==null)if(Array.isArray(i)){var x=0;for(p=u.length;x<p;x++){var y=u[x],M=i[y.materialIndex],L=Math.max(y.start,h.start);for(v=n=Math.min(y.start+y.count,h.start+h.count);L<v;L+=3){n=o.getX(L);var O=o.getX(L+1),F=o.getX(L+2);(n=Vi(this,M,e,dr,r,s,a,c,n,O,F))&&(n.faceIndex=Math.floor(L/3),n.face.materialIndex=y.materialIndex,t.push(n))}}}else for(L=Math.max(0,h.start),n=Math.min(o.count,h.start+h.count),x=L,p=n;x<p;x+=3)n=o.getX(x),O=o.getX(x+1),F=o.getX(x+2),(n=Vi(this,i,e,dr,r,s,a,c,n,O,F))&&(n.faceIndex=Math.floor(x/3),t.push(n));else if(r!==void 0)if(Array.isArray(i))for(x=0,p=u.length;x<p;x++)for(y=u[x],M=i[y.materialIndex],L=Math.max(y.start,h.start),v=n=Math.min(y.start+y.count,h.start+h.count);L<v;L+=3)n=L,O=L+1,F=L+2,(n=Vi(this,M,e,dr,r,s,a,c,n,O,F))&&(n.faceIndex=Math.floor(L/3),n.face.materialIndex=y.materialIndex,t.push(n));else for(L=Math.max(0,h.start),n=Math.min(r.count,h.start+h.count),x=L,p=n;x<p;x+=3)n=x,O=x+1,F=x+2,(n=Vi(this,i,e,dr,r,s,a,c,n,O,F))&&(n.faceIndex=Math.floor(x/3),t.push(n))}else if(n.isGeometry)for(r=Array.isArray(i),s=n.vertices,a=n.faces,n=n.faceVertexUvs[0],0<n.length&&(o=n),x=0,p=a.length;x<p;x++)y=a[x],n=r?i[y.materialIndex]:i,n!==void 0&&(c=s[y.a],u=s[y.b],h=s[y.c],n=ws(this,n,e,dr,c,u,h,hs))&&(o&&o[x]&&(M=o[x],lo.copy(M[0]),uo.copy(M[1]),ho.copy(M[2]),n.uv=lt.getUV(hs,c,u,h,lo,uo,ho,new G)),n.face=y,n.faceIndex=x,t.push(n))}},clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}});var ph=0,Yn=new Se,rl=new W,Pa=new E;he.prototype=Object.assign(Object.create(w.prototype),{constructor:he,isGeometry:!0,applyMatrix:function(e){for(var t=new be().getNormalMatrix(e),n=0,i=this.vertices.length;n<i;n++)this.vertices[n].applyMatrix4(e);for(n=0,i=this.faces.length;n<i;n++){e=this.faces[n],e.normal.applyMatrix3(t).normalize();for(var r=0,o=e.vertexNormals.length;r<o;r++)e.vertexNormals[r].applyMatrix3(t).normalize()}return this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this.normalsNeedUpdate=this.verticesNeedUpdate=!0,this},rotateX:function(e){return Yn.makeRotationX(e),this.applyMatrix(Yn),this},rotateY:function(e){return Yn.makeRotationY(e),this.applyMatrix(Yn),this},rotateZ:function(e){return Yn.makeRotationZ(e),this.applyMatrix(Yn),this},translate:function(e,t,n){return Yn.makeTranslation(e,t,n),this.applyMatrix(Yn),this},scale:function(e,t,n){return Yn.makeScale(e,t,n),this.applyMatrix(Yn),this},lookAt:function(e){return rl.lookAt(e),rl.updateMatrix(),this.applyMatrix(rl.matrix),this},fromBufferGeometry:function(e){function t(x,y,M,L){var O=a===void 0?[]:[n.colors[x].clone(),n.colors[y].clone(),n.colors[M].clone()],F=s===void 0?[]:[new E().fromArray(s,3*x),new E().fromArray(s,3*y),new E().fromArray(s,3*M)];L=new Ai(x,y,M,F,O,L),n.faces.push(L),c!==void 0&&n.faceVertexUvs[0].push([new G().fromArray(c,2*x),new G().fromArray(c,2*y),new G().fromArray(c,2*M)]),u!==void 0&&n.faceVertexUvs[1].push([new G().fromArray(u,2*x),new G().fromArray(u,2*y),new G().fromArray(u,2*M)])}var n=this,i=e.index!==null?e.index.array:void 0,r=e.attributes;if(r.position===void 0)return console.error("THREE.Geometry.fromBufferGeometry(): Position attribute required for conversion."),this;var o=r.position.array,s=r.normal!==void 0?r.normal.array:void 0,a=r.color!==void 0?r.color.array:void 0,c=r.uv!==void 0?r.uv.array:void 0,u=r.uv2!==void 0?r.uv2.array:void 0;for(u!==void 0&&(this.faceVertexUvs[1]=[]),r=0;r<o.length;r+=3)n.vertices.push(new E().fromArray(o,r)),a!==void 0&&n.colors.push(new ve().fromArray(a,r));var h=e.groups;if(0<h.length)for(r=0;r<h.length;r++){o=h[r];var p=o.start,v=p;for(p+=o.count;v<p;v+=3)i!==void 0?t(i[v],i[v+1],i[v+2],o.materialIndex):t(v,v+1,v+2,o.materialIndex)}else if(i!==void 0)for(r=0;r<i.length;r+=3)t(i[r],i[r+1],i[r+2]);else for(r=0;r<o.length/3;r+=3)t(r,r+1,r+2);return this.computeFaceNormals(),e.boundingBox!==null&&(this.boundingBox=e.boundingBox.clone()),e.boundingSphere!==null&&(this.boundingSphere=e.boundingSphere.clone()),this},center:function(){return this.computeBoundingBox(),this.boundingBox.getCenter(Pa).negate(),this.translate(Pa.x,Pa.y,Pa.z),this},normalize:function(){this.computeBoundingSphere();var e=this.boundingSphere.center,t=this.boundingSphere.radius;t=t===0?1:1/t;var n=new Se;return n.set(t,0,0,-t*e.x,0,t,0,-t*e.y,0,0,t,-t*e.z,0,0,0,1),this.applyMatrix(n),this},computeFaceNormals:function(){for(var e=new E,t=new E,n=0,i=this.faces.length;n<i;n++){var r=this.faces[n],o=this.vertices[r.a],s=this.vertices[r.b];e.subVectors(this.vertices[r.c],s),t.subVectors(o,s),e.cross(t),e.normalize(),r.normal.copy(e)}},computeVertexNormals:function(e){e===void 0&&(e=!0);var t,n=Array(this.vertices.length),i=0;for(t=this.vertices.length;i<t;i++)n[i]=new E;if(e){var r=new E,o=new E;for(e=0,i=this.faces.length;e<i;e++){t=this.faces[e];var s=this.vertices[t.a],a=this.vertices[t.b],c=this.vertices[t.c];r.subVectors(c,a),o.subVectors(s,a),r.cross(o),n[t.a].add(r),n[t.b].add(r),n[t.c].add(r)}}else for(this.computeFaceNormals(),e=0,i=this.faces.length;e<i;e++)t=this.faces[e],n[t.a].add(t.normal),n[t.b].add(t.normal),n[t.c].add(t.normal);for(i=0,t=this.vertices.length;i<t;i++)n[i].normalize();for(e=0,i=this.faces.length;e<i;e++)t=this.faces[e],s=t.vertexNormals,s.length===3?(s[0].copy(n[t.a]),s[1].copy(n[t.b]),s[2].copy(n[t.c])):(s[0]=n[t.a].clone(),s[1]=n[t.b].clone(),s[2]=n[t.c].clone());0<this.faces.length&&(this.normalsNeedUpdate=!0)},computeFlatVertexNormals:function(){var e;this.computeFaceNormals();var t=0;for(e=this.faces.length;t<e;t++){var n=this.faces[t],i=n.vertexNormals;i.length===3?(i[0].copy(n.normal),i[1].copy(n.normal),i[2].copy(n.normal)):(i[0]=n.normal.clone(),i[1]=n.normal.clone(),i[2]=n.normal.clone())}0<this.faces.length&&(this.normalsNeedUpdate=!0)},computeMorphNormals:function(){var e,t,n=0;for(t=this.faces.length;n<t;n++){var i=this.faces[n];i.__originalFaceNormal?i.__originalFaceNormal.copy(i.normal):i.__originalFaceNormal=i.normal.clone(),i.__originalVertexNormals||(i.__originalVertexNormals=[]);var r=0;for(e=i.vertexNormals.length;r<e;r++)i.__originalVertexNormals[r]?i.__originalVertexNormals[r].copy(i.vertexNormals[r]):i.__originalVertexNormals[r]=i.vertexNormals[r].clone()}var o=new he;for(o.faces=this.faces,r=0,e=this.morphTargets.length;r<e;r++){if(!this.morphNormals[r]){this.morphNormals[r]={},this.morphNormals[r].faceNormals=[],this.morphNormals[r].vertexNormals=[],i=this.morphNormals[r].faceNormals;var s=this.morphNormals[r].vertexNormals;for(n=0,t=this.faces.length;n<t;n++){var a=new E,c={a:new E,b:new E,c:new E};i.push(a),s.push(c)}}for(s=this.morphNormals[r],o.vertices=this.morphTargets[r].vertices,o.computeFaceNormals(),o.computeVertexNormals(),n=0,t=this.faces.length;n<t;n++)i=this.faces[n],a=s.faceNormals[n],c=s.vertexNormals[n],a.copy(i.normal),c.a.copy(i.vertexNormals[0]),c.b.copy(i.vertexNormals[1]),c.c.copy(i.vertexNormals[2])}for(n=0,t=this.faces.length;n<t;n++)i=this.faces[n],i.normal=i.__originalFaceNormal,i.vertexNormals=i.__originalVertexNormals},computeBoundingBox:function(){this.boundingBox===null&&(this.boundingBox=new pe),this.boundingBox.setFromPoints(this.vertices)},computeBoundingSphere:function(){this.boundingSphere===null&&(this.boundingSphere=new ye),this.boundingSphere.setFromPoints(this.vertices)},merge:function(e,t,n){if(e&&e.isGeometry){var i,r=this.vertices.length,o=this.vertices,s=e.vertices,a=this.faces,c=e.faces,u=this.colors,h=e.colors;n===void 0&&(n=0),t!==void 0&&(i=new be().getNormalMatrix(t));for(var p=0,v=s.length;p<v;p++){var x=s[p].clone();t!==void 0&&x.applyMatrix4(t),o.push(x)}for(p=0,v=h.length;p<v;p++)u.push(h[p].clone());for(p=0,v=c.length;p<v;p++){s=c[p];var y=s.vertexNormals;for(h=s.vertexColors,u=new Ai(s.a+r,s.b+r,s.c+r),u.normal.copy(s.normal),i!==void 0&&u.normal.applyMatrix3(i).normalize(),t=0,o=y.length;t<o;t++)x=y[t].clone(),i!==void 0&&x.applyMatrix3(i).normalize(),u.vertexNormals.push(x);for(u.color.copy(s.color),t=0,o=h.length;t<o;t++)x=h[t],u.vertexColors.push(x.clone());u.materialIndex=s.materialIndex+n,a.push(u)}for(p=0,v=e.faceVertexUvs.length;p<v;p++)for(n=e.faceVertexUvs[p],this.faceVertexUvs[p]===void 0&&(this.faceVertexUvs[p]=[]),t=0,o=n.length;t<o;t++){for(i=n[t],r=[],a=0,c=i.length;a<c;a++)r.push(i[a].clone());this.faceVertexUvs[p].push(r)}}else console.error("THREE.Geometry.merge(): geometry not an instance of THREE.Geometry.",e)},mergeMesh:function(e){e&&e.isMesh?(e.matrixAutoUpdate&&e.updateMatrix(),this.merge(e.geometry,e.matrix)):console.error("THREE.Geometry.mergeMesh(): mesh not an instance of THREE.Mesh.",e)},mergeVertices:function(){var e={},t=[],n=[],i=Math.pow(10,4),r,o=0;for(r=this.vertices.length;o<r;o++){var s=this.vertices[o];s=Math.round(s.x*i)+"_"+Math.round(s.y*i)+"_"+Math.round(s.z*i),e[s]===void 0?(e[s]=o,t.push(this.vertices[o]),n[o]=t.length-1):n[o]=n[e[s]]}for(e=[],o=0,r=this.faces.length;o<r;o++)for(i=this.faces[o],i.a=n[i.a],i.b=n[i.b],i.c=n[i.c],i=[i.a,i.b,i.c],s=0;3>s;s++)if(i[s]===i[(s+1)%3]){e.push(o);break}for(o=e.length-1;0<=o;o--)for(i=e[o],this.faces.splice(i,1),n=0,r=this.faceVertexUvs.length;n<r;n++)this.faceVertexUvs[n].splice(i,1);return o=this.vertices.length-t.length,this.vertices=t,o},setFromPoints:function(e){this.vertices=[];for(var t=0,n=e.length;t<n;t++){var i=e[t];this.vertices.push(new E(i.x,i.y,i.z||0))}return this},sortFacesByMaterialIndex:function(){for(var e=this.faces,t=e.length,n=0;n<t;n++)e[n]._id=n;e.sort(function(c,u){return c.materialIndex-u.materialIndex});var i=this.faceVertexUvs[0],r=this.faceVertexUvs[1],o,s;for(i&&i.length===t&&(o=[]),r&&r.length===t&&(s=[]),n=0;n<t;n++){var a=e[n]._id;o&&o.push(i[a]),s&&s.push(r[a])}o&&(this.faceVertexUvs[0]=o),s&&(this.faceVertexUvs[1]=s)},toJSON:function(){function e(B,Y,Z){return Z?B|1<<Y:B&~(1<<Y)}function t(B){var Y=B.x.toString()+B.y.toString()+B.z.toString();return u[Y]!==void 0||(u[Y]=c.length/3,c.push(B.x,B.y,B.z)),u[Y]}function n(B){var Y=B.r.toString()+B.g.toString()+B.b.toString();return p[Y]!==void 0||(p[Y]=h.length,h.push(B.getHex())),p[Y]}function i(B){var Y=B.x.toString()+B.y.toString();return x[Y]!==void 0||(x[Y]=v.length/2,v.push(B.x,B.y)),x[Y]}var r={metadata:{version:4.5,type:"Geometry",generator:"Geometry.toJSON"}};if(r.uuid=this.uuid,r.type=this.type,this.name!==""&&(r.name=this.name),this.parameters!==void 0){var o=this.parameters,s;for(s in o)o[s]!==void 0&&(r[s]=o[s]);return r}for(o=[],s=0;s<this.vertices.length;s++){var a=this.vertices[s];o.push(a.x,a.y,a.z)}a=[];var c=[],u={},h=[],p={},v=[],x={};for(s=0;s<this.faces.length;s++){var y=this.faces[s],M=this.faceVertexUvs[0][s]!==void 0,L=0<y.normal.length(),O=0<y.vertexNormals.length,F=y.color.r!==1||y.color.g!==1||y.color.b!==1,z=0<y.vertexColors.length,V=0;V=e(V,0,0),V=e(V,1,!0),V=e(V,2,!1),V=e(V,3,M),V=e(V,4,L),V=e(V,5,O),V=e(V,6,F),V=e(V,7,z),a.push(V),a.push(y.a,y.b,y.c),a.push(y.materialIndex),M&&(M=this.faceVertexUvs[0][s],a.push(i(M[0]),i(M[1]),i(M[2]))),L&&a.push(t(y.normal)),O&&(L=y.vertexNormals,a.push(t(L[0]),t(L[1]),t(L[2]))),F&&a.push(n(y.color)),z&&(y=y.vertexColors,a.push(n(y[0]),n(y[1]),n(y[2])))}return r.data={},r.data.vertices=o,r.data.normals=c,0<h.length&&(r.data.colors=h),0<v.length&&(r.data.uvs=[v]),r.data.faces=a,r},clone:function(){return new he().copy(this)},copy:function(e){var t,n,i;this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingSphere=this.boundingBox=null,this.name=e.name;var r=e.vertices,o=0;for(t=r.length;o<t;o++)this.vertices.push(r[o].clone());for(r=e.colors,o=0,t=r.length;o<t;o++)this.colors.push(r[o].clone());for(r=e.faces,o=0,t=r.length;o<t;o++)this.faces.push(r[o].clone());for(o=0,t=e.faceVertexUvs.length;o<t;o++){var s=e.faceVertexUvs[o];for(this.faceVertexUvs[o]===void 0&&(this.faceVertexUvs[o]=[]),r=0,n=s.length;r<n;r++){var a=s[r],c=[],u=0;for(i=a.length;u<i;u++)c.push(a[u].clone());this.faceVertexUvs[o].push(c)}}for(u=e.morphTargets,o=0,t=u.length;o<t;o++){if(i={},i.name=u[o].name,u[o].vertices!==void 0)for(i.vertices=[],r=0,n=u[o].vertices.length;r<n;r++)i.vertices.push(u[o].vertices[r].clone());if(u[o].normals!==void 0)for(i.normals=[],r=0,n=u[o].normals.length;r<n;r++)i.normals.push(u[o].normals[r].clone());this.morphTargets.push(i)}for(u=e.morphNormals,o=0,t=u.length;o<t;o++){if(i={},u[o].vertexNormals!==void 0)for(i.vertexNormals=[],r=0,n=u[o].vertexNormals.length;r<n;r++)s=u[o].vertexNormals[r],a={},a.a=s.a.clone(),a.b=s.b.clone(),a.c=s.c.clone(),i.vertexNormals.push(a);if(u[o].faceNormals!==void 0)for(i.faceNormals=[],r=0,n=u[o].faceNormals.length;r<n;r++)i.faceNormals.push(u[o].faceNormals[r].clone());this.morphNormals.push(i)}for(r=e.skinWeights,o=0,t=r.length;o<t;o++)this.skinWeights.push(r[o].clone());for(r=e.skinIndices,o=0,t=r.length;o<t;o++)this.skinIndices.push(r[o].clone());for(r=e.lineDistances,o=0,t=r.length;o<t;o++)this.lineDistances.push(r[o]);return o=e.boundingBox,o!==null&&(this.boundingBox=o.clone()),o=e.boundingSphere,o!==null&&(this.boundingSphere=o.clone()),this.elementsNeedUpdate=e.elementsNeedUpdate,this.verticesNeedUpdate=e.verticesNeedUpdate,this.uvsNeedUpdate=e.uvsNeedUpdate,this.normalsNeedUpdate=e.normalsNeedUpdate,this.colorsNeedUpdate=e.colorsNeedUpdate,this.lineDistancesNeedUpdate=e.lineDistancesNeedUpdate,this.groupsNeedUpdate=e.groupsNeedUpdate,this},dispose:function(){this.dispatchEvent({type:"dispose"})}});var ol=function(e){function t(n,i,r,o,s,a){e.call(this),this.type="BoxGeometry",this.parameters={width:n,height:i,depth:r,widthSegments:o,heightSegments:s,depthSegments:a},this.fromBufferGeometry(new ds(n,i,r,o,s,a)),this.mergeVertices()}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t}(he),ds=function(e){function t(n,i,r,o,s,a){function c(L,O,F,z,V,B,Y,Z,fe,X,j){var J=B/fe,te=Y/X,ze=B/2,We=Y/2,_=Z/2;Y=fe+1;var b=X+1,H=B=0,K,se,ae=new E;for(se=0;se<b;se++){var et=se*te-We;for(K=0;K<Y;K++)ae[L]=(K*J-ze)*z,ae[O]=et*V,ae[F]=_,p.push(ae.x,ae.y,ae.z),ae[L]=0,ae[O]=0,ae[F]=0<Z?1:-1,v.push(ae.x,ae.y,ae.z),x.push(K/fe),x.push(1-se/X),B+=1}for(se=0;se<X;se++)for(K=0;K<fe;K++)L=y+K+Y*(se+1),O=y+(K+1)+Y*(se+1),F=y+(K+1)+Y*se,h.push(y+K+Y*se,L,F),h.push(L,O,F),H+=6;u.addGroup(M,H,j),M+=H,y+=B}e.call(this),this.type="BoxBufferGeometry",this.parameters={width:n,height:i,depth:r,widthSegments:o,heightSegments:s,depthSegments:a};var u=this;n=n||1,i=i||1,r=r||1,o=Math.floor(o)||1,s=Math.floor(s)||1,a=Math.floor(a)||1;var h=[],p=[],v=[],x=[],y=0,M=0;c("z","y","x",-1,-1,r,i,n,a,s,0),c("z","y","x",1,-1,r,i,-n,a,s,1),c("x","z","y",1,1,n,r,i,o,a,2),c("x","z","y",1,-1,n,r,-i,o,a,3),c("x","y","z",1,-1,n,i,r,o,s,4),c("x","y","z",-1,-1,n,i,-r,o,s,5),this.setIndex(h),this.addAttribute("position",new le(p,3)),this.addAttribute("normal",new le(v,3)),this.addAttribute("uv",new le(x,2))}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t}(re),fh={clone:$n,merge:zt};Rt.prototype=Object.create(ie.prototype),Rt.prototype.constructor=Rt,Rt.prototype.isShaderMaterial=!0,Rt.prototype.copy=function(e){return ie.prototype.copy.call(this,e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=$n(e.uniforms),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.lights=e.lights,this.clipping=e.clipping,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this.extensions=e.extensions,this},Rt.prototype.toJSON=function(e){var t=ie.prototype.toJSON.call(this,e);t.uniforms={};for(var n in this.uniforms){var i=this.uniforms[n].value;t.uniforms[n]=i&&i.isTexture?{type:"t",value:i.toJSON(e).uuid}:i&&i.isColor?{type:"c",value:i.getHex()}:i&&i.isVector2?{type:"v2",value:i.toArray()}:i&&i.isVector3?{type:"v3",value:i.toArray()}:i&&i.isVector4?{type:"v4",value:i.toArray()}:i&&i.isMatrix3?{type:"m3",value:i.toArray()}:i&&i.isMatrix4?{type:"m4",value:i.toArray()}:{value:i}}0<Object.keys(this.defines).length&&(t.defines=this.defines),t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader,e={};for(var r in this.extensions)this.extensions[r]===!0&&(e[r]=!0);return 0<Object.keys(e).length&&(t.extensions=e),t},$t.prototype=Object.assign(Object.create(W.prototype),{constructor:$t,isCamera:!0,copy:function(e,t){return W.prototype.copy.call(this,e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this},getWorldDirection:function(e){e===void 0&&(console.warn("THREE.Camera: .getWorldDirection() target is now required"),e=new E),this.updateMatrixWorld(!0);var t=this.matrixWorld.elements;return e.set(-t[8],-t[9],-t[10]).normalize()},updateMatrixWorld:function(e){W.prototype.updateMatrixWorld.call(this,e),this.matrixWorldInverse.getInverse(this.matrixWorld)},clone:function(){return new this.constructor().copy(this)}}),Je.prototype=Object.assign(Object.create($t.prototype),{constructor:Je,isPerspectiveCamera:!0,copy:function(e,t){return $t.prototype.copy.call(this,e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=e.view===null?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this},setFocalLength:function(e){e=.5*this.getFilmHeight()/e,this.fov=2*Xe.RAD2DEG*Math.atan(e),this.updateProjectionMatrix()},getFocalLength:function(){var e=Math.tan(.5*Xe.DEG2RAD*this.fov);return .5*this.getFilmHeight()/e},getEffectiveFOV:function(){return 2*Xe.RAD2DEG*Math.atan(Math.tan(.5*Xe.DEG2RAD*this.fov)/this.zoom)},getFilmWidth:function(){return this.filmGauge*Math.min(this.aspect,1)},getFilmHeight:function(){return this.filmGauge/Math.max(this.aspect,1)},setViewOffset:function(e,t,n,i,r,o){this.aspect=e/t,this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=i,this.view.width=r,this.view.height=o,this.updateProjectionMatrix()},clearViewOffset:function(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()},updateProjectionMatrix:function(){var e=this.near,t=e*Math.tan(.5*Xe.DEG2RAD*this.fov)/this.zoom,n=2*t,i=this.aspect*n,r=-.5*i,o=this.view;if(this.view!==null&&this.view.enabled){var s=o.fullWidth,a=o.fullHeight;r+=o.offsetX*i/s,t-=o.offsetY*n/a,i*=o.width/s,n*=o.height/a}o=this.filmOffset,o!==0&&(r+=e*o/this.getFilmWidth()),this.projectionMatrix.makePerspective(r,r+i,t,t-n,e,this.far),this.projectionMatrixInverse.getInverse(this.projectionMatrix)},toJSON:function(e){return e=W.prototype.toJSON.call(this,e),e.object.fov=this.fov,e.object.zoom=this.zoom,e.object.near=this.near,e.object.far=this.far,e.object.focus=this.focus,e.object.aspect=this.aspect,this.view!==null&&(e.object.view=Object.assign({},this.view)),e.object.filmGauge=this.filmGauge,e.object.filmOffset=this.filmOffset,e}}),Ei.prototype=Object.create(W.prototype),Ei.prototype.constructor=Ei,On.prototype=Object.create(je.prototype),On.prototype.constructor=On,On.prototype.isWebGLRenderTargetCube=!0,On.prototype.fromEquirectangularTexture=function(e,t){this.texture.type=t.type,this.texture.format=t.format,this.texture.encoding=t.encoding;var n=new It,i=new Rt({type:"CubemapFromEquirect",uniforms:$n({tEquirect:{value:null}}),vertexShader:`varying vec3 vWorldDirection;
vec3 transformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );
}
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
}`,fragmentShader:`uniform sampler2D tEquirect;
varying vec3 vWorldDirection;
#define RECIPROCAL_PI 0.31830988618
#define RECIPROCAL_PI2 0.15915494
void main() {
	vec3 direction = normalize( vWorldDirection );
	vec2 sampleUV;
	sampleUV.y = asin( clamp( direction.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;
	sampleUV.x = atan( direction.z, direction.x ) * RECIPROCAL_PI2 + 0.5;
	gl_FragColor = texture2D( tEquirect, sampleUV );
}`,side:1,blending:0});return i.uniforms.tEquirect.value=t,t=new yt(new ds(5,5,5),i),n.add(t),i=new Ei(1,10,1),i.renderTarget=this,i.renderTarget.texture.name="CubeCameraTexture",i.update(e,n),t.geometry.dispose(),t.material.dispose(),this},ei.prototype=Object.create(Ae.prototype),ei.prototype.constructor=ei,ei.prototype.isDataTexture=!0;var sl=new E,mh=new E,vh=new be;Object.assign(dn.prototype,{isPlane:!0,set:function(e,t){return this.normal.copy(e),this.constant=t,this},setComponents:function(e,t,n,i){return this.normal.set(e,t,n),this.constant=i,this},setFromNormalAndCoplanarPoint:function(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this},setFromCoplanarPoints:function(e,t,n){return t=sl.subVectors(n,t).cross(mh.subVectors(e,t)).normalize(),this.setFromNormalAndCoplanarPoint(t,e),this},clone:function(){return new this.constructor().copy(this)},copy:function(e){return this.normal.copy(e.normal),this.constant=e.constant,this},normalize:function(){var e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this},negate:function(){return this.constant*=-1,this.normal.negate(),this},distanceToPoint:function(e){return this.normal.dot(e)+this.constant},distanceToSphere:function(e){return this.distanceToPoint(e.center)-e.radius},projectPoint:function(e,t){return t===void 0&&(console.warn("THREE.Plane: .projectPoint() target is now required"),t=new E),t.copy(this.normal).multiplyScalar(-this.distanceToPoint(e)).add(e)},intersectLine:function(e,t){t===void 0&&(console.warn("THREE.Plane: .intersectLine() target is now required"),t=new E);var n=e.delta(sl),i=this.normal.dot(n);if(i===0){if(this.distanceToPoint(e.start)===0)return t.copy(e.start)}else if(i=-(e.start.dot(this.normal)+this.constant)/i,!(0>i||1<i))return t.copy(n).multiplyScalar(i).add(e.start)},intersectsLine:function(e){var t=this.distanceToPoint(e.start);return e=this.distanceToPoint(e.end),0>t&&0<e||0>e&&0<t},intersectsBox:function(e){return e.intersectsPlane(this)},intersectsSphere:function(e){return e.intersectsPlane(this)},coplanarPoint:function(e){return e===void 0&&(console.warn("THREE.Plane: .coplanarPoint() target is now required"),e=new E),e.copy(this.normal).multiplyScalar(-this.constant)},applyMatrix4:function(e,t){return t=t||vh.getNormalMatrix(e),e=this.coplanarPoint(sl).applyMatrix4(e),t=this.normal.applyMatrix3(t).normalize(),this.constant=-e.dot(t),this},translate:function(e){return this.constant-=e.dot(this.normal),this},equals:function(e){return e.normal.equals(this.normal)&&e.constant===this.constant}});var po=new ye,ba=new E;Object.assign(vn.prototype,{set:function(e,t,n,i,r,o){var s=this.planes;return s[0].copy(e),s[1].copy(t),s[2].copy(n),s[3].copy(i),s[4].copy(r),s[5].copy(o),this},clone:function(){return new this.constructor().copy(this)},copy:function(e){for(var t=this.planes,n=0;6>n;n++)t[n].copy(e.planes[n]);return this},setFromMatrix:function(e){var t=this.planes,n=e.elements;e=n[0];var i=n[1],r=n[2],o=n[3],s=n[4],a=n[5],c=n[6],u=n[7],h=n[8],p=n[9],v=n[10],x=n[11],y=n[12],M=n[13],L=n[14];return n=n[15],t[0].setComponents(o-e,u-s,x-h,n-y).normalize(),t[1].setComponents(o+e,u+s,x+h,n+y).normalize(),t[2].setComponents(o+i,u+a,x+p,n+M).normalize(),t[3].setComponents(o-i,u-a,x-p,n-M).normalize(),t[4].setComponents(o-r,u-c,x-v,n-L).normalize(),t[5].setComponents(o+r,u+c,x+v,n+L).normalize(),this},intersectsObject:function(e){var t=e.geometry;return t.boundingSphere===null&&t.computeBoundingSphere(),po.copy(t.boundingSphere).applyMatrix4(e.matrixWorld),this.intersectsSphere(po)},intersectsSprite:function(e){return po.center.set(0,0,0),po.radius=.7071067811865476,po.applyMatrix4(e.matrixWorld),this.intersectsSphere(po)},intersectsSphere:function(e){var t=this.planes,n=e.center;e=-e.radius;for(var i=0;6>i;i++)if(t[i].distanceToPoint(n)<e)return!1;return!0},intersectsBox:function(e){for(var t=this.planes,n=0;6>n;n++){var i=t[n];if(ba.x=0<i.normal.x?e.max.x:e.min.x,ba.y=0<i.normal.y?e.max.y:e.min.y,ba.z=0<i.normal.z?e.max.z:e.min.z,0>i.distanceToPoint(ba))return!1}return!0},containsPoint:function(e){for(var t=this.planes,n=0;6>n;n++)if(0>t[n].distanceToPoint(e))return!1;return!0}});var nt={alphamap_fragment:`#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, vUv ).g;
#endif`,alphamap_pars_fragment:`#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,alphatest_fragment:`#ifdef ALPHATEST
	if ( diffuseColor.a < ALPHATEST ) discard;
#endif`,aomap_fragment:`#ifdef USE_AOMAP
	float ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;
	reflectedLight.indirectDiffuse *= ambientOcclusion;
	#if defined( USE_ENVMAP ) && defined( STANDARD )
		float dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );
		reflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.specularRoughness );
	#endif
#endif`,aomap_pars_fragment:`#ifdef USE_AOMAP
	uniform sampler2D aoMap;
	uniform float aoMapIntensity;
#endif`,begin_vertex:"vec3 transformed = vec3( position );",beginnormal_vertex:`vec3 objectNormal = vec3( normal );
#ifdef USE_TANGENT
	vec3 objectTangent = vec3( tangent.xyz );
#endif`,bsdfs:`vec2 integrateSpecularBRDF( const in float dotNV, const in float roughness ) {
	const vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );
	const vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );
	vec4 r = roughness * c0 + c1;
	float a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;
	return vec2( -1.04, 1.04 ) * a004 + r.zw;
}
float punctualLightIntensityToIrradianceFactor( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {
#if defined ( PHYSICALLY_CORRECT_LIGHTS )
	float distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );
	if( cutoffDistance > 0.0 ) {
		distanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );
	}
	return distanceFalloff;
#else
	if( cutoffDistance > 0.0 && decayExponent > 0.0 ) {
		return pow( saturate( -lightDistance / cutoffDistance + 1.0 ), decayExponent );
	}
	return 1.0;
#endif
}
vec3 BRDF_Diffuse_Lambert( const in vec3 diffuseColor ) {
	return RECIPROCAL_PI * diffuseColor;
}
vec3 F_Schlick( const in vec3 specularColor, const in float dotLH ) {
	float fresnel = exp2( ( -5.55473 * dotLH - 6.98316 ) * dotLH );
	return ( 1.0 - specularColor ) * fresnel + specularColor;
}
vec3 F_Schlick_RoughnessDependent( const in vec3 F0, const in float dotNV, const in float roughness ) {
	float fresnel = exp2( ( -5.55473 * dotNV - 6.98316 ) * dotNV );
	vec3 Fr = max( vec3( 1.0 - roughness ), F0 ) - F0;
	return Fr * fresnel + F0;
}
float G_GGX_Smith( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gl = dotNL + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	float gv = dotNV + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	return 1.0 / ( gl * gv );
}
float G_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	float gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	return 0.5 / max( gv + gl, EPSILON );
}
float D_GGX( const in float alpha, const in float dotNH ) {
	float a2 = pow2( alpha );
	float denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;
	return RECIPROCAL_PI * a2 / pow2( denom );
}
vec3 BRDF_Specular_GGX( const in IncidentLight incidentLight, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float roughness ) {
	float alpha = pow2( roughness );
	vec3 halfDir = normalize( incidentLight.direction + viewDir );
	float dotNL = saturate( dot( normal, incidentLight.direction ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotLH = saturate( dot( incidentLight.direction, halfDir ) );
	vec3 F = F_Schlick( specularColor, dotLH );
	float G = G_GGX_SmithCorrelated( alpha, dotNL, dotNV );
	float D = D_GGX( alpha, dotNH );
	return F * ( G * D );
}
vec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {
	const float LUT_SIZE  = 64.0;
	const float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;
	const float LUT_BIAS  = 0.5 / LUT_SIZE;
	float dotNV = saturate( dot( N, V ) );
	vec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );
	uv = uv * LUT_SCALE + LUT_BIAS;
	return uv;
}
float LTC_ClippedSphereFormFactor( const in vec3 f ) {
	float l = length( f );
	return max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );
}
vec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {
	float x = dot( v1, v2 );
	float y = abs( x );
	float a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;
	float b = 3.4175940 + ( 4.1616724 + y ) * y;
	float v = a / b;
	float theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;
	return cross( v1, v2 ) * theta_sintheta;
}
vec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {
	vec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];
	vec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];
	vec3 lightNormal = cross( v1, v2 );
	if( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );
	vec3 T1, T2;
	T1 = normalize( V - N * dot( V, N ) );
	T2 = - cross( N, T1 );
	mat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );
	vec3 coords[ 4 ];
	coords[ 0 ] = mat * ( rectCoords[ 0 ] - P );
	coords[ 1 ] = mat * ( rectCoords[ 1 ] - P );
	coords[ 2 ] = mat * ( rectCoords[ 2 ] - P );
	coords[ 3 ] = mat * ( rectCoords[ 3 ] - P );
	coords[ 0 ] = normalize( coords[ 0 ] );
	coords[ 1 ] = normalize( coords[ 1 ] );
	coords[ 2 ] = normalize( coords[ 2 ] );
	coords[ 3 ] = normalize( coords[ 3 ] );
	vec3 vectorFormFactor = vec3( 0.0 );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );
	float result = LTC_ClippedSphereFormFactor( vectorFormFactor );
	return vec3( result );
}
vec3 BRDF_Specular_GGX_Environment( const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	vec2 brdf = integrateSpecularBRDF( dotNV, roughness );
	return specularColor * brdf.x + brdf.y;
}
void BRDF_Specular_Multiscattering_Environment( const in GeometricContext geometry, const in vec3 specularColor, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
	float dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );
	vec3 F = F_Schlick_RoughnessDependent( specularColor, dotNV, roughness );
	vec2 brdf = integrateSpecularBRDF( dotNV, roughness );
	vec3 FssEss = F * brdf.x + brdf.y;
	float Ess = brdf.x + brdf.y;
	float Ems = 1.0 - Ess;
	vec3 Favg = specularColor + ( 1.0 - specularColor ) * 0.047619;	vec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );
	singleScatter += FssEss;
	multiScatter += Fms * Ems;
}
float G_BlinnPhong_Implicit( ) {
	return 0.25;
}
float D_BlinnPhong( const in float shininess, const in float dotNH ) {
	return RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );
}
vec3 BRDF_Specular_BlinnPhong( const in IncidentLight incidentLight, const in GeometricContext geometry, const in vec3 specularColor, const in float shininess ) {
	vec3 halfDir = normalize( incidentLight.direction + geometry.viewDir );
	float dotNH = saturate( dot( geometry.normal, halfDir ) );
	float dotLH = saturate( dot( incidentLight.direction, halfDir ) );
	vec3 F = F_Schlick( specularColor, dotLH );
	float G = G_BlinnPhong_Implicit( );
	float D = D_BlinnPhong( shininess, dotNH );
	return F * ( G * D );
}
float GGXRoughnessToBlinnExponent( const in float ggxRoughness ) {
	return ( 2.0 / pow2( ggxRoughness + 0.0001 ) - 2.0 );
}
float BlinnExponentToGGXRoughness( const in float blinnExponent ) {
	return sqrt( 2.0 / ( blinnExponent + 2.0 ) );
}
#if defined( USE_SHEEN )
float D_Charlie(float roughness, float NoH) {
	float invAlpha  = 1.0 / roughness;
	float cos2h = NoH * NoH;
	float sin2h = max(1.0 - cos2h, 0.0078125);	return (2.0 + invAlpha) * pow(sin2h, invAlpha * 0.5) / (2.0 * PI);
}
float V_Neubelt(float NoV, float NoL) {
	return saturate(1.0 / (4.0 * (NoL + NoV - NoL * NoV)));
}
vec3 BRDF_Specular_Sheen( const in float roughness, const in vec3 L, const in GeometricContext geometry, vec3 specularColor ) {
	vec3 N = geometry.normal;
	vec3 V = geometry.viewDir;
	vec3 H = normalize( V + L );
	float dotNH = saturate( dot( N, H ) );
	return specularColor * D_Charlie( roughness, dotNH ) * V_Neubelt( dot(N, V), dot(N, L) );
}
#endif`,bumpmap_pars_fragment:`#ifdef USE_BUMPMAP
	uniform sampler2D bumpMap;
	uniform float bumpScale;
	vec2 dHdxy_fwd() {
		vec2 dSTdx = dFdx( vUv );
		vec2 dSTdy = dFdy( vUv );
		float Hll = bumpScale * texture2D( bumpMap, vUv ).x;
		float dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;
		float dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;
		return vec2( dBx, dBy );
	}
	vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy ) {
		vec3 vSigmaX = vec3( dFdx( surf_pos.x ), dFdx( surf_pos.y ), dFdx( surf_pos.z ) );
		vec3 vSigmaY = vec3( dFdy( surf_pos.x ), dFdy( surf_pos.y ), dFdy( surf_pos.z ) );
		vec3 vN = surf_norm;
		vec3 R1 = cross( vSigmaY, vN );
		vec3 R2 = cross( vN, vSigmaX );
		float fDet = dot( vSigmaX, R1 );
		fDet *= ( float( gl_FrontFacing ) * 2.0 - 1.0 );
		vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );
		return normalize( abs( fDet ) * surf_norm - vGrad );
	}
#endif`,clipping_planes_fragment:`#if NUM_CLIPPING_PLANES > 0
	vec4 plane;
	#pragma unroll_loop
	for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
		plane = clippingPlanes[ i ];
		if ( dot( vViewPosition, plane.xyz ) > plane.w ) discard;
	}
	#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
		bool clipped = true;
		#pragma unroll_loop
		for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			clipped = ( dot( vViewPosition, plane.xyz ) > plane.w ) && clipped;
		}
		if ( clipped ) discard;
	#endif
#endif`,clipping_planes_pars_fragment:`#if NUM_CLIPPING_PLANES > 0
	#if ! defined( STANDARD ) && ! defined( PHONG ) && ! defined( MATCAP )
		varying vec3 vViewPosition;
	#endif
	uniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];
#endif`,clipping_planes_pars_vertex:`#if NUM_CLIPPING_PLANES > 0 && ! defined( STANDARD ) && ! defined( PHONG ) && ! defined( MATCAP )
	varying vec3 vViewPosition;
#endif`,clipping_planes_vertex:`#if NUM_CLIPPING_PLANES > 0 && ! defined( STANDARD ) && ! defined( PHONG ) && ! defined( MATCAP )
	vViewPosition = - mvPosition.xyz;
#endif`,color_fragment:`#ifdef USE_COLOR
	diffuseColor.rgb *= vColor;
#endif`,color_pars_fragment:`#ifdef USE_COLOR
	varying vec3 vColor;
#endif`,color_pars_vertex:`#ifdef USE_COLOR
	varying vec3 vColor;
#endif`,color_vertex:`#ifdef USE_COLOR
	vColor.xyz = color.xyz;
#endif`,common:`#define PI 3.14159265359
#define PI2 6.28318530718
#define PI_HALF 1.5707963267949
#define RECIPROCAL_PI 0.31830988618
#define RECIPROCAL_PI2 0.15915494
#define LOG2 1.442695
#define EPSILON 1e-6
#ifndef saturate
#define saturate(a) clamp( a, 0.0, 1.0 )
#endif
#define whiteComplement(a) ( 1.0 - saturate( a ) )
float pow2( const in float x ) { return x*x; }
float pow3( const in float x ) { return x*x*x; }
float pow4( const in float x ) { float x2 = x*x; return x2*x2; }
float average( const in vec3 color ) { return dot( color, vec3( 0.3333 ) ); }
highp float rand( const in vec2 uv ) {
	const highp float a = 12.9898, b = 78.233, c = 43758.5453;
	highp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );
	return fract(sin(sn) * c);
}
#ifdef HIGH_PRECISION
	float precisionSafeLength( vec3 v ) { return length( v ); }
#else
	float max3( vec3 v ) { return max( max( v.x, v.y ), v.z ); }
	float precisionSafeLength( vec3 v ) {
		float maxComponent = max3( abs( v ) );
		return length( v / maxComponent ) * maxComponent;
	}
#endif
struct IncidentLight {
	vec3 color;
	vec3 direction;
	bool visible;
};
struct ReflectedLight {
	vec3 directDiffuse;
	vec3 directSpecular;
	vec3 indirectDiffuse;
	vec3 indirectSpecular;
};
struct GeometricContext {
	vec3 position;
	vec3 normal;
	vec3 viewDir;
#ifdef CLEARCOAT
	vec3 clearcoatNormal;
#endif
};
vec3 transformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );
}
vec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );
}
vec3 projectOnPlane(in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {
	float distance = dot( planeNormal, point - pointOnPlane );
	return - distance * planeNormal + point;
}
float sideOfPlane( in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {
	return sign( dot( point - pointOnPlane, planeNormal ) );
}
vec3 linePlaneIntersect( in vec3 pointOnLine, in vec3 lineDirection, in vec3 pointOnPlane, in vec3 planeNormal ) {
	return lineDirection * ( dot( planeNormal, pointOnPlane - pointOnLine ) / dot( planeNormal, lineDirection ) ) + pointOnLine;
}
mat3 transposeMat3( const in mat3 m ) {
	mat3 tmp;
	tmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );
	tmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );
	tmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );
	return tmp;
}
float linearToRelativeLuminance( const in vec3 color ) {
	vec3 weights = vec3( 0.2126, 0.7152, 0.0722 );
	return dot( weights, color.rgb );
}
bool isPerspectiveMatrix( mat4 m ) {
  return m[ 2 ][ 3 ] == - 1.0;
}`,cube_uv_reflection_fragment:`#ifdef ENVMAP_TYPE_CUBE_UV
#define cubeUV_textureSize (1024.0)
int getFaceFromDirection(vec3 direction) {
	vec3 absDirection = abs(direction);
	int face = -1;
	if( absDirection.x > absDirection.z ) {
		if(absDirection.x > absDirection.y )
			face = direction.x > 0.0 ? 0 : 3;
		else
			face = direction.y > 0.0 ? 1 : 4;
	}
	else {
		if(absDirection.z > absDirection.y )
			face = direction.z > 0.0 ? 2 : 5;
		else
			face = direction.y > 0.0 ? 1 : 4;
	}
	return face;
}
#define cubeUV_maxLods1  (log2(cubeUV_textureSize*0.25) - 1.0)
#define cubeUV_rangeClamp (exp2((6.0 - 1.0) * 2.0))
vec2 MipLevelInfo( vec3 vec, float roughnessLevel, float roughness ) {
	float scale = exp2(cubeUV_maxLods1 - roughnessLevel);
	float dxRoughness = dFdx(roughness);
	float dyRoughness = dFdy(roughness);
	vec3 dx = dFdx( vec * scale * dxRoughness );
	vec3 dy = dFdy( vec * scale * dyRoughness );
	float d = max( dot( dx, dx ), dot( dy, dy ) );
	d = clamp(d, 1.0, cubeUV_rangeClamp);
	float mipLevel = 0.5 * log2(d);
	return vec2(floor(mipLevel), fract(mipLevel));
}
#define cubeUV_maxLods2 (log2(cubeUV_textureSize*0.25) - 2.0)
#define cubeUV_rcpTextureSize (1.0 / cubeUV_textureSize)
vec2 getCubeUV(vec3 direction, float roughnessLevel, float mipLevel) {
	mipLevel = roughnessLevel > cubeUV_maxLods2 - 3.0 ? 0.0 : mipLevel;
	float a = 16.0 * cubeUV_rcpTextureSize;
	vec2 exp2_packed = exp2( vec2( roughnessLevel, mipLevel ) );
	vec2 rcp_exp2_packed = vec2( 1.0 ) / exp2_packed;
	float powScale = exp2_packed.x * exp2_packed.y;
	float scale = rcp_exp2_packed.x * rcp_exp2_packed.y * 0.25;
	float mipOffset = 0.75*(1.0 - rcp_exp2_packed.y) * rcp_exp2_packed.x;
	bool bRes = mipLevel == 0.0;
	scale =  bRes && (scale < a) ? a : scale;
	vec3 r;
	vec2 offset;
	int face = getFaceFromDirection(direction);
	float rcpPowScale = 1.0 / powScale;
	if( face == 0) {
		r = vec3(direction.x, -direction.z, direction.y);
		offset = vec2(0.0+mipOffset,0.75 * rcpPowScale);
		offset.y = bRes && (offset.y < 2.0*a) ? a : offset.y;
	}
	else if( face == 1) {
		r = vec3(direction.y, direction.x, direction.z);
		offset = vec2(scale+mipOffset, 0.75 * rcpPowScale);
		offset.y = bRes && (offset.y < 2.0*a) ? a : offset.y;
	}
	else if( face == 2) {
		r = vec3(direction.z, direction.x, direction.y);
		offset = vec2(2.0*scale+mipOffset, 0.75 * rcpPowScale);
		offset.y = bRes && (offset.y < 2.0*a) ? a : offset.y;
	}
	else if( face == 3) {
		r = vec3(direction.x, direction.z, direction.y);
		offset = vec2(0.0+mipOffset,0.5 * rcpPowScale);
		offset.y = bRes && (offset.y < 2.0*a) ? 0.0 : offset.y;
	}
	else if( face == 4) {
		r = vec3(direction.y, direction.x, -direction.z);
		offset = vec2(scale+mipOffset, 0.5 * rcpPowScale);
		offset.y = bRes && (offset.y < 2.0*a) ? 0.0 : offset.y;
	}
	else {
		r = vec3(direction.z, -direction.x, direction.y);
		offset = vec2(2.0*scale+mipOffset, 0.5 * rcpPowScale);
		offset.y = bRes && (offset.y < 2.0*a) ? 0.0 : offset.y;
	}
	r = normalize(r);
	float texelOffset = 0.5 * cubeUV_rcpTextureSize;
	vec2 s = ( r.yz / abs( r.x ) + vec2( 1.0 ) ) * 0.5;
	vec2 base = offset + vec2( texelOffset );
	return base + s * ( scale - 2.0 * texelOffset );
}
#define cubeUV_maxLods3 (log2(cubeUV_textureSize*0.25) - 3.0)
vec4 textureCubeUV( sampler2D envMap, vec3 reflectedDirection, float roughness ) {
	float roughnessVal = roughness* cubeUV_maxLods3;
	float r1 = floor(roughnessVal);
	float r2 = r1 + 1.0;
	float t = fract(roughnessVal);
	vec2 mipInfo = MipLevelInfo(reflectedDirection, r1, roughness);
	float s = mipInfo.y;
	float level0 = mipInfo.x;
	float level1 = level0 + 1.0;
	level1 = level1 > 5.0 ? 5.0 : level1;
	level0 += min( floor( s + 0.5 ), 5.0 );
	vec2 uv_10 = getCubeUV(reflectedDirection, r1, level0);
	vec4 color10 = envMapTexelToLinear(texture2D(envMap, uv_10));
	vec2 uv_20 = getCubeUV(reflectedDirection, r2, level0);
	vec4 color20 = envMapTexelToLinear(texture2D(envMap, uv_20));
	vec4 result = mix(color10, color20, t);
	return vec4(result.rgb, 1.0);
}
#endif`,defaultnormal_vertex:`vec3 transformedNormal = objectNormal;
#ifdef USE_INSTANCING
	transformedNormal = mat3( instanceMatrix ) * transformedNormal;
#endif
transformedNormal = normalMatrix * transformedNormal;
#ifdef FLIP_SIDED
	transformedNormal = - transformedNormal;
#endif
#ifdef USE_TANGENT
	vec3 transformedTangent = normalMatrix * objectTangent;
	#ifdef FLIP_SIDED
		transformedTangent = - transformedTangent;
	#endif
#endif`,displacementmap_pars_vertex:`#ifdef USE_DISPLACEMENTMAP
	uniform sampler2D displacementMap;
	uniform float displacementScale;
	uniform float displacementBias;
#endif`,displacementmap_vertex:`#ifdef USE_DISPLACEMENTMAP
	transformed += normalize( objectNormal ) * ( texture2D( displacementMap, vUv ).x * displacementScale + displacementBias );
#endif`,emissivemap_fragment:`#ifdef USE_EMISSIVEMAP
	vec4 emissiveColor = texture2D( emissiveMap, vUv );
	emissiveColor.rgb = emissiveMapTexelToLinear( emissiveColor ).rgb;
	totalEmissiveRadiance *= emissiveColor.rgb;
#endif`,emissivemap_pars_fragment:`#ifdef USE_EMISSIVEMAP
	uniform sampler2D emissiveMap;
#endif`,encodings_fragment:"gl_FragColor = linearToOutputTexel( gl_FragColor );",encodings_pars_fragment:`
vec4 LinearToLinear( in vec4 value ) {
	return value;
}
vec4 GammaToLinear( in vec4 value, in float gammaFactor ) {
	return vec4( pow( value.rgb, vec3( gammaFactor ) ), value.a );
}
vec4 LinearToGamma( in vec4 value, in float gammaFactor ) {
	return vec4( pow( value.rgb, vec3( 1.0 / gammaFactor ) ), value.a );
}
vec4 sRGBToLinear( in vec4 value ) {
	return vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.a );
}
vec4 LinearTosRGB( in vec4 value ) {
	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );
}
vec4 RGBEToLinear( in vec4 value ) {
	return vec4( value.rgb * exp2( value.a * 255.0 - 128.0 ), 1.0 );
}
vec4 LinearToRGBE( in vec4 value ) {
	float maxComponent = max( max( value.r, value.g ), value.b );
	float fExp = clamp( ceil( log2( maxComponent ) ), -128.0, 127.0 );
	return vec4( value.rgb / exp2( fExp ), ( fExp + 128.0 ) / 255.0 );
}
vec4 RGBMToLinear( in vec4 value, in float maxRange ) {
	return vec4( value.rgb * value.a * maxRange, 1.0 );
}
vec4 LinearToRGBM( in vec4 value, in float maxRange ) {
	float maxRGB = max( value.r, max( value.g, value.b ) );
	float M = clamp( maxRGB / maxRange, 0.0, 1.0 );
	M = ceil( M * 255.0 ) / 255.0;
	return vec4( value.rgb / ( M * maxRange ), M );
}
vec4 RGBDToLinear( in vec4 value, in float maxRange ) {
	return vec4( value.rgb * ( ( maxRange / 255.0 ) / value.a ), 1.0 );
}
vec4 LinearToRGBD( in vec4 value, in float maxRange ) {
	float maxRGB = max( value.r, max( value.g, value.b ) );
	float D = max( maxRange / maxRGB, 1.0 );
	D = min( floor( D ) / 255.0, 1.0 );
	return vec4( value.rgb * ( D * ( 255.0 / maxRange ) ), D );
}
const mat3 cLogLuvM = mat3( 0.2209, 0.3390, 0.4184, 0.1138, 0.6780, 0.7319, 0.0102, 0.1130, 0.2969 );
vec4 LinearToLogLuv( in vec4 value )  {
	vec3 Xp_Y_XYZp = cLogLuvM * value.rgb;
	Xp_Y_XYZp = max( Xp_Y_XYZp, vec3( 1e-6, 1e-6, 1e-6 ) );
	vec4 vResult;
	vResult.xy = Xp_Y_XYZp.xy / Xp_Y_XYZp.z;
	float Le = 2.0 * log2(Xp_Y_XYZp.y) + 127.0;
	vResult.w = fract( Le );
	vResult.z = ( Le - ( floor( vResult.w * 255.0 ) ) / 255.0 ) / 255.0;
	return vResult;
}
const mat3 cLogLuvInverseM = mat3( 6.0014, -2.7008, -1.7996, -1.3320, 3.1029, -5.7721, 0.3008, -1.0882, 5.6268 );
vec4 LogLuvToLinear( in vec4 value ) {
	float Le = value.z * 255.0 + value.w;
	vec3 Xp_Y_XYZp;
	Xp_Y_XYZp.y = exp2( ( Le - 127.0 ) / 2.0 );
	Xp_Y_XYZp.z = Xp_Y_XYZp.y / value.y;
	Xp_Y_XYZp.x = value.x * Xp_Y_XYZp.z;
	vec3 vRGB = cLogLuvInverseM * Xp_Y_XYZp.rgb;
	return vec4( max( vRGB, 0.0 ), 1.0 );
}`,envmap_fragment:`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vec3 cameraToVertex = normalize( vWorldPosition - cameraPosition );
		vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vec3 reflectVec = reflect( cameraToVertex, worldNormal );
		#else
			vec3 reflectVec = refract( cameraToVertex, worldNormal, refractionRatio );
		#endif
	#else
		vec3 reflectVec = vReflect;
	#endif
	#ifdef ENVMAP_TYPE_CUBE
		vec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );
	#elif defined( ENVMAP_TYPE_EQUIREC )
		vec2 sampleUV;
		reflectVec = normalize( reflectVec );
		sampleUV.y = asin( clamp( reflectVec.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;
		sampleUV.x = atan( reflectVec.z, reflectVec.x ) * RECIPROCAL_PI2 + 0.5;
		vec4 envColor = texture2D( envMap, sampleUV );
	#elif defined( ENVMAP_TYPE_SPHERE )
		reflectVec = normalize( reflectVec );
		vec3 reflectView = normalize( ( viewMatrix * vec4( reflectVec, 0.0 ) ).xyz + vec3( 0.0, 0.0, 1.0 ) );
		vec4 envColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5 );
	#else
		vec4 envColor = vec4( 0.0 );
	#endif
	envColor = envMapTexelToLinear( envColor );
	#ifdef ENVMAP_BLENDING_MULTIPLY
		outgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_MIX )
		outgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_ADD )
		outgoingLight += envColor.xyz * specularStrength * reflectivity;
	#endif
#endif`,envmap_common_pars_fragment:`#ifdef USE_ENVMAP
	uniform float envMapIntensity;
	uniform float flipEnvMap;
	uniform int maxMipLevel;
	#ifdef ENVMAP_TYPE_CUBE
		uniform samplerCube envMap;
	#else
		uniform sampler2D envMap;
	#endif
	
#endif`,envmap_pars_fragment:`#ifdef USE_ENVMAP
	uniform float reflectivity;
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		varying vec3 vWorldPosition;
		uniform float refractionRatio;
	#else
		varying vec3 vReflect;
	#endif
#endif`,envmap_pars_vertex:`#ifdef USE_ENVMAP
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) ||defined( PHONG )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		
		varying vec3 vWorldPosition;
	#else
		varying vec3 vReflect;
		uniform float refractionRatio;
	#endif
#endif`,envmap_physical_pars_fragment:`#if defined( USE_ENVMAP )
	#ifdef ENVMAP_MODE_REFRACTION
		uniform float refractionRatio;
	#endif
	vec3 getLightProbeIndirectIrradiance( const in GeometricContext geometry, const in int maxMIPLevel ) {
		vec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );
		#ifdef ENVMAP_TYPE_CUBE
			vec3 queryVec = vec3( flipEnvMap * worldNormal.x, worldNormal.yz );
			#ifdef TEXTURE_LOD_EXT
				vec4 envMapColor = textureCubeLodEXT( envMap, queryVec, float( maxMIPLevel ) );
			#else
				vec4 envMapColor = textureCube( envMap, queryVec, float( maxMIPLevel ) );
			#endif
			envMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;
		#elif defined( ENVMAP_TYPE_CUBE_UV )
			vec3 queryVec = vec3( flipEnvMap * worldNormal.x, worldNormal.yz );
			vec4 envMapColor = textureCubeUV( envMap, queryVec, 1.0 );
		#else
			vec4 envMapColor = vec4( 0.0 );
		#endif
		return PI * envMapColor.rgb * envMapIntensity;
	}
	float getSpecularMIPLevel( const in float roughness, const in int maxMIPLevel ) {
		float maxMIPLevelScalar = float( maxMIPLevel );
		float sigma = PI * roughness * roughness / ( 1.0 + roughness );
		float desiredMIPLevel = maxMIPLevelScalar + log2( sigma );
		return clamp( desiredMIPLevel, 0.0, maxMIPLevelScalar );
	}
	vec3 getLightProbeIndirectRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in int maxMIPLevel ) {
		#ifdef ENVMAP_MODE_REFLECTION
		  vec3 reflectVec = reflect( -viewDir, normal );
		  reflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );
		#else
		  vec3 reflectVec = refract( -viewDir, normal, refractionRatio );
		#endif
		reflectVec = inverseTransformDirection( reflectVec, viewMatrix );
		float specularMIPLevel = getSpecularMIPLevel( roughness, maxMIPLevel );
		#ifdef ENVMAP_TYPE_CUBE
			vec3 queryReflectVec = vec3( flipEnvMap * reflectVec.x, reflectVec.yz );
			#ifdef TEXTURE_LOD_EXT
				vec4 envMapColor = textureCubeLodEXT( envMap, queryReflectVec, specularMIPLevel );
			#else
				vec4 envMapColor = textureCube( envMap, queryReflectVec, specularMIPLevel );
			#endif
			envMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;
		#elif defined( ENVMAP_TYPE_CUBE_UV )
			vec3 queryReflectVec = vec3( flipEnvMap * reflectVec.x, reflectVec.yz );
			vec4 envMapColor = textureCubeUV( envMap, queryReflectVec, roughness );
		#elif defined( ENVMAP_TYPE_EQUIREC )
			vec2 sampleUV;
			sampleUV.y = asin( clamp( reflectVec.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;
			sampleUV.x = atan( reflectVec.z, reflectVec.x ) * RECIPROCAL_PI2 + 0.5;
			#ifdef TEXTURE_LOD_EXT
				vec4 envMapColor = texture2DLodEXT( envMap, sampleUV, specularMIPLevel );
			#else
				vec4 envMapColor = texture2D( envMap, sampleUV, specularMIPLevel );
			#endif
			envMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;
		#elif defined( ENVMAP_TYPE_SPHERE )
			vec3 reflectView = normalize( ( viewMatrix * vec4( reflectVec, 0.0 ) ).xyz + vec3( 0.0,0.0,1.0 ) );
			#ifdef TEXTURE_LOD_EXT
				vec4 envMapColor = texture2DLodEXT( envMap, reflectView.xy * 0.5 + 0.5, specularMIPLevel );
			#else
				vec4 envMapColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5, specularMIPLevel );
			#endif
			envMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;
		#endif
		return envMapColor.rgb * envMapIntensity;
	}
#endif`,envmap_vertex:`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vWorldPosition = worldPosition.xyz;
	#else
		vec3 cameraToVertex = normalize( worldPosition.xyz - cameraPosition );
		vec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vReflect = reflect( cameraToVertex, worldNormal );
		#else
			vReflect = refract( cameraToVertex, worldNormal, refractionRatio );
		#endif
	#endif
#endif`,fog_vertex:`#ifdef USE_FOG
	fogDepth = -mvPosition.z;
#endif`,fog_pars_vertex:`#ifdef USE_FOG
	varying float fogDepth;
#endif`,fog_fragment:`#ifdef USE_FOG
	#ifdef FOG_EXP2
		float fogFactor = 1.0 - exp( - fogDensity * fogDensity * fogDepth * fogDepth );
	#else
		float fogFactor = smoothstep( fogNear, fogFar, fogDepth );
	#endif
	gl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );
#endif`,fog_pars_fragment:`#ifdef USE_FOG
	uniform vec3 fogColor;
	varying float fogDepth;
	#ifdef FOG_EXP2
		uniform float fogDensity;
	#else
		uniform float fogNear;
		uniform float fogFar;
	#endif
#endif`,gradientmap_pars_fragment:`#ifdef TOON
	uniform sampler2D gradientMap;
	vec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {
		float dotNL = dot( normal, lightDirection );
		vec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );
		#ifdef USE_GRADIENTMAP
			return texture2D( gradientMap, coord ).rgb;
		#else
			return ( coord.x < 0.7 ) ? vec3( 0.7 ) : vec3( 1.0 );
		#endif
	}
#endif`,lightmap_fragment:`#ifdef USE_LIGHTMAP
	reflectedLight.indirectDiffuse += PI * texture2D( lightMap, vUv2 ).xyz * lightMapIntensity;
#endif`,lightmap_pars_fragment:`#ifdef USE_LIGHTMAP
	uniform sampler2D lightMap;
	uniform float lightMapIntensity;
#endif`,lights_lambert_vertex:`vec3 diffuse = vec3( 1.0 );
GeometricContext geometry;
geometry.position = mvPosition.xyz;
geometry.normal = normalize( transformedNormal );
geometry.viewDir = normalize( -mvPosition.xyz );
GeometricContext backGeometry;
backGeometry.position = geometry.position;
backGeometry.normal = -geometry.normal;
backGeometry.viewDir = geometry.viewDir;
vLightFront = vec3( 0.0 );
vIndirectFront = vec3( 0.0 );
#ifdef DOUBLE_SIDED
	vLightBack = vec3( 0.0 );
	vIndirectBack = vec3( 0.0 );
#endif
IncidentLight directLight;
float dotNL;
vec3 directLightColor_Diffuse;
#if NUM_POINT_LIGHTS > 0
	#pragma unroll_loop
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		getPointDirectLightIrradiance( pointLights[ i ], geometry, directLight );
		dotNL = dot( geometry.normal, directLight.direction );
		directLightColor_Diffuse = PI * directLight.color;
		vLightFront += saturate( dotNL ) * directLightColor_Diffuse;
		#ifdef DOUBLE_SIDED
			vLightBack += saturate( -dotNL ) * directLightColor_Diffuse;
		#endif
	}
#endif
#if NUM_SPOT_LIGHTS > 0
	#pragma unroll_loop
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		getSpotDirectLightIrradiance( spotLights[ i ], geometry, directLight );
		dotNL = dot( geometry.normal, directLight.direction );
		directLightColor_Diffuse = PI * directLight.color;
		vLightFront += saturate( dotNL ) * directLightColor_Diffuse;
		#ifdef DOUBLE_SIDED
			vLightBack += saturate( -dotNL ) * directLightColor_Diffuse;
		#endif
	}
#endif
#if NUM_DIR_LIGHTS > 0
	#pragma unroll_loop
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		getDirectionalDirectLightIrradiance( directionalLights[ i ], geometry, directLight );
		dotNL = dot( geometry.normal, directLight.direction );
		directLightColor_Diffuse = PI * directLight.color;
		vLightFront += saturate( dotNL ) * directLightColor_Diffuse;
		#ifdef DOUBLE_SIDED
			vLightBack += saturate( -dotNL ) * directLightColor_Diffuse;
		#endif
	}
#endif
#if NUM_HEMI_LIGHTS > 0
	#pragma unroll_loop
	for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
		vIndirectFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );
		#ifdef DOUBLE_SIDED
			vIndirectBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry );
		#endif
	}
#endif`,lights_pars_begin:`uniform bool receiveShadow;
uniform vec3 ambientLightColor;
uniform vec3 lightProbe[ 9 ];
vec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {
	float x = normal.x, y = normal.y, z = normal.z;
	vec3 result = shCoefficients[ 0 ] * 0.886227;
	result += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;
	result += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;
	result += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;
	result += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;
	result += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;
	result += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );
	result += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;
	result += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );
	return result;
}
vec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in GeometricContext geometry ) {
	vec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );
	vec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );
	return irradiance;
}
vec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {
	vec3 irradiance = ambientLightColor;
	#ifndef PHYSICALLY_CORRECT_LIGHTS
		irradiance *= PI;
	#endif
	return irradiance;
}
#if NUM_DIR_LIGHTS > 0
	struct DirectionalLight {
		vec3 direction;
		vec3 color;
		int shadow;
		float shadowBias;
		float shadowRadius;
		vec2 shadowMapSize;
	};
	uniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];
	void getDirectionalDirectLightIrradiance( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight directLight ) {
		directLight.color = directionalLight.color;
		directLight.direction = directionalLight.direction;
		directLight.visible = true;
	}
#endif
#if NUM_POINT_LIGHTS > 0
	struct PointLight {
		vec3 position;
		vec3 color;
		float distance;
		float decay;
		int shadow;
		float shadowBias;
		float shadowRadius;
		vec2 shadowMapSize;
		float shadowCameraNear;
		float shadowCameraFar;
	};
	uniform PointLight pointLights[ NUM_POINT_LIGHTS ];
	void getPointDirectLightIrradiance( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight directLight ) {
		vec3 lVector = pointLight.position - geometry.position;
		directLight.direction = normalize( lVector );
		float lightDistance = length( lVector );
		directLight.color = pointLight.color;
		directLight.color *= punctualLightIntensityToIrradianceFactor( lightDistance, pointLight.distance, pointLight.decay );
		directLight.visible = ( directLight.color != vec3( 0.0 ) );
	}
#endif
#if NUM_SPOT_LIGHTS > 0
	struct SpotLight {
		vec3 position;
		vec3 direction;
		vec3 color;
		float distance;
		float decay;
		float coneCos;
		float penumbraCos;
		int shadow;
		float shadowBias;
		float shadowRadius;
		vec2 shadowMapSize;
	};
	uniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];
	void getSpotDirectLightIrradiance( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight directLight  ) {
		vec3 lVector = spotLight.position - geometry.position;
		directLight.direction = normalize( lVector );
		float lightDistance = length( lVector );
		float angleCos = dot( directLight.direction, spotLight.direction );
		if ( angleCos > spotLight.coneCos ) {
			float spotEffect = smoothstep( spotLight.coneCos, spotLight.penumbraCos, angleCos );
			directLight.color = spotLight.color;
			directLight.color *= spotEffect * punctualLightIntensityToIrradianceFactor( lightDistance, spotLight.distance, spotLight.decay );
			directLight.visible = true;
		} else {
			directLight.color = vec3( 0.0 );
			directLight.visible = false;
		}
	}
#endif
#if NUM_RECT_AREA_LIGHTS > 0
	struct RectAreaLight {
		vec3 color;
		vec3 position;
		vec3 halfWidth;
		vec3 halfHeight;
	};
	uniform sampler2D ltc_1;	uniform sampler2D ltc_2;
	uniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];
#endif
#if NUM_HEMI_LIGHTS > 0
	struct HemisphereLight {
		vec3 direction;
		vec3 skyColor;
		vec3 groundColor;
	};
	uniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];
	vec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in GeometricContext geometry ) {
		float dotNL = dot( geometry.normal, hemiLight.direction );
		float hemiDiffuseWeight = 0.5 * dotNL + 0.5;
		vec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );
		#ifndef PHYSICALLY_CORRECT_LIGHTS
			irradiance *= PI;
		#endif
		return irradiance;
	}
#endif`,lights_phong_fragment:`BlinnPhongMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularColor = specular;
material.specularShininess = shininess;
material.specularStrength = specularStrength;`,lights_phong_pars_fragment:`varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
struct BlinnPhongMaterial {
	vec3	diffuseColor;
	vec3	specularColor;
	float	specularShininess;
	float	specularStrength;
};
void RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	#ifdef TOON
		vec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;
	#else
		float dotNL = saturate( dot( geometry.normal, directLight.direction ) );
		vec3 irradiance = dotNL * directLight.color;
	#endif
	#ifndef PHYSICALLY_CORRECT_LIGHTS
		irradiance *= PI;
	#endif
	reflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );
	reflectedLight.directSpecular += irradiance * BRDF_Specular_BlinnPhong( directLight, geometry, material.specularColor, material.specularShininess ) * material.specularStrength;
}
void RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_BlinnPhong
#define RE_IndirectDiffuse		RE_IndirectDiffuse_BlinnPhong
#define Material_LightProbeLOD( material )	(0)`,lights_physical_fragment:`PhysicalMaterial material;
material.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );
material.specularRoughness = clamp( roughnessFactor, 0.04, 1.0 );
#ifdef REFLECTIVITY
	material.specularColor = mix( vec3( MAXIMUM_SPECULAR_COEFFICIENT * pow2( reflectivity ) ), diffuseColor.rgb, metalnessFactor );
#else
	material.specularColor = mix( vec3( DEFAULT_SPECULAR_COEFFICIENT ), diffuseColor.rgb, metalnessFactor );
#endif
#ifdef CLEARCOAT
	material.clearcoat = saturate( clearcoat );	material.clearcoatRoughness = clamp( clearcoatRoughness, 0.04, 1.0 );
#endif
#ifdef USE_SHEEN
	material.sheenColor = sheen;
#endif`,lights_physical_pars_fragment:`struct PhysicalMaterial {
	vec3	diffuseColor;
	float	specularRoughness;
	vec3	specularColor;
#ifdef CLEARCOAT
	float clearcoat;
	float clearcoatRoughness;
#endif
#ifdef USE_SHEEN
	vec3 sheenColor;
#endif
};
#define MAXIMUM_SPECULAR_COEFFICIENT 0.16
#define DEFAULT_SPECULAR_COEFFICIENT 0.04
float clearcoatDHRApprox( const in float roughness, const in float dotNL ) {
	return DEFAULT_SPECULAR_COEFFICIENT + ( 1.0 - DEFAULT_SPECULAR_COEFFICIENT ) * ( pow( 1.0 - dotNL, 5.0 ) * pow( 1.0 - roughness, 2.0 ) );
}
#if NUM_RECT_AREA_LIGHTS > 0
	void RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
		vec3 normal = geometry.normal;
		vec3 viewDir = geometry.viewDir;
		vec3 position = geometry.position;
		vec3 lightPos = rectAreaLight.position;
		vec3 halfWidth = rectAreaLight.halfWidth;
		vec3 halfHeight = rectAreaLight.halfHeight;
		vec3 lightColor = rectAreaLight.color;
		float roughness = material.specularRoughness;
		vec3 rectCoords[ 4 ];
		rectCoords[ 0 ] = lightPos + halfWidth - halfHeight;		rectCoords[ 1 ] = lightPos - halfWidth - halfHeight;
		rectCoords[ 2 ] = lightPos - halfWidth + halfHeight;
		rectCoords[ 3 ] = lightPos + halfWidth + halfHeight;
		vec2 uv = LTC_Uv( normal, viewDir, roughness );
		vec4 t1 = texture2D( ltc_1, uv );
		vec4 t2 = texture2D( ltc_2, uv );
		mat3 mInv = mat3(
			vec3( t1.x, 0, t1.y ),
			vec3(    0, 1,    0 ),
			vec3( t1.z, 0, t1.w )
		);
		vec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );
		reflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );
		reflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );
	}
#endif
void RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifndef PHYSICALLY_CORRECT_LIGHTS
		irradiance *= PI;
	#endif
	#ifdef CLEARCOAT
		float ccDotNL = saturate( dot( geometry.clearcoatNormal, directLight.direction ) );
		vec3 ccIrradiance = ccDotNL * directLight.color;
		#ifndef PHYSICALLY_CORRECT_LIGHTS
			ccIrradiance *= PI;
		#endif
		float clearcoatDHR = material.clearcoat * clearcoatDHRApprox( material.clearcoatRoughness, ccDotNL );
		reflectedLight.directSpecular += ccIrradiance * material.clearcoat * BRDF_Specular_GGX( directLight, geometry.viewDir, geometry.clearcoatNormal, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearcoatRoughness );
	#else
		float clearcoatDHR = 0.0;
	#endif
	#ifdef USE_SHEEN
		reflectedLight.directSpecular += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Specular_Sheen(
			material.specularRoughness,
			directLight.direction,
			geometry,
			material.sheenColor
		);
	#else
		reflectedLight.directSpecular += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Specular_GGX( directLight, geometry.viewDir, geometry.normal, material.specularColor, material.specularRoughness);
	#endif
	reflectedLight.directDiffuse += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );
}
void RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {
	#ifdef CLEARCOAT
		float ccDotNV = saturate( dot( geometry.clearcoatNormal, geometry.viewDir ) );
		reflectedLight.indirectSpecular += clearcoatRadiance * material.clearcoat * BRDF_Specular_GGX_Environment( geometry.viewDir, geometry.clearcoatNormal, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearcoatRoughness );
		float ccDotNL = ccDotNV;
		float clearcoatDHR = material.clearcoat * clearcoatDHRApprox( material.clearcoatRoughness, ccDotNL );
	#else
		float clearcoatDHR = 0.0;
	#endif
	float clearcoatInv = 1.0 - clearcoatDHR;
	vec3 singleScattering = vec3( 0.0 );
	vec3 multiScattering = vec3( 0.0 );
	vec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;
	BRDF_Specular_Multiscattering_Environment( geometry, material.specularColor, material.specularRoughness, singleScattering, multiScattering );
	vec3 diffuse = material.diffuseColor * ( 1.0 - ( singleScattering + multiScattering ) );
	reflectedLight.indirectSpecular += clearcoatInv * radiance * singleScattering;
	reflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;
	reflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;
}
#define RE_Direct				RE_Direct_Physical
#define RE_Direct_RectArea		RE_Direct_RectArea_Physical
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Physical
#define RE_IndirectSpecular		RE_IndirectSpecular_Physical
float computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {
	return saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );
}`,lights_fragment_begin:`
GeometricContext geometry;
geometry.position = - vViewPosition;
geometry.normal = normal;
geometry.viewDir = normalize( vViewPosition );
#ifdef CLEARCOAT
	geometry.clearcoatNormal = clearcoatNormal;
#endif
IncidentLight directLight;
#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )
	PointLight pointLight;
	#pragma unroll_loop
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		pointLight = pointLights[ i ];
		getPointDirectLightIrradiance( pointLight, geometry, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )
		directLight.color *= all( bvec3( pointLight.shadow, directLight.visible, receiveShadow ) ) ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
#endif
#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )
	SpotLight spotLight;
	#pragma unroll_loop
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		spotLight = spotLights[ i ];
		getSpotDirectLightIrradiance( spotLight, geometry, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		directLight.color *= all( bvec3( spotLight.shadow, directLight.visible, receiveShadow ) ) ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
#endif
#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )
	DirectionalLight directionalLight;
	#pragma unroll_loop
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		directionalLight = directionalLights[ i ];
		getDirectionalDirectLightIrradiance( directionalLight, geometry, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )
		directLight.color *= all( bvec3( directionalLight.shadow, directLight.visible, receiveShadow ) ) ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
#endif
#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )
	RectAreaLight rectAreaLight;
	#pragma unroll_loop
	for ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {
		rectAreaLight = rectAreaLights[ i ];
		RE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );
	}
#endif
#if defined( RE_IndirectDiffuse )
	vec3 iblIrradiance = vec3( 0.0 );
	vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );
	irradiance += getLightProbeIrradiance( lightProbe, geometry );
	#if ( NUM_HEMI_LIGHTS > 0 )
		#pragma unroll_loop
		for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
			irradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );
		}
	#endif
#endif
#if defined( RE_IndirectSpecular )
	vec3 radiance = vec3( 0.0 );
	vec3 clearcoatRadiance = vec3( 0.0 );
#endif`,lights_fragment_maps:`#if defined( RE_IndirectDiffuse )
	#ifdef USE_LIGHTMAP
		vec3 lightMapIrradiance = texture2D( lightMap, vUv2 ).xyz * lightMapIntensity;
		#ifndef PHYSICALLY_CORRECT_LIGHTS
			lightMapIrradiance *= PI;
		#endif
		irradiance += lightMapIrradiance;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )
		iblIrradiance += getLightProbeIndirectIrradiance( geometry, maxMipLevel );
	#endif
#endif
#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )
	radiance += getLightProbeIndirectRadiance( geometry.viewDir, geometry.normal, material.specularRoughness, maxMipLevel );
	#ifdef CLEARCOAT
		clearcoatRadiance += getLightProbeIndirectRadiance( geometry.viewDir, geometry.clearcoatNormal, material.clearcoatRoughness, maxMipLevel );
	#endif
#endif`,lights_fragment_end:`#if defined( RE_IndirectDiffuse )
	RE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );
#endif
#if defined( RE_IndirectSpecular )
	RE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometry, material, reflectedLight );
#endif`,logdepthbuf_fragment:`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	gl_FragDepthEXT = vIsPerspective == 1.0 ? log2( vFragDepth ) * logDepthBufFC * 0.5 : gl_FragCoord.z;
#endif`,logdepthbuf_pars_fragment:`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	uniform float logDepthBufFC;
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,logdepthbuf_pars_vertex:`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		varying float vFragDepth;
		varying float vIsPerspective;
	#else
		uniform float logDepthBufFC;
	#endif
#endif`,logdepthbuf_vertex:`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		vFragDepth = 1.0 + gl_Position.w;
		vIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );
	#else
		if ( isPerspectiveMatrix( projectionMatrix ) ) {
			gl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;
			gl_Position.z *= gl_Position.w;
		}
	#endif
#endif`,map_fragment:`#ifdef USE_MAP
	vec4 texelColor = texture2D( map, vUv );
	texelColor = mapTexelToLinear( texelColor );
	diffuseColor *= texelColor;
#endif`,map_pars_fragment:`#ifdef USE_MAP
	uniform sampler2D map;
#endif`,map_particle_fragment:`#ifdef USE_MAP
	vec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;
	vec4 mapTexel = texture2D( map, uv );
	diffuseColor *= mapTexelToLinear( mapTexel );
#endif`,map_particle_pars_fragment:`#ifdef USE_MAP
	uniform mat3 uvTransform;
	uniform sampler2D map;
#endif`,metalnessmap_fragment:`float metalnessFactor = metalness;
#ifdef USE_METALNESSMAP
	vec4 texelMetalness = texture2D( metalnessMap, vUv );
	metalnessFactor *= texelMetalness.b;
#endif`,metalnessmap_pars_fragment:`#ifdef USE_METALNESSMAP
	uniform sampler2D metalnessMap;
#endif`,morphnormal_vertex:`#ifdef USE_MORPHNORMALS
	objectNormal += ( morphNormal0 - normal ) * morphTargetInfluences[ 0 ];
	objectNormal += ( morphNormal1 - normal ) * morphTargetInfluences[ 1 ];
	objectNormal += ( morphNormal2 - normal ) * morphTargetInfluences[ 2 ];
	objectNormal += ( morphNormal3 - normal ) * morphTargetInfluences[ 3 ];
#endif`,morphtarget_pars_vertex:`#ifdef USE_MORPHTARGETS
	#ifndef USE_MORPHNORMALS
	uniform float morphTargetInfluences[ 8 ];
	#else
	uniform float morphTargetInfluences[ 4 ];
	#endif
#endif`,morphtarget_vertex:`#ifdef USE_MORPHTARGETS
	transformed += ( morphTarget0 - position ) * morphTargetInfluences[ 0 ];
	transformed += ( morphTarget1 - position ) * morphTargetInfluences[ 1 ];
	transformed += ( morphTarget2 - position ) * morphTargetInfluences[ 2 ];
	transformed += ( morphTarget3 - position ) * morphTargetInfluences[ 3 ];
	#ifndef USE_MORPHNORMALS
	transformed += ( morphTarget4 - position ) * morphTargetInfluences[ 4 ];
	transformed += ( morphTarget5 - position ) * morphTargetInfluences[ 5 ];
	transformed += ( morphTarget6 - position ) * morphTargetInfluences[ 6 ];
	transformed += ( morphTarget7 - position ) * morphTargetInfluences[ 7 ];
	#endif
#endif`,normal_fragment_begin:`#ifdef FLAT_SHADED
	vec3 fdx = vec3( dFdx( vViewPosition.x ), dFdx( vViewPosition.y ), dFdx( vViewPosition.z ) );
	vec3 fdy = vec3( dFdy( vViewPosition.x ), dFdy( vViewPosition.y ), dFdy( vViewPosition.z ) );
	vec3 normal = normalize( cross( fdx, fdy ) );
#else
	vec3 normal = normalize( vNormal );
	#ifdef DOUBLE_SIDED
		normal = normal * ( float( gl_FrontFacing ) * 2.0 - 1.0 );
	#endif
	#ifdef USE_TANGENT
		vec3 tangent = normalize( vTangent );
		vec3 bitangent = normalize( vBitangent );
		#ifdef DOUBLE_SIDED
			tangent = tangent * ( float( gl_FrontFacing ) * 2.0 - 1.0 );
			bitangent = bitangent * ( float( gl_FrontFacing ) * 2.0 - 1.0 );
		#endif
	#endif
#endif
vec3 geometryNormal = normal;`,normal_fragment_maps:`#ifdef OBJECTSPACE_NORMALMAP
	normal = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;
	#ifdef FLIP_SIDED
		normal = - normal;
	#endif
	#ifdef DOUBLE_SIDED
		normal = normal * ( float( gl_FrontFacing ) * 2.0 - 1.0 );
	#endif
	normal = normalize( normalMatrix * normal );
#elif defined( TANGENTSPACE_NORMALMAP )
	#ifdef USE_TANGENT
		mat3 vTBN = mat3( tangent, bitangent, normal );
		vec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;
		mapN.xy = normalScale * mapN.xy;
		normal = normalize( vTBN * mapN );
	#else
		normal = perturbNormal2Arb( -vViewPosition, normal, normalScale, normalMap );
	#endif
#elif defined( USE_BUMPMAP )
	normal = perturbNormalArb( -vViewPosition, normal, dHdxy_fwd() );
#endif`,normalmap_pars_fragment:`#ifdef USE_NORMALMAP
	uniform sampler2D normalMap;
	uniform vec2 normalScale;
#endif
#ifdef OBJECTSPACE_NORMALMAP
	uniform mat3 normalMatrix;
#endif
#if ! defined ( USE_TANGENT ) && ( defined ( TANGENTSPACE_NORMALMAP ) || defined ( USE_CLEARCOAT_NORMALMAP ) )
	vec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm, vec2 normalScale, in sampler2D normalMap ) {
		vec3 q0 = vec3( dFdx( eye_pos.x ), dFdx( eye_pos.y ), dFdx( eye_pos.z ) );
		vec3 q1 = vec3( dFdy( eye_pos.x ), dFdy( eye_pos.y ), dFdy( eye_pos.z ) );
		vec2 st0 = dFdx( vUv.st );
		vec2 st1 = dFdy( vUv.st );
		float scale = sign( st1.t * st0.s - st0.t * st1.s );
		vec3 S = normalize( ( q0 * st1.t - q1 * st0.t ) * scale );
		vec3 T = normalize( ( - q0 * st1.s + q1 * st0.s ) * scale );
		vec3 N = normalize( surf_norm );
		vec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;
		mapN.xy *= normalScale;
		#ifdef DOUBLE_SIDED
			bool frontFacing = dot( cross( S, T ), N ) > 0.0;
			mapN.xy *= ( float( frontFacing ) * 2.0 - 1.0 );
		#else
			mapN.xy *= ( float( gl_FrontFacing ) * 2.0 - 1.0 );
		#endif
		mat3 tsn = mat3( S, T, N );
		return normalize( tsn * mapN );
	}
#endif`,clearcoat_normal_fragment_begin:`#ifdef CLEARCOAT
	vec3 clearcoatNormal = geometryNormal;
#endif`,clearcoat_normal_fragment_maps:`#ifdef USE_CLEARCOAT_NORMALMAP
	#ifdef USE_TANGENT
		mat3 vTBN = mat3( tangent, bitangent, clearcoatNormal );
		vec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;
		mapN.xy = clearcoatNormalScale * mapN.xy;
		clearcoatNormal = normalize( vTBN * mapN );
	#else
		clearcoatNormal = perturbNormal2Arb( - vViewPosition, clearcoatNormal, clearcoatNormalScale, clearcoatNormalMap );
	#endif
#endif`,clearcoat_normalmap_pars_fragment:`#ifdef USE_CLEARCOAT_NORMALMAP
	uniform sampler2D clearcoatNormalMap;
	uniform vec2 clearcoatNormalScale;
#endif`,packing:`vec3 packNormalToRGB( const in vec3 normal ) {
	return normalize( normal ) * 0.5 + 0.5;
}
vec3 unpackRGBToNormal( const in vec3 rgb ) {
	return 2.0 * rgb.xyz - 1.0;
}
const float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;
const vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256.,  256. );
const vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );
const float ShiftRight8 = 1. / 256.;
vec4 packDepthToRGBA( const in float v ) {
	vec4 r = vec4( fract( v * PackFactors ), v );
	r.yzw -= r.xyz * ShiftRight8;	return r * PackUpscale;
}
float unpackRGBAToDepth( const in vec4 v ) {
	return dot( v, UnpackFactors );
}
vec4 encodeHalfRGBA ( vec2 v ) {
	vec4 encoded = vec4( 0.0 );
	const vec2 offset = vec2( 1.0 / 255.0, 0.0 );
	encoded.xy = vec2( v.x, fract( v.x * 255.0 ) );
	encoded.xy = encoded.xy - ( encoded.yy * offset );
	encoded.zw = vec2( v.y, fract( v.y * 255.0 ) );
	encoded.zw = encoded.zw - ( encoded.ww * offset );
	return encoded;
}
vec2 decodeHalfRGBA( vec4 v ) {
	return vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );
}
float viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {
	return ( viewZ + near ) / ( near - far );
}
float orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {
	return linearClipZ * ( near - far ) - near;
}
float viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {
	return (( near + viewZ ) * far ) / (( far - near ) * viewZ );
}
float perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {
	return ( near * far ) / ( ( far - near ) * invClipZ - far );
}`,premultiplied_alpha_fragment:`#ifdef PREMULTIPLIED_ALPHA
	gl_FragColor.rgb *= gl_FragColor.a;
#endif`,project_vertex:`vec4 mvPosition = vec4( transformed, 1.0 );
#ifdef USE_INSTANCING
	mvPosition = instanceMatrix * mvPosition;
#endif
mvPosition = modelViewMatrix * mvPosition;
gl_Position = projectionMatrix * mvPosition;`,dithering_fragment:`#ifdef DITHERING
	gl_FragColor.rgb = dithering( gl_FragColor.rgb );
#endif`,dithering_pars_fragment:`#ifdef DITHERING
	vec3 dithering( vec3 color ) {
		float grid_position = rand( gl_FragCoord.xy );
		vec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );
		dither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );
		return color + dither_shift_RGB;
	}
#endif`,roughnessmap_fragment:`float roughnessFactor = roughness;
#ifdef USE_ROUGHNESSMAP
	vec4 texelRoughness = texture2D( roughnessMap, vUv );
	roughnessFactor *= texelRoughness.g;
#endif`,roughnessmap_pars_fragment:`#ifdef USE_ROUGHNESSMAP
	uniform sampler2D roughnessMap;
#endif`,shadowmap_pars_fragment:`#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
		varying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
	float texture2DCompare( sampler2D depths, vec2 uv, float compare ) {
		return step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );
	}
	vec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {
		return decodeHalfRGBA( texture2D( shadow, uv ) );
	}
	float VSMShadow (sampler2D shadow, vec2 uv, float compare ){
		float occlusion = 1.0;
		vec2 distribution = texture2DDistribution( shadow, uv );
		float hard_shadow = step( compare , distribution.x );
		if (hard_shadow != 1.0 ) {
			float distance = compare - distribution.x ;
			float variance = max( 0.00000, distribution.y * distribution.y );
			float softness_probability = variance / (variance + distance * distance );			softness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );			occlusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );
		}
		return occlusion;
	}
	float texture2DShadowLerp( sampler2D depths, vec2 size, vec2 uv, float compare ) {
		const vec2 offset = vec2( 0.0, 1.0 );
		vec2 texelSize = vec2( 1.0 ) / size;
		vec2 centroidUV = ( floor( uv * size - 0.5 ) + 0.5 ) * texelSize;
		float lb = texture2DCompare( depths, centroidUV + texelSize * offset.xx, compare );
		float lt = texture2DCompare( depths, centroidUV + texelSize * offset.xy, compare );
		float rb = texture2DCompare( depths, centroidUV + texelSize * offset.yx, compare );
		float rt = texture2DCompare( depths, centroidUV + texelSize * offset.yy, compare );
		vec2 f = fract( uv * size + 0.5 );
		float a = mix( lb, lt, f.y );
		float b = mix( rb, rt, f.y );
		float c = mix( a, b, f.x );
		return c;
	}
	float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
		float shadow = 1.0;
		shadowCoord.xyz /= shadowCoord.w;
		shadowCoord.z += shadowBias;
		bvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );
		bool inFrustum = all( inFrustumVec );
		bvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );
		bool frustumTest = all( frustumTestVec );
		if ( frustumTest ) {
		#if defined( SHADOWMAP_TYPE_PCF )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx0 = - texelSize.x * shadowRadius;
			float dy0 = - texelSize.y * shadowRadius;
			float dx1 = + texelSize.x * shadowRadius;
			float dy1 = + texelSize.y * shadowRadius;
			float dx2 = dx0 / 2.0;
			float dy2 = dy0 / 2.0;
			float dx3 = dx1 / 2.0;
			float dy3 = dy1 / 2.0;
			shadow = (
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )
			) * ( 1.0 / 17.0 );
		#elif defined( SHADOWMAP_TYPE_PCF_SOFT )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx0 = - texelSize.x * shadowRadius;
			float dy0 = - texelSize.y * shadowRadius;
			float dx1 = + texelSize.x * shadowRadius;
			float dy1 = + texelSize.y * shadowRadius;
			shadow = (
				texture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +
				texture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +
				texture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +
				texture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +
				texture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy, shadowCoord.z ) +
				texture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +
				texture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +
				texture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +
				texture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )
			) * ( 1.0 / 9.0 );
		#elif defined( SHADOWMAP_TYPE_VSM )
			shadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );
		#else
			shadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );
		#endif
		}
		return shadow;
	}
	vec2 cubeToUV( vec3 v, float texelSizeY ) {
		vec3 absV = abs( v );
		float scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );
		absV *= scaleToCube;
		v *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );
		vec2 planar = v.xy;
		float almostATexel = 1.5 * texelSizeY;
		float almostOne = 1.0 - almostATexel;
		if ( absV.z >= almostOne ) {
			if ( v.z > 0.0 )
				planar.x = 4.0 - v.x;
		} else if ( absV.x >= almostOne ) {
			float signX = sign( v.x );
			planar.x = v.z * signX + 2.0 * signX;
		} else if ( absV.y >= almostOne ) {
			float signY = sign( v.y );
			planar.x = v.x + 2.0 * signY + 2.0;
			planar.y = v.z * signY - 2.0;
		}
		return vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );
	}
	float getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {
		vec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );
		vec3 lightToPosition = shadowCoord.xyz;
		float dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );		dp += shadowBias;
		vec3 bd3D = normalize( lightToPosition );
		#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )
			vec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;
			return (
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )
			) * ( 1.0 / 9.0 );
		#else
			return texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );
		#endif
	}
#endif`,shadowmap_pars_vertex:`#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		uniform mat4 spotShadowMatrix[ NUM_SPOT_LIGHT_SHADOWS ];
		varying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
#endif`,shadowmap_vertex:`#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
	#pragma unroll_loop
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		vDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * worldPosition;
	}
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	#pragma unroll_loop
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		vSpotShadowCoord[ i ] = spotShadowMatrix[ i ] * worldPosition;
	}
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	#pragma unroll_loop
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		vPointShadowCoord[ i ] = pointShadowMatrix[ i ] * worldPosition;
	}
	#endif
#endif`,shadowmask_pars_fragment:`float getShadowMask() {
	float shadow = 1.0;
	#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLight directionalLight;
	#pragma unroll_loop
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		directionalLight = directionalLights[ i ];
		shadow *= all( bvec2( directionalLight.shadow, receiveShadow ) ) ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
	}
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLight spotLight;
	#pragma unroll_loop
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		spotLight = spotLights[ i ];
		shadow *= all( bvec2( spotLight.shadow, receiveShadow ) ) ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;
	}
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	PointLight pointLight;
	#pragma unroll_loop
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		pointLight = pointLights[ i ];
		shadow *= all( bvec2( pointLight.shadow, receiveShadow ) ) ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;
	}
	#endif
	#endif
	return shadow;
}`,skinbase_vertex:`#ifdef USE_SKINNING
	mat4 boneMatX = getBoneMatrix( skinIndex.x );
	mat4 boneMatY = getBoneMatrix( skinIndex.y );
	mat4 boneMatZ = getBoneMatrix( skinIndex.z );
	mat4 boneMatW = getBoneMatrix( skinIndex.w );
#endif`,skinning_pars_vertex:`#ifdef USE_SKINNING
	uniform mat4 bindMatrix;
	uniform mat4 bindMatrixInverse;
	#ifdef BONE_TEXTURE
		uniform highp sampler2D boneTexture;
		uniform int boneTextureSize;
		mat4 getBoneMatrix( const in float i ) {
			float j = i * 4.0;
			float x = mod( j, float( boneTextureSize ) );
			float y = floor( j / float( boneTextureSize ) );
			float dx = 1.0 / float( boneTextureSize );
			float dy = 1.0 / float( boneTextureSize );
			y = dy * ( y + 0.5 );
			vec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );
			vec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );
			vec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );
			vec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );
			mat4 bone = mat4( v1, v2, v3, v4 );
			return bone;
		}
	#else
		uniform mat4 boneMatrices[ MAX_BONES ];
		mat4 getBoneMatrix( const in float i ) {
			mat4 bone = boneMatrices[ int(i) ];
			return bone;
		}
	#endif
#endif`,skinning_vertex:`#ifdef USE_SKINNING
	vec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );
	vec4 skinned = vec4( 0.0 );
	skinned += boneMatX * skinVertex * skinWeight.x;
	skinned += boneMatY * skinVertex * skinWeight.y;
	skinned += boneMatZ * skinVertex * skinWeight.z;
	skinned += boneMatW * skinVertex * skinWeight.w;
	transformed = ( bindMatrixInverse * skinned ).xyz;
#endif`,skinnormal_vertex:`#ifdef USE_SKINNING
	mat4 skinMatrix = mat4( 0.0 );
	skinMatrix += skinWeight.x * boneMatX;
	skinMatrix += skinWeight.y * boneMatY;
	skinMatrix += skinWeight.z * boneMatZ;
	skinMatrix += skinWeight.w * boneMatW;
	skinMatrix  = bindMatrixInverse * skinMatrix * bindMatrix;
	objectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;
	#ifdef USE_TANGENT
		objectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#endif
#endif`,specularmap_fragment:`float specularStrength;
#ifdef USE_SPECULARMAP
	vec4 texelSpecular = texture2D( specularMap, vUv );
	specularStrength = texelSpecular.r;
#else
	specularStrength = 1.0;
#endif`,specularmap_pars_fragment:`#ifdef USE_SPECULARMAP
	uniform sampler2D specularMap;
#endif`,tonemapping_fragment:`#if defined( TONE_MAPPING )
	gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );
#endif`,tonemapping_pars_fragment:`#ifndef saturate
#define saturate(a) clamp( a, 0.0, 1.0 )
#endif
uniform float toneMappingExposure;
uniform float toneMappingWhitePoint;
vec3 LinearToneMapping( vec3 color ) {
	return toneMappingExposure * color;
}
vec3 ReinhardToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	return saturate( color / ( vec3( 1.0 ) + color ) );
}
#define Uncharted2Helper( x ) max( ( ( x * ( 0.15 * x + 0.10 * 0.50 ) + 0.20 * 0.02 ) / ( x * ( 0.15 * x + 0.50 ) + 0.20 * 0.30 ) ) - 0.02 / 0.30, vec3( 0.0 ) )
vec3 Uncharted2ToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	return saturate( Uncharted2Helper( color ) / Uncharted2Helper( vec3( toneMappingWhitePoint ) ) );
}
vec3 OptimizedCineonToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	color = max( vec3( 0.0 ), color - 0.004 );
	return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );
}
vec3 ACESFilmicToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	return saturate( ( color * ( 2.51 * color + 0.03 ) ) / ( color * ( 2.43 * color + 0.59 ) + 0.14 ) );
}`,uv_pars_fragment:`#ifdef USE_UV
	varying vec2 vUv;
#endif`,uv_pars_vertex:`#ifdef USE_UV
	varying vec2 vUv;
	uniform mat3 uvTransform;
#endif`,uv_vertex:`#ifdef USE_UV
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
#endif`,uv2_pars_fragment:`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	varying vec2 vUv2;
#endif`,uv2_pars_vertex:`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	attribute vec2 uv2;
	varying vec2 vUv2;
#endif`,uv2_vertex:`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	vUv2 = uv2;
#endif`,worldpos_vertex:`#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP )
	vec4 worldPosition = vec4( transformed, 1.0 );
	#ifdef USE_INSTANCING
		worldPosition = instanceMatrix * worldPosition;
	#endif
	worldPosition = modelMatrix * worldPosition;
#endif`,background_frag:`uniform sampler2D t2D;
varying vec2 vUv;
void main() {
	vec4 texColor = texture2D( t2D, vUv );
	gl_FragColor = mapTexelToLinear( texColor );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,background_vert:`varying vec2 vUv;
uniform mat3 uvTransform;
void main() {
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	gl_Position = vec4( position.xy, 1.0, 1.0 );
}`,cube_frag:`uniform samplerCube tCube;
uniform float tFlip;
uniform float opacity;
varying vec3 vWorldDirection;
void main() {
	vec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );
	gl_FragColor = mapTexelToLinear( texColor );
	gl_FragColor.a *= opacity;
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,cube_vert:`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,depth_frag:`#if DEPTH_PACKING == 3200
	uniform float opacity;
#endif
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( 1.0 );
	#if DEPTH_PACKING == 3200
		diffuseColor.a = opacity;
	#endif
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <logdepthbuf_fragment>
	#if DEPTH_PACKING == 3200
		gl_FragColor = vec4( vec3( 1.0 - gl_FragCoord.z ), opacity );
	#elif DEPTH_PACKING == 3201
		gl_FragColor = packDepthToRGBA( gl_FragCoord.z );
	#endif
}`,depth_vert:`#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
}`,distanceRGBA_frag:`#define DISTANCE
uniform vec3 referencePosition;
uniform float nearDistance;
uniform float farDistance;
varying vec3 vWorldPosition;
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <clipping_planes_pars_fragment>
void main () {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( 1.0 );
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	float dist = length( vWorldPosition - referencePosition );
	dist = ( dist - nearDistance ) / ( farDistance - nearDistance );
	dist = saturate( dist );
	gl_FragColor = packDepthToRGBA( dist );
}`,distanceRGBA_vert:`#define DISTANCE
varying vec3 vWorldPosition;
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	vWorldPosition = worldPosition.xyz;
}`,equirect_frag:`uniform sampler2D tEquirect;
varying vec3 vWorldDirection;
#include <common>
void main() {
	vec3 direction = normalize( vWorldDirection );
	vec2 sampleUV;
	sampleUV.y = asin( clamp( direction.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;
	sampleUV.x = atan( direction.z, direction.x ) * RECIPROCAL_PI2 + 0.5;
	vec4 texColor = texture2D( tEquirect, sampleUV );
	gl_FragColor = mapTexelToLinear( texColor );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,equirect_vert:`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
}`,linedashed_frag:`uniform vec3 diffuse;
uniform float opacity;
uniform float dashSize;
uniform float totalSize;
varying float vLineDistance;
#include <common>
#include <color_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	if ( mod( vLineDistance, totalSize ) > dashSize ) {
		discard;
	}
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <color_fragment>
	outgoingLight = diffuseColor.rgb;
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <premultiplied_alpha_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
}`,linedashed_vert:`uniform float scale;
attribute float lineDistance;
varying float vLineDistance;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <color_vertex>
	vLineDistance = scale * lineDistance;
	vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );
	gl_Position = projectionMatrix * mvPosition;
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,meshbasic_frag:`uniform vec3 diffuse;
uniform float opacity;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	#ifdef USE_LIGHTMAP
		reflectedLight.indirectDiffuse += texture2D( lightMap, vUv2 ).xyz * lightMapIntensity;
	#else
		reflectedLight.indirectDiffuse += vec3( 1.0 );
	#endif
	#include <aomap_fragment>
	reflectedLight.indirectDiffuse *= diffuseColor.rgb;
	vec3 outgoingLight = reflectedLight.indirectDiffuse;
	#include <envmap_fragment>
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <premultiplied_alpha_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
}`,meshbasic_vert:`#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <skinbase_vertex>
	#ifdef USE_ENVMAP
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	#include <envmap_vertex>
	#include <fog_vertex>
}`,meshlambert_frag:`uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
varying vec3 vLightFront;
varying vec3 vIndirectFront;
#ifdef DOUBLE_SIDED
	varying vec3 vLightBack;
	varying vec3 vIndirectBack;
#endif
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <fog_pars_fragment>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	#include <emissivemap_fragment>
	reflectedLight.indirectDiffuse = getAmbientLightIrradiance( ambientLightColor );
	#ifdef DOUBLE_SIDED
		reflectedLight.indirectDiffuse += ( gl_FrontFacing ) ? vIndirectFront : vIndirectBack;
	#else
		reflectedLight.indirectDiffuse += vIndirectFront;
	#endif
	#include <lightmap_fragment>
	reflectedLight.indirectDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb );
	#ifdef DOUBLE_SIDED
		reflectedLight.directDiffuse = ( gl_FrontFacing ) ? vLightFront : vLightBack;
	#else
		reflectedLight.directDiffuse = vLightFront;
	#endif
	reflectedLight.directDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb ) * getShadowMask();
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <envmap_fragment>
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,meshlambert_vert:`#define LAMBERT
varying vec3 vLightFront;
varying vec3 vIndirectFront;
#ifdef DOUBLE_SIDED
	varying vec3 vLightBack;
	varying vec3 vIndirectBack;
#endif
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <envmap_pars_vertex>
#include <bsdfs>
#include <lights_pars_begin>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <lights_lambert_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,meshmatcap_frag:`#define MATCAP
uniform vec3 diffuse;
uniform float opacity;
uniform sampler2D matcap;
varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <fog_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	vec3 viewDir = normalize( vViewPosition );
	vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );
	vec3 y = cross( viewDir, x );
	vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;
	#ifdef USE_MATCAP
		vec4 matcapColor = texture2D( matcap, uv );
		matcapColor = matcapTexelToLinear( matcapColor );
	#else
		vec4 matcapColor = vec4( 1.0 );
	#endif
	vec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <premultiplied_alpha_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
}`,meshmatcap_vert:`#define MATCAP
varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#ifndef FLAT_SHADED
		vNormal = normalize( transformedNormal );
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
	vViewPosition = - mvPosition.xyz;
}`,meshphong_frag:`#define PHONG
uniform vec3 diffuse;
uniform vec3 emissive;
uniform vec3 specular;
uniform float shininess;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <gradientmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <lights_phong_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_phong_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	#include <envmap_fragment>
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,meshphong_vert:`#define PHONG
varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,meshphysical_frag:`#define STANDARD
#ifdef PHYSICAL
	#define REFLECTIVITY
	#define CLEARCOAT
	#define TRANSPARENCY
#endif
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float roughness;
uniform float metalness;
uniform float opacity;
#ifdef TRANSPARENCY
	uniform float transparency;
#endif
#ifdef REFLECTIVITY
	uniform float reflectivity;
#endif
#ifdef CLEARCOAT
	uniform float clearcoat;
	uniform float clearcoatRoughness;
#endif
#ifdef USE_SHEEN
	uniform vec3 sheen;
#endif
varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <bsdfs>
#include <cube_uv_reflection_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_physical_pars_fragment>
#include <fog_pars_fragment>
#include <lights_pars_begin>
#include <lights_physical_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <clearcoat_normalmap_pars_fragment>
#include <roughnessmap_pars_fragment>
#include <metalnessmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <roughnessmap_fragment>
	#include <metalnessmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <clearcoat_normal_fragment_begin>
	#include <clearcoat_normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_physical_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	#ifdef TRANSPARENCY
		diffuseColor.a *= saturate( 1. - transparency + linearToRelativeLuminance( reflectedLight.directSpecular + reflectedLight.indirectSpecular ) );
	#endif
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,meshphysical_vert:`#define STANDARD
varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
	#ifdef USE_TANGENT
		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );
	#endif
#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,normal_frag:`#define NORMAL
uniform float opacity;
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )
	varying vec3 vViewPosition;
#endif
#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif
#include <packing>
#include <uv_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	gl_FragColor = vec4( packNormalToRGB( normal ), opacity );
}`,normal_vert:`#define NORMAL
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )
	varying vec3 vViewPosition;
#endif
#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
	#ifdef USE_TANGENT
		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );
	#endif
#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )
	vViewPosition = - mvPosition.xyz;
#endif
}`,points_frag:`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <color_pars_fragment>
#include <map_particle_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_particle_fragment>
	#include <color_fragment>
	#include <alphatest_fragment>
	outgoingLight = diffuseColor.rgb;
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <premultiplied_alpha_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
}`,points_vert:`uniform float size;
uniform float scale;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <color_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	gl_PointSize = size;
	#ifdef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );
	#endif
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <fog_vertex>
}`,shadow_frag:`uniform vec3 color;
uniform float opacity;
#include <common>
#include <packing>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
void main() {
	gl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );
	#include <fog_fragment>
}`,shadow_vert:`#include <fog_pars_vertex>
#include <shadowmap_pars_vertex>
void main() {
	#include <begin_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,sprite_frag:`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <alphatest_fragment>
	outgoingLight = diffuseColor.rgb;
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
}`,sprite_vert:`uniform float rotation;
uniform vec2 center;
#include <common>
#include <uv_pars_vertex>
#include <fog_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	vec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );
	vec2 scale;
	scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );
	scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );
	#ifndef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) scale *= - mvPosition.z;
	#endif
	vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;
	vec2 rotatedPosition;
	rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
	rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
	mvPosition.xy += rotatedPosition;
	gl_Position = projectionMatrix * mvPosition;
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`},Ee={common:{diffuse:{value:new ve(15658734)},opacity:{value:1},map:{value:null},uvTransform:{value:new be},alphaMap:{value:null}},specularmap:{specularMap:{value:null}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},refractionRatio:{value:.98},maxMipLevel:{value:0}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new G(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new ve(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{},shadow:{},shadowBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{},shadow:{},shadowBias:{},shadowRadius:{},shadowMapSize:{}}},spotShadowMap:{value:[]},spotShadowMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{},shadow:{},shadowBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}}},points:{diffuse:{value:new ve(15658734)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},uvTransform:{value:new be}},sprite:{diffuse:{value:new ve(15658734)},opacity:{value:1},center:{value:new G(.5,.5)},rotation:{value:0},map:{value:null},uvTransform:{value:new be}}},Xn={basic:{uniforms:zt([Ee.common,Ee.specularmap,Ee.envmap,Ee.aomap,Ee.lightmap,Ee.fog]),vertexShader:nt.meshbasic_vert,fragmentShader:nt.meshbasic_frag},lambert:{uniforms:zt([Ee.common,Ee.specularmap,Ee.envmap,Ee.aomap,Ee.lightmap,Ee.emissivemap,Ee.fog,Ee.lights,{emissive:{value:new ve(0)}}]),vertexShader:nt.meshlambert_vert,fragmentShader:nt.meshlambert_frag},phong:{uniforms:zt([Ee.common,Ee.specularmap,Ee.envmap,Ee.aomap,Ee.lightmap,Ee.emissivemap,Ee.bumpmap,Ee.normalmap,Ee.displacementmap,Ee.gradientmap,Ee.fog,Ee.lights,{emissive:{value:new ve(0)},specular:{value:new ve(1118481)},shininess:{value:30}}]),vertexShader:nt.meshphong_vert,fragmentShader:nt.meshphong_frag},standard:{uniforms:zt([Ee.common,Ee.envmap,Ee.aomap,Ee.lightmap,Ee.emissivemap,Ee.bumpmap,Ee.normalmap,Ee.displacementmap,Ee.roughnessmap,Ee.metalnessmap,Ee.fog,Ee.lights,{emissive:{value:new ve(0)},roughness:{value:.5},metalness:{value:.5},envMapIntensity:{value:1}}]),vertexShader:nt.meshphysical_vert,fragmentShader:nt.meshphysical_frag},matcap:{uniforms:zt([Ee.common,Ee.bumpmap,Ee.normalmap,Ee.displacementmap,Ee.fog,{matcap:{value:null}}]),vertexShader:nt.meshmatcap_vert,fragmentShader:nt.meshmatcap_frag},points:{uniforms:zt([Ee.points,Ee.fog]),vertexShader:nt.points_vert,fragmentShader:nt.points_frag},dashed:{uniforms:zt([Ee.common,Ee.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:nt.linedashed_vert,fragmentShader:nt.linedashed_frag},depth:{uniforms:zt([Ee.common,Ee.displacementmap]),vertexShader:nt.depth_vert,fragmentShader:nt.depth_frag},normal:{uniforms:zt([Ee.common,Ee.bumpmap,Ee.normalmap,Ee.displacementmap,{opacity:{value:1}}]),vertexShader:nt.normal_vert,fragmentShader:nt.normal_frag},sprite:{uniforms:zt([Ee.sprite,Ee.fog]),vertexShader:nt.sprite_vert,fragmentShader:nt.sprite_frag},background:{uniforms:{uvTransform:{value:new be},t2D:{value:null}},vertexShader:nt.background_vert,fragmentShader:nt.background_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:nt.cube_vert,fragmentShader:nt.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:nt.equirect_vert,fragmentShader:nt.equirect_frag},distanceRGBA:{uniforms:zt([Ee.common,Ee.displacementmap,{referencePosition:{value:new E},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:nt.distanceRGBA_vert,fragmentShader:nt.distanceRGBA_frag},shadow:{uniforms:zt([Ee.lights,Ee.fog,{color:{value:new ve(0)},opacity:{value:1}}]),vertexShader:nt.shadow_vert,fragmentShader:nt.shadow_frag}};Xn.physical={uniforms:zt([Xn.standard.uniforms,{transparency:{value:0},clearcoat:{value:0},clearcoatRoughness:{value:0},sheen:{value:new ve(0)},clearcoatNormalScale:{value:new G(1,1)},clearcoatNormalMap:{value:null}}]),vertexShader:nt.meshphysical_vert,fragmentShader:nt.meshphysical_frag},ti.prototype=Object.create(he.prototype),ti.prototype.constructor=ti,ni.prototype=Object.create(re.prototype),ni.prototype.constructor=ni,Ct.prototype=Object.create(Ae.prototype),Ct.prototype.constructor=Ct,Ct.prototype.isCubeTexture=!0,Object.defineProperty(Ct.prototype,"images",{get:function(){return this.image},set:function(e){this.image=e}}),en.prototype=Object.create(Ae.prototype),en.prototype.constructor=en,en.prototype.isDataTexture2DArray=!0,Gt.prototype=Object.create(Ae.prototype),Gt.prototype.constructor=Gt,Gt.prototype.isDataTexture3D=!0;var ru=new Ae,gh=new en,yh=new Gt,ou=new Ct,su=[],au=[],cu=new Float32Array(16),lu=new Float32Array(9),uu=new Float32Array(4);Os.prototype.updateCache=function(e){var t=this.cache;e instanceof Float32Array&&t.length!==e.length&&(this.cache=new Float32Array(e.length)),Tt(t,e)},Fs.prototype.setValue=function(e,t,n){for(var i=this.seq,r=0,o=i.length;r!==o;++r){var s=i[r];s.setValue(e,t[s.id],n)}};var al=/([\w\d_]+)(\])?(\[|\.)?/g;Fn.prototype.setValue=function(e,t,n,i){t=this.map[t],t!==void 0&&t.setValue(e,n,i)},Fn.prototype.setOptional=function(e,t,n){t=t[n],t!==void 0&&this.setValue(e,n,t)},Fn.upload=function(e,t,n,i){for(var r=0,o=t.length;r!==o;++r){var s=t[r],a=n[s.id];a.needsUpdate!==!1&&s.setValue(e,a.value,i)}},Fn.seqWithValue=function(e,t){for(var n=[],i=0,r=e.length;i!==r;++i){var o=e[i];o.id in t&&n.push(o)}return n};var xh=0,cl=/^[ \t]*#include +<([\w\d./]+)>/gm,hu=/#pragma unroll_loop[\s]+?for \( int i = (\d+); i < (\d+); i \+\+ \) \{([\s\S]+?)(?=\})\}/g,wh=0;g.prototype=Object.create(ie.prototype),g.prototype.constructor=g,g.prototype.isMeshDepthMaterial=!0,g.prototype.copy=function(e){return ie.prototype.copy.call(this,e),this.depthPacking=e.depthPacking,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this},A.prototype=Object.create(ie.prototype),A.prototype.constructor=A,A.prototype.isMeshDistanceMaterial=!0,A.prototype.copy=function(e){return ie.prototype.copy.call(this,e),this.referencePosition.copy(e.referencePosition),this.nearDistance=e.nearDistance,this.farDistance=e.farDistance,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this},k.prototype=Object.assign(Object.create(je.prototype),{constructor:k,isWebGLMultiviewRenderTarget:!0,copy:function(e){return je.prototype.copy.call(this,e),this.numViews=e.numViews,this},setNumViews:function(e){return this.numViews!==e&&(this.numViews=e,this.dispose()),this}}),Q.prototype=Object.assign(Object.create(W.prototype),{constructor:Q,isGroup:!0}),xe.prototype=Object.assign(Object.create(Je.prototype),{constructor:xe,isArrayCamera:!0});var du=new E,pu=new E;Object.assign(Ue.prototype,w.prototype),Object.assign(Qe.prototype,w.prototype),Object.assign(tt.prototype,{isFogExp2:!0,clone:function(){return new tt(this.color,this.density)},toJSON:function(){return{type:"FogExp2",color:this.color.getHex(),density:this.density}}}),Object.assign(xt.prototype,{isFog:!0,clone:function(){return new xt(this.color,this.near,this.far)},toJSON:function(){return{type:"Fog",color:this.color.getHex(),near:this.near,far:this.far}}}),Object.defineProperty(ct.prototype,"needsUpdate",{set:function(e){e===!0&&this.version++}}),Object.assign(ct.prototype,{isInterleavedBuffer:!0,onUploadCallback:function(){},setDynamic:function(e){return this.dynamic=e,this},copy:function(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.dynamic=e.dynamic,this},copyAt:function(e,t,n){e*=this.stride,n*=t.stride;for(var i=0,r=this.stride;i<r;i++)this.array[e+i]=t.array[n+i];return this},set:function(e,t){return t===void 0&&(t=0),this.array.set(e,t),this},clone:function(){return new this.constructor().copy(this)},onUpload:function(e){return this.onUploadCallback=e,this}}),Object.defineProperties(gt.prototype,{count:{get:function(){return this.data.count}},array:{get:function(){return this.data.array}}}),Object.assign(gt.prototype,{isInterleavedBufferAttribute:!0,setX:function(e,t){return this.data.array[e*this.data.stride+this.offset]=t,this},setY:function(e,t){return this.data.array[e*this.data.stride+this.offset+1]=t,this},setZ:function(e,t){return this.data.array[e*this.data.stride+this.offset+2]=t,this},setW:function(e,t){return this.data.array[e*this.data.stride+this.offset+3]=t,this},getX:function(e){return this.data.array[e*this.data.stride+this.offset]},getY:function(e){return this.data.array[e*this.data.stride+this.offset+1]},getZ:function(e){return this.data.array[e*this.data.stride+this.offset+2]},getW:function(e){return this.data.array[e*this.data.stride+this.offset+3]},setXY:function(e,t,n){return e=e*this.data.stride+this.offset,this.data.array[e+0]=t,this.data.array[e+1]=n,this},setXYZ:function(e,t,n,i){return e=e*this.data.stride+this.offset,this.data.array[e+0]=t,this.data.array[e+1]=n,this.data.array[e+2]=i,this},setXYZW:function(e,t,n,i,r){return e=e*this.data.stride+this.offset,this.data.array[e+0]=t,this.data.array[e+1]=n,this.data.array[e+2]=i,this.data.array[e+3]=r,this}}),wt.prototype=Object.create(ie.prototype),wt.prototype.constructor=wt,wt.prototype.isSpriteMaterial=!0,wt.prototype.copy=function(e){return ie.prototype.copy.call(this,e),this.color.copy(e.color),this.map=e.map,this.rotation=e.rotation,this.sizeAttenuation=e.sizeAttenuation,this};var fo,ps=new E,mo=new E,vo=new E,go=new G,fs=new G,fu=new Se,Ra=new E,ms=new E,Da=new E,mu=new G,ll=new G,vu=new G;kt.prototype=Object.assign(Object.create(W.prototype),{constructor:kt,isSprite:!0,raycast:function(e,t){e.camera===null&&console.error('THREE.Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),mo.setFromMatrixScale(this.matrixWorld),fu.copy(e.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(e.camera.matrixWorldInverse,this.matrixWorld),vo.setFromMatrixPosition(this.modelViewMatrix),e.camera.isPerspectiveCamera&&this.material.sizeAttenuation===!1&&mo.multiplyScalar(-vo.z);var n=this.material.rotation;if(n!==0)var i=Math.cos(n),r=Math.sin(n);n=this.center,Bt(Ra.set(-.5,-.5,0),vo,n,mo,r,i),Bt(ms.set(.5,-.5,0),vo,n,mo,r,i),Bt(Da.set(.5,.5,0),vo,n,mo,r,i),mu.set(0,0),ll.set(1,0),vu.set(1,1);var o=e.ray.intersectTriangle(Ra,ms,Da,!1,ps);o===null&&(Bt(ms.set(-.5,.5,0),vo,n,mo,r,i),ll.set(0,1),o=e.ray.intersectTriangle(Ra,Da,ms,!1,ps),o===null)||(r=e.ray.origin.distanceTo(ps),r<e.near||r>e.far||t.push({distance:r,point:ps.clone(),uv:lt.getUV(ps,Ra,ms,Da,mu,ll,vu,new G),face:null,object:this}))},clone:function(){return new this.constructor(this.material).copy(this)},copy:function(e){return W.prototype.copy.call(this,e),e.center!==void 0&&this.center.copy(e.center),this}});var Ba=new E,gu=new E;Ot.prototype=Object.assign(Object.create(W.prototype),{constructor:Ot,isLOD:!0,copy:function(e){W.prototype.copy.call(this,e,!1),e=e.levels;for(var t=0,n=e.length;t<n;t++){var i=e[t];this.addLevel(i.object.clone(),i.distance)}return this},addLevel:function(e,t){t===void 0&&(t=0),t=Math.abs(t);for(var n=this.levels,i=0;i<n.length&&!(t<n[i].distance);i++);return n.splice(i,0,{distance:t,object:e}),this.add(e),this},getObjectForDistance:function(e){for(var t=this.levels,n=1,i=t.length;n<i&&!(e<t[n].distance);n++);return t[n-1].object},raycast:function(e,t){Ba.setFromMatrixPosition(this.matrixWorld);var n=e.ray.origin.distanceTo(Ba);this.getObjectForDistance(n).raycast(e,t)},update:function(e){var t=this.levels;if(1<t.length){Ba.setFromMatrixPosition(e.matrixWorld),gu.setFromMatrixPosition(this.matrixWorld),e=Ba.distanceTo(gu),t[0].object.visible=!0;for(var n=1,i=t.length;n<i&&e>=t[n].distance;n++)t[n-1].object.visible=!1,t[n].object.visible=!0;for(;n<i;n++)t[n].object.visible=!1}},toJSON:function(e){e=W.prototype.toJSON.call(this,e),e.object.levels=[];for(var t=this.levels,n=0,i=t.length;n<i;n++){var r=t[n];e.object.levels.push({object:r.object.uuid,distance:r.distance})}return e}}),Lt.prototype=Object.assign(Object.create(yt.prototype),{constructor:Lt,isSkinnedMesh:!0,bind:function(e,t){this.skeleton=e,t===void 0&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),t=this.matrixWorld),this.bindMatrix.copy(t),this.bindMatrixInverse.getInverse(t)},pose:function(){this.skeleton.pose()},normalizeSkinWeights:function(){for(var e=new _e,t=this.geometry.attributes.skinWeight,n=0,i=t.count;n<i;n++){e.x=t.getX(n),e.y=t.getY(n),e.z=t.getZ(n),e.w=t.getW(n);var r=1/e.manhattanLength();r!==1/0?e.multiplyScalar(r):e.set(1,0,0,0),t.setXYZW(n,e.x,e.y,e.z,e.w)}},updateMatrixWorld:function(e){yt.prototype.updateMatrixWorld.call(this,e),this.bindMode==="attached"?this.bindMatrixInverse.getInverse(this.matrixWorld):this.bindMode==="detached"?this.bindMatrixInverse.getInverse(this.bindMatrix):console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)},clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}});var yu=new Se,Ah=new Se;Object.assign(tn.prototype,{calculateInverses:function(){this.boneInverses=[];for(var e=0,t=this.bones.length;e<t;e++){var n=new Se;this.bones[e]&&n.getInverse(this.bones[e].matrixWorld),this.boneInverses.push(n)}},pose:function(){var e,t,n=0;for(t=this.bones.length;n<t;n++)(e=this.bones[n])&&e.matrixWorld.getInverse(this.boneInverses[n]);for(n=0,t=this.bones.length;n<t;n++)(e=this.bones[n])&&(e.parent&&e.parent.isBone?(e.matrix.getInverse(e.parent.matrixWorld),e.matrix.multiply(e.matrixWorld)):e.matrix.copy(e.matrixWorld),e.matrix.decompose(e.position,e.quaternion,e.scale))},update:function(){for(var e=this.bones,t=this.boneInverses,n=this.boneMatrices,i=this.boneTexture,r=0,o=e.length;r<o;r++)yu.multiplyMatrices(e[r]?e[r].matrixWorld:Ah,t[r]),yu.toArray(n,16*r);i!==void 0&&(i.needsUpdate=!0)},clone:function(){return new tn(this.bones,this.boneInverses)},getBoneByName:function(e){for(var t=0,n=this.bones.length;t<n;t++){var i=this.bones[t];if(i.name===e)return i}}}),pn.prototype=Object.assign(Object.create(W.prototype),{constructor:pn,isBone:!0}),Ft.prototype=Object.assign(Object.create(yt.prototype),{constructor:Ft,isInstancedMesh:!0,raycast:function(){},setMatrixAt:function(e,t){t.toArray(this.instanceMatrix.array,16*e)},updateMorphTargets:function(){}}),$e.prototype=Object.create(ie.prototype),$e.prototype.constructor=$e,$e.prototype.isLineBasicMaterial=!0,$e.prototype.copy=function(e){return ie.prototype.copy.call(this,e),this.color.copy(e.color),this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this};var xu=new E,wu=new E,Au=new Se,Ia=new de,Oa=new ye;At.prototype=Object.assign(Object.create(W.prototype),{constructor:At,isLine:!0,computeLineDistances:function(){var e=this.geometry;if(e.isBufferGeometry)if(e.index===null){for(var t=e.attributes.position,n=[0],i=1,r=t.count;i<r;i++)xu.fromBufferAttribute(t,i-1),wu.fromBufferAttribute(t,i),n[i]=n[i-1],n[i]+=xu.distanceTo(wu);e.addAttribute("lineDistance",new le(n,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else if(e.isGeometry)for(t=e.vertices,n=e.lineDistances,n[0]=0,i=1,r=t.length;i<r;i++)n[i]=n[i-1],n[i]+=t[i-1].distanceTo(t[i]);return this},raycast:function(e,t){var n=e.linePrecision,i=this.geometry,r=this.matrixWorld;if(i.boundingSphere===null&&i.computeBoundingSphere(),Oa.copy(i.boundingSphere),Oa.applyMatrix4(r),Oa.radius+=n,e.ray.intersectsSphere(Oa)!==!1){Au.getInverse(r),Ia.copy(e.ray).applyMatrix4(Au),n/=(this.scale.x+this.scale.y+this.scale.z)/3,n*=n;var o=new E,s=new E;r=new E;var a=new E,c=this&&this.isLineSegments?2:1;if(i.isBufferGeometry){var u=i.index,h=i.attributes.position.array;if(u!==null){u=u.array,i=0;for(var p=u.length-1;i<p;i+=c){var v=u[i+1];o.fromArray(h,3*u[i]),s.fromArray(h,3*v),v=Ia.distanceSqToSegment(o,s,a,r),v>n||(a.applyMatrix4(this.matrixWorld),v=e.ray.origin.distanceTo(a),v<e.near||v>e.far||t.push({distance:v,point:r.clone().applyMatrix4(this.matrixWorld),index:i,face:null,faceIndex:null,object:this}))}}else for(i=0,p=h.length/3-1;i<p;i+=c)o.fromArray(h,3*i),s.fromArray(h,3*i+3),v=Ia.distanceSqToSegment(o,s,a,r),v>n||(a.applyMatrix4(this.matrixWorld),v=e.ray.origin.distanceTo(a),v<e.near||v>e.far||t.push({distance:v,point:r.clone().applyMatrix4(this.matrixWorld),index:i,face:null,faceIndex:null,object:this}))}else if(i.isGeometry)for(o=i.vertices,s=o.length,i=0;i<s-1;i+=c)v=Ia.distanceSqToSegment(o[i],o[i+1],a,r),v>n||(a.applyMatrix4(this.matrixWorld),v=e.ray.origin.distanceTo(a),v<e.near||v>e.far||t.push({distance:v,point:r.clone().applyMatrix4(this.matrixWorld),index:i,face:null,faceIndex:null,object:this}))}},clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}});var Fa=new E,Na=new E;ot.prototype=Object.assign(Object.create(At.prototype),{constructor:ot,isLineSegments:!0,computeLineDistances:function(){var e=this.geometry;if(e.isBufferGeometry)if(e.index===null){for(var t=e.attributes.position,n=[],i=0,r=t.count;i<r;i+=2)Fa.fromBufferAttribute(t,i),Na.fromBufferAttribute(t,i+1),n[i]=i===0?0:n[i-1],n[i+1]=n[i]+Fa.distanceTo(Na);e.addAttribute("lineDistance",new le(n,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else if(e.isGeometry)for(t=e.vertices,n=e.lineDistances,i=0,r=t.length;i<r;i+=2)Fa.copy(t[i]),Na.copy(t[i+1]),n[i]=i===0?0:n[i-1],n[i+1]=n[i]+Fa.distanceTo(Na);return this}}),Ci.prototype=Object.assign(Object.create(At.prototype),{constructor:Ci,isLineLoop:!0}),nn.prototype=Object.create(ie.prototype),nn.prototype.constructor=nn,nn.prototype.isPointsMaterial=!0,nn.prototype.copy=function(e){return ie.prototype.copy.call(this,e),this.color.copy(e.color),this.map=e.map,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this.morphTargets=e.morphTargets,this};var Mu=new Se,ul=new de,Ua=new ye,za=new E;oi.prototype=Object.assign(Object.create(W.prototype),{constructor:oi,isPoints:!0,raycast:function(e,t){var n=this.geometry,i=this.matrixWorld,r=e.params.Points.threshold;if(n.boundingSphere===null&&n.computeBoundingSphere(),Ua.copy(n.boundingSphere),Ua.applyMatrix4(i),Ua.radius+=r,e.ray.intersectsSphere(Ua)!==!1)if(Mu.getInverse(i),ul.copy(e.ray).applyMatrix4(Mu),r/=(this.scale.x+this.scale.y+this.scale.z)/3,r*=r,n.isBufferGeometry){var o=n.index;if(n=n.attributes.position.array,o!==null){var s=o.array;o=0;for(var a=s.length;o<a;o++){var c=s[o];za.fromArray(n,3*c),Lr(za,c,r,i,e,t,this)}}else for(o=0,s=n.length/3;o<s;o++)za.fromArray(n,3*o),Lr(za,o,r,i,e,t,this)}else for(n=n.vertices,o=0,s=n.length;o<s;o++)Lr(n[o],o,r,i,e,t,this)},updateMorphTargets:function(){var e=this.geometry;if(e.isBufferGeometry){e=e.morphAttributes;var t=Object.keys(e);if(0<t.length){var n=e[t[0]];if(n!==void 0)for(this.morphTargetInfluences=[],this.morphTargetDictionary={},e=0,t=n.length;e<t;e++){var i=n[e].name||String(e);this.morphTargetInfluences.push(0),this.morphTargetDictionary[i]=e}}}else e=e.morphTargets,e!==void 0&&0<e.length&&console.error("THREE.Points.updateMorphTargets() does not support THREE.Geometry. Use THREE.BufferGeometry instead.")},clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}}),Pr.prototype=Object.assign(Object.create(Ae.prototype),{constructor:Pr,isVideoTexture:!0,update:function(){var e=this.image;e.readyState>=e.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}}),Un.prototype=Object.create(Ae.prototype),Un.prototype.constructor=Un,Un.prototype.isCompressedTexture=!0,qt.prototype=Object.create(Ae.prototype),qt.prototype.constructor=qt,qt.prototype.isCanvasTexture=!0,Xi.prototype=Object.create(Ae.prototype),Xi.prototype.constructor=Xi,Xi.prototype.isDepthTexture=!0,Li.prototype=Object.create(re.prototype),Li.prototype.constructor=Li,bo.prototype=Object.create(he.prototype),bo.prototype.constructor=bo,br.prototype=Object.create(re.prototype),br.prototype.constructor=br,Ro.prototype=Object.create(he.prototype),Ro.prototype.constructor=Ro,rn.prototype=Object.create(re.prototype),rn.prototype.constructor=rn,Do.prototype=Object.create(he.prototype),Do.prototype.constructor=Do,Rr.prototype=Object.create(rn.prototype),Rr.prototype.constructor=Rr,Bo.prototype=Object.create(he.prototype),Bo.prototype.constructor=Bo,Qi.prototype=Object.create(rn.prototype),Qi.prototype.constructor=Qi,Io.prototype=Object.create(he.prototype),Io.prototype.constructor=Io,Dr.prototype=Object.create(rn.prototype),Dr.prototype.constructor=Dr,Oo.prototype=Object.create(he.prototype),Oo.prototype.constructor=Oo,Br.prototype=Object.create(rn.prototype),Br.prototype.constructor=Br,Fo.prototype=Object.create(he.prototype),Fo.prototype.constructor=Fo,qi.prototype=Object.create(re.prototype),qi.prototype.constructor=qi,qi.prototype.toJSON=function(){var e=re.prototype.toJSON.call(this);return e.path=this.parameters.path.toJSON(),e},No.prototype=Object.create(he.prototype),No.prototype.constructor=No,Ir.prototype=Object.create(re.prototype),Ir.prototype.constructor=Ir,Uo.prototype=Object.create(he.prototype),Uo.prototype.constructor=Uo,Or.prototype=Object.create(re.prototype),Or.prototype.constructor=Or;var Mh={triangulate:function(e,t,n){n=n||2;var i=t&&t.length,r=i?t[0]*n:e.length,o=_l(e,0,r,n,!0),s=[];if(!o||o.next===o.prev)return s;var a;if(i){var c=n;i=[];var u,h=0;for(u=t.length;h<u;h++){var p=t[h]*c,v=h<u-1?t[h+1]*c:e.length;p=_l(e,p,v,c,!1),p===p.next&&(p.steiner=!0),i.push(Ju(p))}for(i.sort(Zu),h=0;h<i.length;h++)t=i[h],c=o,(c=Ku(t,c))&&(t=Ll(c,t),zo(t,t.next)),o=zo(o,o.next)}if(e.length>80*n){var x=a=e[0],y=i=e[1];for(c=n;c<r;c+=n)h=e[c],t=e[c+1],h<x&&(x=h),t<y&&(y=t),h>a&&(a=h),t>i&&(i=t);a=Math.max(a-x,i-y),a=a!==0?1/a:0}return Go(o,s,n,x,y,a),s}},mi={area:function(e){for(var t=e.length,n=0,i=t-1,r=0;r<t;i=r++)n+=e[i].x*e[r].y-e[r].x*e[i].y;return .5*n},isClockWise:function(e){return 0>mi.area(e)},triangulateShape:function(e,t){var n=[],i=[],r=[];bl(e),Rl(n,e);var o=e.length;for(t.forEach(bl),e=0;e<t.length;e++)i.push(o),o+=t[e].length,Rl(n,t[e]);for(t=Mh.triangulate(n,i),e=0;e<t.length;e+=3)r.push(t.slice(e,e+3));return r}};Ki.prototype=Object.create(he.prototype),Ki.prototype.constructor=Ki,Ki.prototype.toJSON=function(){var e=he.prototype.toJSON.call(this);return Dl(this.parameters.shapes,this.parameters.options,e)},zn.prototype=Object.create(re.prototype),zn.prototype.constructor=zn,zn.prototype.toJSON=function(){var e=re.prototype.toJSON.call(this);return Dl(this.parameters.shapes,this.parameters.options,e)};var Eh={generateTopUV:function(e,t,n,i,r){e=t[3*i],i=t[3*i+1];var o=t[3*r];return r=t[3*r+1],[new G(t[3*n],t[3*n+1]),new G(e,i),new G(o,r)]},generateSideWallUV:function(e,t,n,i,r,o){e=t[3*n];var s=t[3*n+1];n=t[3*n+2];var a=t[3*i],c=t[3*i+1];i=t[3*i+2];var u=t[3*r],h=t[3*r+1];r=t[3*r+2];var p=t[3*o],v=t[3*o+1];return t=t[3*o+2],.01>Math.abs(s-c)?[new G(e,1-n),new G(a,1-i),new G(u,1-r),new G(p,1-t)]:[new G(s,1-n),new G(c,1-i),new G(h,1-r),new G(v,1-t)]}};jo.prototype=Object.create(he.prototype),jo.prototype.constructor=jo,Nr.prototype=Object.create(zn.prototype),Nr.prototype.constructor=Nr,Wo.prototype=Object.create(he.prototype),Wo.prototype.constructor=Wo,Pi.prototype=Object.create(re.prototype),Pi.prototype.constructor=Pi,ko.prototype=Object.create(he.prototype),ko.prototype.constructor=ko,Ur.prototype=Object.create(re.prototype),Ur.prototype.constructor=Ur,Yo.prototype=Object.create(he.prototype),Yo.prototype.constructor=Yo,zr.prototype=Object.create(re.prototype),zr.prototype.constructor=zr,Ji.prototype=Object.create(he.prototype),Ji.prototype.constructor=Ji,Ji.prototype.toJSON=function(){var e=he.prototype.toJSON.call(this);return Bl(this.parameters.shapes,e)},$i.prototype=Object.create(re.prototype),$i.prototype.constructor=$i,$i.prototype.toJSON=function(){var e=re.prototype.toJSON.call(this);return Bl(this.parameters.shapes,e)},Gr.prototype=Object.create(re.prototype),Gr.prototype.constructor=Gr,er.prototype=Object.create(he.prototype),er.prototype.constructor=er,si.prototype=Object.create(re.prototype),si.prototype.constructor=si,Xo.prototype=Object.create(er.prototype),Xo.prototype.constructor=Xo,Qo.prototype=Object.create(si.prototype),Qo.prototype.constructor=Qo,qo.prototype=Object.create(he.prototype),qo.prototype.constructor=qo,Hr.prototype=Object.create(re.prototype),Hr.prototype.constructor=Hr;var Zt=Object.freeze({WireframeGeometry:Li,ParametricGeometry:bo,ParametricBufferGeometry:br,TetrahedronGeometry:Do,TetrahedronBufferGeometry:Rr,OctahedronGeometry:Bo,OctahedronBufferGeometry:Qi,IcosahedronGeometry:Io,IcosahedronBufferGeometry:Dr,DodecahedronGeometry:Oo,DodecahedronBufferGeometry:Br,PolyhedronGeometry:Ro,PolyhedronBufferGeometry:rn,TubeGeometry:Fo,TubeBufferGeometry:qi,TorusKnotGeometry:No,TorusKnotBufferGeometry:Ir,TorusGeometry:Uo,TorusBufferGeometry:Or,TextGeometry:jo,TextBufferGeometry:Nr,SphereGeometry:Wo,SphereBufferGeometry:Pi,RingGeometry:ko,RingBufferGeometry:Ur,PlaneGeometry:ti,PlaneBufferGeometry:ni,LatheGeometry:Yo,LatheBufferGeometry:zr,ShapeGeometry:Ji,ShapeBufferGeometry:$i,ExtrudeGeometry:Ki,ExtrudeBufferGeometry:zn,EdgesGeometry:Gr,ConeGeometry:Xo,ConeBufferGeometry:Qo,CylinderGeometry:er,CylinderBufferGeometry:si,CircleGeometry:qo,CircleBufferGeometry:Hr,BoxGeometry:ol,BoxBufferGeometry:ds});tr.prototype=Object.create(ie.prototype),tr.prototype.constructor=tr,tr.prototype.isShadowMaterial=!0,tr.prototype.copy=function(e){return ie.prototype.copy.call(this,e),this.color.copy(e.color),this},Vr.prototype=Object.create(Rt.prototype),Vr.prototype.constructor=Vr,Vr.prototype.isRawShaderMaterial=!0,Gn.prototype=Object.create(ie.prototype),Gn.prototype.constructor=Gn,Gn.prototype.isMeshStandardMaterial=!0,Gn.prototype.copy=function(e){return ie.prototype.copy.call(this,e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapIntensity=e.envMapIntensity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this},nr.prototype=Object.create(Gn.prototype),nr.prototype.constructor=nr,nr.prototype.isMeshPhysicalMaterial=!0,nr.prototype.copy=function(e){return Gn.prototype.copy.call(this,e),this.defines={STANDARD:"",PHYSICAL:""},this.reflectivity=e.reflectivity,this.clearcoat=e.clearcoat,this.clearcoatRoughness=e.clearcoatRoughness,this.sheen=e.sheen?(this.sheen||new ve).copy(e.sheen):null,this.clearcoatNormalMap=e.clearcoatNormalMap,this.clearcoatNormalScale.copy(e.clearcoatNormalScale),this.transparency=e.transparency,this},yn.prototype=Object.create(ie.prototype),yn.prototype.constructor=yn,yn.prototype.isMeshPhongMaterial=!0,yn.prototype.copy=function(e){return ie.prototype.copy.call(this,e),this.color.copy(e.color),this.specular.copy(e.specular),this.shininess=e.shininess,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this},ir.prototype=Object.create(yn.prototype),ir.prototype.constructor=ir,ir.prototype.isMeshToonMaterial=!0,ir.prototype.copy=function(e){return yn.prototype.copy.call(this,e),this.gradientMap=e.gradientMap,this},rr.prototype=Object.create(ie.prototype),rr.prototype.constructor=rr,rr.prototype.isMeshNormalMaterial=!0,rr.prototype.copy=function(e){return ie.prototype.copy.call(this,e),this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this},or.prototype=Object.create(ie.prototype),or.prototype.constructor=or,or.prototype.isMeshLambertMaterial=!0,or.prototype.copy=function(e){return ie.prototype.copy.call(this,e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this},sr.prototype=Object.create(ie.prototype),sr.prototype.constructor=sr,sr.prototype.isMeshMatcapMaterial=!0,sr.prototype.copy=function(e){return ie.prototype.copy.call(this,e),this.defines={MATCAP:""},this.color.copy(e.color),this.matcap=e.matcap,this.map=e.map,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this},ar.prototype=Object.create($e.prototype),ar.prototype.constructor=ar,ar.prototype.isLineDashedMaterial=!0,ar.prototype.copy=function(e){return $e.prototype.copy.call(this,e),this.scale=e.scale,this.dashSize=e.dashSize,this.gapSize=e.gapSize,this};var Sh=Object.freeze({ShadowMaterial:tr,SpriteMaterial:wt,RawShaderMaterial:Vr,ShaderMaterial:Rt,PointsMaterial:nn,MeshPhysicalMaterial:nr,MeshStandardMaterial:Gn,MeshPhongMaterial:yn,MeshToonMaterial:ir,MeshNormalMaterial:rr,MeshLambertMaterial:or,MeshDepthMaterial:g,MeshDistanceMaterial:A,MeshBasicMaterial:Wt,MeshMatcapMaterial:sr,LineDashedMaterial:ar,LineBasicMaterial:$e,Material:ie}),Nt={arraySlice:function(e,t,n){return Nt.isTypedArray(e)?new e.constructor(e.subarray(t,n!==void 0?n:e.length)):e.slice(t,n)},convertArray:function(e,t,n){return!e||!n&&e.constructor===t?e:typeof t.BYTES_PER_ELEMENT=="number"?new t(e):Array.prototype.slice.call(e)},isTypedArray:function(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)},getKeyframeOrder:function(e){for(var t=e.length,n=Array(t),i=0;i!==t;++i)n[i]=i;return n.sort(function(r,o){return e[r]-e[o]}),n},sortedArray:function(e,t,n){for(var i=e.length,r=new e.constructor(i),o=0,s=0;s!==i;++o)for(var a=n[o]*t,c=0;c!==t;++c)r[s++]=e[a+c];return r},flattenJSON:function(e,t,n,i){for(var r=1,o=e[0];o!==void 0&&o[i]===void 0;)o=e[r++];if(o!==void 0){var s=o[i];if(s!==void 0)if(Array.isArray(s))do s=o[i],s!==void 0&&(t.push(o.time),n.push.apply(n,s)),o=e[r++];while(o!==void 0);else if(s.toArray!==void 0)do s=o[i],s!==void 0&&(t.push(o.time),s.toArray(n,n.length)),o=e[r++];while(o!==void 0);else do s=o[i],s!==void 0&&(t.push(o.time),n.push(s)),o=e[r++];while(o!==void 0)}}};Object.assign(an.prototype,{evaluate:function(e){var t=this.parameterPositions,n=this._cachedIndex,i=t[n],r=t[n-1];e:{t:{n:{i:if(!(e<i)){for(var o=n+2;;){if(i===void 0){if(e<r)break i;return this._cachedIndex=n=t.length,this.afterEnd_(n-1,e,r)}if(n===o)break;if(r=i,i=t[++n],e<i)break t}i=t.length;break n}if(e>=r)break e;for(o=t[1],e<o&&(n=2,r=o),o=n-2;;){if(r===void 0)return this._cachedIndex=0,this.beforeStart_(0,e,i);if(n===o)break;if(i=r,r=t[--n-1],e>=r)break t}i=n,n=0}for(;n<i;)r=n+i>>>1,e<t[r]?i=r:n=r+1;if(i=t[n],r=t[n-1],r===void 0)return this._cachedIndex=0,this.beforeStart_(0,e,i);if(i===void 0)return this._cachedIndex=n=t.length,this.afterEnd_(n-1,r,e)}this._cachedIndex=n,this.intervalChanged_(n,r,i)}return this.interpolate_(n,r,e,i)},settings:null,DefaultSettings_:{},getSettings_:function(){return this.settings||this.DefaultSettings_},copySampleValue_:function(e){var t=this.resultBuffer,n=this.sampleValues,i=this.valueSize;e*=i;for(var r=0;r!==i;++r)t[r]=n[e+r];return t},interpolate_:function(){throw Error("call to abstract method")},intervalChanged_:function(){}}),Object.assign(an.prototype,{beforeStart_:an.prototype.copySampleValue_,afterEnd_:an.prototype.copySampleValue_}),Xs.prototype=Object.assign(Object.create(an.prototype),{constructor:Xs,DefaultSettings_:{endingStart:2400,endingEnd:2400},intervalChanged_:function(e,t,n){var i=this.parameterPositions,r=e-2,o=e+1,s=i[r],a=i[o];if(s===void 0)switch(this.getSettings_().endingStart){case 2401:r=e,s=2*t-n;break;case 2402:r=i.length-2,s=t+i[r]-i[r+1];break;default:r=e,s=n}if(a===void 0)switch(this.getSettings_().endingEnd){case 2401:o=e,a=2*n-t;break;case 2402:o=1,a=n+i[1]-i[0];break;default:o=e-1,a=t}e=.5*(n-t),i=this.valueSize,this._weightPrev=e/(t-s),this._weightNext=e/(a-n),this._offsetPrev=r*i,this._offsetNext=o*i},interpolate_:function(e,t,n,i){var r=this.resultBuffer,o=this.sampleValues,s=this.valueSize;e*=s;var a=e-s,c=this._offsetPrev,u=this._offsetNext,h=this._weightPrev,p=this._weightNext,v=(n-t)/(i-t);for(n=v*v,i=n*v,t=-h*i+2*h*n-h*v,h=(1+h)*i+(-1.5-2*h)*n+(-.5+h)*v+1,v=(-1-p)*i+(1.5+p)*n+.5*v,p=p*i-p*n,n=0;n!==s;++n)r[n]=t*o[c+n]+h*o[a+n]+v*o[e+n]+p*o[u+n];return r}}),Zo.prototype=Object.assign(Object.create(an.prototype),{constructor:Zo,interpolate_:function(e,t,n,i){var r=this.resultBuffer,o=this.sampleValues,s=this.valueSize;e*=s;var a=e-s;for(t=(n-t)/(i-t),n=1-t,i=0;i!==s;++i)r[i]=o[a+i]*n+o[e+i]*t;return r}}),Qs.prototype=Object.assign(Object.create(an.prototype),{constructor:Qs,interpolate_:function(e){return this.copySampleValue_(e-1)}}),Object.assign(Vt,{toJSON:function(e){var t=e.constructor;if(t.toJSON!==void 0)t=t.toJSON(e);else{t={name:e.name,times:Nt.convertArray(e.times,Array),values:Nt.convertArray(e.values,Array)};var n=e.getInterpolation();n!==e.DefaultInterpolation&&(t.interpolation=n)}return t.type=e.ValueTypeName,t}}),Object.assign(Vt.prototype,{constructor:Vt,TimeBufferType:Float32Array,ValueBufferType:Float32Array,DefaultInterpolation:2301,InterpolantFactoryMethodDiscrete:function(e){return new Qs(this.times,this.values,this.getValueSize(),e)},InterpolantFactoryMethodLinear:function(e){return new Zo(this.times,this.values,this.getValueSize(),e)},InterpolantFactoryMethodSmooth:function(e){return new Xs(this.times,this.values,this.getValueSize(),e)},setInterpolation:function(e){switch(e){case 2300:var t=this.InterpolantFactoryMethodDiscrete;break;case 2301:t=this.InterpolantFactoryMethodLinear;break;case 2302:t=this.InterpolantFactoryMethodSmooth}if(t===void 0){if(t="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name,this.createInterpolant===void 0)if(e!==this.DefaultInterpolation)this.setInterpolation(this.DefaultInterpolation);else throw Error(t);return console.warn("THREE.KeyframeTrack:",t),this}return this.createInterpolant=t,this},getInterpolation:function(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return 2300;case this.InterpolantFactoryMethodLinear:return 2301;case this.InterpolantFactoryMethodSmooth:return 2302}},getValueSize:function(){return this.values.length/this.times.length},shift:function(e){if(e!==0)for(var t=this.times,n=0,i=t.length;n!==i;++n)t[n]+=e;return this},scale:function(e){if(e!==1)for(var t=this.times,n=0,i=t.length;n!==i;++n)t[n]*=e;return this},trim:function(e,t){for(var n=this.times,i=n.length,r=0,o=i-1;r!==i&&n[r]<e;)++r;for(;o!==-1&&n[o]>t;)--o;return++o,(r!==0||o!==i)&&(r>=o&&(o=Math.max(o,1),r=o-1),e=this.getValueSize(),this.times=Nt.arraySlice(n,r,o),this.values=Nt.arraySlice(this.values,r*e,o*e)),this},validate:function(){var e=!0,t=this.getValueSize();t-Math.floor(t)!==0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),e=!1);var n=this.times;t=this.values;var i=n.length;i===0&&(console.error("THREE.KeyframeTrack: Track is empty.",this),e=!1);for(var r=null,o=0;o!==i;o++){var s=n[o];if(typeof s=="number"&&isNaN(s)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,o,s),e=!1;break}if(r!==null&&r>s){console.error("THREE.KeyframeTrack: Out of order keys.",this,o,s,r),e=!1;break}r=s}if(t!==void 0&&Nt.isTypedArray(t)){for(o=0,n=t.length;o!==n;++o)if(i=t[o],isNaN(i)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,o,i),e=!1;break}}return e},optimize:function(){for(var e=this.times,t=this.values,n=this.getValueSize(),i=this.getInterpolation()===2302,r=1,o=e.length-1,s=1;s<o;++s){var a=!1,c=e[s];if(c!==e[s+1]&&(s!==1||c!==c[0]))if(i)a=!0;else{var u=s*n,h=u-n,p=u+n;for(c=0;c!==n;++c){var v=t[u+c];if(v!==t[h+c]||v!==t[p+c]){a=!0;break}}}if(a){if(s!==r)for(e[r]=e[s],a=s*n,u=r*n,c=0;c!==n;++c)t[u+c]=t[a+c];++r}}if(0<o){for(e[r]=e[o],a=o*n,u=r*n,c=0;c!==n;++c)t[u+c]=t[a+c];++r}return r!==e.length&&(this.times=Nt.arraySlice(e,0,r),this.values=Nt.arraySlice(t,0,r*n)),this},clone:function(){var e=Nt.arraySlice(this.times,0),t=Nt.arraySlice(this.values,0);return e=new this.constructor(this.name,e,t),e.createInterpolant=this.createInterpolant,e}}),qs.prototype=Object.assign(Object.create(Vt.prototype),{constructor:qs,ValueTypeName:"bool",ValueBufferType:Array,DefaultInterpolation:2300,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0}),Zs.prototype=Object.assign(Object.create(Vt.prototype),{constructor:Zs,ValueTypeName:"color"}),jr.prototype=Object.assign(Object.create(Vt.prototype),{constructor:jr,ValueTypeName:"number"}),Ks.prototype=Object.assign(Object.create(an.prototype),{constructor:Ks,interpolate_:function(e,t,n,i){var r=this.resultBuffer,o=this.sampleValues,s=this.valueSize;for(e*=s,t=(n-t)/(i-t),n=e+s;e!==n;e+=4)we.slerpFlat(r,0,o,e-s,o,e,t);return r}}),Ko.prototype=Object.assign(Object.create(Vt.prototype),{constructor:Ko,ValueTypeName:"quaternion",DefaultInterpolation:2301,InterpolantFactoryMethodLinear:function(e){return new Ks(this.times,this.values,this.getValueSize(),e)},InterpolantFactoryMethodSmooth:void 0}),Js.prototype=Object.assign(Object.create(Vt.prototype),{constructor:Js,ValueTypeName:"string",ValueBufferType:Array,DefaultInterpolation:2300,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0}),Wr.prototype=Object.assign(Object.create(Vt.prototype),{constructor:Wr,ValueTypeName:"vector"}),Object.assign(fn,{parse:function(e){for(var t=[],n=e.tracks,i=1/(e.fps||1),r=0,o=n.length;r!==o;++r)t.push(eh(n[r]).scale(i));return new fn(e.name,e.duration,t)},toJSON:function(e){var t=[],n=e.tracks;e={name:e.name,duration:e.duration,tracks:t,uuid:e.uuid};for(var i=0,r=n.length;i!==r;++i)t.push(Vt.toJSON(n[i]));return e},CreateFromMorphTargetSequence:function(e,t,n,i){for(var r=t.length,o=[],s=0;s<r;s++){var a=[],c=[];a.push((s+r-1)%r,s,(s+1)%r),c.push(0,1,0);var u=Nt.getKeyframeOrder(a);a=Nt.sortedArray(a,1,u),c=Nt.sortedArray(c,1,u),i||a[0]!==0||(a.push(r),c.push(c[0])),o.push(new jr(".morphTargetInfluences["+t[s].name+"]",a,c).scale(1/n))}return new fn(e,-1,o)},findByName:function(e,t){var n=e;for(Array.isArray(e)||(n=e.geometry&&e.geometry.animations||e.animations),e=0;e<n.length;e++)if(n[e].name===t)return n[e];return null},CreateClipsFromMorphTargetSequences:function(e,t,n){for(var i={},r=/^([\w-]*?)([\d]+)$/,o=0,s=e.length;o<s;o++){var a=e[o],c=a.name.match(r);if(c&&1<c.length){var u=c[1];(c=i[u])||(i[u]=c=[]),c.push(a)}}e=[];for(u in i)e.push(fn.CreateFromMorphTargetSequence(u,i[u],t,n));return e},parseAnimation:function(e,t){if(!e)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;var n=function(M,L,O,F,z){if(O.length!==0){var V=[],B=[];Nt.flattenJSON(O,V,B,F),V.length!==0&&z.push(new M(L,V,B))}},i=[],r=e.name||"default",o=e.length||-1,s=e.fps||30;e=e.hierarchy||[];for(var a=0;a<e.length;a++){var c=e[a].keys;if(c&&c.length!==0)if(c[0].morphTargets){o={};for(var u=0;u<c.length;u++)if(c[u].morphTargets)for(var h=0;h<c[u].morphTargets.length;h++)o[c[u].morphTargets[h]]=-1;for(var p in o){var v=[],x=[];for(h=0;h!==c[u].morphTargets.length;++h){var y=c[u];v.push(y.time),x.push(y.morphTarget===p?1:0)}i.push(new jr(".morphTargetInfluence["+p+"]",v,x))}o=o.length*(s||1)}else u=".bones["+t[a].name+"]",n(Wr,u+".position",c,"pos",i),n(Ko,u+".quaternion",c,"rot",i),n(Wr,u+".scale",c,"scl",i)}return i.length===0?null:new fn(r,o,i)}}),Object.assign(fn.prototype,{resetDuration:function(){for(var e=0,t=0,n=this.tracks.length;t!==n;++t){var i=this.tracks[t];e=Math.max(e,i.times[i.times.length-1])}return this.duration=e,this},trim:function(){for(var e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this},validate:function(){for(var e=!0,t=0;t<this.tracks.length;t++)e=e&&this.tracks[t].validate();return e},optimize:function(){for(var e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this},clone:function(){for(var e=[],t=0;t<this.tracks.length;t++)e.push(this.tracks[t].clone());return new fn(this.name,this.duration,e)}});var vr={enabled:!1,files:{},add:function(e,t){this.enabled!==!1&&(this.files[e]=t)},get:function(e){if(this.enabled!==!1)return this.files[e]},remove:function(e){delete this.files[e]},clear:function(){this.files={}}},Eu=new Mc;Object.assign(ut.prototype,{load:function(){},parse:function(){},setCrossOrigin:function(e){return this.crossOrigin=e,this},setPath:function(e){return this.path=e,this},setResourcePath:function(e){return this.resourcePath=e,this}});var Pn={};mn.prototype=Object.assign(Object.create(ut.prototype),{constructor:mn,load:function(e,t,n,i){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);var r=this,o=vr.get(e);if(o!==void 0)return r.manager.itemStart(e),setTimeout(function(){t&&t(o),r.manager.itemEnd(e)},0),o;if(Pn[e]!==void 0)Pn[e].push({onLoad:t,onProgress:n,onError:i});else{var s=e.match(/^data:(.*?)(;base64)?,(.*)$/);if(s){n=s[1];var a=!!s[2];s=s[3],s=decodeURIComponent(s),a&&(s=atob(s));try{var c=(this.responseType||"").toLowerCase();switch(c){case"arraybuffer":case"blob":var u=new Uint8Array(s.length);for(a=0;a<s.length;a++)u[a]=s.charCodeAt(a);var h=c==="blob"?new Blob([u.buffer],{type:n}):u.buffer;break;case"document":h=new DOMParser().parseFromString(s,n);break;case"json":h=JSON.parse(s);break;default:h=s}setTimeout(function(){t&&t(h),r.manager.itemEnd(e)},0)}catch(v){setTimeout(function(){i&&i(v),r.manager.itemError(e),r.manager.itemEnd(e)},0)}}else{Pn[e]=[],Pn[e].push({onLoad:t,onProgress:n,onError:i});var p=new XMLHttpRequest;p.open("GET",e,!0),p.addEventListener("load",function(v){var x=this.response;vr.add(e,x);var y=Pn[e];if(delete Pn[e],this.status===200||this.status===0){this.status===0&&console.warn("THREE.FileLoader: HTTP Status 0 received.");for(var M=0,L=y.length;M<L;M++){var O=y[M];O.onLoad&&O.onLoad(x)}}else{for(M=0,L=y.length;M<L;M++)O=y[M],O.onError&&O.onError(v);r.manager.itemError(e)}r.manager.itemEnd(e)},!1),p.addEventListener("progress",function(v){for(var x=Pn[e],y=0,M=x.length;y<M;y++){var L=x[y];L.onProgress&&L.onProgress(v)}},!1),p.addEventListener("error",function(v){var x=Pn[e];delete Pn[e];for(var y=0,M=x.length;y<M;y++){var L=x[y];L.onError&&L.onError(v)}r.manager.itemError(e),r.manager.itemEnd(e)},!1),p.addEventListener("abort",function(v){var x=Pn[e];delete Pn[e];for(var y=0,M=x.length;y<M;y++){var L=x[y];L.onError&&L.onError(v)}r.manager.itemError(e),r.manager.itemEnd(e)},!1),this.responseType!==void 0&&(p.responseType=this.responseType),this.withCredentials!==void 0&&(p.withCredentials=this.withCredentials),p.overrideMimeType&&p.overrideMimeType(this.mimeType!==void 0?this.mimeType:"text/plain");for(a in this.requestHeader)p.setRequestHeader(a,this.requestHeader[a]);p.send(null)}return r.manager.itemStart(e),p}},setResponseType:function(e){return this.responseType=e,this},setWithCredentials:function(e){return this.withCredentials=e,this},setMimeType:function(e){return this.mimeType=e,this},setRequestHeader:function(e){return this.requestHeader=e,this}}),Ec.prototype=Object.assign(Object.create(ut.prototype),{constructor:Ec,load:function(e,t,n,i){var r=this,o=new mn(r.manager);o.setPath(r.path),o.load(e,function(s){t(r.parse(JSON.parse(s)))},n,i)},parse:function(e){for(var t=[],n=0;n<e.length;n++){var i=fn.parse(e[n]);t.push(i)}return t}}),Sc.prototype=Object.assign(Object.create(ut.prototype),{constructor:Sc,load:function(e,t,n,i){function r(v){c.load(e[v],function(x){x=o.parse(x,!0),s[v]={width:x.width,height:x.height,format:x.format,mipmaps:x.mipmaps},u+=1,u===6&&(x.mipmapCount===1&&(a.minFilter=1006),a.format=x.format,a.needsUpdate=!0,t&&t(a))},n,i)}var o=this,s=[],a=new Un;a.image=s;var c=new mn(this.manager);if(c.setPath(this.path),c.setResponseType("arraybuffer"),Array.isArray(e))for(var u=0,h=0,p=e.length;h<p;++h)r(h);else c.load(e,function(v){if(v=o.parse(v,!0),v.isCubemap)for(var x=v.mipmaps.length/v.mipmapCount,y=0;y<x;y++){s[y]={mipmaps:[]};for(var M=0;M<v.mipmapCount;M++)s[y].mipmaps.push(v.mipmaps[y*v.mipmapCount+M]),s[y].format=v.format,s[y].width=v.width,s[y].height=v.height}else a.image.width=v.width,a.image.height=v.height,a.mipmaps=v.mipmaps;v.mipmapCount===1&&(a.minFilter=1006),a.format=v.format,a.needsUpdate=!0,t&&t(a)},n,i);return a}}),$s.prototype=Object.assign(Object.create(ut.prototype),{constructor:$s,load:function(e,t,n,i){var r=this,o=new ei,s=new mn(this.manager);return s.setResponseType("arraybuffer"),s.setPath(this.path),s.load(e,function(a){(a=r.parse(a))&&(a.image!==void 0?o.image=a.image:a.data!==void 0&&(o.image.width=a.width,o.image.height=a.height,o.image.data=a.data),o.wrapS=a.wrapS!==void 0?a.wrapS:1001,o.wrapT=a.wrapT!==void 0?a.wrapT:1001,o.magFilter=a.magFilter!==void 0?a.magFilter:1006,o.minFilter=a.minFilter!==void 0?a.minFilter:1008,o.anisotropy=a.anisotropy!==void 0?a.anisotropy:1,a.format!==void 0&&(o.format=a.format),a.type!==void 0&&(o.type=a.type),a.mipmaps!==void 0&&(o.mipmaps=a.mipmaps),a.mipmapCount===1&&(o.minFilter=1006),o.needsUpdate=!0,t&&t(o,a))},n,i),o}}),kr.prototype=Object.assign(Object.create(ut.prototype),{constructor:kr,load:function(e,t,n,i){function r(){c.removeEventListener("load",r,!1),c.removeEventListener("error",o,!1),vr.add(e,this),t&&t(this),s.manager.itemEnd(e)}function o(u){c.removeEventListener("load",r,!1),c.removeEventListener("error",o,!1),i&&i(u),s.manager.itemError(e),s.manager.itemEnd(e)}this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);var s=this,a=vr.get(e);if(a!==void 0)return s.manager.itemStart(e),setTimeout(function(){t&&t(a),s.manager.itemEnd(e)},0),a;var c=document.createElementNS("http://www.w3.org/1999/xhtml","img");return c.addEventListener("load",r,!1),c.addEventListener("error",o,!1),e.substr(0,5)!=="data:"&&this.crossOrigin!==void 0&&(c.crossOrigin=this.crossOrigin),s.manager.itemStart(e),c.src=e,c}}),ea.prototype=Object.assign(Object.create(ut.prototype),{constructor:ea,load:function(e,t,n,i){function r(c){s.load(e[c],function(u){o.images[c]=u,a++,a===6&&(o.needsUpdate=!0,t&&t(o))},void 0,i)}var o=new Ct,s=new kr(this.manager);s.setCrossOrigin(this.crossOrigin),s.setPath(this.path);var a=0;for(n=0;n<e.length;++n)r(n);return o}}),ta.prototype=Object.assign(Object.create(ut.prototype),{constructor:ta,load:function(e,t,n,i){var r=new Ae,o=new kr(this.manager);return o.setCrossOrigin(this.crossOrigin),o.setPath(this.path),o.load(e,function(s){r.image=s,s=0<e.search(/\.jpe?g($|\?)/i)||e.search(/^data:image\/jpeg/)===0,r.format=s?1022:1023,r.needsUpdate=!0,t!==void 0&&t(r)},n,i),r}}),Object.assign(Pe.prototype,{getPoint:function(){return console.warn("THREE.Curve: .getPoint() not implemented."),null},getPointAt:function(e,t){return e=this.getUtoTmapping(e),this.getPoint(e,t)},getPoints:function(e){e===void 0&&(e=5);for(var t=[],n=0;n<=e;n++)t.push(this.getPoint(n/e));return t},getSpacedPoints:function(e){e===void 0&&(e=5);for(var t=[],n=0;n<=e;n++)t.push(this.getPointAt(n/e));return t},getLength:function(){var e=this.getLengths();return e[e.length-1]},getLengths:function(e){if(e===void 0&&(e=this.arcLengthDivisions),this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;var t=[],n=this.getPoint(0),i,r=0;for(t.push(0),i=1;i<=e;i++){var o=this.getPoint(i/e);r+=o.distanceTo(n),t.push(r),n=o}return this.cacheArcLengths=t},updateArcLengths:function(){this.needsUpdate=!0,this.getLengths()},getUtoTmapping:function(e,t){var n=this.getLengths(),i=n.length;t=t||e*n[i-1];for(var r=0,o=i-1,s;r<=o;)if(e=Math.floor(r+(o-r)/2),s=n[e]-t,0>s)r=e+1;else if(0<s)o=e-1;else{o=e;break}return e=o,n[e]===t?e/(i-1):(r=n[e],(e+(t-r)/(n[e+1]-r))/(i-1))},getTangent:function(e){var t=e-1e-4;return e+=1e-4,0>t&&(t=0),1<e&&(e=1),t=this.getPoint(t),this.getPoint(e).clone().sub(t).normalize()},getTangentAt:function(e){return e=this.getUtoTmapping(e),this.getTangent(e)},computeFrenetFrames:function(e,t){var n=new E,i=[],r=[],o=[],s=new E,a=new Se,c;for(c=0;c<=e;c++){var u=c/e;i[c]=this.getTangentAt(u),i[c].normalize()}r[0]=new E,o[0]=new E,c=Number.MAX_VALUE,u=Math.abs(i[0].x);var h=Math.abs(i[0].y),p=Math.abs(i[0].z);for(u<=c&&(c=u,n.set(1,0,0)),h<=c&&(c=h,n.set(0,1,0)),p<=c&&n.set(0,0,1),s.crossVectors(i[0],n).normalize(),r[0].crossVectors(i[0],s),o[0].crossVectors(i[0],r[0]),c=1;c<=e;c++)r[c]=r[c-1].clone(),o[c]=o[c-1].clone(),s.crossVectors(i[c-1],i[c]),s.length()>Number.EPSILON&&(s.normalize(),n=Math.acos(Xe.clamp(i[c-1].dot(i[c]),-1,1)),r[c].applyMatrix4(a.makeRotationAxis(s,n))),o[c].crossVectors(i[c],r[c]);if(t===!0)for(n=Math.acos(Xe.clamp(r[0].dot(r[e]),-1,1)),n/=e,0<i[0].dot(s.crossVectors(r[0],r[e]))&&(n=-n),c=1;c<=e;c++)r[c].applyMatrix4(a.makeRotationAxis(i[c],n*c)),o[c].crossVectors(i[c],r[c]);return{tangents:i,normals:r,binormals:o}},clone:function(){return new this.constructor().copy(this)},copy:function(e){return this.arcLengthDivisions=e.arcLengthDivisions,this},toJSON:function(){var e={metadata:{version:4.5,type:"Curve",generator:"Curve.toJSON"}};return e.arcLengthDivisions=this.arcLengthDivisions,e.type=this.type,e},fromJSON:function(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}}),cn.prototype=Object.create(Pe.prototype),cn.prototype.constructor=cn,cn.prototype.isEllipseCurve=!0,cn.prototype.getPoint=function(e,t){t=t||new G;for(var n=2*Math.PI,i=this.aEndAngle-this.aStartAngle,r=Math.abs(i)<Number.EPSILON;0>i;)i+=n;for(;i>n;)i-=n;i<Number.EPSILON&&(i=r?0:n),this.aClockwise!==!0||r||(i=i===n?-n:i-n),n=this.aStartAngle+e*i,e=this.aX+this.xRadius*Math.cos(n);var o=this.aY+this.yRadius*Math.sin(n);return this.aRotation!==0&&(n=Math.cos(this.aRotation),i=Math.sin(this.aRotation),r=e-this.aX,o-=this.aY,e=r*n-o*i+this.aX,o=r*i+o*n+this.aY),t.set(e,o)},cn.prototype.copy=function(e){return Pe.prototype.copy.call(this,e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this},cn.prototype.toJSON=function(){var e=Pe.prototype.toJSON.call(this);return e.aX=this.aX,e.aY=this.aY,e.xRadius=this.xRadius,e.yRadius=this.yRadius,e.aStartAngle=this.aStartAngle,e.aEndAngle=this.aEndAngle,e.aClockwise=this.aClockwise,e.aRotation=this.aRotation,e},cn.prototype.fromJSON=function(e){return Pe.prototype.fromJSON.call(this,e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this},Yr.prototype=Object.create(cn.prototype),Yr.prototype.constructor=Yr,Yr.prototype.isArcCurve=!0;var Ga=new E,hl=new Tc,dl=new Tc,pl=new Tc;Yt.prototype=Object.create(Pe.prototype),Yt.prototype.constructor=Yt,Yt.prototype.isCatmullRomCurve3=!0,Yt.prototype.getPoint=function(e,t){t=t||new E;var n=this.points,i=n.length;e*=i-(this.closed?0:1);var r=Math.floor(e);if(e-=r,this.closed?r+=0<r?0:(Math.floor(Math.abs(r)/i)+1)*i:e===0&&r===i-1&&(r=i-2,e=1),this.closed||0<r)var o=n[(r-1)%i];else Ga.subVectors(n[0],n[1]).add(n[0]),o=Ga;var s=n[r%i],a=n[(r+1)%i];if(this.closed||r+2<i?n=n[(r+2)%i]:(Ga.subVectors(n[i-1],n[i-2]).add(n[i-1]),n=Ga),this.curveType==="centripetal"||this.curveType==="chordal"){var c=this.curveType==="chordal"?.5:.25;i=Math.pow(o.distanceToSquared(s),c),r=Math.pow(s.distanceToSquared(a),c),c=Math.pow(a.distanceToSquared(n),c),1e-4>r&&(r=1),1e-4>i&&(i=r),1e-4>c&&(c=r),hl.initNonuniformCatmullRom(o.x,s.x,a.x,n.x,i,r,c),dl.initNonuniformCatmullRom(o.y,s.y,a.y,n.y,i,r,c),pl.initNonuniformCatmullRom(o.z,s.z,a.z,n.z,i,r,c)}else this.curveType==="catmullrom"&&(hl.initCatmullRom(o.x,s.x,a.x,n.x,this.tension),dl.initCatmullRom(o.y,s.y,a.y,n.y,this.tension),pl.initCatmullRom(o.z,s.z,a.z,n.z,this.tension));return t.set(hl.calc(e),dl.calc(e),pl.calc(e)),t},Yt.prototype.copy=function(e){Pe.prototype.copy.call(this,e),this.points=[];for(var t=0,n=e.points.length;t<n;t++)this.points.push(e.points[t].clone());return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this},Yt.prototype.toJSON=function(){var e=Pe.prototype.toJSON.call(this);e.points=[];for(var t=0,n=this.points.length;t<n;t++)e.points.push(this.points[t].toArray());return e.closed=this.closed,e.curveType=this.curveType,e.tension=this.tension,e},Yt.prototype.fromJSON=function(e){Pe.prototype.fromJSON.call(this,e),this.points=[];for(var t=0,n=e.points.length;t<n;t++){var i=e.points[t];this.points.push(new E().fromArray(i))}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this},xn.prototype=Object.create(Pe.prototype),xn.prototype.constructor=xn,xn.prototype.isCubicBezierCurve=!0,xn.prototype.getPoint=function(e,t){t=t||new G;var n=this.v0,i=this.v1,r=this.v2,o=this.v3;return t.set($o(e,n.x,i.x,r.x,o.x),$o(e,n.y,i.y,r.y,o.y)),t},xn.prototype.copy=function(e){return Pe.prototype.copy.call(this,e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this},xn.prototype.toJSON=function(){var e=Pe.prototype.toJSON.call(this);return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e},xn.prototype.fromJSON=function(e){return Pe.prototype.fromJSON.call(this,e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this},Hn.prototype=Object.create(Pe.prototype),Hn.prototype.constructor=Hn,Hn.prototype.isCubicBezierCurve3=!0,Hn.prototype.getPoint=function(e,t){t=t||new E;var n=this.v0,i=this.v1,r=this.v2,o=this.v3;return t.set($o(e,n.x,i.x,r.x,o.x),$o(e,n.y,i.y,r.y,o.y),$o(e,n.z,i.z,r.z,o.z)),t},Hn.prototype.copy=function(e){return Pe.prototype.copy.call(this,e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this},Hn.prototype.toJSON=function(){var e=Pe.prototype.toJSON.call(this);return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e},Hn.prototype.fromJSON=function(e){return Pe.prototype.fromJSON.call(this,e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this},on.prototype=Object.create(Pe.prototype),on.prototype.constructor=on,on.prototype.isLineCurve=!0,on.prototype.getPoint=function(e,t){return t=t||new G,e===1?t.copy(this.v2):(t.copy(this.v2).sub(this.v1),t.multiplyScalar(e).add(this.v1)),t},on.prototype.getPointAt=function(e,t){return this.getPoint(e,t)},on.prototype.getTangent=function(){return this.v2.clone().sub(this.v1).normalize()},on.prototype.copy=function(e){return Pe.prototype.copy.call(this,e),this.v1.copy(e.v1),this.v2.copy(e.v2),this},on.prototype.toJSON=function(){var e=Pe.prototype.toJSON.call(this);return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e},on.prototype.fromJSON=function(e){return Pe.prototype.fromJSON.call(this,e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this},wn.prototype=Object.create(Pe.prototype),wn.prototype.constructor=wn,wn.prototype.isLineCurve3=!0,wn.prototype.getPoint=function(e,t){return t=t||new E,e===1?t.copy(this.v2):(t.copy(this.v2).sub(this.v1),t.multiplyScalar(e).add(this.v1)),t},wn.prototype.getPointAt=function(e,t){return this.getPoint(e,t)},wn.prototype.copy=function(e){return Pe.prototype.copy.call(this,e),this.v1.copy(e.v1),this.v2.copy(e.v2),this},wn.prototype.toJSON=function(){var e=Pe.prototype.toJSON.call(this);return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e},wn.prototype.fromJSON=function(e){return Pe.prototype.fromJSON.call(this,e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this},An.prototype=Object.create(Pe.prototype),An.prototype.constructor=An,An.prototype.isQuadraticBezierCurve=!0,An.prototype.getPoint=function(e,t){t=t||new G;var n=this.v0,i=this.v1,r=this.v2;return t.set(Jo(e,n.x,i.x,r.x),Jo(e,n.y,i.y,r.y)),t},An.prototype.copy=function(e){return Pe.prototype.copy.call(this,e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this},An.prototype.toJSON=function(){var e=Pe.prototype.toJSON.call(this);return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e},An.prototype.fromJSON=function(e){return Pe.prototype.fromJSON.call(this,e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this},Vn.prototype=Object.create(Pe.prototype),Vn.prototype.constructor=Vn,Vn.prototype.isQuadraticBezierCurve3=!0,Vn.prototype.getPoint=function(e,t){t=t||new E;var n=this.v0,i=this.v1,r=this.v2;return t.set(Jo(e,n.x,i.x,r.x),Jo(e,n.y,i.y,r.y),Jo(e,n.z,i.z,r.z)),t},Vn.prototype.copy=function(e){return Pe.prototype.copy.call(this,e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this},Vn.prototype.toJSON=function(){var e=Pe.prototype.toJSON.call(this);return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e},Vn.prototype.fromJSON=function(e){return Pe.prototype.fromJSON.call(this,e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this},Mn.prototype=Object.create(Pe.prototype),Mn.prototype.constructor=Mn,Mn.prototype.isSplineCurve=!0,Mn.prototype.getPoint=function(e,t){t=t||new G;var n=this.points,i=(n.length-1)*e;e=Math.floor(i),i-=e;var r=n[e===0?e:e-1],o=n[e],s=n[e>n.length-2?n.length-1:e+1];return n=n[e>n.length-3?n.length-1:e+2],t.set(Il(i,r.x,o.x,s.x,n.x),Il(i,r.y,o.y,s.y,n.y)),t},Mn.prototype.copy=function(e){Pe.prototype.copy.call(this,e),this.points=[];for(var t=0,n=e.points.length;t<n;t++)this.points.push(e.points[t].clone());return this},Mn.prototype.toJSON=function(){var e=Pe.prototype.toJSON.call(this);e.points=[];for(var t=0,n=this.points.length;t<n;t++)e.points.push(this.points[t].toArray());return e},Mn.prototype.fromJSON=function(e){Pe.prototype.fromJSON.call(this,e),this.points=[];for(var t=0,n=e.points.length;t<n;t++){var i=e.points[t];this.points.push(new G().fromArray(i))}return this};var fl=Object.freeze({ArcCurve:Yr,CatmullRomCurve3:Yt,CubicBezierCurve:xn,CubicBezierCurve3:Hn,EllipseCurve:cn,LineCurve:on,LineCurve3:wn,QuadraticBezierCurve:An,QuadraticBezierCurve3:Vn,SplineCurve:Mn});ai.prototype=Object.assign(Object.create(Pe.prototype),{constructor:ai,add:function(e){this.curves.push(e)},closePath:function(){var e=this.curves[0].getPoint(0),t=this.curves[this.curves.length-1].getPoint(1);e.equals(t)||this.curves.push(new on(t,e))},getPoint:function(e){var t=e*this.getLength(),n=this.getCurveLengths();for(e=0;e<n.length;){if(n[e]>=t)return t=n[e]-t,e=this.curves[e],n=e.getLength(),e.getPointAt(n===0?0:1-t/n);e++}return null},getLength:function(){var e=this.getCurveLengths();return e[e.length-1]},updateArcLengths:function(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()},getCurveLengths:function(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;for(var e=[],t=0,n=0,i=this.curves.length;n<i;n++)t+=this.curves[n].getLength(),e.push(t);return this.cacheLengths=e},getSpacedPoints:function(e){e===void 0&&(e=40);for(var t=[],n=0;n<=e;n++)t.push(this.getPoint(n/e));return this.autoClose&&t.push(t[0]),t},getPoints:function(e){e=e||12;for(var t=[],n,i=0,r=this.curves;i<r.length;i++){var o=r[i];o=o.getPoints(o&&o.isEllipseCurve?2*e:o&&(o.isLineCurve||o.isLineCurve3)?1:o&&o.isSplineCurve?e*o.points.length:e);for(var s=0;s<o.length;s++){var a=o[s];n&&n.equals(a)||(t.push(a),n=a)}}return this.autoClose&&1<t.length&&!t[t.length-1].equals(t[0])&&t.push(t[0]),t},copy:function(e){Pe.prototype.copy.call(this,e),this.curves=[];for(var t=0,n=e.curves.length;t<n;t++)this.curves.push(e.curves[t].clone());return this.autoClose=e.autoClose,this},toJSON:function(){var e=Pe.prototype.toJSON.call(this);e.autoClose=this.autoClose,e.curves=[];for(var t=0,n=this.curves.length;t<n;t++)e.curves.push(this.curves[t].toJSON());return e},fromJSON:function(e){Pe.prototype.fromJSON.call(this,e),this.autoClose=e.autoClose,this.curves=[];for(var t=0,n=e.curves.length;t<n;t++){var i=e.curves[t];this.curves.push(new fl[i.type]().fromJSON(i))}return this}}),En.prototype=Object.assign(Object.create(ai.prototype),{constructor:En,setFromPoints:function(e){this.moveTo(e[0].x,e[0].y);for(var t=1,n=e.length;t<n;t++)this.lineTo(e[t].x,e[t].y)},moveTo:function(e,t){this.currentPoint.set(e,t)},lineTo:function(e,t){var n=new on(this.currentPoint.clone(),new G(e,t));this.curves.push(n),this.currentPoint.set(e,t)},quadraticCurveTo:function(e,t,n,i){e=new An(this.currentPoint.clone(),new G(e,t),new G(n,i)),this.curves.push(e),this.currentPoint.set(n,i)},bezierCurveTo:function(e,t,n,i,r,o){e=new xn(this.currentPoint.clone(),new G(e,t),new G(n,i),new G(r,o)),this.curves.push(e),this.currentPoint.set(r,o)},splineThru:function(e){var t=[this.currentPoint.clone()].concat(e);t=new Mn(t),this.curves.push(t),this.currentPoint.copy(e[e.length-1])},arc:function(e,t,n,i,r,o){this.absarc(e+this.currentPoint.x,t+this.currentPoint.y,n,i,r,o)},absarc:function(e,t,n,i,r,o){this.absellipse(e,t,n,n,i,r,o)},ellipse:function(e,t,n,i,r,o,s,a){this.absellipse(e+this.currentPoint.x,t+this.currentPoint.y,n,i,r,o,s,a)},absellipse:function(e,t,n,i,r,o,s,a){e=new cn(e,t,n,i,r,o,s,a),0<this.curves.length&&(t=e.getPoint(0),t.equals(this.currentPoint)||this.lineTo(t.x,t.y)),this.curves.push(e),e=e.getPoint(1),this.currentPoint.copy(e)},copy:function(e){return ai.prototype.copy.call(this,e),this.currentPoint.copy(e.currentPoint),this},toJSON:function(){var e=ai.prototype.toJSON.call(this);return e.currentPoint=this.currentPoint.toArray(),e},fromJSON:function(e){return ai.prototype.fromJSON.call(this,e),this.currentPoint.fromArray(e.currentPoint),this}}),bi.prototype=Object.assign(Object.create(En.prototype),{constructor:bi,getPointsHoles:function(e){for(var t=[],n=0,i=this.holes.length;n<i;n++)t[n]=this.holes[n].getPoints(e);return t},extractPoints:function(e){return{shape:this.getPoints(e),holes:this.getPointsHoles(e)}},copy:function(e){En.prototype.copy.call(this,e),this.holes=[];for(var t=0,n=e.holes.length;t<n;t++)this.holes.push(e.holes[t].clone());return this},toJSON:function(){var e=En.prototype.toJSON.call(this);e.uuid=this.uuid,e.holes=[];for(var t=0,n=this.holes.length;t<n;t++)e.holes.push(this.holes[t].toJSON());return e},fromJSON:function(e){En.prototype.fromJSON.call(this,e),this.uuid=e.uuid,this.holes=[];for(var t=0,n=e.holes.length;t<n;t++){var i=e.holes[t];this.holes.push(new En().fromJSON(i))}return this}}),ft.prototype=Object.assign(Object.create(W.prototype),{constructor:ft,isLight:!0,copy:function(e){return W.prototype.copy.call(this,e),this.color.copy(e.color),this.intensity=e.intensity,this},toJSON:function(e){return e=W.prototype.toJSON.call(this,e),e.object.color=this.color.getHex(),e.object.intensity=this.intensity,this.groundColor!==void 0&&(e.object.groundColor=this.groundColor.getHex()),this.distance!==void 0&&(e.object.distance=this.distance),this.angle!==void 0&&(e.object.angle=this.angle),this.decay!==void 0&&(e.object.decay=this.decay),this.penumbra!==void 0&&(e.object.penumbra=this.penumbra),this.shadow!==void 0&&(e.object.shadow=this.shadow.toJSON()),e}}),na.prototype=Object.assign(Object.create(ft.prototype),{constructor:na,isHemisphereLight:!0,copy:function(e){return ft.prototype.copy.call(this,e),this.groundColor.copy(e.groundColor),this}}),Object.assign(jn.prototype,{_projScreenMatrix:new Se,_lightPositionWorld:new E,_lookTarget:new E,getViewportCount:function(){return this._viewportCount},getFrustum:function(){return this._frustum},updateMatrices:function(e){var t=this.camera,n=this.matrix,i=this._projScreenMatrix,r=this._lookTarget,o=this._lightPositionWorld;o.setFromMatrixPosition(e.matrixWorld),t.position.copy(o),r.setFromMatrixPosition(e.target.matrixWorld),t.lookAt(r),t.updateMatrixWorld(),i.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),this._frustum.setFromMatrix(i),n.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),n.multiply(t.projectionMatrix),n.multiply(t.matrixWorldInverse)},getViewport:function(e){return this._viewports[e]},getFrameExtents:function(){return this._frameExtents},copy:function(e){return this.camera=e.camera.clone(),this.bias=e.bias,this.radius=e.radius,this.mapSize.copy(e.mapSize),this},clone:function(){return new this.constructor().copy(this)},toJSON:function(){var e={};return this.bias!==0&&(e.bias=this.bias),this.radius!==1&&(e.radius=this.radius),(this.mapSize.x!==512||this.mapSize.y!==512)&&(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}}),ia.prototype=Object.assign(Object.create(jn.prototype),{constructor:ia,isSpotLightShadow:!0,updateMatrices:function(e,t,n){var i=this.camera,r=2*Xe.RAD2DEG*e.angle,o=this.mapSize.width/this.mapSize.height,s=e.distance||i.far;(r!==i.fov||o!==i.aspect||s!==i.far)&&(i.fov=r,i.aspect=o,i.far=s,i.updateProjectionMatrix()),jn.prototype.updateMatrices.call(this,e,t,n)}}),ra.prototype=Object.assign(Object.create(ft.prototype),{constructor:ra,isSpotLight:!0,copy:function(e){return ft.prototype.copy.call(this,e),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}),_c.prototype=Object.assign(Object.create(jn.prototype),{constructor:_c,isPointLightShadow:!0,updateMatrices:function(e,t,n){t=this.camera;var i=this.matrix,r=this._lightPositionWorld,o=this._lookTarget,s=this._projScreenMatrix;r.setFromMatrixPosition(e.matrixWorld),t.position.copy(r),o.copy(t.position),o.add(this._cubeDirections[n]),t.up.copy(this._cubeUps[n]),t.lookAt(o),t.updateMatrixWorld(),i.makeTranslation(-r.x,-r.y,-r.z),s.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),this._frustum.setFromMatrix(s)}}),oa.prototype=Object.assign(Object.create(ft.prototype),{constructor:oa,isPointLight:!0,copy:function(e){return ft.prototype.copy.call(this,e),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}}),es.prototype=Object.assign(Object.create($t.prototype),{constructor:es,isOrthographicCamera:!0,copy:function(e,t){return $t.prototype.copy.call(this,e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=e.view===null?null:Object.assign({},e.view),this},setViewOffset:function(e,t,n,i,r,o){this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=i,this.view.width=r,this.view.height=o,this.updateProjectionMatrix()},clearViewOffset:function(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()},updateProjectionMatrix:function(){var e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),n=(this.right+this.left)/2,i=(this.top+this.bottom)/2,r=n-e;if(n+=e,e=i+t,t=i-t,this.view!==null&&this.view.enabled){n=this.zoom/(this.view.width/this.view.fullWidth),t=this.zoom/(this.view.height/this.view.fullHeight);var o=(this.right-this.left)/this.view.width;i=(this.top-this.bottom)/this.view.height,r+=this.view.offsetX/n*o,n=r+this.view.width/n*o,e-=this.view.offsetY/t*i,t=e-this.view.height/t*i}this.projectionMatrix.makeOrthographic(r,n,e,t,this.near,this.far),this.projectionMatrixInverse.getInverse(this.projectionMatrix)},toJSON:function(e){return e=W.prototype.toJSON.call(this,e),e.object.zoom=this.zoom,e.object.left=this.left,e.object.right=this.right,e.object.top=this.top,e.object.bottom=this.bottom,e.object.near=this.near,e.object.far=this.far,this.view!==null&&(e.object.view=Object.assign({},this.view)),e}}),sa.prototype=Object.assign(Object.create(jn.prototype),{constructor:sa,isDirectionalLightShadow:!0,updateMatrices:function(e,t,n){jn.prototype.updateMatrices.call(this,e,t,n)}}),aa.prototype=Object.assign(Object.create(ft.prototype),{constructor:aa,isDirectionalLight:!0,copy:function(e){return ft.prototype.copy.call(this,e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}),ca.prototype=Object.assign(Object.create(ft.prototype),{constructor:ca,isAmbientLight:!0}),la.prototype=Object.assign(Object.create(ft.prototype),{constructor:la,isRectAreaLight:!0,copy:function(e){return ft.prototype.copy.call(this,e),this.width=e.width,this.height=e.height,this},toJSON:function(e){return e=ft.prototype.toJSON.call(this,e),e.object.width=this.width,e.object.height=this.height,e}}),ua.prototype=Object.assign(Object.create(ut.prototype),{constructor:ua,load:function(e,t,n,i){var r=this,o=new mn(r.manager);o.setPath(r.path),o.load(e,function(s){t(r.parse(JSON.parse(s)))},n,i)},parse:function(e){function t(a){return n[a]===void 0&&console.warn("THREE.MaterialLoader: Undefined texture",a),n[a]}var n=this.textures,i=new Sh[e.type];if(e.uuid!==void 0&&(i.uuid=e.uuid),e.name!==void 0&&(i.name=e.name),e.color!==void 0&&i.color.setHex(e.color),e.roughness!==void 0&&(i.roughness=e.roughness),e.metalness!==void 0&&(i.metalness=e.metalness),e.sheen!==void 0&&(i.sheen=new ve().setHex(e.sheen)),e.emissive!==void 0&&i.emissive.setHex(e.emissive),e.specular!==void 0&&i.specular.setHex(e.specular),e.shininess!==void 0&&(i.shininess=e.shininess),e.clearcoat!==void 0&&(i.clearcoat=e.clearcoat),e.clearcoatRoughness!==void 0&&(i.clearcoatRoughness=e.clearcoatRoughness),e.vertexColors!==void 0&&(i.vertexColors=e.vertexColors),e.fog!==void 0&&(i.fog=e.fog),e.flatShading!==void 0&&(i.flatShading=e.flatShading),e.blending!==void 0&&(i.blending=e.blending),e.combine!==void 0&&(i.combine=e.combine),e.side!==void 0&&(i.side=e.side),e.opacity!==void 0&&(i.opacity=e.opacity),e.transparent!==void 0&&(i.transparent=e.transparent),e.alphaTest!==void 0&&(i.alphaTest=e.alphaTest),e.depthTest!==void 0&&(i.depthTest=e.depthTest),e.depthWrite!==void 0&&(i.depthWrite=e.depthWrite),e.colorWrite!==void 0&&(i.colorWrite=e.colorWrite),e.stencilWrite!==void 0&&(i.stencilWrite=e.stencilWrite),e.stencilWriteMask!==void 0&&(i.stencilWriteMask=e.stencilWriteMask),e.stencilFunc!==void 0&&(i.stencilFunc=e.stencilFunc),e.stencilRef!==void 0&&(i.stencilRef=e.stencilRef),e.stencilFuncMask!==void 0&&(i.stencilFuncMask=e.stencilFuncMask),e.stencilFail!==void 0&&(i.stencilFail=e.stencilFail),e.stencilZFail!==void 0&&(i.stencilZFail=e.stencilZFail),e.stencilZPass!==void 0&&(i.stencilZPass=e.stencilZPass),e.wireframe!==void 0&&(i.wireframe=e.wireframe),e.wireframeLinewidth!==void 0&&(i.wireframeLinewidth=e.wireframeLinewidth),e.wireframeLinecap!==void 0&&(i.wireframeLinecap=e.wireframeLinecap),e.wireframeLinejoin!==void 0&&(i.wireframeLinejoin=e.wireframeLinejoin),e.rotation!==void 0&&(i.rotation=e.rotation),e.linewidth!==1&&(i.linewidth=e.linewidth),e.dashSize!==void 0&&(i.dashSize=e.dashSize),e.gapSize!==void 0&&(i.gapSize=e.gapSize),e.scale!==void 0&&(i.scale=e.scale),e.polygonOffset!==void 0&&(i.polygonOffset=e.polygonOffset),e.polygonOffsetFactor!==void 0&&(i.polygonOffsetFactor=e.polygonOffsetFactor),e.polygonOffsetUnits!==void 0&&(i.polygonOffsetUnits=e.polygonOffsetUnits),e.skinning!==void 0&&(i.skinning=e.skinning),e.morphTargets!==void 0&&(i.morphTargets=e.morphTargets),e.morphNormals!==void 0&&(i.morphNormals=e.morphNormals),e.dithering!==void 0&&(i.dithering=e.dithering),e.visible!==void 0&&(i.visible=e.visible),e.toneMapped!==void 0&&(i.toneMapped=e.toneMapped),e.userData!==void 0&&(i.userData=e.userData),e.uniforms!==void 0)for(var r in e.uniforms){var o=e.uniforms[r];switch(i.uniforms[r]={},o.type){case"t":i.uniforms[r].value=t(o.value);break;case"c":i.uniforms[r].value=new ve().setHex(o.value);break;case"v2":i.uniforms[r].value=new G().fromArray(o.value);break;case"v3":i.uniforms[r].value=new E().fromArray(o.value);break;case"v4":i.uniforms[r].value=new _e().fromArray(o.value);break;case"m3":i.uniforms[r].value=new be().fromArray(o.value);case"m4":i.uniforms[r].value=new Se().fromArray(o.value);break;default:i.uniforms[r].value=o.value}}if(e.defines!==void 0&&(i.defines=e.defines),e.vertexShader!==void 0&&(i.vertexShader=e.vertexShader),e.fragmentShader!==void 0&&(i.fragmentShader=e.fragmentShader),e.extensions!==void 0)for(var s in e.extensions)i.extensions[s]=e.extensions[s];return e.shading!==void 0&&(i.flatShading=e.shading===1),e.size!==void 0&&(i.size=e.size),e.sizeAttenuation!==void 0&&(i.sizeAttenuation=e.sizeAttenuation),e.map!==void 0&&(i.map=t(e.map)),e.matcap!==void 0&&(i.matcap=t(e.matcap)),e.alphaMap!==void 0&&(i.alphaMap=t(e.alphaMap),i.transparent=!0),e.bumpMap!==void 0&&(i.bumpMap=t(e.bumpMap)),e.bumpScale!==void 0&&(i.bumpScale=e.bumpScale),e.normalMap!==void 0&&(i.normalMap=t(e.normalMap)),e.normalMapType!==void 0&&(i.normalMapType=e.normalMapType),e.normalScale!==void 0&&(r=e.normalScale,Array.isArray(r)===!1&&(r=[r,r]),i.normalScale=new G().fromArray(r)),e.displacementMap!==void 0&&(i.displacementMap=t(e.displacementMap)),e.displacementScale!==void 0&&(i.displacementScale=e.displacementScale),e.displacementBias!==void 0&&(i.displacementBias=e.displacementBias),e.roughnessMap!==void 0&&(i.roughnessMap=t(e.roughnessMap)),e.metalnessMap!==void 0&&(i.metalnessMap=t(e.metalnessMap)),e.emissiveMap!==void 0&&(i.emissiveMap=t(e.emissiveMap)),e.emissiveIntensity!==void 0&&(i.emissiveIntensity=e.emissiveIntensity),e.specularMap!==void 0&&(i.specularMap=t(e.specularMap)),e.envMap!==void 0&&(i.envMap=t(e.envMap)),e.envMapIntensity!==void 0&&(i.envMapIntensity=e.envMapIntensity),e.reflectivity!==void 0&&(i.reflectivity=e.reflectivity),e.refractionRatio!==void 0&&(i.refractionRatio=e.refractionRatio),e.lightMap!==void 0&&(i.lightMap=t(e.lightMap)),e.lightMapIntensity!==void 0&&(i.lightMapIntensity=e.lightMapIntensity),e.aoMap!==void 0&&(i.aoMap=t(e.aoMap)),e.aoMapIntensity!==void 0&&(i.aoMapIntensity=e.aoMapIntensity),e.gradientMap!==void 0&&(i.gradientMap=t(e.gradientMap)),e.clearcoatNormalMap!==void 0&&(i.clearcoatNormalMap=t(e.clearcoatNormalMap)),e.clearcoatNormalScale!==void 0&&(i.clearcoatNormalScale=new G().fromArray(e.clearcoatNormalScale)),i},setTextures:function(e){return this.textures=e,this}});var ml={decodeText:function(e){if(typeof TextDecoder<"u")return new TextDecoder().decode(e);for(var t="",n=0,i=e.length;n<i;n++)t+=String.fromCharCode(e[n]);try{return decodeURIComponent(escape(t))}catch{return t}},extractUrlBase:function(e){var t=e.lastIndexOf("/");return t===-1?"./":e.substr(0,t+1)}};ha.prototype=Object.assign(Object.create(re.prototype),{constructor:ha,isInstancedBufferGeometry:!0,copy:function(e){return re.prototype.copy.call(this,e),this.maxInstancedCount=e.maxInstancedCount,this},clone:function(){return new this.constructor().copy(this)},toJSON:function(){var e=re.prototype.toJSON.call(this);return e.maxInstancedCount=this.maxInstancedCount,e.isInstancedBufferGeometry=!0,e}}),da.prototype=Object.assign(Object.create(Ce.prototype),{constructor:da,isInstancedBufferAttribute:!0,copy:function(e){return Ce.prototype.copy.call(this,e),this.meshPerAttribute=e.meshPerAttribute,this},toJSON:function(){var e=Ce.prototype.toJSON.call(this);return e.meshPerAttribute=this.meshPerAttribute,e.isInstancedBufferAttribute=!0,e}}),pa.prototype=Object.assign(Object.create(ut.prototype),{constructor:pa,load:function(e,t,n,i){var r=this,o=new mn(r.manager);o.setPath(r.path),o.load(e,function(s){t(r.parse(JSON.parse(s)))},n,i)},parse:function(e){var t=e.isInstancedBufferGeometry?new ha:new re,n=e.data.index;if(n!==void 0){var i=new vl[n.type](n.array);t.setIndex(new Ce(i,1))}n=e.data.attributes;for(var r in n){var o=n[r];i=new vl[o.type](o.array),i=new(o.isInstancedBufferAttribute?da:Ce)(i,o.itemSize,o.normalized),o.name!==void 0&&(i.name=o.name),t.addAttribute(r,i)}var s=e.data.morphAttributes;if(s)for(r in s){var a=s[r],c=[];n=0;for(var u=a.length;n<u;n++)o=a[n],i=new vl[o.type](o.array),i=new Ce(i,o.itemSize,o.normalized),o.name!==void 0&&(i.name=o.name),c.push(i);t.morphAttributes[r]=c}if(r=e.data.groups||e.data.drawcalls||e.data.offsets,r!==void 0)for(n=0,o=r.length;n!==o;++n)i=r[n],t.addGroup(i.start,i.count,i.materialIndex);return n=e.data.boundingSphere,n!==void 0&&(r=new E,n.center!==void 0&&r.fromArray(n.center),t.boundingSphere=new ye(r,n.radius)),e.name&&(t.name=e.name),e.userData&&(t.userData=e.userData),t}});var vl={Int8Array,Uint8Array,Uint8ClampedArray:typeof Uint8ClampedArray<"u"?Uint8ClampedArray:Uint8Array,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array};fa.prototype=Object.assign(Object.create(ut.prototype),{constructor:fa,load:function(e,t,n,i){var r=this,o=this.path===""?ml.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||o,o=new mn(r.manager),o.setPath(this.path),o.load(e,function(s){var a=null;try{a=JSON.parse(s)}catch(c){i!==void 0&&i(c),console.error("THREE:ObjectLoader: Can't parse "+e+".",c.message);return}s=a.metadata,s===void 0||s.type===void 0||s.type.toLowerCase()==="geometry"?console.error("THREE.ObjectLoader: Can't load "+e):r.parse(a,t)},n,i)},parse:function(e,t){var n=this.parseShape(e.shapes);n=this.parseGeometries(e.geometries,n);var i=this.parseImages(e.images,function(){t!==void 0&&t(r)});i=this.parseTextures(e.textures,i),i=this.parseMaterials(e.materials,i);var r=this.parseObject(e.object,n,i);return e.animations&&(r.animations=this.parseAnimations(e.animations)),e.images!==void 0&&e.images.length!==0||t===void 0||t(r),r},parseShape:function(e){var t={};if(e!==void 0)for(var n=0,i=e.length;n<i;n++){var r=new bi().fromJSON(e[n]);t[r.uuid]=r}return t},parseGeometries:function(e,t){var n={};if(e!==void 0)for(var i=new pa,r=0,o=e.length;r<o;r++){var s=e[r];switch(s.type){case"PlaneGeometry":case"PlaneBufferGeometry":var a=new Zt[s.type](s.width,s.height,s.widthSegments,s.heightSegments);break;case"BoxGeometry":case"BoxBufferGeometry":case"CubeGeometry":a=new Zt[s.type](s.width,s.height,s.depth,s.widthSegments,s.heightSegments,s.depthSegments);break;case"CircleGeometry":case"CircleBufferGeometry":a=new Zt[s.type](s.radius,s.segments,s.thetaStart,s.thetaLength);break;case"CylinderGeometry":case"CylinderBufferGeometry":a=new Zt[s.type](s.radiusTop,s.radiusBottom,s.height,s.radialSegments,s.heightSegments,s.openEnded,s.thetaStart,s.thetaLength);break;case"ConeGeometry":case"ConeBufferGeometry":a=new Zt[s.type](s.radius,s.height,s.radialSegments,s.heightSegments,s.openEnded,s.thetaStart,s.thetaLength);break;case"SphereGeometry":case"SphereBufferGeometry":a=new Zt[s.type](s.radius,s.widthSegments,s.heightSegments,s.phiStart,s.phiLength,s.thetaStart,s.thetaLength);break;case"DodecahedronGeometry":case"DodecahedronBufferGeometry":case"IcosahedronGeometry":case"IcosahedronBufferGeometry":case"OctahedronGeometry":case"OctahedronBufferGeometry":case"TetrahedronGeometry":case"TetrahedronBufferGeometry":a=new Zt[s.type](s.radius,s.detail);break;case"RingGeometry":case"RingBufferGeometry":a=new Zt[s.type](s.innerRadius,s.outerRadius,s.thetaSegments,s.phiSegments,s.thetaStart,s.thetaLength);break;case"TorusGeometry":case"TorusBufferGeometry":a=new Zt[s.type](s.radius,s.tube,s.radialSegments,s.tubularSegments,s.arc);break;case"TorusKnotGeometry":case"TorusKnotBufferGeometry":a=new Zt[s.type](s.radius,s.tube,s.tubularSegments,s.radialSegments,s.p,s.q);break;case"TubeGeometry":case"TubeBufferGeometry":a=new Zt[s.type](new fl[s.path.type]().fromJSON(s.path),s.tubularSegments,s.radius,s.radialSegments,s.closed);break;case"LatheGeometry":case"LatheBufferGeometry":a=new Zt[s.type](s.points,s.segments,s.phiStart,s.phiLength);break;case"PolyhedronGeometry":case"PolyhedronBufferGeometry":a=new Zt[s.type](s.vertices,s.indices,s.radius,s.details);break;case"ShapeGeometry":case"ShapeBufferGeometry":a=[];for(var c=0,u=s.shapes.length;c<u;c++){var h=t[s.shapes[c]];a.push(h)}a=new Zt[s.type](a,s.curveSegments);break;case"ExtrudeGeometry":case"ExtrudeBufferGeometry":for(a=[],c=0,u=s.shapes.length;c<u;c++)h=t[s.shapes[c]],a.push(h);c=s.options.extrudePath,c!==void 0&&(s.options.extrudePath=new fl[c.type]().fromJSON(c)),a=new Zt[s.type](a,s.options);break;case"BufferGeometry":case"InstancedBufferGeometry":a=i.parse(s);break;case"Geometry":"THREE"in window&&"LegacyJSONLoader"in THREE?a=new THREE.LegacyJSONLoader().parse(s,this.resourcePath).geometry:console.error('THREE.ObjectLoader: You have to import LegacyJSONLoader in order load geometry data of type "Geometry".');break;default:console.warn('THREE.ObjectLoader: Unsupported geometry type "'+s.type+'"');continue}a.uuid=s.uuid,s.name!==void 0&&(a.name=s.name),a.isBufferGeometry===!0&&s.userData!==void 0&&(a.userData=s.userData),n[s.uuid]=a}return n},parseMaterials:function(e,t){var n={},i={};if(e!==void 0){var r=new ua;r.setTextures(t),t=0;for(var o=e.length;t<o;t++){var s=e[t];if(s.type==="MultiMaterial"){for(var a=[],c=0;c<s.materials.length;c++){var u=s.materials[c];n[u.uuid]===void 0&&(n[u.uuid]=r.parse(u)),a.push(n[u.uuid])}i[s.uuid]=a}else n[s.uuid]===void 0&&(n[s.uuid]=r.parse(s)),i[s.uuid]=n[s.uuid]}}return i},parseAnimations:function(e){for(var t=[],n=0;n<e.length;n++){var i=e[n],r=fn.parse(i);i.uuid!==void 0&&(r.uuid=i.uuid),t.push(r)}return t},parseImages:function(e,t){function n(v){return i.manager.itemStart(v),o.load(v,function(){i.manager.itemEnd(v)},void 0,function(){i.manager.itemError(v),i.manager.itemEnd(v)})}var i=this,r={};if(e!==void 0&&0<e.length){t=new Mc(t);var o=new kr(t);o.setCrossOrigin(this.crossOrigin),t=0;for(var s=e.length;t<s;t++){var a=e[t],c=a.url;if(Array.isArray(c)){r[a.uuid]=[];for(var u=0,h=c.length;u<h;u++){var p=c[u];p=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(p)?p:i.resourcePath+p,r[a.uuid].push(n(p))}}else p=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(a.url)?a.url:i.resourcePath+a.url,r[a.uuid]=n(p)}}return r},parseTextures:function(e,t){function n(c,u){return typeof c=="number"?c:(console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",c),u[c])}var i={};if(e!==void 0)for(var r=0,o=e.length;r<o;r++){var s=e[r];s.image===void 0&&console.warn('THREE.ObjectLoader: No "image" specified for',s.uuid),t[s.image]===void 0&&console.warn("THREE.ObjectLoader: Undefined image",s.image);var a=Array.isArray(t[s.image])?new Ct(t[s.image]):new Ae(t[s.image]);a.needsUpdate=!0,a.uuid=s.uuid,s.name!==void 0&&(a.name=s.name),s.mapping!==void 0&&(a.mapping=n(s.mapping,Th)),s.offset!==void 0&&a.offset.fromArray(s.offset),s.repeat!==void 0&&a.repeat.fromArray(s.repeat),s.center!==void 0&&a.center.fromArray(s.center),s.rotation!==void 0&&(a.rotation=s.rotation),s.wrap!==void 0&&(a.wrapS=n(s.wrap[0],Su),a.wrapT=n(s.wrap[1],Su)),s.format!==void 0&&(a.format=s.format),s.type!==void 0&&(a.type=s.type),s.encoding!==void 0&&(a.encoding=s.encoding),s.minFilter!==void 0&&(a.minFilter=n(s.minFilter,Tu)),s.magFilter!==void 0&&(a.magFilter=n(s.magFilter,Tu)),s.anisotropy!==void 0&&(a.anisotropy=s.anisotropy),s.flipY!==void 0&&(a.flipY=s.flipY),s.premultiplyAlpha!==void 0&&(a.premultiplyAlpha=s.premultiplyAlpha),s.unpackAlignment!==void 0&&(a.unpackAlignment=s.unpackAlignment),i[s.uuid]=a}return i},parseObject:function(e,t,n){function i(u){return t[u]===void 0&&console.warn("THREE.ObjectLoader: Undefined geometry",u),t[u]}function r(u){if(u!==void 0){if(Array.isArray(u)){for(var h=[],p=0,v=u.length;p<v;p++){var x=u[p];n[x]===void 0&&console.warn("THREE.ObjectLoader: Undefined material",x),h.push(n[x])}return h}return n[u]===void 0&&console.warn("THREE.ObjectLoader: Undefined material",u),n[u]}}switch(e.type){case"Scene":var o=new It;e.background!==void 0&&Number.isInteger(e.background)&&(o.background=new ve(e.background)),e.fog!==void 0&&(e.fog.type==="Fog"?o.fog=new xt(e.fog.color,e.fog.near,e.fog.far):e.fog.type==="FogExp2"&&(o.fog=new tt(e.fog.color,e.fog.density)));break;case"PerspectiveCamera":o=new Je(e.fov,e.aspect,e.near,e.far),e.focus!==void 0&&(o.focus=e.focus),e.zoom!==void 0&&(o.zoom=e.zoom),e.filmGauge!==void 0&&(o.filmGauge=e.filmGauge),e.filmOffset!==void 0&&(o.filmOffset=e.filmOffset),e.view!==void 0&&(o.view=Object.assign({},e.view));break;case"OrthographicCamera":o=new es(e.left,e.right,e.top,e.bottom,e.near,e.far),e.zoom!==void 0&&(o.zoom=e.zoom),e.view!==void 0&&(o.view=Object.assign({},e.view));break;case"AmbientLight":o=new ca(e.color,e.intensity);break;case"DirectionalLight":o=new aa(e.color,e.intensity);break;case"PointLight":o=new oa(e.color,e.intensity,e.distance,e.decay);break;case"RectAreaLight":o=new la(e.color,e.intensity,e.width,e.height);break;case"SpotLight":o=new ra(e.color,e.intensity,e.distance,e.angle,e.penumbra,e.decay);break;case"HemisphereLight":o=new na(e.color,e.groundColor,e.intensity);break;case"SkinnedMesh":console.warn("THREE.ObjectLoader.parseObject() does not support SkinnedMesh yet.");case"Mesh":o=i(e.geometry);var s=r(e.material);o=o.bones&&0<o.bones.length?new Lt(o,s):new yt(o,s),e.drawMode!==void 0&&o.setDrawMode(e.drawMode);break;case"LOD":o=new Ot;break;case"Line":o=new At(i(e.geometry),r(e.material),e.mode);break;case"LineLoop":o=new Ci(i(e.geometry),r(e.material));break;case"LineSegments":o=new ot(i(e.geometry),r(e.material));break;case"PointCloud":case"Points":o=new oi(i(e.geometry),r(e.material));break;case"Sprite":o=new kt(r(e.material));break;case"Group":o=new Q;break;default:o=new W}if(o.uuid=e.uuid,e.name!==void 0&&(o.name=e.name),e.matrix!==void 0?(o.matrix.fromArray(e.matrix),e.matrixAutoUpdate!==void 0&&(o.matrixAutoUpdate=e.matrixAutoUpdate),o.matrixAutoUpdate&&o.matrix.decompose(o.position,o.quaternion,o.scale)):(e.position!==void 0&&o.position.fromArray(e.position),e.rotation!==void 0&&o.rotation.fromArray(e.rotation),e.quaternion!==void 0&&o.quaternion.fromArray(e.quaternion),e.scale!==void 0&&o.scale.fromArray(e.scale)),e.castShadow!==void 0&&(o.castShadow=e.castShadow),e.receiveShadow!==void 0&&(o.receiveShadow=e.receiveShadow),e.shadow&&(e.shadow.bias!==void 0&&(o.shadow.bias=e.shadow.bias),e.shadow.radius!==void 0&&(o.shadow.radius=e.shadow.radius),e.shadow.mapSize!==void 0&&o.shadow.mapSize.fromArray(e.shadow.mapSize),e.shadow.camera!==void 0&&(o.shadow.camera=this.parseObject(e.shadow.camera))),e.visible!==void 0&&(o.visible=e.visible),e.frustumCulled!==void 0&&(o.frustumCulled=e.frustumCulled),e.renderOrder!==void 0&&(o.renderOrder=e.renderOrder),e.userData!==void 0&&(o.userData=e.userData),e.layers!==void 0&&(o.layers.mask=e.layers),e.children!==void 0){s=e.children;for(var a=0;a<s.length;a++)o.add(this.parseObject(s[a],t,n))}if(e.type==="LOD")for(e=e.levels,s=0;s<e.length;s++){a=e[s];var c=o.getObjectByProperty("uuid",a.object);c!==void 0&&o.addLevel(c,a.distance)}return o}});var Th={UVMapping:300,CubeReflectionMapping:301,CubeRefractionMapping:302,EquirectangularReflectionMapping:303,EquirectangularRefractionMapping:304,SphericalReflectionMapping:305,CubeUVReflectionMapping:306,CubeUVRefractionMapping:307},Su={RepeatWrapping:1e3,ClampToEdgeWrapping:1001,MirroredRepeatWrapping:1002},Tu={NearestFilter:1003,NearestMipmapNearestFilter:1004,NearestMipmapLinearFilter:1005,LinearFilter:1006,LinearMipmapNearestFilter:1007,LinearMipmapLinearFilter:1008};Cc.prototype=Object.assign(Object.create(ut.prototype),{constructor:Cc,setOptions:function(e){return this.options=e,this},load:function(e,t,n,i){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);var r=this,o=vr.get(e);if(o!==void 0)return r.manager.itemStart(e),setTimeout(function(){t&&t(o),r.manager.itemEnd(e)},0),o;fetch(e).then(function(s){return s.blob()}).then(function(s){return r.options===void 0?createImageBitmap(s):createImageBitmap(s,r.options)}).then(function(s){vr.add(e,s),t&&t(s),r.manager.itemEnd(e)}).catch(function(s){i&&i(s),r.manager.itemError(e),r.manager.itemEnd(e)}),r.manager.itemStart(e)}}),Object.assign(Lc.prototype,{moveTo:function(e,t){this.currentPath=new En,this.subPaths.push(this.currentPath),this.currentPath.moveTo(e,t)},lineTo:function(e,t){this.currentPath.lineTo(e,t)},quadraticCurveTo:function(e,t,n,i){this.currentPath.quadraticCurveTo(e,t,n,i)},bezierCurveTo:function(e,t,n,i,r,o){this.currentPath.bezierCurveTo(e,t,n,i,r,o)},splineThru:function(e){this.currentPath.splineThru(e)},toShapes:function(e,t){function n(L){for(var O=[],F=0,z=L.length;F<z;F++){var V=L[F],B=new bi;B.curves=V.curves,O.push(B)}return O}function i(L,O){for(var F=O.length,z=!1,V=F-1,B=0;B<F;V=B++){var Y=O[V],Z=O[B],fe=Z.x-Y.x,X=Z.y-Y.y;if(Math.abs(X)>Number.EPSILON){if(0>X&&(Y=O[B],fe=-fe,Z=O[V],X=-X),!(L.y<Y.y||L.y>Z.y))if(L.y===Y.y){if(L.x===Y.x)return!0}else{if(V=X*(L.x-Y.x)-fe*(L.y-Y.y),V===0)return!0;0>V||(z=!z)}}else if(L.y===Y.y&&(Z.x<=L.x&&L.x<=Y.x||Y.x<=L.x&&L.x<=Z.x))return!0}return z}var r=mi.isClockWise,o=this.subPaths;if(o.length===0)return[];if(t===!0)return n(o);if(t=[],o.length===1){var s=o[0],a=new bi;return a.curves=s.curves,t.push(a),t}var c=!r(o[0].getPoints());c=e?!c:c,a=[];var u=[],h=[],p=0;u[p]=void 0,h[p]=[];for(var v=0,x=o.length;v<x;v++){s=o[v];var y=s.getPoints(),M=r(y);(M=e?!M:M)?(!c&&u[p]&&p++,u[p]={s:new bi,p:y},u[p].s.curves=s.curves,c&&p++,h[p]=[]):h[p].push({h:s,p:y[0]})}if(!u[0])return n(o);if(1<u.length){for(v=!1,e=[],r=0,o=u.length;r<o;r++)a[r]=[];for(r=0,o=u.length;r<o;r++)for(s=h[r],M=0;M<s.length;M++){for(c=s[M],p=!0,y=0;y<u.length;y++)i(c.p,u[y].p)&&(r!==y&&e.push({froms:r,tos:y,hole:M}),p?(p=!1,a[y].push(c)):v=!0);p&&a[r].push(c)}0<e.length&&(v||(h=a))}for(v=0,r=u.length;v<r;v++)for(a=u[v].s,t.push(a),e=h[v],o=0,s=e.length;o<s;o++)a.holes.push(e[o].h);return t}}),Object.assign(Pc.prototype,{isFont:!0,generateShapes:function(e,t){t===void 0&&(t=100);var n=[],i=t;t=this.data;var r=Array.from?Array.from(e):String(e).split("");i/=t.resolution;var o=(t.boundingBox.yMax-t.boundingBox.yMin+t.underlineThickness)*i;e=[];for(var s=0,a=0,c=0;c<r.length;c++){var u=r[c];if(u===`
`)s=0,a-=o;else{var h=u;u=i;var p=s,v=a,x=t,y=x.glyphs[h]||x.glyphs["?"];if(y){if(h=new Lc,y.o){x=y._cachedOutline||(y._cachedOutline=y.o.split(" "));for(var M=0,L=x.length;M<L;)switch(x[M++]){case"m":var O=x[M++]*u+p,F=x[M++]*u+v;h.moveTo(O,F);break;case"l":O=x[M++]*u+p,F=x[M++]*u+v,h.lineTo(O,F);break;case"q":var z=x[M++]*u+p,V=x[M++]*u+v,B=x[M++]*u+p,Y=x[M++]*u+v;h.quadraticCurveTo(B,Y,z,V);break;case"b":z=x[M++]*u+p,V=x[M++]*u+v,B=x[M++]*u+p,Y=x[M++]*u+v,O=x[M++]*u+p,F=x[M++]*u+v,h.bezierCurveTo(B,Y,O,F,z,V)}}u={offsetX:y.ha*u,path:h}}else console.error('THREE.Font: character "'+h+'" does not exists in font family '+x.familyName+"."),u=void 0;s+=u.offsetX,e.push(u.path)}}for(t=0,r=e.length;t<r;t++)Array.prototype.push.apply(n,e[t].toShapes());return n}}),bc.prototype=Object.assign(Object.create(ut.prototype),{constructor:bc,load:function(e,t,n,i){var r=this,o=new mn(this.manager);o.setPath(this.path),o.load(e,function(s){try{var a=JSON.parse(s)}catch{console.warn("THREE.FontLoader: typeface.js support is being deprecated. Use typeface.json instead."),a=JSON.parse(s.substring(65,s.length-2))}s=r.parse(a),t&&t(s)},n,i)},parse:function(e){return new Pc(e)}});var Ha,gl={getContext:function(){return Ha===void 0&&(Ha=new(window.AudioContext||window.webkitAudioContext)),Ha},setContext:function(e){Ha=e}};ma.prototype=Object.assign(Object.create(ut.prototype),{constructor:ma,load:function(e,t,n,i){var r=new mn(this.manager);r.setResponseType("arraybuffer"),r.setPath(this.path),r.load(e,function(o){o=o.slice(0),gl.getContext().decodeAudioData(o,function(s){t(s)})},n,i)}}),Object.assign(va.prototype,{isSphericalHarmonics3:!0,set:function(e){for(var t=0;9>t;t++)this.coefficients[t].copy(e[t]);return this},zero:function(){for(var e=0;9>e;e++)this.coefficients[e].set(0,0,0);return this},getAt:function(e,t){var n=e.x,i=e.y;e=e.z;var r=this.coefficients;return t.copy(r[0]).multiplyScalar(.282095),t.addScale(r[1],.488603*i),t.addScale(r[2],.488603*e),t.addScale(r[3],.488603*n),t.addScale(r[4],1.092548*n*i),t.addScale(r[5],1.092548*i*e),t.addScale(r[6],.315392*(3*e*e-1)),t.addScale(r[7],1.092548*n*e),t.addScale(r[8],.546274*(n*n-i*i)),t},getIrradianceAt:function(e,t){var n=e.x,i=e.y;e=e.z;var r=this.coefficients;return t.copy(r[0]).multiplyScalar(.886227),t.addScale(r[1],1.023328*i),t.addScale(r[2],1.023328*e),t.addScale(r[3],1.023328*n),t.addScale(r[4],.858086*n*i),t.addScale(r[5],.858086*i*e),t.addScale(r[6],.743125*e*e-.247708),t.addScale(r[7],.858086*n*e),t.addScale(r[8],.429043*(n*n-i*i)),t},add:function(e){for(var t=0;9>t;t++)this.coefficients[t].add(e.coefficients[t]);return this},scale:function(e){for(var t=0;9>t;t++)this.coefficients[t].multiplyScalar(e);return this},lerp:function(e,t){for(var n=0;9>n;n++)this.coefficients[n].lerp(e.coefficients[n],t);return this},equals:function(e){for(var t=0;9>t;t++)if(!this.coefficients[t].equals(e.coefficients[t]))return!1;return!0},copy:function(e){return this.set(e.coefficients)},clone:function(){return new this.constructor().copy(this)},fromArray:function(e,t){t===void 0&&(t=0);for(var n=this.coefficients,i=0;9>i;i++)n[i].fromArray(e,t+3*i);return this},toArray:function(e,t){e===void 0&&(e=[]),t===void 0&&(t=0);for(var n=this.coefficients,i=0;9>i;i++)n[i].toArray(e,t+3*i);return e}}),Object.assign(va,{getBasisAt:function(e,t){var n=e.x,i=e.y;e=e.z,t[0]=.282095,t[1]=.488603*i,t[2]=.488603*e,t[3]=.488603*n,t[4]=1.092548*n*i,t[5]=1.092548*i*e,t[6]=.315392*(3*e*e-1),t[7]=1.092548*n*e,t[8]=.546274*(n*n-i*i)}}),Sn.prototype=Object.assign(Object.create(ft.prototype),{constructor:Sn,isLightProbe:!0,copy:function(e){return ft.prototype.copy.call(this,e),this.sh.copy(e.sh),this.intensity=e.intensity,this},toJSON:function(e){return ft.prototype.toJSON.call(this,e)}}),Rc.prototype=Object.assign(Object.create(Sn.prototype),{constructor:Rc,isHemisphereLightProbe:!0,copy:function(e){return Sn.prototype.copy.call(this,e),this},toJSON:function(e){return Sn.prototype.toJSON.call(this,e)}}),Dc.prototype=Object.assign(Object.create(Sn.prototype),{constructor:Dc,isAmbientLightProbe:!0,copy:function(e){return Sn.prototype.copy.call(this,e),this},toJSON:function(e){return Sn.prototype.toJSON.call(this,e)}});var _u=new Se,Cu=new Se;Object.assign(Ol.prototype,{update:function(e){var t=this._cache;if(t.focus!==e.focus||t.fov!==e.fov||t.aspect!==e.aspect*this.aspect||t.near!==e.near||t.far!==e.far||t.zoom!==e.zoom||t.eyeSep!==this.eyeSep){t.focus=e.focus,t.fov=e.fov,t.aspect=e.aspect*this.aspect,t.near=e.near,t.far=e.far,t.zoom=e.zoom,t.eyeSep=this.eyeSep;var n=e.projectionMatrix.clone(),i=t.eyeSep/2,r=i*t.near/t.focus,o=t.near*Math.tan(Xe.DEG2RAD*t.fov*.5)/t.zoom;Cu.elements[12]=-i,_u.elements[12]=i,i=-o*t.aspect+r;var s=o*t.aspect+r;n.elements[0]=2*t.near/(s-i),n.elements[8]=(s+i)/(s-i),this.cameraL.projectionMatrix.copy(n),i=-o*t.aspect-r,s=o*t.aspect-r,n.elements[0]=2*t.near/(s-i),n.elements[8]=(s+i)/(s-i),this.cameraR.projectionMatrix.copy(n)}this.cameraL.matrixWorld.copy(e.matrixWorld).multiply(Cu),this.cameraR.matrixWorld.copy(e.matrixWorld).multiply(_u)}}),Object.assign(Bc.prototype,{start:function(){this.oldTime=this.startTime=(typeof performance>"u"?Date:performance).now(),this.elapsedTime=0,this.running=!0},stop:function(){this.getElapsedTime(),this.autoStart=this.running=!1},getElapsedTime:function(){return this.getDelta(),this.elapsedTime},getDelta:function(){var e=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){var t=(typeof performance>"u"?Date:performance).now();e=(t-this.oldTime)/1e3,this.oldTime=t,this.elapsedTime+=e}return e}});var gr=new E,Lu=new we,_h=new E,yr=new E;Ic.prototype=Object.assign(Object.create(W.prototype),{constructor:Ic,getInput:function(){return this.gain},removeFilter:function(){return this.filter!==null&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null),this},getFilter:function(){return this.filter},setFilter:function(e){return this.filter!==null?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=e,this.gain.connect(this.filter),this.filter.connect(this.context.destination),this},getMasterVolume:function(){return this.gain.gain.value},setMasterVolume:function(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this},updateMatrixWorld:function(e){W.prototype.updateMatrixWorld.call(this,e),e=this.context.listener;var t=this.up;if(this.timeDelta=this._clock.getDelta(),this.matrixWorld.decompose(gr,Lu,_h),yr.set(0,0,-1).applyQuaternion(Lu),e.positionX){var n=this.context.currentTime+this.timeDelta;e.positionX.linearRampToValueAtTime(gr.x,n),e.positionY.linearRampToValueAtTime(gr.y,n),e.positionZ.linearRampToValueAtTime(gr.z,n),e.forwardX.linearRampToValueAtTime(yr.x,n),e.forwardY.linearRampToValueAtTime(yr.y,n),e.forwardZ.linearRampToValueAtTime(yr.z,n),e.upX.linearRampToValueAtTime(t.x,n),e.upY.linearRampToValueAtTime(t.y,n),e.upZ.linearRampToValueAtTime(t.z,n)}else e.setPosition(gr.x,gr.y,gr.z),e.setOrientation(yr.x,yr.y,yr.z,t.x,t.y,t.z)}}),Xr.prototype=Object.assign(Object.create(W.prototype),{constructor:Xr,getOutput:function(){return this.gain},setNodeSource:function(e){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=e,this.connect(),this},setMediaElementSource:function(e){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(e),this.connect(),this},setMediaStreamSource:function(e){return this.hasPlaybackControl=!1,this.sourceType="mediaStreamNode",this.source=this.context.createMediaStreamSource(e),this.connect(),this},setBuffer:function(e){return this.buffer=e,this.sourceType="buffer",this.autoplay&&this.play(),this},play:function(){if(this.isPlaying===!0)console.warn("THREE.Audio: Audio is already playing.");else if(this.hasPlaybackControl===!1)console.warn("THREE.Audio: this Audio has no playback control.");else{var e=this.context.createBufferSource();return e.buffer=this.buffer,e.loop=this.loop,e.onended=this.onEnded.bind(this),this.startTime=this.context.currentTime,e.start(this.startTime,this.offset,this.duration),this.isPlaying=!0,this.source=e,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect()}},pause:function(){if(this.hasPlaybackControl===!1)console.warn("THREE.Audio: this Audio has no playback control.");else return this.isPlaying===!0&&(this.source.stop(),this.source.onended=null,this.offset+=(this.context.currentTime-this.startTime)*this.playbackRate,this.isPlaying=!1),this},stop:function(){if(this.hasPlaybackControl===!1)console.warn("THREE.Audio: this Audio has no playback control.");else return this.source.stop(),this.source.onended=null,this.offset=0,this.isPlaying=!1,this},connect:function(){if(0<this.filters.length){this.source.connect(this.filters[0]);for(var e=1,t=this.filters.length;e<t;e++)this.filters[e-1].connect(this.filters[e]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this},disconnect:function(){if(0<this.filters.length){this.source.disconnect(this.filters[0]);for(var e=1,t=this.filters.length;e<t;e++)this.filters[e-1].disconnect(this.filters[e]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this},getFilters:function(){return this.filters},setFilters:function(e){return e||(e=[]),this.isPlaying===!0?(this.disconnect(),this.filters=e,this.connect()):this.filters=e,this},setDetune:function(e){if(this.detune=e,this.source.detune!==void 0)return this.isPlaying===!0&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this},getDetune:function(){return this.detune},getFilter:function(){return this.getFilters()[0]},setFilter:function(e){return this.setFilters(e?[e]:[])},setPlaybackRate:function(e){if(this.hasPlaybackControl===!1)console.warn("THREE.Audio: this Audio has no playback control.");else return this.playbackRate=e,this.isPlaying===!0&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this},getPlaybackRate:function(){return this.playbackRate},onEnded:function(){this.isPlaying=!1},getLoop:function(){return this.hasPlaybackControl===!1?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop},setLoop:function(e){if(this.hasPlaybackControl===!1)console.warn("THREE.Audio: this Audio has no playback control.");else return this.loop=e,this.isPlaying===!0&&(this.source.loop=this.loop),this},getVolume:function(){return this.gain.gain.value},setVolume:function(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}});var xr=new E,Pu=new we,Ch=new E,wr=new E;Oc.prototype=Object.assign(Object.create(Xr.prototype),{constructor:Oc,getOutput:function(){return this.panner},getRefDistance:function(){return this.panner.refDistance},setRefDistance:function(e){return this.panner.refDistance=e,this},getRolloffFactor:function(){return this.panner.rolloffFactor},setRolloffFactor:function(e){return this.panner.rolloffFactor=e,this},getDistanceModel:function(){return this.panner.distanceModel},setDistanceModel:function(e){return this.panner.distanceModel=e,this},getMaxDistance:function(){return this.panner.maxDistance},setMaxDistance:function(e){return this.panner.maxDistance=e,this},setDirectionalCone:function(e,t,n){return this.panner.coneInnerAngle=e,this.panner.coneOuterAngle=t,this.panner.coneOuterGain=n,this},updateMatrixWorld:function(e){if(W.prototype.updateMatrixWorld.call(this,e),this.hasPlaybackControl!==!0||this.isPlaying!==!1)if(this.matrixWorld.decompose(xr,Pu,Ch),wr.set(0,0,1).applyQuaternion(Pu),e=this.panner,e.positionX){var t=this.context.currentTime+this.listener.timeDelta;e.positionX.linearRampToValueAtTime(xr.x,t),e.positionY.linearRampToValueAtTime(xr.y,t),e.positionZ.linearRampToValueAtTime(xr.z,t),e.orientationX.linearRampToValueAtTime(wr.x,t),e.orientationY.linearRampToValueAtTime(wr.y,t),e.orientationZ.linearRampToValueAtTime(wr.z,t)}else e.setPosition(xr.x,xr.y,xr.z),e.setOrientation(wr.x,wr.y,wr.z)}}),Object.assign(Fc.prototype,{getFrequencyData:function(){return this.analyser.getByteFrequencyData(this.data),this.data},getAverageFrequency:function(){for(var e=0,t=this.getFrequencyData(),n=0;n<t.length;n++)e+=t[n];return e/t.length}}),Object.assign(Nc.prototype,{accumulate:function(e,t){var n=this.buffer,i=this.valueSize;e=e*i+i;var r=this.cumulativeWeight;if(r===0){for(r=0;r!==i;++r)n[e+r]=n[r];r=t}else r+=t,this._mixBufferRegion(n,e,0,t/r,i);this.cumulativeWeight=r},apply:function(e){var t=this.valueSize,n=this.buffer;e=e*t+t;var i=this.cumulativeWeight,r=this.binding;this.cumulativeWeight=0,1>i&&this._mixBufferRegion(n,e,3*t,1-i,t),i=t;for(var o=t+t;i!==o;++i)if(n[i]!==n[i+t]){r.setValue(n,e);break}},saveOriginalState:function(){var e=this.buffer,t=this.valueSize,n=3*t;this.binding.getValue(e,n);for(var i=t;i!==n;++i)e[i]=e[n+i%t];this.cumulativeWeight=0},restoreOriginalState:function(){this.binding.setValue(this.buffer,3*this.valueSize)},_select:function(e,t,n,i,r){if(.5<=i)for(i=0;i!==r;++i)e[t+i]=e[n+i]},_slerp:function(e,t,n,i){we.slerpFlat(e,t,e,t,e,n,i)},_lerp:function(e,t,n,i,r){for(var o=1-i,s=0;s!==r;++s){var a=t+s;e[a]=e[a]*o+e[n+s]*i}}});var Lh=/[\[\]\.:\/]/g,Ph="[^"+"\\[\\]\\.:\\/".replace("\\.","")+"]",bh=/((?:WC+[\/:])*)/.source.replace("WC","[^\\[\\]\\.:\\/]"),Rh=/(WCOD+)?/.source.replace("WCOD",Ph),Dh=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC","[^\\[\\]\\.:\\/]"),Bh=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC","[^\\[\\]\\.:\\/]"),Ih=new RegExp("^"+bh+Rh+Dh+Bh+"$"),Oh=["material","materials","bones"];Object.assign(Fl.prototype,{getValue:function(e,t){this.bind();var n=this._bindings[this._targetGroup.nCachedObjects_];n!==void 0&&n.getValue(e,t)},setValue:function(e,t){for(var n=this._bindings,i=this._targetGroup.nCachedObjects_,r=n.length;i!==r;++i)n[i].setValue(e,t)},bind:function(){for(var e=this._bindings,t=this._targetGroup.nCachedObjects_,n=e.length;t!==n;++t)e[t].bind()},unbind:function(){for(var e=this._bindings,t=this._targetGroup.nCachedObjects_,n=e.length;t!==n;++t)e[t].unbind()}}),Object.assign(Xt,{Composite:Fl,create:function(e,t,n){return e&&e.isAnimationObjectGroup?new Xt.Composite(e,t,n):new Xt(e,t,n)},sanitizeNodeName:function(e){return e.replace(/\s/g,"_").replace(Lh,"")},parseTrackName:function(e){var t=Ih.exec(e);if(!t)throw Error("PropertyBinding: Cannot parse trackName: "+e);t={nodeName:t[2],objectName:t[3],objectIndex:t[4],propertyName:t[5],propertyIndex:t[6]};var n=t.nodeName&&t.nodeName.lastIndexOf(".");if(n!==void 0&&n!==-1){var i=t.nodeName.substring(n+1);Oh.indexOf(i)!==-1&&(t.nodeName=t.nodeName.substring(0,n),t.objectName=i)}if(t.propertyName===null||t.propertyName.length===0)throw Error("PropertyBinding: can not parse propertyName from trackName: "+e);return t},findNode:function(e,t){if(!t||t===""||t==="root"||t==="."||t===-1||t===e.name||t===e.uuid)return e;if(e.skeleton){var n=e.skeleton.getBoneByName(t);if(n!==void 0)return n}if(e.children){var i=function(r){for(var o=0;o<r.length;o++){var s=r[o];if(s.name===t||s.uuid===t||(s=i(s.children)))return s}return null};if(e=i(e.children))return e}return null}}),Object.assign(Xt.prototype,{_getValue_unavailable:function(){},_setValue_unavailable:function(){},BindingType:{Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},Versioning:{None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},GetterByBindingType:[function(e,t){e[t]=this.node[this.propertyName]},function(e,t){for(var n=this.resolvedProperty,i=0,r=n.length;i!==r;++i)e[t++]=n[i]},function(e,t){e[t]=this.resolvedProperty[this.propertyIndex]},function(e,t){this.resolvedProperty.toArray(e,t)}],SetterByBindingTypeAndVersioning:[[function(e,t){this.targetObject[this.propertyName]=e[t]},function(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.needsUpdate=!0},function(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(e,t){for(var n=this.resolvedProperty,i=0,r=n.length;i!==r;++i)n[i]=e[t++]},function(e,t){for(var n=this.resolvedProperty,i=0,r=n.length;i!==r;++i)n[i]=e[t++];this.targetObject.needsUpdate=!0},function(e,t){for(var n=this.resolvedProperty,i=0,r=n.length;i!==r;++i)n[i]=e[t++];this.targetObject.matrixWorldNeedsUpdate=!0}],[function(e,t){this.resolvedProperty[this.propertyIndex]=e[t]},function(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.needsUpdate=!0},function(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(e,t){this.resolvedProperty.fromArray(e,t)},function(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.needsUpdate=!0},function(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.matrixWorldNeedsUpdate=!0}]],getValue:function(e,t){this.bind(),this.getValue(e,t)},setValue:function(e,t){this.bind(),this.setValue(e,t)},bind:function(){var e=this.node,t=this.parsedPath,n=t.objectName,i=t.propertyName,r=t.propertyIndex;if(e||(this.node=e=Xt.findNode(this.rootNode,t.nodeName)||this.rootNode),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,e){if(n){var o=t.objectIndex;switch(n){case"materials":if(!e.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!e.material.materials){console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);return}e=e.material.materials;break;case"bones":if(!e.skeleton){console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);return}for(e=e.skeleton.bones,n=0;n<e.length;n++)if(e[n].name===o){o=n;break}break;default:if(e[n]===void 0){console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);return}e=e[n]}if(o!==void 0){if(e[o]===void 0){console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,e);return}e=e[o]}}if(o=e[i],o===void 0)console.error("THREE.PropertyBinding: Trying to update property for track: "+t.nodeName+"."+i+" but it wasn't found.",e);else{if(t=this.Versioning.None,this.targetObject=e,e.needsUpdate!==void 0?t=this.Versioning.NeedsUpdate:e.matrixWorldNeedsUpdate!==void 0&&(t=this.Versioning.MatrixWorldNeedsUpdate),n=this.BindingType.Direct,r!==void 0){if(i==="morphTargetInfluences"){if(!e.geometry){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);return}if(e.geometry.isBufferGeometry){if(!e.geometry.morphAttributes){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);return}for(n=0;n<this.node.geometry.morphAttributes.position.length;n++)if(e.geometry.morphAttributes.position[n].name===r){r=n;break}}else{if(!e.geometry.morphTargets){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphTargets.",this);return}for(n=0;n<this.node.geometry.morphTargets.length;n++)if(e.geometry.morphTargets[n].name===r){r=n;break}}}n=this.BindingType.ArrayElement,this.resolvedProperty=o,this.propertyIndex=r}else o.fromArray!==void 0&&o.toArray!==void 0?(n=this.BindingType.HasFromToArray,this.resolvedProperty=o):Array.isArray(o)?(n=this.BindingType.EntireArray,this.resolvedProperty=o):this.propertyName=i;this.getValue=this.GetterByBindingType[n],this.setValue=this.SetterByBindingTypeAndVersioning[n][t]}}else console.error("THREE.PropertyBinding: Trying to update node for track: "+this.path+" but it wasn't found.")},unbind:function(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}),Object.assign(Xt.prototype,{_getValue_unbound:Xt.prototype.getValue,_setValue_unbound:Xt.prototype.setValue}),Object.assign(Nl.prototype,{isAnimationObjectGroup:!0,add:function(){for(var e=this._objects,t=e.length,n=this.nCachedObjects_,i=this._indicesByUUID,r=this._paths,o=this._parsedPaths,s=this._bindings,a=s.length,c=void 0,u=0,h=arguments.length;u!==h;++u){var p=arguments[u],v=p.uuid,x=i[v];if(x===void 0){x=t++,i[v]=x,e.push(p),v=0;for(var y=a;v!==y;++v)s[v].push(new Xt(p,r[v],o[v]))}else if(x<n){c=e[x];var M=--n;for(y=e[M],i[y.uuid]=x,e[x]=y,i[v]=M,e[M]=p,v=0,y=a;v!==y;++v){var L=s[v],O=L[x];L[x]=L[M],O===void 0&&(O=new Xt(p,r[v],o[v])),L[M]=O}}else e[x]!==c&&console.error("THREE.AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=n},remove:function(){for(var e=this._objects,t=this.nCachedObjects_,n=this._indicesByUUID,i=this._bindings,r=i.length,o=0,s=arguments.length;o!==s;++o){var a=arguments[o],c=a.uuid,u=n[c];if(u!==void 0&&u>=t){var h=t++,p=e[h];for(n[p.uuid]=u,e[u]=p,n[c]=h,e[h]=a,a=0,c=r;a!==c;++a){p=i[a];var v=p[u];p[u]=p[h],p[h]=v}}}this.nCachedObjects_=t},uncache:function(){for(var e=this._objects,t=e.length,n=this.nCachedObjects_,i=this._indicesByUUID,r=this._bindings,o=r.length,s=0,a=arguments.length;s!==a;++s){var c=arguments[s].uuid,u=i[c];if(u!==void 0)if(delete i[c],u<n){c=--n;var h=e[c],p=--t,v=e[p];for(i[h.uuid]=u,e[u]=h,i[v.uuid]=c,e[c]=v,e.pop(),h=0,v=o;h!==v;++h){var x=r[h],y=x[p];x[u]=x[c],x[c]=y,x.pop()}}else for(p=--t,v=e[p],i[v.uuid]=u,e[u]=v,e.pop(),h=0,v=o;h!==v;++h)x=r[h],x[u]=x[p],x.pop()}this.nCachedObjects_=n},subscribe_:function(e,t){var n=this._bindingsIndicesByPath,i=n[e],r=this._bindings;if(i!==void 0)return r[i];var o=this._paths,s=this._parsedPaths,a=this._objects,c=this.nCachedObjects_,u=Array(a.length);for(i=r.length,n[e]=i,o.push(e),s.push(t),r.push(u),n=c,i=a.length;n!==i;++n)u[n]=new Xt(a[n],e,t);return u},unsubscribe_:function(e){var t=this._bindingsIndicesByPath,n=t[e];if(n!==void 0){var i=this._paths,r=this._parsedPaths,o=this._bindings,s=o.length-1,a=o[s];t[e[s]]=n,o[n]=a,o.pop(),r[n]=r[s],r.pop(),i[n]=i[s],i.pop()}}}),Object.assign(Ul.prototype,{play:function(){return this._mixer._activateAction(this),this},stop:function(){return this._mixer._deactivateAction(this),this.reset()},reset:function(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()},isRunning:function(){return this.enabled&&!this.paused&&this.timeScale!==0&&this._startTime===null&&this._mixer._isActiveAction(this)},isScheduled:function(){return this._mixer._isActiveAction(this)},startAt:function(e){return this._startTime=e,this},setLoop:function(e,t){return this.loop=e,this.repetitions=t,this},setEffectiveWeight:function(e){return this.weight=e,this._effectiveWeight=this.enabled?e:0,this.stopFading()},getEffectiveWeight:function(){return this._effectiveWeight},fadeIn:function(e){return this._scheduleFading(e,0,1)},fadeOut:function(e){return this._scheduleFading(e,1,0)},crossFadeFrom:function(e,t,n){if(e.fadeOut(t),this.fadeIn(t),n){n=this._clip.duration;var i=e._clip.duration,r=n/i;e.warp(1,i/n,t),this.warp(r,1,t)}return this},crossFadeTo:function(e,t,n){return e.crossFadeFrom(this,t,n)},stopFading:function(){var e=this._weightInterpolant;return e!==null&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this},setEffectiveTimeScale:function(e){return this.timeScale=e,this._effectiveTimeScale=this.paused?0:e,this.stopWarping()},getEffectiveTimeScale:function(){return this._effectiveTimeScale},setDuration:function(e){return this.timeScale=this._clip.duration/e,this.stopWarping()},syncWith:function(e){return this.time=e.time,this.timeScale=e.timeScale,this.stopWarping()},halt:function(e){return this.warp(this._effectiveTimeScale,0,e)},warp:function(e,t,n){var i=this._mixer,r=i.time,o=this._timeScaleInterpolant,s=this.timeScale;return o===null&&(this._timeScaleInterpolant=o=i._lendControlInterpolant()),i=o.parameterPositions,o=o.sampleValues,i[0]=r,i[1]=r+n,o[0]=e/s,o[1]=t/s,this},stopWarping:function(){var e=this._timeScaleInterpolant;return e!==null&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this},getMixer:function(){return this._mixer},getClip:function(){return this._clip},getRoot:function(){return this._localRoot||this._mixer._root},_update:function(e,t,n,i){if(this.enabled){var r=this._startTime;if(r!==null){if(t=(e-r)*n,0>t||n===0)return;this._startTime=null,t*=n}if(t*=this._updateTimeScale(e),n=this._updateTime(t),e=this._updateWeight(e),0<e){t=this._interpolants,r=this._propertyBindings;for(var o=0,s=t.length;o!==s;++o)t[o].evaluate(n),r[o].accumulate(i,e)}}else this._updateWeight(e)},_updateWeight:function(e){var t=0;if(this.enabled){t=this.weight;var n=this._weightInterpolant;if(n!==null){var i=n.evaluate(e)[0];t*=i,e>n.parameterPositions[1]&&(this.stopFading(),i===0&&(this.enabled=!1))}}return this._effectiveWeight=t},_updateTimeScale:function(e){var t=0;if(!this.paused){t=this.timeScale;var n=this._timeScaleInterpolant;if(n!==null){var i=n.evaluate(e)[0];t*=i,e>n.parameterPositions[1]&&(this.stopWarping(),t===0?this.paused=!0:this.timeScale=t)}}return this._effectiveTimeScale=t},_updateTime:function(e){var t=this.time+e,n=this._clip.duration,i=this.loop,r=this._loopCount,o=i===2202;if(e===0)return r===-1?t:o&&(r&1)===1?n-t:t;if(i===2200)e:{if(r===-1&&(this._loopCount=0,this._setEndings(!0,!0,!1)),t>=n)t=n;else if(0>t)t=0;else{this.time=t;break e}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=t,this._mixer.dispatchEvent({type:"finished",action:this,direction:0>e?-1:1})}else{if(r===-1&&(0<=e?(r=0,this._setEndings(!0,this.repetitions===0,o)):this._setEndings(this.repetitions===0,!0,o)),t>=n||0>t){i=Math.floor(t/n),t-=n*i,r+=Math.abs(i);var s=this.repetitions-r;0>=s?(this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=t=0<e?n:0,this._mixer.dispatchEvent({type:"finished",action:this,direction:0<e?1:-1})):(s===1?(e=0>e,this._setEndings(e,!e,o)):this._setEndings(!1,!1,o),this._loopCount=r,this.time=t,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:i}))}else this.time=t;if(o&&(r&1)===1)return n-t}return t},_setEndings:function(e,t,n){var i=this._interpolantSettings;n?(i.endingStart=2401,i.endingEnd=2401):(i.endingStart=e?this.zeroSlopeAtStart?2401:2400:2402,i.endingEnd=t?this.zeroSlopeAtEnd?2401:2400:2402)},_scheduleFading:function(e,t,n){var i=this._mixer,r=i.time,o=this._weightInterpolant;return o===null&&(this._weightInterpolant=o=i._lendControlInterpolant()),i=o.parameterPositions,o=o.sampleValues,i[0]=r,o[0]=t,i[1]=r+e,o[1]=n,this}}),Uc.prototype=Object.assign(Object.create(w.prototype),{constructor:Uc,_bindAction:function(e,t){var n=e._localRoot||this._root,i=e._clip.tracks,r=i.length,o=e._propertyBindings;e=e._interpolants;var s=n.uuid,a=this._bindingsByRootAndName,c=a[s];for(c===void 0&&(c={},a[s]=c),a=0;a!==r;++a){var u=i[a],h=u.name,p=c[h];if(p===void 0){if(p=o[a],p!==void 0){p._cacheIndex===null&&(++p.referenceCount,this._addInactiveBinding(p,s,h));continue}p=new Nc(Xt.create(n,h,t&&t._propertyBindings[a].binding.parsedPath),u.ValueTypeName,u.getValueSize()),++p.referenceCount,this._addInactiveBinding(p,s,h)}o[a]=p,e[a].resultBuffer=p.buffer}},_activateAction:function(e){if(!this._isActiveAction(e)){if(e._cacheIndex===null){var t=(e._localRoot||this._root).uuid,n=e._clip.uuid,i=this._actionsByClip[n];this._bindAction(e,i&&i.knownActions[0]),this._addInactiveAction(e,n,t)}for(t=e._propertyBindings,n=0,i=t.length;n!==i;++n){var r=t[n];r.useCount++===0&&(this._lendBinding(r),r.saveOriginalState())}this._lendAction(e)}},_deactivateAction:function(e){if(this._isActiveAction(e)){for(var t=e._propertyBindings,n=0,i=t.length;n!==i;++n){var r=t[n];--r.useCount===0&&(r.restoreOriginalState(),this._takeBackBinding(r))}this._takeBackAction(e)}},_initMemoryManager:function(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;var e=this;this.stats={actions:{get total(){return e._actions.length},get inUse(){return e._nActiveActions}},bindings:{get total(){return e._bindings.length},get inUse(){return e._nActiveBindings}},controlInterpolants:{get total(){return e._controlInterpolants.length},get inUse(){return e._nActiveControlInterpolants}}}},_isActiveAction:function(e){return e=e._cacheIndex,e!==null&&e<this._nActiveActions},_addInactiveAction:function(e,t,n){var i=this._actions,r=this._actionsByClip,o=r[t];o===void 0?(o={knownActions:[e],actionByRoot:{}},e._byClipCacheIndex=0,r[t]=o):(t=o.knownActions,e._byClipCacheIndex=t.length,t.push(e)),e._cacheIndex=i.length,i.push(e),o.actionByRoot[n]=e},_removeInactiveAction:function(e){var t=this._actions,n=t[t.length-1],i=e._cacheIndex;n._cacheIndex=i,t[i]=n,t.pop(),e._cacheIndex=null,t=e._clip.uuid,n=this._actionsByClip,i=n[t];var r=i.knownActions,o=r[r.length-1],s=e._byClipCacheIndex;o._byClipCacheIndex=s,r[s]=o,r.pop(),e._byClipCacheIndex=null,delete i.actionByRoot[(e._localRoot||this._root).uuid],r.length===0&&delete n[t],this._removeInactiveBindingsForAction(e)},_removeInactiveBindingsForAction:function(e){e=e._propertyBindings;for(var t=0,n=e.length;t!==n;++t){var i=e[t];--i.referenceCount===0&&this._removeInactiveBinding(i)}},_lendAction:function(e){var t=this._actions,n=e._cacheIndex,i=this._nActiveActions++,r=t[i];e._cacheIndex=i,t[i]=e,r._cacheIndex=n,t[n]=r},_takeBackAction:function(e){var t=this._actions,n=e._cacheIndex,i=--this._nActiveActions,r=t[i];e._cacheIndex=i,t[i]=e,r._cacheIndex=n,t[n]=r},_addInactiveBinding:function(e,t,n){var i=this._bindingsByRootAndName,r=i[t],o=this._bindings;r===void 0&&(r={},i[t]=r),r[n]=e,e._cacheIndex=o.length,o.push(e)},_removeInactiveBinding:function(e){var t=this._bindings,n=e.binding,i=n.rootNode.uuid;n=n.path;var r=this._bindingsByRootAndName,o=r[i],s=t[t.length-1];e=e._cacheIndex,s._cacheIndex=e,t[e]=s,t.pop(),delete o[n],Object.keys(o).length===0&&delete r[i]},_lendBinding:function(e){var t=this._bindings,n=e._cacheIndex,i=this._nActiveBindings++,r=t[i];e._cacheIndex=i,t[i]=e,r._cacheIndex=n,t[n]=r},_takeBackBinding:function(e){var t=this._bindings,n=e._cacheIndex,i=--this._nActiveBindings,r=t[i];e._cacheIndex=i,t[i]=e,r._cacheIndex=n,t[n]=r},_lendControlInterpolant:function(){var e=this._controlInterpolants,t=this._nActiveControlInterpolants++,n=e[t];return n===void 0&&(n=new Zo(new Float32Array(2),new Float32Array(2),1,this._controlInterpolantsResultBuffer),n.__cacheIndex=t,e[t]=n),n},_takeBackControlInterpolant:function(e){var t=this._controlInterpolants,n=e.__cacheIndex,i=--this._nActiveControlInterpolants,r=t[i];e.__cacheIndex=i,t[i]=e,r.__cacheIndex=n,t[n]=r},_controlInterpolantsResultBuffer:new Float32Array(1),clipAction:function(e,t){var n=t||this._root,i=n.uuid;n=typeof e=="string"?fn.findByName(n,e):e,e=n!==null?n.uuid:e;var r=this._actionsByClip[e],o=null;if(r!==void 0){if(o=r.actionByRoot[i],o!==void 0)return o;o=r.knownActions[0],n===null&&(n=o._clip)}return n===null?null:(t=new Ul(this,n,t),this._bindAction(t,o),this._addInactiveAction(t,e,i),t)},existingAction:function(e,t){var n=t||this._root;return t=n.uuid,n=typeof e=="string"?fn.findByName(n,e):e,e=this._actionsByClip[n?n.uuid:e],e!==void 0&&e.actionByRoot[t]||null},stopAllAction:function(){for(var e=this._actions,t=this._nActiveActions,n=this._bindings,i=this._nActiveBindings,r=this._nActiveBindings=this._nActiveActions=0;r!==t;++r)e[r].reset();for(r=0;r!==i;++r)n[r].useCount=0;return this},update:function(e){e*=this.timeScale;for(var t=this._actions,n=this._nActiveActions,i=this.time+=e,r=Math.sign(e),o=this._accuIndex^=1,s=0;s!==n;++s)t[s]._update(i,e,r,o);for(e=this._bindings,t=this._nActiveBindings,s=0;s!==t;++s)e[s].apply(o);return this},setTime:function(e){for(var t=this.time=0;t<this._actions.length;t++)this._actions[t].time=0;return this.update(e)},getRoot:function(){return this._root},uncacheClip:function(e){var t=this._actions;e=e.uuid;var n=this._actionsByClip,i=n[e];if(i!==void 0){i=i.knownActions;for(var r=0,o=i.length;r!==o;++r){var s=i[r];this._deactivateAction(s);var a=s._cacheIndex,c=t[t.length-1];s._cacheIndex=null,s._byClipCacheIndex=null,c._cacheIndex=a,t[a]=c,t.pop(),this._removeInactiveBindingsForAction(s)}delete n[e]}},uncacheRoot:function(e){e=e.uuid;var t=this._actionsByClip;for(i in t){var n=t[i].actionByRoot[e];n!==void 0&&(this._deactivateAction(n),this._removeInactiveAction(n))}var i=this._bindingsByRootAndName[e];if(i!==void 0)for(var r in i)e=i[r],e.restoreOriginalState(),this._removeInactiveBinding(e)},uncacheAction:function(e,t){e=this.existingAction(e,t),e!==null&&(this._deactivateAction(e),this._removeInactiveAction(e))}}),ga.prototype.clone=function(){return new ga(this.value.clone===void 0?this.value:this.value.clone())},zc.prototype=Object.assign(Object.create(ct.prototype),{constructor:zc,isInstancedInterleavedBuffer:!0,copy:function(e){return ct.prototype.copy.call(this,e),this.meshPerAttribute=e.meshPerAttribute,this}}),Object.assign(zl.prototype,{linePrecision:1,set:function(e,t){this.ray.set(e,t)},setFromCamera:function(e,t){t&&t.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(t.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(t).sub(this.ray.origin).normalize(),this.camera=t):t&&t.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,(t.near+t.far)/(t.near-t.far)).unproject(t),this.ray.direction.set(0,0,-1).transformDirection(t.matrixWorld),this.camera=t):console.error("THREE.Raycaster: Unsupported camera type.")},intersectObject:function(e,t,n){return n=n||[],Gc(e,this,n,t),n.sort(Gl),n},intersectObjects:function(e,t,n){if(n=n||[],Array.isArray(e)===!1)return console.warn("THREE.Raycaster.intersectObjects: objects is not an Array."),n;for(var i=0,r=e.length;i<r;i++)Gc(e[i],this,n,t);return n.sort(Gl),n}}),Object.assign(Hl.prototype,{set:function(e,t,n){return this.radius=e,this.phi=t,this.theta=n,this},clone:function(){return new this.constructor().copy(this)},copy:function(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this},makeSafe:function(){return this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi)),this},setFromVector3:function(e){return this.setFromCartesianCoords(e.x,e.y,e.z)},setFromCartesianCoords:function(e,t,n){return this.radius=Math.sqrt(e*e+t*t+n*n),this.radius===0?this.phi=this.theta=0:(this.theta=Math.atan2(e,n),this.phi=Math.acos(Xe.clamp(t/this.radius,-1,1))),this}}),Object.assign(Vl.prototype,{set:function(e,t,n){return this.radius=e,this.theta=t,this.y=n,this},clone:function(){return new this.constructor().copy(this)},copy:function(e){return this.radius=e.radius,this.theta=e.theta,this.y=e.y,this},setFromVector3:function(e){return this.setFromCartesianCoords(e.x,e.y,e.z)},setFromCartesianCoords:function(e,t,n){return this.radius=Math.sqrt(e*e+n*n),this.theta=Math.atan2(e,n),this.y=t,this}});var bu=new G;Object.assign(Hc.prototype,{set:function(e,t){return this.min.copy(e),this.max.copy(t),this},setFromPoints:function(e){this.makeEmpty();for(var t=0,n=e.length;t<n;t++)this.expandByPoint(e[t]);return this},setFromCenterAndSize:function(e,t){return t=bu.copy(t).multiplyScalar(.5),this.min.copy(e).sub(t),this.max.copy(e).add(t),this},clone:function(){return new this.constructor().copy(this)},copy:function(e){return this.min.copy(e.min),this.max.copy(e.max),this},makeEmpty:function(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y},getCenter:function(e){return e===void 0&&(console.warn("THREE.Box2: .getCenter() target is now required"),e=new G),this.isEmpty()?e.set(0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)},getSize:function(e){return e===void 0&&(console.warn("THREE.Box2: .getSize() target is now required"),e=new G),this.isEmpty()?e.set(0,0):e.subVectors(this.max,this.min)},expandByPoint:function(e){return this.min.min(e),this.max.max(e),this},expandByVector:function(e){return this.min.sub(e),this.max.add(e),this},expandByScalar:function(e){return this.min.addScalar(-e),this.max.addScalar(e),this},containsPoint:function(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y)},containsBox:function(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y},getParameter:function(e,t){return t===void 0&&(console.warn("THREE.Box2: .getParameter() target is now required"),t=new G),t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y))},intersectsBox:function(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y)},clampPoint:function(e,t){return t===void 0&&(console.warn("THREE.Box2: .clampPoint() target is now required"),t=new G),t.copy(e).clamp(this.min,this.max)},distanceToPoint:function(e){return bu.copy(e).clamp(this.min,this.max).sub(e).length()},intersect:function(e){return this.min.max(e.min),this.max.min(e.max),this},union:function(e){return this.min.min(e.min),this.max.max(e.max),this},translate:function(e){return this.min.add(e),this.max.add(e),this},equals:function(e){return e.min.equals(this.min)&&e.max.equals(this.max)}});var Ru=new E,Va=new E;Object.assign(Vc.prototype,{set:function(e,t){return this.start.copy(e),this.end.copy(t),this},clone:function(){return new this.constructor().copy(this)},copy:function(e){return this.start.copy(e.start),this.end.copy(e.end),this},getCenter:function(e){return e===void 0&&(console.warn("THREE.Line3: .getCenter() target is now required"),e=new E),e.addVectors(this.start,this.end).multiplyScalar(.5)},delta:function(e){return e===void 0&&(console.warn("THREE.Line3: .delta() target is now required"),e=new E),e.subVectors(this.end,this.start)},distanceSq:function(){return this.start.distanceToSquared(this.end)},distance:function(){return this.start.distanceTo(this.end)},at:function(e,t){return t===void 0&&(console.warn("THREE.Line3: .at() target is now required"),t=new E),this.delta(t).multiplyScalar(e).add(this.start)},closestPointToPointParameter:function(e,t){return Ru.subVectors(e,this.start),Va.subVectors(this.end,this.start),e=Va.dot(Va),e=Va.dot(Ru)/e,t&&(e=Xe.clamp(e,0,1)),e},closestPointToPoint:function(e,t,n){return e=this.closestPointToPointParameter(e,t),n===void 0&&(console.warn("THREE.Line3: .closestPointToPoint() target is now required"),n=new E),this.delta(n).multiplyScalar(e).add(this.start)},applyMatrix4:function(e){return this.start.applyMatrix4(e),this.end.applyMatrix4(e),this},equals:function(e){return e.start.equals(this.start)&&e.end.equals(this.end)}}),ts.prototype=Object.create(W.prototype),ts.prototype.constructor=ts,ts.prototype.isImmediateRenderObject=!0;var Qn=new E,vi=new E,yl=new be,Fh=["a","b","c"];ns.prototype=Object.create(ot.prototype),ns.prototype.constructor=ns,ns.prototype.update=function(){this.object.updateMatrixWorld(!0),yl.getNormalMatrix(this.object.matrixWorld);var e=this.object.matrixWorld,t=this.geometry.attributes.position,n=this.object.geometry;if(n&&n.isGeometry)for(var i=n.vertices,r=n.faces,o=n=0,s=r.length;o<s;o++)for(var a=r[o],c=0,u=a.vertexNormals.length;c<u;c++){var h=a.vertexNormals[c];Qn.copy(i[a[Fh[c]]]).applyMatrix4(e),vi.copy(h).applyMatrix3(yl).normalize().multiplyScalar(this.size).add(Qn),t.setXYZ(n,Qn.x,Qn.y,Qn.z),n+=1,t.setXYZ(n,vi.x,vi.y,vi.z),n+=1}else if(n&&n.isBufferGeometry)for(i=n.attributes.position,r=n.attributes.normal,c=n=0,u=i.count;c<u;c++)Qn.set(i.getX(c),i.getY(c),i.getZ(c)).applyMatrix4(e),vi.set(r.getX(c),r.getY(c),r.getZ(c)),vi.applyMatrix3(yl).normalize().multiplyScalar(this.size).add(Qn),t.setXYZ(n,Qn.x,Qn.y,Qn.z),n+=1,t.setXYZ(n,vi.x,vi.y,vi.z),n+=1;t.needsUpdate=!0};var Du=new E;Qr.prototype=Object.create(W.prototype),Qr.prototype.constructor=Qr,Qr.prototype.dispose=function(){this.cone.geometry.dispose(),this.cone.material.dispose()},Qr.prototype.update=function(){this.light.updateMatrixWorld();var e=this.light.distance?this.light.distance:1e3,t=e*Math.tan(this.light.angle);this.cone.scale.set(t,t,e),Du.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(Du),this.color!==void 0?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)};var Fi=new E,ja=new Se,xl=new Se;qr.prototype=Object.create(ot.prototype),qr.prototype.constructor=qr,qr.prototype.updateMatrixWorld=function(e){var t=this.bones,n=this.geometry,i=n.getAttribute("position");xl.getInverse(this.root.matrixWorld);for(var r=0,o=0;r<t.length;r++){var s=t[r];s.parent&&s.parent.isBone&&(ja.multiplyMatrices(xl,s.matrixWorld),Fi.setFromMatrixPosition(ja),i.setXYZ(o,Fi.x,Fi.y,Fi.z),ja.multiplyMatrices(xl,s.parent.matrixWorld),Fi.setFromMatrixPosition(ja),i.setXYZ(o+1,Fi.x,Fi.y,Fi.z),o+=2)}n.getAttribute("position").needsUpdate=!0,W.prototype.updateMatrixWorld.call(this,e)},Zr.prototype=Object.create(yt.prototype),Zr.prototype.constructor=Zr,Zr.prototype.dispose=function(){this.geometry.dispose(),this.material.dispose()},Zr.prototype.update=function(){this.color!==void 0?this.material.color.set(this.color):this.material.color.copy(this.light.color)},Kr.prototype=Object.create(At.prototype),Kr.prototype.constructor=Kr,Kr.prototype.update=function(){if(this.scale.set(.5*this.light.width,.5*this.light.height,1),this.color!==void 0)this.material.color.set(this.color),this.children[0].material.color.set(this.color);else{this.material.color.copy(this.light.color).multiplyScalar(this.light.intensity);var e=this.material.color,t=Math.max(e.r,e.g,e.b);1<t&&e.multiplyScalar(1/t),this.children[0].material.color.copy(this.material.color)}},Kr.prototype.dispose=function(){this.geometry.dispose(),this.material.dispose(),this.children[0].geometry.dispose(),this.children[0].material.dispose()};var Nh=new E,Bu=new ve,Iu=new ve;Jr.prototype=Object.create(W.prototype),Jr.prototype.constructor=Jr,Jr.prototype.dispose=function(){this.children[0].geometry.dispose(),this.children[0].material.dispose()},Jr.prototype.update=function(){var e=this.children[0];if(this.color!==void 0)this.material.color.set(this.color);else{var t=e.geometry.getAttribute("color");Bu.copy(this.light.color),Iu.copy(this.light.groundColor);for(var n=0,i=t.count;n<i;n++){var r=n<i/2?Bu:Iu;t.setXYZ(n,r.r,r.g,r.b)}t.needsUpdate=!0}e.lookAt(Nh.setFromMatrixPosition(this.light.matrixWorld).negate())},$r.prototype=Object.create(yt.prototype),$r.prototype.constructor=$r,$r.prototype.dispose=function(){this.geometry.dispose(),this.material.dispose()},$r.prototype.onBeforeRender=function(){this.position.copy(this.lightProbe.position),this.scale.set(1,1,1).multiplyScalar(this.size),this.material.uniforms.intensity.value=this.lightProbe.intensity},ya.prototype=Object.assign(Object.create(ot.prototype),{constructor:ya,copy:function(e){return ot.prototype.copy.call(this,e),this.geometry.copy(e.geometry),this.material.copy(e.material),this},clone:function(){return new this.constructor().copy(this)}}),xa.prototype=Object.create(ot.prototype),xa.prototype.constructor=xa,eo.prototype=Object.create(At.prototype),eo.prototype.constructor=eo,eo.prototype.update=function(){function e(y,M,L,O){for(L=(M-y)/L,x.setXYZ(c,0,0,0),u++,h=y;h<M;h+=L)p=c+u,x.setXYZ(p,Math.sin(h)*n,0,Math.cos(h)*n),x.setXYZ(p+1,Math.sin(Math.min(h+L,M))*n,0,Math.cos(Math.min(h+L,M))*n),x.setXYZ(p+2,0,0,0),u+=3;v.addGroup(c,u,O),c+=u,u=0}var t=this.audio,n=this.range,i=this.divisionsInnerAngle,r=this.divisionsOuterAngle,o=Xe.degToRad(t.panner.coneInnerAngle);t=Xe.degToRad(t.panner.coneOuterAngle);var s=o/2,a=t/2,c=0,u=0,h,p,v=this.geometry,x=v.attributes.position;v.clearGroups(),e(-a,-s,r,0),e(-s,s,i,1),e(s,a,r,0),x.needsUpdate=!0,o===t&&(this.material[0].visible=!1)},eo.prototype.dispose=function(){this.geometry.dispose(),this.material[0].dispose(),this.material[1].dispose()};var vs=new E,Wa=new E,Ou=new be;is.prototype=Object.create(ot.prototype),is.prototype.constructor=is,is.prototype.update=function(){this.object.updateMatrixWorld(!0),Ou.getNormalMatrix(this.object.matrixWorld);var e=this.object.matrixWorld,t=this.geometry.attributes.position,n=this.object.geometry,i=n.vertices;n=n.faces;for(var r=0,o=0,s=n.length;o<s;o++){var a=n[o],c=a.normal;vs.copy(i[a.a]).add(i[a.b]).add(i[a.c]).divideScalar(3).applyMatrix4(e),Wa.copy(c).applyMatrix3(Ou).normalize().multiplyScalar(this.size).add(vs),t.setXYZ(r,vs.x,vs.y,vs.z),r+=1,t.setXYZ(r,Wa.x,Wa.y,Wa.z),r+=1}t.needsUpdate=!0};var Fu=new E,ka=new E,Nu=new E;to.prototype=Object.create(W.prototype),to.prototype.constructor=to,to.prototype.dispose=function(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()},to.prototype.update=function(){Fu.setFromMatrixPosition(this.light.matrixWorld),ka.setFromMatrixPosition(this.light.target.matrixWorld),Nu.subVectors(ka,Fu),this.lightPlane.lookAt(ka),this.color!==void 0?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(ka),this.targetLine.scale.z=Nu.length()};var Ya=new E,_t=new $t;rs.prototype=Object.create(ot.prototype),rs.prototype.constructor=rs,rs.prototype.update=function(){var e=this.geometry,t=this.pointMap;_t.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse),Pt("c",t,e,_t,0,0,-1),Pt("t",t,e,_t,0,0,1),Pt("n1",t,e,_t,-1,-1,-1),Pt("n2",t,e,_t,1,-1,-1),Pt("n3",t,e,_t,-1,1,-1),Pt("n4",t,e,_t,1,1,-1),Pt("f1",t,e,_t,-1,-1,1),Pt("f2",t,e,_t,1,-1,1),Pt("f3",t,e,_t,-1,1,1),Pt("f4",t,e,_t,1,1,1),Pt("u1",t,e,_t,.7,1.1,-1),Pt("u2",t,e,_t,-.7,1.1,-1),Pt("u3",t,e,_t,0,2,-1),Pt("cf1",t,e,_t,-1,0,1),Pt("cf2",t,e,_t,1,0,1),Pt("cf3",t,e,_t,0,-1,1),Pt("cf4",t,e,_t,0,1,1),Pt("cn1",t,e,_t,-1,0,-1),Pt("cn2",t,e,_t,1,0,-1),Pt("cn3",t,e,_t,0,-1,-1),Pt("cn4",t,e,_t,0,1,-1),e.getAttribute("position").needsUpdate=!0};var Xa=new pe;ci.prototype=Object.create(ot.prototype),ci.prototype.constructor=ci,ci.prototype.update=function(e){if(e!==void 0&&console.warn("THREE.BoxHelper: .update() has no longer arguments."),this.object!==void 0&&Xa.setFromObject(this.object),!Xa.isEmpty()){e=Xa.min;var t=Xa.max,n=this.geometry.attributes.position,i=n.array;i[0]=t.x,i[1]=t.y,i[2]=t.z,i[3]=e.x,i[4]=t.y,i[5]=t.z,i[6]=e.x,i[7]=e.y,i[8]=t.z,i[9]=t.x,i[10]=e.y,i[11]=t.z,i[12]=t.x,i[13]=t.y,i[14]=e.z,i[15]=e.x,i[16]=t.y,i[17]=e.z,i[18]=e.x,i[19]=e.y,i[20]=e.z,i[21]=t.x,i[22]=e.y,i[23]=e.z,n.needsUpdate=!0,this.geometry.computeBoundingSphere()}},ci.prototype.setFromObject=function(e){return this.object=e,this.update(),this},ci.prototype.copy=function(e){return ot.prototype.copy.call(this,e),this.object=e.object,this},ci.prototype.clone=function(){return new this.constructor().copy(this)},os.prototype=Object.create(ot.prototype),os.prototype.constructor=os,os.prototype.updateMatrixWorld=function(e){var t=this.box;t.isEmpty()||(t.getCenter(this.position),t.getSize(this.scale),this.scale.multiplyScalar(.5),W.prototype.updateMatrixWorld.call(this,e))},ss.prototype=Object.create(At.prototype),ss.prototype.constructor=ss,ss.prototype.updateMatrixWorld=function(e){var t=-this.plane.constant;1e-8>Math.abs(t)&&(t=1e-8),this.scale.set(.5*this.size,.5*this.size,t),this.children[0].material.side=0>t?1:0,this.lookAt(this.plane.normal),W.prototype.updateMatrixWorld.call(this,e)};var Uu=new E,Qa,wl;li.prototype=Object.create(W.prototype),li.prototype.constructor=li,li.prototype.setDirection=function(e){.99999<e.y?this.quaternion.set(0,0,0,1):-.99999>e.y?this.quaternion.set(1,0,0,0):(Uu.set(e.z,0,-e.x).normalize(),this.quaternion.setFromAxisAngle(Uu,Math.acos(e.y)))},li.prototype.setLength=function(e,t,n){t===void 0&&(t=.2*e),n===void 0&&(n=.2*t),this.line.scale.set(1,Math.max(1e-4,e-t),1),this.line.updateMatrix(),this.cone.scale.set(n,t,n),this.cone.position.y=e,this.cone.updateMatrix()},li.prototype.setColor=function(e){this.line.material.color.set(e),this.cone.material.color.set(e)},li.prototype.copy=function(e){return W.prototype.copy.call(this,e,!1),this.line.copy(e.line),this.cone.copy(e.cone),this},li.prototype.clone=function(){return new this.constructor().copy(this)},as.prototype=Object.create(ot.prototype),as.prototype.constructor=as,Pe.create=function(e,t){return console.log("THREE.Curve.create() has been deprecated"),e.prototype=Object.create(Pe.prototype),e.prototype.constructor=e,e.prototype.getPoint=t,e},Object.assign(ai.prototype,{createPointsGeometry:function(e){return console.warn("THREE.CurvePath: .createPointsGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead."),e=this.getPoints(e),this.createGeometry(e)},createSpacedPointsGeometry:function(e){return console.warn("THREE.CurvePath: .createSpacedPointsGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead."),e=this.getSpacedPoints(e),this.createGeometry(e)},createGeometry:function(e){console.warn("THREE.CurvePath: .createGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead.");for(var t=new he,n=0,i=e.length;n<i;n++){var r=e[n];t.vertices.push(new E(r.x,r.y,r.z||0))}return t}}),Object.assign(En.prototype,{fromPoints:function(e){console.warn("THREE.Path: .fromPoints() has been renamed to .setFromPoints()."),this.setFromPoints(e)}}),Wl.prototype=Object.create(Yt.prototype),kl.prototype=Object.create(Yt.prototype),jc.prototype=Object.create(Yt.prototype),Object.assign(jc.prototype,{initFromArray:function(){console.error("THREE.Spline: .initFromArray() has been removed.")},getControlPointsArray:function(){console.error("THREE.Spline: .getControlPointsArray() has been removed.")},reparametrizeByArcLength:function(){console.error("THREE.Spline: .reparametrizeByArcLength() has been removed.")}}),ya.prototype.setColors=function(){console.error("THREE.GridHelper: setColors() has been deprecated, pass them in the constructor instead.")},qr.prototype.update=function(){console.error("THREE.SkeletonHelper: update() no longer needs to be called.")},Object.assign(ut.prototype,{extractUrlBase:function(e){return console.warn("THREE.Loader: .extractUrlBase() has been deprecated. Use THREE.LoaderUtils.extractUrlBase() instead."),ml.extractUrlBase(e)}}),ut.Handlers={add:function(){console.error("THREE.Loader: Handlers.add() has been removed. Use LoadingManager.addHandler() instead.")},get:function(){console.error("THREE.Loader: Handlers.get() has been removed. Use LoadingManager.getHandler() instead.")}},Object.assign(fa.prototype,{setTexturePath:function(e){return console.warn("THREE.ObjectLoader: .setTexturePath() has been renamed to .setResourcePath()."),this.setResourcePath(e)}}),Object.assign(Hc.prototype,{center:function(e){return console.warn("THREE.Box2: .center() has been renamed to .getCenter()."),this.getCenter(e)},empty:function(){return console.warn("THREE.Box2: .empty() has been renamed to .isEmpty()."),this.isEmpty()},isIntersectionBox:function(e){return console.warn("THREE.Box2: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(e)},size:function(e){return console.warn("THREE.Box2: .size() has been renamed to .getSize()."),this.getSize(e)}}),Object.assign(pe.prototype,{center:function(e){return console.warn("THREE.Box3: .center() has been renamed to .getCenter()."),this.getCenter(e)},empty:function(){return console.warn("THREE.Box3: .empty() has been renamed to .isEmpty()."),this.isEmpty()},isIntersectionBox:function(e){return console.warn("THREE.Box3: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(e)},isIntersectionSphere:function(e){return console.warn("THREE.Box3: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(e)},size:function(e){return console.warn("THREE.Box3: .size() has been renamed to .getSize()."),this.getSize(e)}}),Vc.prototype.center=function(e){return console.warn("THREE.Line3: .center() has been renamed to .getCenter()."),this.getCenter(e)},Object.assign(Xe,{random16:function(){return console.warn("THREE.Math: .random16() has been deprecated. Use Math.random() instead."),Math.random()},nearestPowerOfTwo:function(e){return console.warn("THREE.Math: .nearestPowerOfTwo() has been renamed to .floorPowerOfTwo()."),Xe.floorPowerOfTwo(e)},nextPowerOfTwo:function(e){return console.warn("THREE.Math: .nextPowerOfTwo() has been renamed to .ceilPowerOfTwo()."),Xe.ceilPowerOfTwo(e)}}),Object.assign(be.prototype,{flattenToArrayOffset:function(e,t){return console.warn("THREE.Matrix3: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(e,t)},multiplyVector3:function(e){return console.warn("THREE.Matrix3: .multiplyVector3() has been removed. Use vector.applyMatrix3( matrix ) instead."),e.applyMatrix3(this)},multiplyVector3Array:function(){console.error("THREE.Matrix3: .multiplyVector3Array() has been removed.")},applyToBuffer:function(e){return console.warn("THREE.Matrix3: .applyToBuffer() has been removed. Use matrix.applyToBufferAttribute( attribute ) instead."),this.applyToBufferAttribute(e)},applyToVector3Array:function(){console.error("THREE.Matrix3: .applyToVector3Array() has been removed.")}}),Object.assign(Se.prototype,{extractPosition:function(e){return console.warn("THREE.Matrix4: .extractPosition() has been renamed to .copyPosition()."),this.copyPosition(e)},flattenToArrayOffset:function(e,t){return console.warn("THREE.Matrix4: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(e,t)},getPosition:function(){return console.warn("THREE.Matrix4: .getPosition() has been removed. Use Vector3.setFromMatrixPosition( matrix ) instead."),new E().setFromMatrixColumn(this,3)},setRotationFromQuaternion:function(e){return console.warn("THREE.Matrix4: .setRotationFromQuaternion() has been renamed to .makeRotationFromQuaternion()."),this.makeRotationFromQuaternion(e)},multiplyToArray:function(){console.warn("THREE.Matrix4: .multiplyToArray() has been removed.")},multiplyVector3:function(e){return console.warn("THREE.Matrix4: .multiplyVector3() has been removed. Use vector.applyMatrix4( matrix ) instead."),e.applyMatrix4(this)},multiplyVector4:function(e){return console.warn("THREE.Matrix4: .multiplyVector4() has been removed. Use vector.applyMatrix4( matrix ) instead."),e.applyMatrix4(this)},multiplyVector3Array:function(){console.error("THREE.Matrix4: .multiplyVector3Array() has been removed.")},rotateAxis:function(e){console.warn("THREE.Matrix4: .rotateAxis() has been removed. Use Vector3.transformDirection( matrix ) instead."),e.transformDirection(this)},crossVector:function(e){return console.warn("THREE.Matrix4: .crossVector() has been removed. Use vector.applyMatrix4( matrix ) instead."),e.applyMatrix4(this)},translate:function(){console.error("THREE.Matrix4: .translate() has been removed.")},rotateX:function(){console.error("THREE.Matrix4: .rotateX() has been removed.")},rotateY:function(){console.error("THREE.Matrix4: .rotateY() has been removed.")},rotateZ:function(){console.error("THREE.Matrix4: .rotateZ() has been removed.")},rotateByAxis:function(){console.error("THREE.Matrix4: .rotateByAxis() has been removed.")},applyToBuffer:function(e){return console.warn("THREE.Matrix4: .applyToBuffer() has been removed. Use matrix.applyToBufferAttribute( attribute ) instead."),this.applyToBufferAttribute(e)},applyToVector3Array:function(){console.error("THREE.Matrix4: .applyToVector3Array() has been removed.")},makeFrustum:function(e,t,n,i,r,o){return console.warn("THREE.Matrix4: .makeFrustum() has been removed. Use .makePerspective( left, right, top, bottom, near, far ) instead."),this.makePerspective(e,t,i,n,r,o)}}),dn.prototype.isIntersectionLine=function(e){return console.warn("THREE.Plane: .isIntersectionLine() has been renamed to .intersectsLine()."),this.intersectsLine(e)},we.prototype.multiplyVector3=function(e){return console.warn("THREE.Quaternion: .multiplyVector3() has been removed. Use is now vector.applyQuaternion( quaternion ) instead."),e.applyQuaternion(this)},Object.assign(de.prototype,{isIntersectionBox:function(e){return console.warn("THREE.Ray: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(e)},isIntersectionPlane:function(e){return console.warn("THREE.Ray: .isIntersectionPlane() has been renamed to .intersectsPlane()."),this.intersectsPlane(e)},isIntersectionSphere:function(e){return console.warn("THREE.Ray: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(e)}}),Object.assign(lt.prototype,{area:function(){return console.warn("THREE.Triangle: .area() has been renamed to .getArea()."),this.getArea()},barycoordFromPoint:function(e,t){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),this.getBarycoord(e,t)},midpoint:function(e){return console.warn("THREE.Triangle: .midpoint() has been renamed to .getMidpoint()."),this.getMidpoint(e)},normal:function(e){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),this.getNormal(e)},plane:function(e){return console.warn("THREE.Triangle: .plane() has been renamed to .getPlane()."),this.getPlane(e)}}),Object.assign(lt,{barycoordFromPoint:function(e,t,n,i,r){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),lt.getBarycoord(e,t,n,i,r)},normal:function(e,t,n,i){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),lt.getNormal(e,t,n,i)}}),Object.assign(bi.prototype,{extractAllPoints:function(e){return console.warn("THREE.Shape: .extractAllPoints() has been removed. Use .extractPoints() instead."),this.extractPoints(e)},extrude:function(e){return console.warn("THREE.Shape: .extrude() has been removed. Use ExtrudeGeometry() instead."),new Ki(this,e)},makeGeometry:function(e){return console.warn("THREE.Shape: .makeGeometry() has been removed. Use ShapeGeometry() instead."),new Ji(this,e)}}),Object.assign(G.prototype,{fromAttribute:function(e,t,n){return console.warn("THREE.Vector2: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(e,t,n)},distanceToManhattan:function(e){return console.warn("THREE.Vector2: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(e)},lengthManhattan:function(){return console.warn("THREE.Vector2: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}}),Object.assign(E.prototype,{setEulerFromRotationMatrix:function(){console.error("THREE.Vector3: .setEulerFromRotationMatrix() has been removed. Use Euler.setFromRotationMatrix() instead.")},setEulerFromQuaternion:function(){console.error("THREE.Vector3: .setEulerFromQuaternion() has been removed. Use Euler.setFromQuaternion() instead.")},getPositionFromMatrix:function(e){return console.warn("THREE.Vector3: .getPositionFromMatrix() has been renamed to .setFromMatrixPosition()."),this.setFromMatrixPosition(e)},getScaleFromMatrix:function(e){return console.warn("THREE.Vector3: .getScaleFromMatrix() has been renamed to .setFromMatrixScale()."),this.setFromMatrixScale(e)},getColumnFromMatrix:function(e,t){return console.warn("THREE.Vector3: .getColumnFromMatrix() has been renamed to .setFromMatrixColumn()."),this.setFromMatrixColumn(t,e)},applyProjection:function(e){return console.warn("THREE.Vector3: .applyProjection() has been removed. Use .applyMatrix4( m ) instead."),this.applyMatrix4(e)},fromAttribute:function(e,t,n){return console.warn("THREE.Vector3: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(e,t,n)},distanceToManhattan:function(e){return console.warn("THREE.Vector3: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(e)},lengthManhattan:function(){return console.warn("THREE.Vector3: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}}),Object.assign(_e.prototype,{fromAttribute:function(e,t,n){return console.warn("THREE.Vector4: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(e,t,n)},lengthManhattan:function(){return console.warn("THREE.Vector4: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}}),Object.assign(he.prototype,{computeTangents:function(){console.error("THREE.Geometry: .computeTangents() has been removed.")},computeLineDistances:function(){console.error("THREE.Geometry: .computeLineDistances() has been removed. Use THREE.Line.computeLineDistances() instead.")}}),Object.assign(W.prototype,{getChildByName:function(e){return console.warn("THREE.Object3D: .getChildByName() has been renamed to .getObjectByName()."),this.getObjectByName(e)},renderDepth:function(){console.warn("THREE.Object3D: .renderDepth has been removed. Use .renderOrder, instead.")},translate:function(e,t){return console.warn("THREE.Object3D: .translate() has been removed. Use .translateOnAxis( axis, distance ) instead."),this.translateOnAxis(t,e)},getWorldRotation:function(){console.error("THREE.Object3D: .getWorldRotation() has been removed. Use THREE.Object3D.getWorldQuaternion( target ) instead.")}}),Object.defineProperties(W.prototype,{eulerOrder:{get:function(){return console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order},set:function(e){console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order=e}},useQuaternion:{get:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")},set:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")}}}),Object.defineProperties(Ot.prototype,{objects:{get:function(){return console.warn("THREE.LOD: .objects has been renamed to .levels."),this.levels}}}),Object.defineProperty(tn.prototype,"useVertexTexture",{get:function(){console.warn("THREE.Skeleton: useVertexTexture has been removed.")},set:function(){console.warn("THREE.Skeleton: useVertexTexture has been removed.")}}),Lt.prototype.initBones=function(){console.error("THREE.SkinnedMesh: initBones() has been removed.")},Object.defineProperty(Pe.prototype,"__arcLengthDivisions",{get:function(){return console.warn("THREE.Curve: .__arcLengthDivisions is now .arcLengthDivisions."),this.arcLengthDivisions},set:function(e){console.warn("THREE.Curve: .__arcLengthDivisions is now .arcLengthDivisions."),this.arcLengthDivisions=e}}),Je.prototype.setLens=function(e,t){console.warn("THREE.PerspectiveCamera.setLens is deprecated. Use .setFocalLength and .filmGauge for a photographic setup."),t!==void 0&&(this.filmGauge=t),this.setFocalLength(e)},Object.defineProperties(ft.prototype,{onlyShadow:{set:function(){console.warn("THREE.Light: .onlyShadow has been removed.")}},shadowCameraFov:{set:function(e){console.warn("THREE.Light: .shadowCameraFov is now .shadow.camera.fov."),this.shadow.camera.fov=e}},shadowCameraLeft:{set:function(e){console.warn("THREE.Light: .shadowCameraLeft is now .shadow.camera.left."),this.shadow.camera.left=e}},shadowCameraRight:{set:function(e){console.warn("THREE.Light: .shadowCameraRight is now .shadow.camera.right."),this.shadow.camera.right=e}},shadowCameraTop:{set:function(e){console.warn("THREE.Light: .shadowCameraTop is now .shadow.camera.top."),this.shadow.camera.top=e}},shadowCameraBottom:{set:function(e){console.warn("THREE.Light: .shadowCameraBottom is now .shadow.camera.bottom."),this.shadow.camera.bottom=e}},shadowCameraNear:{set:function(e){console.warn("THREE.Light: .shadowCameraNear is now .shadow.camera.near."),this.shadow.camera.near=e}},shadowCameraFar:{set:function(e){console.warn("THREE.Light: .shadowCameraFar is now .shadow.camera.far."),this.shadow.camera.far=e}},shadowCameraVisible:{set:function(){console.warn("THREE.Light: .shadowCameraVisible has been removed. Use new THREE.CameraHelper( light.shadow.camera ) instead.")}},shadowBias:{set:function(e){console.warn("THREE.Light: .shadowBias is now .shadow.bias."),this.shadow.bias=e}},shadowDarkness:{set:function(){console.warn("THREE.Light: .shadowDarkness has been removed.")}},shadowMapWidth:{set:function(e){console.warn("THREE.Light: .shadowMapWidth is now .shadow.mapSize.width."),this.shadow.mapSize.width=e}},shadowMapHeight:{set:function(e){console.warn("THREE.Light: .shadowMapHeight is now .shadow.mapSize.height."),this.shadow.mapSize.height=e}}}),Object.defineProperties(Ce.prototype,{length:{get:function(){return console.warn("THREE.BufferAttribute: .length has been deprecated. Use .count instead."),this.array.length}}}),Object.assign(Ce.prototype,{copyIndicesArray:function(){console.error("THREE.BufferAttribute: .copyIndicesArray() has been removed.")},setArray:function(e){return console.warn("THREE.BufferAttribute: .setArray has been deprecated. Use BufferGeometry .setAttribute to replace/resize attribute buffers"),this.count=e!==void 0?e.length/this.itemSize:0,this.array=e,this}}),Object.assign(re.prototype,{addIndex:function(e){console.warn("THREE.BufferGeometry: .addIndex() has been renamed to .setIndex()."),this.setIndex(e)},addDrawCall:function(e,t,n){n!==void 0&&console.warn("THREE.BufferGeometry: .addDrawCall() no longer supports indexOffset."),console.warn("THREE.BufferGeometry: .addDrawCall() is now .addGroup()."),this.addGroup(e,t)},clearDrawCalls:function(){console.warn("THREE.BufferGeometry: .clearDrawCalls() is now .clearGroups()."),this.clearGroups()},computeTangents:function(){console.warn("THREE.BufferGeometry: .computeTangents() has been removed.")},computeOffsets:function(){console.warn("THREE.BufferGeometry: .computeOffsets() has been removed.")}}),Object.defineProperties(re.prototype,{drawcalls:{get:function(){return console.error("THREE.BufferGeometry: .drawcalls has been renamed to .groups."),this.groups}},offsets:{get:function(){return console.warn("THREE.BufferGeometry: .offsets has been renamed to .groups."),this.groups}}}),Object.assign(ct.prototype,{setArray:function(e){return console.warn("THREE.InterleavedBuffer: .setArray has been deprecated. Use BufferGeometry .setAttribute to replace/resize attribute buffers"),this.count=e!==void 0?e.length/this.stride:0,this.array=e,this}}),Object.assign(zn.prototype,{getArrays:function(){console.error("THREE.ExtrudeBufferGeometry: .getArrays() has been removed.")},addShapeList:function(){console.error("THREE.ExtrudeBufferGeometry: .addShapeList() has been removed.")},addShape:function(){console.error("THREE.ExtrudeBufferGeometry: .addShape() has been removed.")}}),Object.defineProperties(ga.prototype,{dynamic:{set:function(){console.warn("THREE.Uniform: .dynamic has been removed. Use object.onBeforeRender() instead.")}},onUpdate:{value:function(){return console.warn("THREE.Uniform: .onUpdate() has been removed. Use object.onBeforeRender() instead."),this}}}),Object.defineProperties(ie.prototype,{wrapAround:{get:function(){console.warn("THREE.Material: .wrapAround has been removed.")},set:function(){console.warn("THREE.Material: .wrapAround has been removed.")}},overdraw:{get:function(){console.warn("THREE.Material: .overdraw has been removed.")},set:function(){console.warn("THREE.Material: .overdraw has been removed.")}},wrapRGB:{get:function(){return console.warn("THREE.Material: .wrapRGB has been removed."),new ve}},shading:{get:function(){console.error("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead.")},set:function(e){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=e===1}},stencilMask:{get:function(){return console.warn("THREE."+this.type+": .stencilMask has been removed. Use .stencilFuncMask instead."),this.stencilFuncMask},set:function(e){console.warn("THREE."+this.type+": .stencilMask has been removed. Use .stencilFuncMask instead."),this.stencilFuncMask=e}}}),Object.defineProperties(yn.prototype,{metal:{get:function(){return console.warn("THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead."),!1},set:function(){console.warn("THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead")}}}),Object.defineProperties(Rt.prototype,{derivatives:{get:function(){return console.warn("THREE.ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives},set:function(e){console.warn("THREE. ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives=e}}}),Object.assign(at.prototype,{clearTarget:function(e,t,n,i){console.warn("THREE.WebGLRenderer: .clearTarget() has been deprecated. Use .setRenderTarget() and .clear() instead."),this.setRenderTarget(e),this.clear(t,n,i)},animate:function(e){console.warn("THREE.WebGLRenderer: .animate() is now .setAnimationLoop()."),this.setAnimationLoop(e)},getCurrentRenderTarget:function(){return console.warn("THREE.WebGLRenderer: .getCurrentRenderTarget() is now .getRenderTarget()."),this.getRenderTarget()},getMaxAnisotropy:function(){return console.warn("THREE.WebGLRenderer: .getMaxAnisotropy() is now .capabilities.getMaxAnisotropy()."),this.capabilities.getMaxAnisotropy()},getPrecision:function(){return console.warn("THREE.WebGLRenderer: .getPrecision() is now .capabilities.precision."),this.capabilities.precision},resetGLState:function(){return console.warn("THREE.WebGLRenderer: .resetGLState() is now .state.reset()."),this.state.reset()},supportsFloatTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsFloatTextures() is now .extensions.get( 'OES_texture_float' )."),this.extensions.get("OES_texture_float")},supportsHalfFloatTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsHalfFloatTextures() is now .extensions.get( 'OES_texture_half_float' )."),this.extensions.get("OES_texture_half_float")},supportsStandardDerivatives:function(){return console.warn("THREE.WebGLRenderer: .supportsStandardDerivatives() is now .extensions.get( 'OES_standard_derivatives' )."),this.extensions.get("OES_standard_derivatives")},supportsCompressedTextureS3TC:function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTextureS3TC() is now .extensions.get( 'WEBGL_compressed_texture_s3tc' )."),this.extensions.get("WEBGL_compressed_texture_s3tc")},supportsCompressedTexturePVRTC:function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTexturePVRTC() is now .extensions.get( 'WEBGL_compressed_texture_pvrtc' )."),this.extensions.get("WEBGL_compressed_texture_pvrtc")},supportsBlendMinMax:function(){return console.warn("THREE.WebGLRenderer: .supportsBlendMinMax() is now .extensions.get( 'EXT_blend_minmax' )."),this.extensions.get("EXT_blend_minmax")},supportsVertexTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsVertexTextures() is now .capabilities.vertexTextures."),this.capabilities.vertexTextures},supportsInstancedArrays:function(){return console.warn("THREE.WebGLRenderer: .supportsInstancedArrays() is now .extensions.get( 'ANGLE_instanced_arrays' )."),this.extensions.get("ANGLE_instanced_arrays")},enableScissorTest:function(e){console.warn("THREE.WebGLRenderer: .enableScissorTest() is now .setScissorTest()."),this.setScissorTest(e)},initMaterial:function(){console.warn("THREE.WebGLRenderer: .initMaterial() has been removed.")},addPrePlugin:function(){console.warn("THREE.WebGLRenderer: .addPrePlugin() has been removed.")},addPostPlugin:function(){console.warn("THREE.WebGLRenderer: .addPostPlugin() has been removed.")},updateShadowMap:function(){console.warn("THREE.WebGLRenderer: .updateShadowMap() has been removed.")},setFaceCulling:function(){console.warn("THREE.WebGLRenderer: .setFaceCulling() has been removed.")},allocTextureUnit:function(){console.warn("THREE.WebGLRenderer: .allocTextureUnit() has been removed.")},setTexture:function(){console.warn("THREE.WebGLRenderer: .setTexture() has been removed.")},setTexture2D:function(){console.warn("THREE.WebGLRenderer: .setTexture2D() has been removed.")},setTextureCube:function(){console.warn("THREE.WebGLRenderer: .setTextureCube() has been removed.")},getActiveMipMapLevel:function(){return console.warn("THREE.WebGLRenderer: .getActiveMipMapLevel() is now .getActiveMipmapLevel()."),this.getActiveMipmapLevel()}}),Object.defineProperties(at.prototype,{shadowMapEnabled:{get:function(){return this.shadowMap.enabled},set:function(e){console.warn("THREE.WebGLRenderer: .shadowMapEnabled is now .shadowMap.enabled."),this.shadowMap.enabled=e}},shadowMapType:{get:function(){return this.shadowMap.type},set:function(e){console.warn("THREE.WebGLRenderer: .shadowMapType is now .shadowMap.type."),this.shadowMap.type=e}},shadowMapCullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")}},context:{get:function(){return console.warn("THREE.WebGLRenderer: .context has been removed. Use .getContext() instead."),this.getContext()}}}),Object.defineProperties(S.prototype,{cullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")}},renderReverseSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")}},renderSingleSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")}}}),Object.defineProperties(On.prototype,{activeCubeFace:{set:function(){console.warn("THREE.WebGLRenderTargetCube: .activeCubeFace has been removed. It is now the second parameter of WebGLRenderer.setRenderTarget().")}},activeMipMapLevel:{set:function(){console.warn("THREE.WebGLRenderTargetCube: .activeMipMapLevel has been removed. It is now the third parameter of WebGLRenderer.setRenderTarget().")}}}),Object.defineProperties(je.prototype,{wrapS:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS},set:function(e){console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS=e}},wrapT:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT},set:function(e){console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT=e}},magFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter},set:function(e){console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter=e}},minFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter},set:function(e){console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter=e}},anisotropy:{get:function(){return console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy},set:function(e){console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy=e}},offset:{get:function(){return console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset},set:function(e){console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset=e}},repeat:{get:function(){return console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat},set:function(e){console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat=e}},format:{get:function(){return console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format},set:function(e){console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format=e}},type:{get:function(){return console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type},set:function(e){console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type=e}},generateMipmaps:{get:function(){return console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps},set:function(e){console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps=e}}}),Object.defineProperties(Ue.prototype,{standing:{set:function(){console.warn("THREE.WebVRManager: .standing has been removed.")}},userHeight:{set:function(){console.warn("THREE.WebVRManager: .userHeight has been removed.")}}}),Xr.prototype.load=function(e){console.warn("THREE.Audio: .load has been deprecated. Use THREE.AudioLoader instead.");var t=this;return new ma().load(e,function(n){t.setBuffer(n)}),this},Fc.prototype.getData=function(){return console.warn("THREE.AudioAnalyser: .getData() is now .getFrequencyData()."),this.getFrequencyData()},Ei.prototype.updateCubeMap=function(e,t){return console.warn("THREE.CubeCamera: .updateCubeMap() is now .update()."),this.update(e,t)},Ri.crossOrigin=void 0,Ri.loadTexture=function(e,t,n,i){console.warn("THREE.ImageUtils.loadTexture has been deprecated. Use THREE.TextureLoader() instead.");var r=new ta;return r.setCrossOrigin(this.crossOrigin),e=r.load(e,n,void 0,i),t&&(e.mapping=t),e},Ri.loadTextureCube=function(e,t,n,i){console.warn("THREE.ImageUtils.loadTextureCube has been deprecated. Use THREE.CubeTextureLoader() instead.");var r=new ea;return r.setCrossOrigin(this.crossOrigin),e=r.load(e,n,void 0,i),t&&(e.mapping=t),e},Ri.loadCompressedTexture=function(){console.error("THREE.ImageUtils.loadCompressedTexture has been removed. Use THREE.DDSLoader instead.")},Ri.loadCompressedTextureCube=function(){console.error("THREE.ImageUtils.loadCompressedTextureCube has been removed. Use THREE.DDSLoader instead.")},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:"109"}})),f.ACESFilmicToneMapping=5,f.AddEquation=100,f.AddOperation=2,f.AdditiveBlending=2,f.AlphaFormat=1021,f.AlwaysDepth=1,f.AlwaysStencilFunc=519,f.AmbientLight=ca,f.AmbientLightProbe=Dc,f.AnimationClip=fn,f.AnimationLoader=Ec,f.AnimationMixer=Uc,f.AnimationObjectGroup=Nl,f.AnimationUtils=Nt,f.ArcCurve=Yr,f.ArrayCamera=xe,f.ArrowHelper=li,f.Audio=Xr,f.AudioAnalyser=Fc,f.AudioContext=gl,f.AudioListener=Ic,f.AudioLoader=ma,f.AxesHelper=as,f.AxisHelper=function(e){return console.warn("THREE.AxisHelper has been renamed to THREE.AxesHelper."),new as(e)},f.BackSide=1,f.BasicDepthPacking=3200,f.BasicShadowMap=0,f.BinaryTextureLoader=function(e){return console.warn("THREE.BinaryTextureLoader has been renamed to THREE.DataTextureLoader."),new $s(e)},f.Bone=pn,f.BooleanKeyframeTrack=qs,f.BoundingBoxHelper=function(e,t){return console.warn("THREE.BoundingBoxHelper has been deprecated. Creating a THREE.BoxHelper instead."),new ci(e,t)},f.Box2=Hc,f.Box3=pe,f.Box3Helper=os,f.BoxBufferGeometry=ds,f.BoxGeometry=ol,f.BoxHelper=ci,f.BufferAttribute=Ce,f.BufferGeometry=re,f.BufferGeometryLoader=pa,f.ByteType=1010,f.Cache=vr,f.Camera=$t,f.CameraHelper=rs,f.CanvasRenderer=function(){console.error("THREE.CanvasRenderer has been removed")},f.CanvasTexture=qt,f.CatmullRomCurve3=Yt,f.CineonToneMapping=4,f.CircleBufferGeometry=Hr,f.CircleGeometry=qo,f.ClampToEdgeWrapping=1001,f.Clock=Bc,f.ClosedSplineCurve3=Wl,f.Color=ve,f.ColorKeyframeTrack=Zs,f.CompressedTexture=Un,f.CompressedTextureLoader=Sc,f.ConeBufferGeometry=Qo,f.ConeGeometry=Xo,f.CubeCamera=Ei,f.CubeGeometry=ol,f.CubeReflectionMapping=301,f.CubeRefractionMapping=302,f.CubeTexture=Ct,f.CubeTextureLoader=ea,f.CubeUVReflectionMapping=306,f.CubeUVRefractionMapping=307,f.CubicBezierCurve=xn,f.CubicBezierCurve3=Hn,f.CubicInterpolant=Xs,f.CullFaceBack=1,f.CullFaceFront=2,f.CullFaceFrontBack=3,f.CullFaceNone=0,f.Curve=Pe,f.CurvePath=ai,f.CustomBlending=5,f.CylinderBufferGeometry=si,f.CylinderGeometry=er,f.Cylindrical=Vl,f.DataTexture=ei,f.DataTexture2DArray=en,f.DataTexture3D=Gt,f.DataTextureLoader=$s,f.DecrementStencilOp=7683,f.DecrementWrapStencilOp=34056,f.DefaultLoadingManager=Eu,f.DepthFormat=1026,f.DepthStencilFormat=1027,f.DepthTexture=Xi,f.DirectionalLight=aa,f.DirectionalLightHelper=to,f.DirectionalLightShadow=sa,f.DiscreteInterpolant=Qs,f.DodecahedronBufferGeometry=Br,f.DodecahedronGeometry=Oo,f.DoubleSide=2,f.DstAlphaFactor=206,f.DstColorFactor=208,f.DynamicBufferAttribute=function(e,t){return console.warn("THREE.DynamicBufferAttribute has been removed. Use new THREE.BufferAttribute().setDynamic( true ) instead."),new Ce(e,t).setDynamic(!0)},f.EdgesGeometry=Gr,f.EdgesHelper=function(e,t){return console.warn("THREE.EdgesHelper has been removed. Use THREE.EdgesGeometry instead."),new ot(new Gr(e.geometry),new $e({color:t!==void 0?t:16777215}))},f.EllipseCurve=cn,f.EqualDepth=4,f.EqualStencilFunc=514,f.EquirectangularReflectionMapping=303,f.EquirectangularRefractionMapping=304,f.Euler=ht,f.EventDispatcher=w,f.ExtrudeBufferGeometry=zn,f.ExtrudeGeometry=Ki,f.Face3=Ai,f.Face4=function(e,t,n,i,r,o,s){return console.warn("THREE.Face4 has been removed. A THREE.Face3 will be created instead."),new Ai(e,t,n,r,o,s)},f.FaceColors=1,f.FaceNormalsHelper=is,f.FileLoader=mn,f.FlatShading=1,f.Float32Attribute=function(e,t){return console.warn("THREE.Float32Attribute has been removed. Use new THREE.Float32BufferAttribute() instead."),new le(e,t)},f.Float32BufferAttribute=le,f.Float64Attribute=function(e,t){return console.warn("THREE.Float64Attribute has been removed. Use new THREE.Float64BufferAttribute() instead."),new In(e,t)},f.Float64BufferAttribute=In,f.FloatType=1015,f.Fog=xt,f.FogExp2=tt,f.Font=Pc,f.FontLoader=bc,f.FrontFaceDirectionCCW=1,f.FrontFaceDirectionCW=0,f.FrontSide=0,f.Frustum=vn,f.GammaEncoding=3007,f.Geometry=he,f.GeometryUtils={merge:function(e,t,n){if(console.warn("THREE.GeometryUtils: .merge() has been moved to Geometry. Use geometry.merge( geometry2, matrix, materialIndexOffset ) instead."),t.isMesh){t.matrixAutoUpdate&&t.updateMatrix();var i=t.matrix;t=t.geometry}e.merge(t,i,n)},center:function(e){return console.warn("THREE.GeometryUtils: .center() has been moved to Geometry. Use geometry.center() instead."),e.center()}},f.GreaterDepth=6,f.GreaterEqualDepth=5,f.GreaterEqualStencilFunc=518,f.GreaterStencilFunc=516,f.GridHelper=ya,f.Group=Q,f.HalfFloatType=1016,f.HemisphereLight=na,f.HemisphereLightHelper=Jr,f.HemisphereLightProbe=Rc,f.IcosahedronBufferGeometry=Dr,f.IcosahedronGeometry=Io,f.ImageBitmapLoader=Cc,f.ImageLoader=kr,f.ImageUtils=Ri,f.ImmediateRenderObject=ts,f.IncrementStencilOp=7682,f.IncrementWrapStencilOp=34055,f.InstancedBufferAttribute=da,f.InstancedBufferGeometry=ha,f.InstancedInterleavedBuffer=zc,f.InstancedMesh=Ft,f.Int16Attribute=function(e,t){return console.warn("THREE.Int16Attribute has been removed. Use new THREE.Int16BufferAttribute() instead."),new Jn(e,t)},f.Int16BufferAttribute=Jn,f.Int32Attribute=function(e,t){return console.warn("THREE.Int32Attribute has been removed. Use new THREE.Int32BufferAttribute() instead."),new Hi(e,t)},f.Int32BufferAttribute=Hi,f.Int8Attribute=function(e,t){return console.warn("THREE.Int8Attribute has been removed. Use new THREE.Int8BufferAttribute() instead."),new Kn(e,t)},f.Int8BufferAttribute=Kn,f.IntType=1013,f.InterleavedBuffer=ct,f.InterleavedBufferAttribute=gt,f.Interpolant=an,f.InterpolateDiscrete=2300,f.InterpolateLinear=2301,f.InterpolateSmooth=2302,f.InvertStencilOp=5386,f.JSONLoader=function(){console.error("THREE.JSONLoader has been removed.")},f.KeepStencilOp=7680,f.KeyframeTrack=Vt,f.LOD=Ot,f.LatheBufferGeometry=zr,f.LatheGeometry=Yo,f.Layers=Re,f.LensFlare=function(){console.error("THREE.LensFlare has been moved to /examples/js/objects/Lensflare.js")},f.LessDepth=2,f.LessEqualDepth=3,f.LessEqualStencilFunc=515,f.LessStencilFunc=513,f.Light=ft,f.LightProbe=Sn,f.LightProbeHelper=$r,f.LightShadow=jn,f.Line=At,f.Line3=Vc,f.LineBasicMaterial=$e,f.LineCurve=on,f.LineCurve3=wn,f.LineDashedMaterial=ar,f.LineLoop=Ci,f.LinePieces=1,f.LineSegments=ot,f.LineStrip=0,f.LinearEncoding=3e3,f.LinearFilter=1006,f.LinearInterpolant=Zo,f.LinearMipMapLinearFilter=1008,f.LinearMipMapNearestFilter=1007,f.LinearMipmapLinearFilter=1008,f.LinearMipmapNearestFilter=1007,f.LinearToneMapping=1,f.Loader=ut,f.LoaderUtils=ml,f.LoadingManager=Mc,f.LogLuvEncoding=3003,f.LoopOnce=2200,f.LoopPingPong=2202,f.LoopRepeat=2201,f.LuminanceAlphaFormat=1025,f.LuminanceFormat=1024,f.MOUSE={LEFT:0,MIDDLE:1,RIGHT:2,ROTATE:0,DOLLY:1,PAN:2},f.Material=ie,f.MaterialLoader=ua,f.Math=Xe,f.Matrix3=be,f.Matrix4=Se,f.MaxEquation=104,f.Mesh=yt,f.MeshBasicMaterial=Wt,f.MeshDepthMaterial=g,f.MeshDistanceMaterial=A,f.MeshFaceMaterial=function(e){return console.warn("THREE.MeshFaceMaterial has been removed. Use an Array instead."),e},f.MeshLambertMaterial=or,f.MeshMatcapMaterial=sr,f.MeshNormalMaterial=rr,f.MeshPhongMaterial=yn,f.MeshPhysicalMaterial=nr,f.MeshStandardMaterial=Gn,f.MeshToonMaterial=ir,f.MinEquation=103,f.MirroredRepeatWrapping=1002,f.MixOperation=1,f.MultiMaterial=function(e){return e===void 0&&(e=[]),console.warn("THREE.MultiMaterial has been removed. Use an Array instead."),e.isMultiMaterial=!0,e.materials=e,e.clone=function(){return e.slice()},e},f.MultiplyBlending=4,f.MultiplyOperation=0,f.NearestFilter=1003,f.NearestMipMapLinearFilter=1005,f.NearestMipMapNearestFilter=1004,f.NearestMipmapLinearFilter=1005,f.NearestMipmapNearestFilter=1004,f.NeverDepth=0,f.NeverStencilFunc=512,f.NoBlending=0,f.NoColors=0,f.NoToneMapping=0,f.NormalBlending=1,f.NotEqualDepth=7,f.NotEqualStencilFunc=517,f.NumberKeyframeTrack=jr,f.Object3D=W,f.ObjectLoader=fa,f.ObjectSpaceNormalMap=1,f.OctahedronBufferGeometry=Qi,f.OctahedronGeometry=Bo,f.OneFactor=201,f.OneMinusDstAlphaFactor=207,f.OneMinusDstColorFactor=209,f.OneMinusSrcAlphaFactor=205,f.OneMinusSrcColorFactor=203,f.OrthographicCamera=es,f.PCFShadowMap=1,f.PCFSoftShadowMap=2,f.ParametricBufferGeometry=br,f.ParametricGeometry=bo,f.Particle=function(e){return console.warn("THREE.Particle has been renamed to THREE.Sprite."),new kt(e)},f.ParticleBasicMaterial=function(e){return console.warn("THREE.ParticleBasicMaterial has been renamed to THREE.PointsMaterial."),new nn(e)},f.ParticleSystem=function(e,t){return console.warn("THREE.ParticleSystem has been renamed to THREE.Points."),new oi(e,t)},f.ParticleSystemMaterial=function(e){return console.warn("THREE.ParticleSystemMaterial has been renamed to THREE.PointsMaterial."),new nn(e)},f.Path=En,f.PerspectiveCamera=Je,f.Plane=dn,f.PlaneBufferGeometry=ni,f.PlaneGeometry=ti,f.PlaneHelper=ss,f.PointCloud=function(e,t){return console.warn("THREE.PointCloud has been renamed to THREE.Points."),new oi(e,t)},f.PointCloudMaterial=function(e){return console.warn("THREE.PointCloudMaterial has been renamed to THREE.PointsMaterial."),new nn(e)},f.PointLight=oa,f.PointLightHelper=Zr,f.Points=oi,f.PointsMaterial=nn,f.PolarGridHelper=xa,f.PolyhedronBufferGeometry=rn,f.PolyhedronGeometry=Ro,f.PositionalAudio=Oc,f.PositionalAudioHelper=eo,f.PropertyBinding=Xt,f.PropertyMixer=Nc,f.QuadraticBezierCurve=An,f.QuadraticBezierCurve3=Vn,f.Quaternion=we,f.QuaternionKeyframeTrack=Ko,f.QuaternionLinearInterpolant=Ks,f.REVISION="109",f.RGBADepthPacking=3201,f.RGBAFormat=1023,f.RGBA_ASTC_10x10_Format=37819,f.RGBA_ASTC_10x5_Format=37816,f.RGBA_ASTC_10x6_Format=37817,f.RGBA_ASTC_10x8_Format=37818,f.RGBA_ASTC_12x10_Format=37820,f.RGBA_ASTC_12x12_Format=37821,f.RGBA_ASTC_4x4_Format=37808,f.RGBA_ASTC_5x4_Format=37809,f.RGBA_ASTC_5x5_Format=37810,f.RGBA_ASTC_6x5_Format=37811,f.RGBA_ASTC_6x6_Format=37812,f.RGBA_ASTC_8x5_Format=37813,f.RGBA_ASTC_8x6_Format=37814,f.RGBA_ASTC_8x8_Format=37815,f.RGBA_PVRTC_2BPPV1_Format=35843,f.RGBA_PVRTC_4BPPV1_Format=35842,f.RGBA_S3TC_DXT1_Format=33777,f.RGBA_S3TC_DXT3_Format=33778,f.RGBA_S3TC_DXT5_Format=33779,f.RGBDEncoding=3006,f.RGBEEncoding=3002,f.RGBEFormat=1023,f.RGBFormat=1022,f.RGBM16Encoding=3005,f.RGBM7Encoding=3004,f.RGB_ETC1_Format=36196,f.RGB_PVRTC_2BPPV1_Format=35841,f.RGB_PVRTC_4BPPV1_Format=35840,f.RGB_S3TC_DXT1_Format=33776,f.RawShaderMaterial=Vr,f.Ray=de,f.Raycaster=zl,f.RectAreaLight=la,f.RectAreaLightHelper=Kr,f.RedFormat=1028,f.ReinhardToneMapping=2,f.RepeatWrapping=1e3,f.ReplaceStencilOp=7681,f.ReverseSubtractEquation=102,f.RingBufferGeometry=Ur,f.RingGeometry=ko,f.Scene=It,f.SceneUtils={createMultiMaterialObject:function(){console.error("THREE.SceneUtils has been moved to /examples/js/utils/SceneUtils.js")},detach:function(){console.error("THREE.SceneUtils has been moved to /examples/js/utils/SceneUtils.js")},attach:function(){console.error("THREE.SceneUtils has been moved to /examples/js/utils/SceneUtils.js")}},f.ShaderChunk=nt,f.ShaderLib=Xn,f.ShaderMaterial=Rt,f.ShadowMaterial=tr,f.Shape=bi,f.ShapeBufferGeometry=$i,f.ShapeGeometry=Ji,f.ShapePath=Lc,f.ShapeUtils=mi,f.ShortType=1011,f.Skeleton=tn,f.SkeletonHelper=qr,f.SkinnedMesh=Lt,f.SmoothShading=2,f.Sphere=ye,f.SphereBufferGeometry=Pi,f.SphereGeometry=Wo,f.Spherical=Hl,f.SphericalHarmonics3=va,f.SphericalReflectionMapping=305,f.Spline=jc,f.SplineCurve=Mn,f.SplineCurve3=kl,f.SpotLight=ra,f.SpotLightHelper=Qr,f.SpotLightShadow=ia,f.Sprite=kt,f.SpriteMaterial=wt,f.SrcAlphaFactor=204,f.SrcAlphaSaturateFactor=210,f.SrcColorFactor=202,f.StereoCamera=Ol,f.StringKeyframeTrack=Js,f.SubtractEquation=101,f.SubtractiveBlending=3,f.TOUCH={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},f.TangentSpaceNormalMap=0,f.TetrahedronBufferGeometry=Rr,f.TetrahedronGeometry=Do,f.TextBufferGeometry=Nr,f.TextGeometry=jo,f.Texture=Ae,f.TextureLoader=ta,f.TorusBufferGeometry=Or,f.TorusGeometry=Uo,f.TorusKnotBufferGeometry=Ir,f.TorusKnotGeometry=No,f.Triangle=lt,f.TriangleFanDrawMode=2,f.TriangleStripDrawMode=1,f.TrianglesDrawMode=0,f.TubeBufferGeometry=qi,f.TubeGeometry=Fo,f.UVMapping=300,f.Uint16Attribute=function(e,t){return console.warn("THREE.Uint16Attribute has been removed. Use new THREE.Uint16BufferAttribute() instead."),new Bn(e,t)},f.Uint16BufferAttribute=Bn,f.Uint32Attribute=function(e,t){return console.warn("THREE.Uint32Attribute has been removed. Use new THREE.Uint32BufferAttribute() instead."),new St(e,t)},f.Uint32BufferAttribute=St,f.Uint8Attribute=function(e,t){return console.warn("THREE.Uint8Attribute has been removed. Use new THREE.Uint8BufferAttribute() instead."),new Mi(e,t)},f.Uint8BufferAttribute=Mi,f.Uint8ClampedAttribute=function(e,t){return console.warn("THREE.Uint8ClampedAttribute has been removed. Use new THREE.Uint8ClampedBufferAttribute() instead."),new Gi(e,t)},f.Uint8ClampedBufferAttribute=Gi,f.Uncharted2ToneMapping=3,f.Uniform=ga,f.UniformsLib=Ee,f.UniformsUtils=fh,f.UnsignedByteType=1009,f.UnsignedInt248Type=1020,f.UnsignedIntType=1014,f.UnsignedShort4444Type=1017,f.UnsignedShort5551Type=1018,f.UnsignedShort565Type=1019,f.UnsignedShortType=1012,f.VSMShadowMap=3,f.Vector2=G,f.Vector3=E,f.Vector4=_e,f.VectorKeyframeTrack=Wr,f.Vertex=function(e,t,n){return console.warn("THREE.Vertex has been removed. Use THREE.Vector3 instead."),new E(e,t,n)},f.VertexColors=2,f.VertexNormalsHelper=ns,f.VideoTexture=Pr,f.WebGLMultisampleRenderTarget=Ve,f.WebGLRenderTarget=je,f.WebGLRenderTargetCube=On,f.WebGLRenderer=at,f.WebGLUtils=I,f.WireframeGeometry=Li,f.WireframeHelper=function(e,t){return console.warn("THREE.WireframeHelper has been removed. Use THREE.WireframeGeometry instead."),new ot(new Li(e.geometry),new $e({color:t!==void 0?t:16777215}))},f.WrapAroundEnding=2402,f.XHRLoader=function(e){return console.warn("THREE.XHRLoader has been renamed to THREE.FileLoader."),new mn(e)},f.ZeroCurvatureEnding=2400,f.ZeroFactor=200,f.ZeroSlopeEnding=2401,f.ZeroStencilOp=0,f.sRGBEncoding=3001,Object.defineProperty(f,"__esModule",{value:!0})});function Ja(f){return Ja=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(w){return typeof w}:function(w){return w&&typeof Symbol=="function"&&w.constructor===Symbol&&w!==Symbol.prototype?"symbol":typeof w},Ja(f)}(function(f,w){(typeof exports>"u"?"undefined":Ja(exports))==="object"&&typeof module<"u"?w(exports,require("three")):typeof define=="function"&&define.amd?define(["exports","three"],w):(f=f||self,w(f.POSTPROCESSING={},f.THREE))})(void 0,function(f,w){var G=Math.cos,we=Math.sin,E=Math.PI,be=Math.pow,Ae=Math.round,_e=Math.floor,je=Number.parseInt,Ve=Math.abs,Se=Math.sqrt,ht=Math.min,Re=Math.max;function W(C,m){if(!(C instanceof m))throw new TypeError("Cannot call a class as a function")}function It(C,m){for(var l,d=0;d<m.length;d++)l=m[d],l.enumerable=l.enumerable||!1,l.configurable=!0,"value"in l&&(l.writable=!0),Object.defineProperty(C,l.key,l)}function pe(C,m,l){return m&&It(C.prototype,m),l&&It(C,l),C}function wi(C,m,l){return m in C?Object.defineProperty(C,m,{value:l,enumerable:!0,configurable:!0,writable:!0}):C[m]=l,C}function ye(C,m){if(typeof m!="function"&&m!==null)throw new TypeError("Super expression must either be null or a function");C.prototype=Object.create(m&&m.prototype,{constructor:{value:C,writable:!0,configurable:!0}}),m&&lt(C,m)}function de(C){return de=Object.setPrototypeOf?Object.getPrototypeOf:function(m){return m.__proto__||Object.getPrototypeOf(m)},de(C)}function lt(C,m){return lt=Object.setPrototypeOf||function(l,d){return l.__proto__=d,l},lt(C,m)}function ve(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}function Dn(){return Dn=ve()?Reflect.construct:function(C,m,l){var d=[null];d.push.apply(d,m);var g=Function.bind.apply(C,d),A=new g;return l&&lt(A,l.prototype),A},Dn.apply(null,arguments)}function hn(C){return Function.toString.call(C).indexOf("[native code]")!==-1}function zi(C){var m=typeof Map=="function"?new Map:void 0;return zi=function(l){function d(){return Dn(l,arguments,de(this).constructor)}if(l===null||!hn(l))return l;if(typeof l!="function")throw new TypeError("Super expression must either be null or a function");if(typeof m<"u"){if(m.has(l))return m.get(l);m.set(l,d)}return d.prototype=Object.create(l.prototype,{constructor:{value:d,enumerable:!1,writable:!0,configurable:!0}}),lt(d,l)},zi(C)}function Ai(C){if(C===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return C}function ie(C,m){return m&&(Ja(m)==="object"||typeof m=="function")?m:Ai(C)}function Wt(C,m){for(;!Object.prototype.hasOwnProperty.call(C,m)&&(C=de(C),C!==null););return C}function Ce(C,m,l){return Ce=typeof Reflect<"u"&&Reflect.get?Reflect.get:function(d,g,A){var S=Wt(d,g);if(S){var R=Object.getOwnPropertyDescriptor(S,g);return R.get?R.get.call(A):R.value}},Ce(C,m,l||C)}function Kn(C,m,l,d){return Kn=typeof Reflect<"u"&&Reflect.set?Reflect.set:function(g,A,S,R){var D,I=Wt(g,A);if(I){if(D=Object.getOwnPropertyDescriptor(I,A),D.set)return D.set.call(R,S),!0;if(!D.writable)return!1}if(D=Object.getOwnPropertyDescriptor(R,A),D){if(!D.writable)return!1;D.value=S,Object.defineProperty(R,A,D)}else wi(R,A,S);return!0},Kn(C,m,l,d)}function Mi(C,m,l,d,g){var A=Kn(C,m,l,d||C);if(!A&&g)throw new Error("failed to set property");return l}function Gi(){if(ji===null){var C=new Float32Array([-1,-1,0,3,-1,0,-1,3,0]),m=new Float32Array([0,0,2,0,0,2]);ji=new w.BufferGeometry,ji.addAttribute("position",new w.BufferAttribute(C,3)),ji.addAttribute("uv",new w.BufferAttribute(m,2))}return ji}function Jn(C,m){for(var l,d=[];(l=C.exec(m))!==null;)d.push(l[1]);return d}function Bn(C,m,l){var d,g,A=!0,S=!1,R=void 0;try{for(var D,I,k=m[Symbol.iterator]();!(A=(D=k.next()).done);A=!0){I=D.value,d="$1"+C+I.charAt(0).toUpperCase()+I.slice(1),g=new RegExp("([^\\.])(\\b"+I+"\\b)","g");var q=!0,Q=!1,xe=void 0;try{for(var Me,Ue,Qe=l.entries()[Symbol.iterator]();!(q=(Me=Qe.next()).done);q=!0)Ue=Me.value,Ue[1]!==null&&l.set(Ue[0],Ue[1].replace(g,d))}catch(at){Q=!0,xe=at}finally{try{q||Qe.return==null||Qe.return()}finally{if(Q)throw xe}}}}catch(at){S=!0,R=at}finally{try{A||k.return==null||k.return()}finally{if(S)throw R}}}function Hi(C,m,l,d,g,A,S){var R=/(?:\w+\s+(\w+)\([\w\s,]*\)\s*{[^}]+})/g,D=/(?:varying\s+\w+\s+(\w*))/g,I=m.blendMode,k=new Map([["fragment",m.fragmentShader],["vertex",m.vertexShader]]),q=k.get("fragment")!==void 0&&0<=k.get("fragment").indexOf("mainImage"),Q=k.get("fragment")!==void 0&&0<=k.get("fragment").indexOf("mainUv"),xe=[],Me=[],Ue=!1,Qe=!1;if(k.get("fragment")===void 0)console.error("Missing fragment shader",m);else if(Q&&S&Dt.CONVOLUTION)console.error("Effects that transform UV coordinates are incompatible with convolution effects",m);else if(!q&&!Q)console.error("The fragment shader contains neither a mainImage nor a mainUv function",m);else{if(Q&&(l.set(rt.FRAGMENT_MAIN_UV,l.get(rt.FRAGMENT_MAIN_UV)+"	"+C+`MainUv(UV);
`),Ue=!0),k.get("vertex")!==null&&0<=k.get("vertex").indexOf("mainSupport")){var at="	"+C+"MainSupport(";0<=k.get("vertex").indexOf("uv")&&(at+="vUv"),at+=`);
`,l.set(rt.VERTEX_MAIN_SUPPORT,l.get(rt.VERTEX_MAIN_SUPPORT)+at),xe=xe.concat(Jn(D,k.get("vertex"))),Me=Me.concat(xe).concat(Jn(R,k.get("vertex")))}if(Me=Me.concat(Jn(R,k.get("fragment"))).concat(Array.from(m.uniforms.keys())).concat(Array.from(m.defines.keys())),m.uniforms.forEach(function(ct,gt){return A.set(C+gt.charAt(0).toUpperCase()+gt.slice(1),ct)}),m.defines.forEach(function(ct,gt){return g.set(C+gt.charAt(0).toUpperCase()+gt.slice(1),ct)}),Bn(C,Me,g),Bn(C,Me,k),d.set(I.blendFunction,I),q){var tt=C+"MainImage(color0, UV, ";S&Dt.DEPTH&&0<=k.get("fragment").indexOf("depth")&&(tt+="depth, ",Qe=!0),tt+=`color1);
	`;var xt=C+"BlendOpacity";A.set(xt,I.opacity),tt+="color0 = blend"+I.blendFunction+"(color0, color1, "+xt+`);

	`,l.set(rt.FRAGMENT_MAIN_IMAGE,l.get(rt.FRAGMENT_MAIN_IMAGE)+tt),l.set(rt.FRAGMENT_HEAD,l.get(rt.FRAGMENT_HEAD)+"uniform float "+xt+`;

`)}l.set(rt.FRAGMENT_HEAD,l.get(rt.FRAGMENT_HEAD)+k.get("fragment")+`
`),k.get("vertex")!==null&&l.set(rt.VERTEX_HEAD,l.get(rt.VERTEX_HEAD)+k.get("vertex")+`
`)}return{varyings:xe,transformedUv:Ue,readDepth:Qe}}function St(C,m){return C+Math.random()*(m-C)}function le(C,m,l,d){var g,A,S,R,D=document.createElementNS("http://www.w3.org/1999/xhtml","canvas"),I=D.getContext("2d"),k=I.createImageData(C,m),q=k.data;for(A=0;A<m;++A)for(g=0;g<C;++g)S=4*(A*C+g),R=(A*C+g)*d,q[S]=0<d?l[R]:0,q[S+1]=1<d?l[R+1]:0,q[S+2]=2<d?l[R+2]:0,q[S+3]=3<d?l[R+3]:255;return D.width=C,D.height=m,I.putImageData(k,0,0),D}function In(C,m,l){return C+(m-C)*l}function xs(C){return ht(Re(C,0),1)}function Mo(C,m){var l=m.min,d=m.max,g=.5*Se(2*l.x),A=.5*Se(2*l.y),S=.5*Se(2*d.x),R=.5*Se(2*d.y),D=xs(C/32);return l.set(In(g,l.x,D),In(A,l.y,D)),d.set(In(S,d.x,D),In(R,d.y,D)),m}function re(C,m,l,d){var g,A,S,R,D=Math.trunc,I=Math.sign,k=m.x-C.x,q=m.y-C.y,Q=l,xe=l+1,Me=C.y+q*(Q-C.x)/k,Ue=C.y+q*(xe-C.x)/k;return Q>=C.x&&Q<m.x||xe>C.x&&xe<=m.x?I(Me)===I(Ue)||1e-4>Ve(Me)||1e-4>Ve(Ue)?(g=(Me+Ue)/2,0>g?d.set(Ve(g),0):d.set(0,Ve(g))):(R=-C.y*k/q+C.x,A=R>C.x?Me*(R-D(R))/2:0,S=R<m.x?Ue*(1-(R-D(R)))/2:0,g=Ve(A)>Ve(S)?A:-S,0>g?d.set(Ve(A),Ve(S)):d.set(Ve(S),Ve(A))):d.set(0,0),d}function yt(C,m,l,d,g){var A=_r.min,S=_r.max,R=Yi.min,D=Yi.max,I=Yi,k=.5+d,q=.5+d-1,Q=m+l+1;switch(C){case 0:{g.set(0,0);break}case 1:{m<=l?re(A.set(0,q),S.set(Q/2,0),m,g):g.set(0,0);break}case 2:{m>=l?re(A.set(Q/2,0),S.set(Q,q),m,g):g.set(0,0);break}case 3:{re(A.set(0,q),S.set(Q/2,0),m,R),re(A.set(Q/2,0),S.set(Q,q),m,D),Mo(Q,I),g.addVectors(R,D);break}case 4:{m<=l?re(A.set(0,k),S.set(Q/2,0),m,g):g.set(0,0);break}case 5:{g.set(0,0);break}case 6:{0<Ve(d)?(re(A.set(0,k),S.set(Q,q),m,R),re(A.set(0,k),S.set(Q/2,0),m,D),D.add(re(A.set(Q/2,0),S.set(Q,q),m,g)),g.addVectors(R,D).divideScalar(2)):re(A.set(0,k),S.set(Q,q),m,g);break}case 7:{re(A.set(0,k),S.set(Q,q),m,g);break}case 8:{m>=l?re(A.set(Q/2,0),S.set(Q,k),m,g):g.set(0,0);break}case 9:{0<Ve(d)?(re(A.set(0,q),S.set(Q,k),m,R),re(A.set(0,q),S.set(Q/2,0),m,D),D.add(re(A.set(Q/2,0),S.set(Q,k),m,g)),g.addVectors(R,D).divideScalar(2)):re(A.set(0,q),S.set(Q,k),m,g);break}case 10:{g.set(0,0);break}case 11:{re(A.set(0,q),S.set(Q,k),m,g);break}case 12:{re(A.set(0,k),S.set(Q/2,0),m,R),re(A.set(Q/2,0),S.set(Q,k),m,D),Mo(Q,I),g.addVectors(R,D);break}case 13:{re(A.set(0,q),S.set(Q,k),m,g);break}case 14:{re(A.set(0,k),S.set(Q,q),m,g);break}case 15:{g.set(0,0);break}}return g}function ws(C,m,l,d){var g,A,S,R,D,I=C.equals(m);return I||(g=(C.x+m.x)/2,A=(C.y+m.y)/2,S=m.y-C.y,R=C.x-m.x,D=S*(l-g)+R*(d-A),I=0<D),I}function Vi(C,m,l,d){var g,A,S,R,D;for(g=0,S=0;S<30;++S)for(A=0;A<30;++A)R=A/29,D=S/29,ws(C,m,l+R,d+D)&&++g;return g/900}function he(C,m,l,d,g,A){var S=ks[C],R=S[0],D=S[1];return 0<R&&(m.x+=g[0],m.y+=g[1]),0<D&&(l.x+=g[0],l.y+=g[1]),A.set(1-Vi(m,l,1+d,0+d),Vi(m,l,1+d,1+d))}function $n(C,m,l,d,g){var A=_r.min,S=_r.max,R=Yi.min,D=Yi.max,I=m+l+1;switch(C){case 0:{he(C,A.set(1,1),S.set(1+I,1+I),m,d,R),he(C,A.set(1,0),S.set(1+I,0+I),m,d,D),g.addVectors(R,D).divideScalar(2);break}case 1:{he(C,A.set(1,0),S.set(0+I,0+I),m,d,R),he(C,A.set(1,0),S.set(1+I,0+I),m,d,D),g.addVectors(R,D).divideScalar(2);break}case 2:{he(C,A.set(0,0),S.set(1+I,0+I),m,d,R),he(C,A.set(1,0),S.set(1+I,0+I),m,d,D),g.addVectors(R,D).divideScalar(2);break}case 3:{he(C,A.set(1,0),S.set(1+I,0+I),m,d,g);break}case 4:{he(C,A.set(1,1),S.set(0+I,0+I),m,d,R),he(C,A.set(1,1),S.set(1+I,0+I),m,d,D),g.addVectors(R,D).divideScalar(2);break}case 5:{he(C,A.set(1,1),S.set(0+I,0+I),m,d,R),he(C,A.set(1,0),S.set(1+I,0+I),m,d,D),g.addVectors(R,D).divideScalar(2);break}case 6:{he(C,A.set(1,1),S.set(1+I,0+I),m,d,g);break}case 7:{he(C,A.set(1,1),S.set(1+I,0+I),m,d,R),he(C,A.set(1,0),S.set(1+I,0+I),m,d,D),g.addVectors(R,D).divideScalar(2);break}case 8:{he(C,A.set(0,0),S.set(1+I,1+I),m,d,R),he(C,A.set(1,0),S.set(1+I,1+I),m,d,D),g.addVectors(R,D).divideScalar(2);break}case 9:{he(C,A.set(1,0),S.set(1+I,1+I),m,d,g);break}case 10:{he(C,A.set(0,0),S.set(1+I,1+I),m,d,R),he(C,A.set(1,0),S.set(1+I,0+I),m,d,D),g.addVectors(R,D).divideScalar(2);break}case 11:{he(C,A.set(1,0),S.set(1+I,1+I),m,d,R),he(C,A.set(1,0),S.set(1+I,0+I),m,d,D),g.addVectors(R,D).divideScalar(2);break}case 12:{he(C,A.set(1,1),S.set(1+I,1+I),m,d,g);break}case 13:{he(C,A.set(1,1),S.set(1+I,1+I),m,d,R),he(C,A.set(1,0),S.set(1+I,1+I),m,d,D),g.addVectors(R,D).divideScalar(2);break}case 14:{he(C,A.set(1,1),S.set(1+I,1+I),m,d,R),he(C,A.set(1,1),S.set(1+I,0+I),m,d,D),g.addVectors(R,D).divideScalar(2);break}case 15:{he(C,A.set(1,1),S.set(1+I,1+I),m,d,R),he(C,A.set(1,0),S.set(1+I,0+I),m,d,D),g.addVectors(R,D).divideScalar(2);break}}return g}function zt(C,m,l){var d,g,A,S,R,D,I,k,q=new w.Vector2;for(d=0,g=C.length;d<g;++d)for(D=C[d],I=D.data,k=D.width,S=0;S<k;++S)for(A=0;A<k;++A)l?yt(d,A,S,m,q):$n(d,A,S,m,q),R=2*(S*k+A),I[R]=255*q.x,I[R+1]=255*q.y}function Rt(C,m,l,d,g,A){var S,R,D,I,k,q,Q,xe,Me,Ue,Qe=new w.Vector2,at=A.data,tt=A.width;for(S=0,R=m.length;S<R;++S)for(Q=l[S],xe=m[S],Me=xe.data,Ue=xe.width,I=0;I<d;++I)for(D=0;D<d;++D)Qe.fromArray(Q).multiplyScalar(d),Qe.add(C),Qe.x+=D,Qe.y+=I,k=2*(Qe.y*tt+Qe.x),q=g?2*(I*I*Ue+D*D):2*(I*Ue+D),at[k]=Me[q],at[k+1]=Me[q+1]}function $t(C,m,l){return C+(m-C)*l}function Je(C){var m=$t(C[0],C[1],.75),l=$t(C[2],C[3],1-.25);return $t(m,l,1-.125)}function Ei(C,m){var l=0;return m[3]===1&&(l+=1),l==1&&m[2]===1&&C[1]!==1&&C[3]!==1&&(l+=1),l}function On(C,m){var l=0;return m[3]===1&&C[1]!==1&&C[3]!==1&&(l+=1),l==1&&m[2]===1&&C[0]!==1&&C[2]!==1&&(l+=1),l}var ei=function(){function C(){W(this,C)}return pe(C,[{key:"dispose",value:function(){}}]),C}(),dn=function(){function C(){W(this,C)}return pe(C,[{key:"initialize",value:function(){}}]),C}(),vn="varying vec2 vUv;void main(){vUv=position.xy*0.5+0.5;gl_Position=vec4(position.xy,1.0,1.0);}",Sr=function(C){function m(){return W(this,m),ie(this,de(m).call(this,{type:"AdaptiveLuminanceMaterial",defines:{MIP_LEVEL_1X1:"0.0"},uniforms:{previousLuminanceBuffer:new w.Uniform(null),currentLuminanceBuffer:new w.Uniform(null),minLuminance:new w.Uniform(.01),deltaTime:new w.Uniform(0),tau:new w.Uniform(1)},fragmentShader:"uniform sampler2D previousLuminanceBuffer;uniform sampler2D currentLuminanceBuffer;uniform float minLuminance;uniform float deltaTime;uniform float tau;varying vec2 vUv;void main(){float previousLuminance=texture2D(previousLuminanceBuffer,vUv,MIP_LEVEL_1X1).r;float currentLuminance=texture2D(currentLuminanceBuffer,vUv,MIP_LEVEL_1X1).r;previousLuminance=max(minLuminance,previousLuminance);currentLuminance=max(minLuminance,currentLuminance);float adaptedLum=previousLuminance+(currentLuminance-previousLuminance)*(1.0-exp(-deltaTime*tau));gl_FragColor.r=adaptedLum;}",vertexShader:vn,depthWrite:!1,depthTest:!1}))}return ye(m,C),m}(w.ShaderMaterial),As=function(C){function m(){var l=0<arguments.length&&arguments[0]!==void 0?arguments[0]:new w.Vector2;return W(this,m),ie(this,de(m).call(this,{type:"ColorEdgesMaterial",defines:{LOCAL_CONTRAST_ADAPTATION_FACTOR:"2.0",EDGE_THRESHOLD:"0.1"},uniforms:{inputBuffer:new w.Uniform(null),texelSize:new w.Uniform(l)},fragmentShader:"uniform sampler2D inputBuffer;varying vec2 vUv;varying vec2 vUv0;varying vec2 vUv1;varying vec2 vUv2;varying vec2 vUv3;varying vec2 vUv4;varying vec2 vUv5;void main(){const vec2 threshold=vec2(EDGE_THRESHOLD);vec4 delta;vec3 c=texture2D(inputBuffer,vUv).rgb;vec3 cLeft=texture2D(inputBuffer,vUv0).rgb;vec3 t=abs(c-cLeft);delta.x=max(max(t.r,t.g),t.b);vec3 cTop=texture2D(inputBuffer,vUv1).rgb;t=abs(c-cTop);delta.y=max(max(t.r,t.g),t.b);vec2 edges=step(threshold,delta.xy);if(dot(edges,vec2(1.0))==0.0){discard;}vec3 cRight=texture2D(inputBuffer,vUv2).rgb;t=abs(c-cRight);delta.z=max(max(t.r,t.g),t.b);vec3 cBottom=texture2D(inputBuffer,vUv3).rgb;t=abs(c-cBottom);delta.w=max(max(t.r,t.g),t.b);float maxDelta=max(max(max(delta.x,delta.y),delta.z),delta.w);vec3 cLeftLeft=texture2D(inputBuffer,vUv4).rgb;t=abs(c-cLeftLeft);delta.z=max(max(t.r,t.g),t.b);vec3 cTopTop=texture2D(inputBuffer,vUv5).rgb;t=abs(c-cTopTop);delta.w=max(max(t.r,t.g),t.b);maxDelta=max(max(maxDelta,delta.z),delta.w);edges*=step(maxDelta,LOCAL_CONTRAST_ADAPTATION_FACTOR*delta.xy);gl_FragColor=vec4(edges,0.0,1.0);}",vertexShader:"uniform vec2 texelSize;varying vec2 vUv;varying vec2 vUv0;varying vec2 vUv1;varying vec2 vUv2;varying vec2 vUv3;varying vec2 vUv4;varying vec2 vUv5;void main(){vUv=position.xy*0.5+0.5;vUv0=vUv+texelSize*vec2(-1.0,0.0);vUv1=vUv+texelSize*vec2(0.0,-1.0);vUv2=vUv+texelSize*vec2(1.0,0.0);vUv3=vUv+texelSize*vec2(0.0,1.0);vUv4=vUv+texelSize*vec2(-2.0,0.0);vUv5=vUv+texelSize*vec2(0.0,-2.0);gl_Position=vec4(position.xy,1.0,1.0);}",depthWrite:!1,depthTest:!1}))}return ye(m,C),pe(m,[{key:"setLocalContrastAdaptationFactor",value:function(l){this.defines.LOCAL_CONTRAST_ADAPTATION_FACTOR=l.toFixed("2"),this.needsUpdate=!0}},{key:"setEdgeDetectionThreshold",value:function(l){l=ht(Re(l,.05),.5),this.defines.EDGE_THRESHOLD=l.toFixed("2"),this.needsUpdate=!0}}]),m}(w.ShaderMaterial),ti=function(C){function m(){var l,d=0<arguments.length&&arguments[0]!==void 0?arguments[0]:new w.Vector2;return W(this,m),l=ie(this,de(m).call(this,{type:"ConvolutionMaterial",uniforms:{inputBuffer:new w.Uniform(null),texelSize:new w.Uniform(new w.Vector2),halfTexelSize:new w.Uniform(new w.Vector2),kernel:new w.Uniform(0),scale:new w.Uniform(1)},fragmentShader:`#include <common>
#include <dithering_pars_fragment>
uniform sampler2D inputBuffer;varying vec2 vUv0;varying vec2 vUv1;varying vec2 vUv2;varying vec2 vUv3;void main(){vec4 sum=texture2D(inputBuffer,vUv0);sum+=texture2D(inputBuffer,vUv1);sum+=texture2D(inputBuffer,vUv2);sum+=texture2D(inputBuffer,vUv3);gl_FragColor=sum*0.25;
#include <dithering_fragment>
}`,vertexShader:"uniform vec2 texelSize;uniform vec2 halfTexelSize;uniform float kernel;uniform float scale;/*Packing multiple texture coordinates into one varying and using a swizzle toextract them in the fragment shader still causes a dependent texture read.*/varying vec2 vUv0;varying vec2 vUv1;varying vec2 vUv2;varying vec2 vUv3;void main(){vec2 uv=position.xy*0.5+0.5;vec2 dUv=(texelSize*vec2(kernel)+halfTexelSize)*scale;vUv0=vec2(uv.x-dUv.x,uv.y+dUv.y);vUv1=vec2(uv.x+dUv.x,uv.y+dUv.y);vUv2=vec2(uv.x+dUv.x,uv.y-dUv.y);vUv3=vec2(uv.x-dUv.x,uv.y-dUv.y);gl_Position=vec4(position.xy,1.0,1.0);}",depthWrite:!1,depthTest:!1})),l.setTexelSize(d.x,d.y),l.kernelSize=Si.LARGE,l}return ye(m,C),pe(m,[{key:"getKernel",value:function(){return ni[this.kernelSize]}},{key:"setTexelSize",value:function(l,d){this.uniforms.texelSize.value.set(l,d),this.uniforms.halfTexelSize.value.set(l,d).multiplyScalar(.5)}}]),m}(w.ShaderMaterial),ni=[new Float32Array([0,0]),new Float32Array([0,1,1]),new Float32Array([0,1,1,2]),new Float32Array([0,1,2,2,3]),new Float32Array([0,1,2,3,4,4,5]),new Float32Array([0,1,2,3,4,5,7,8,9,10])],Si={VERY_SMALL:0,SMALL:1,MEDIUM:2,LARGE:3,VERY_LARGE:4,HUGE:5},Tr=function(C){function m(){return W(this,m),ie(this,de(m).call(this,{type:"CopyMaterial",uniforms:{inputBuffer:new w.Uniform(null),opacity:new w.Uniform(1)},fragmentShader:"uniform sampler2D inputBuffer;uniform float opacity;varying vec2 vUv;void main(){vec4 texel=texture2D(inputBuffer,vUv);gl_FragColor=opacity*texel;}",vertexShader:vn,depthWrite:!1,depthTest:!1}))}return ye(m,C),m}(w.ShaderMaterial),Ms=function(C){function m(){var l,d=0<arguments.length&&arguments[0]!==void 0?arguments[0]:null,g=1<arguments.length?arguments[1]:void 0;return W(this,m),l=ie(this,de(m).call(this,{type:"DepthComparisonMaterial",uniforms:{depthBuffer:new w.Uniform(d),cameraNear:new w.Uniform(.3),cameraFar:new w.Uniform(1e3)},fragmentShader:`#include <packing>
#include <clipping_planes_pars_fragment>
uniform sampler2D depthBuffer;uniform float cameraNear;uniform float cameraFar;varying float vViewZ;varying vec4 vProjTexCoord;void main(){
#include <clipping_planes_fragment>
vec2 projTexCoord=(vProjTexCoord.xy/vProjTexCoord.w)*0.5+0.5;projTexCoord=clamp(projTexCoord,0.002,0.998);float fragCoordZ=unpackRGBAToDepth(texture2D(depthBuffer,projTexCoord));
#ifdef PERSPECTIVE_CAMERA
float viewZ=perspectiveDepthToViewZ(fragCoordZ,cameraNear,cameraFar);
#else
float viewZ=orthographicDepthToViewZ(fragCoordZ,cameraNear,cameraFar);
#endif
float depthTest=(-vViewZ>-viewZ)? 1.0 : 0.0;gl_FragColor.rg=vec2(0.0,depthTest);}`,vertexShader:`#include <common>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <clipping_planes_pars_vertex>
varying float vViewZ;varying vec4 vProjTexCoord;void main(){
#include <skinbase_vertex>
#include <begin_vertex>
#include <morphtarget_vertex>
#include <skinning_vertex>
#include <project_vertex>
vViewZ=mvPosition.z;vProjTexCoord=gl_Position;
#include <clipping_planes_vertex>
}`,depthWrite:!1,depthTest:!1,morphTargets:!0,skinning:!0})),l.adoptCameraSettings(g),l}return ye(m,C),pe(m,[{key:"adoptCameraSettings",value:function(){var l=0<arguments.length&&arguments[0]!==void 0?arguments[0]:null;l!==null&&(this.uniforms.cameraNear.value=l.near,this.uniforms.cameraFar.value=l.far,l instanceof w.PerspectiveCamera?this.defines.PERSPECTIVE_CAMERA="1":delete this.defines.PERSPECTIVE_CAMERA)}}]),m}(w.ShaderMaterial),Es=function(C){function m(){return W(this,m),ie(this,de(m).call(this,{type:"DepthMaskMaterial",defines:{DEPTH_PACKING_0:"0",DEPTH_PACKING_1:"0"},uniforms:{depthBuffer0:new w.Uniform(null),depthBuffer1:new w.Uniform(null),inputBuffer:new w.Uniform(null)},fragmentShader:`#include <common>
#include <packing>
uniform sampler2D depthBuffer0;uniform sampler2D depthBuffer1;uniform sampler2D inputBuffer;varying vec2 vUv;void main(){
#if DEPTH_PACKING_0 == 3201
float d0=unpackRGBAToDepth(texture2D(depthBuffer0,vUv));
#else
float d0=texture2D(depthBuffer0,vUv).r;
#endif
#if DEPTH_PACKING_1 == 3201
float d1=unpackRGBAToDepth(texture2D(depthBuffer1,vUv));
#else
float d1=texture2D(depthBuffer1,vUv).r;
#endif
if(d0<d1){discard;}gl_FragColor=texture2D(inputBuffer,vUv);}`,vertexShader:vn,depthWrite:!1,depthTest:!1}))}return ye(m,C),m}(w.ShaderMaterial),Ss=function(C){function m(){var l,d=0<arguments.length&&arguments[0]!==void 0?arguments[0]:null,g=1<arguments.length&&arguments[1]!==void 0?arguments[1]:null,A=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null,S=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null,R=4<arguments.length&&arguments[4]!==void 0&&arguments[4];return W(this,m),l=ie(this,de(m).call(this,{type:"EffectMaterial",defines:{DEPTH_PACKING:"0"},uniforms:{inputBuffer:new w.Uniform(null),depthBuffer:new w.Uniform(null),resolution:new w.Uniform(new w.Vector2),texelSize:new w.Uniform(new w.Vector2),cameraNear:new w.Uniform(.3),cameraFar:new w.Uniform(1e3),aspect:new w.Uniform(1),time:new w.Uniform(0)},depthWrite:!1,depthTest:!1,dithering:R})),d!==null&&l.setShaderParts(d),g!==null&&l.setDefines(g),A!==null&&l.setUniforms(A),l.adoptCameraSettings(S),l}return ye(m,C),pe(m,[{key:"setShaderParts",value:function(l){return this.fragmentShader=`#include <common>
#include <packing>
#include <dithering_pars_fragment>
uniform sampler2D inputBuffer;uniform sampler2D depthBuffer;uniform vec2 resolution;uniform vec2 texelSize;uniform float cameraNear;uniform float cameraFar;uniform float aspect;uniform float time;varying vec2 vUv;float readDepth(const in vec2 uv){
#if DEPTH_PACKING == 3201
return unpackRGBAToDepth(texture2D(depthBuffer,uv));
#else
return texture2D(depthBuffer,uv).r;
#endif
}FRAGMENT_HEADvoid main(){FRAGMENT_MAIN_UVvec4 color0=texture2D(inputBuffer,UV);vec4 color1=vec4(0.0);FRAGMENT_MAIN_IMAGEgl_FragColor=color0;
#include <dithering_fragment>
}`.replace(rt.FRAGMENT_HEAD,l.get(rt.FRAGMENT_HEAD)).replace(rt.FRAGMENT_MAIN_UV,l.get(rt.FRAGMENT_MAIN_UV)).replace(rt.FRAGMENT_MAIN_IMAGE,l.get(rt.FRAGMENT_MAIN_IMAGE)),this.vertexShader="uniform vec2 resolution;uniform vec2 texelSize;uniform float cameraNear;uniform float cameraFar;uniform float aspect;uniform float time;varying vec2 vUv;VERTEX_HEADvoid main(){vUv=position.xy*0.5+0.5;VERTEX_MAIN_SUPPORTgl_Position=vec4(position.xy,1.0,1.0);}".replace(rt.VERTEX_HEAD,l.get(rt.VERTEX_HEAD)).replace(rt.VERTEX_MAIN_SUPPORT,l.get(rt.VERTEX_MAIN_SUPPORT)),this.needsUpdate=!0,this}},{key:"setDefines",value:function(l){var d=!0,g=!1,A=void 0;try{for(var S,R,D=l.entries()[Symbol.iterator]();!(d=(S=D.next()).done);d=!0)R=S.value,this.defines[R[0]]=R[1]}catch(I){g=!0,A=I}finally{try{d||D.return==null||D.return()}finally{if(g)throw A}}return this.needsUpdate=!0,this}},{key:"setUniforms",value:function(l){var d=!0,g=!1,A=void 0;try{for(var S,R,D=l.entries()[Symbol.iterator]();!(d=(S=D.next()).done);d=!0)R=S.value,this.uniforms[R[0]]=R[1]}catch(I){g=!0,A=I}finally{try{d||D.return==null||D.return()}finally{if(g)throw A}}return this.needsUpdate=!0,this}},{key:"adoptCameraSettings",value:function(){var l=0<arguments.length&&arguments[0]!==void 0?arguments[0]:null;l!==null&&(this.uniforms.cameraNear.value=l.near,this.uniforms.cameraFar.value=l.far,l instanceof w.PerspectiveCamera?this.defines.PERSPECTIVE_CAMERA="1":delete this.defines.PERSPECTIVE_CAMERA,this.needsUpdate=!0)}},{key:"setSize",value:function(l,d){l=Re(l,1),d=Re(d,1),this.uniforms.resolution.value.set(l,d),this.uniforms.texelSize.value.set(1/l,1/d),this.uniforms.aspect.value=l/d}},{key:"depthPacking",get:function(){return je(this.defines.DEPTH_PACKING)},set:function(l){this.defines.DEPTH_PACKING=l.toFixed(0)}}]),m}(w.ShaderMaterial),rt={FRAGMENT_HEAD:"FRAGMENT_HEAD",FRAGMENT_MAIN_UV:"FRAGMENT_MAIN_UV",FRAGMENT_MAIN_IMAGE:"FRAGMENT_MAIN_IMAGE",VERTEX_HEAD:"VERTEX_HEAD",VERTEX_MAIN_SUPPORT:"VERTEX_MAIN_SUPPORT"},Ts=function(C){function m(l){return W(this,m),ie(this,de(m).call(this,{type:"GodRaysMaterial",defines:{SAMPLES_INT:"60",SAMPLES_FLOAT:"60.0"},uniforms:{inputBuffer:new w.Uniform(null),lightPosition:new w.Uniform(l),density:new w.Uniform(1),decay:new w.Uniform(1),weight:new w.Uniform(1),exposure:new w.Uniform(1),clampMax:new w.Uniform(1)},fragmentShader:`#include <common>
#include <dithering_pars_fragment>
uniform sampler2D inputBuffer;uniform vec2 lightPosition;uniform float exposure;uniform float decay;uniform float density;uniform float weight;uniform float clampMax;varying vec2 vUv;void main(){vec2 coord=vUv;vec2 delta=coord-lightPosition;delta*=1.0/SAMPLES_FLOAT*density;float illuminationDecay=1.0;vec4 texel;vec4 color=vec4(0.0);/*Estimate the probability of occlusion at each pixel by summing samplesalong a ray to the light position.*/for(int i=0;i<SAMPLES_INT;++i){coord-=delta;texel=texture2D(inputBuffer,coord);texel*=illuminationDecay*weight;color+=texel;illuminationDecay*=decay;}gl_FragColor=clamp(color*exposure,0.0,clampMax);
#include <dithering_fragment>
}`,vertexShader:vn,depthWrite:!1,depthTest:!1}))}return ye(m,C),pe(m,[{key:"samples",get:function(){return je(this.defines.SAMPLES_INT)},set:function(l){l=_e(l),this.defines.SAMPLES_INT=l.toFixed(0),this.defines.SAMPLES_FLOAT=l.toFixed(1),this.needsUpdate=!0}}]),m}(w.ShaderMaterial),Eo=function(C){function m(){var l,d=0<arguments.length&&arguments[0]!==void 0&&arguments[0],g=1<arguments.length&&arguments[1]!==void 0?arguments[1]:null;W(this,m);var A=g!==null;return l=ie(this,de(m).call(this,{type:"LuminanceMaterial",uniforms:{inputBuffer:new w.Uniform(null),threshold:new w.Uniform(0),smoothing:new w.Uniform(1),range:new w.Uniform(A?g:new w.Vector2)},fragmentShader:`#include <common>
uniform sampler2D inputBuffer;
#ifdef RANGE
uniform vec2 range;
#elif defined(THRESHOLD)
uniform float threshold;uniform float smoothing;
#endif
varying vec2 vUv;void main(){vec4 texel=texture2D(inputBuffer,vUv);float l=linearToRelativeLuminance(texel.rgb);
#ifdef RANGE
float low=step(range.x,l);float high=step(l,range.y);l*=low*high;
#elif defined(THRESHOLD)
l=smoothstep(threshold,threshold+smoothing,l);
#endif
#ifdef COLOR
gl_FragColor=vec4(texel.rgb*l,l);
#else
gl_FragColor=vec4(l);
#endif
}`,vertexShader:vn,depthWrite:!1,depthTest:!1})),l.colorOutput=d,l.useThreshold=!0,l.useRange=A,l}return ye(m,C),pe(m,[{key:"setColorOutputEnabled",value:function(l){l?this.defines.COLOR="1":delete this.defines.COLOR,this.needsUpdate=!0}},{key:"setLuminanceRangeEnabled",value:function(l){l?this.defines.RANGE="1":delete this.defines.RANGE,this.needsUpdate=!0}},{key:"threshold",get:function(){return this.uniforms.threshold.value},set:function(l){this.uniforms.threshold.value=l}},{key:"smoothing",get:function(){return this.uniforms.smoothing.value},set:function(l){this.uniforms.smoothing.value=l}},{key:"useThreshold",get:function(){return this.defines.THRESHOLD!==void 0},set:function(l){l?this.defines.THRESHOLD="1":delete this.defines.THRESHOLD,this.needsUpdate=!0}},{key:"colorOutput",get:function(){return this.defines.COLOR!==void 0},set:function(l){l?this.defines.COLOR="1":delete this.defines.COLOR,this.needsUpdate=!0}},{key:"useRange",get:function(){return this.defines.RANGE!==void 0},set:function(l){l?this.defines.RANGE="1":delete this.defines.RANGE,this.needsUpdate=!0}},{key:"luminanceRange",get:function(){return this.defines.RANGE!==void 0},set:function(l){l?this.defines.RANGE="1":delete this.defines.RANGE,this.needsUpdate=!0}}]),m}(w.ShaderMaterial),_s=function(C){function m(){var l,d=0<arguments.length&&arguments[0]!==void 0?arguments[0]:new w.Vector2;return W(this,m),l=ie(this,de(m).call(this,{type:"OutlineEdgesMaterial",uniforms:{maskTexture:new w.Uniform(null),texelSize:new w.Uniform(new w.Vector2)},fragmentShader:"uniform sampler2D maskTexture;varying vec2 vUv0;varying vec2 vUv1;varying vec2 vUv2;varying vec2 vUv3;void main(){vec2 c0=texture2D(maskTexture,vUv0).rg;vec2 c1=texture2D(maskTexture,vUv1).rg;vec2 c2=texture2D(maskTexture,vUv2).rg;vec2 c3=texture2D(maskTexture,vUv3).rg;float d0=(c0.x-c1.x)*0.5;float d1=(c2.x-c3.x)*0.5;float d=length(vec2(d0,d1));float a0=min(c0.y,c1.y);float a1=min(c2.y,c3.y);float visibilityFactor=min(a0,a1);gl_FragColor.rg=(1.0-visibilityFactor>0.001)? vec2(d,0.0): vec2(0.0,d);}",vertexShader:"uniform vec2 texelSize;varying vec2 vUv0;varying vec2 vUv1;varying vec2 vUv2;varying vec2 vUv3;void main(){vec2 uv=position.xy*0.5+0.5;vUv0=vec2(uv.x+texelSize.x,uv.y);vUv1=vec2(uv.x-texelSize.x,uv.y);vUv2=vec2(uv.x,uv.y+texelSize.y);vUv3=vec2(uv.x,uv.y-texelSize.y);gl_Position=vec4(position.xy,1.0,1.0);}",depthWrite:!1,depthTest:!1})),l.setTexelSize(d.x,d.y),l}return ye(m,C),pe(m,[{key:"setTexelSize",value:function(l,d){this.uniforms.texelSize.value.set(l,d)}}]),m}(w.ShaderMaterial),Cs=function(C){function m(){var l=0<arguments.length&&arguments[0]!==void 0?arguments[0]:new w.Vector2,d=1<arguments.length&&arguments[1]!==void 0?arguments[1]:new w.Vector2;return W(this,m),ie(this,de(m).call(this,{type:"SMAAWeightsMaterial",defines:{MAX_SEARCH_STEPS_INT:"16",MAX_SEARCH_STEPS_FLOAT:"16.0",MAX_SEARCH_STEPS_DIAG_INT:"8",MAX_SEARCH_STEPS_DIAG_FLOAT:"8.0",CORNER_ROUNDING:"25",CORNER_ROUNDING_NORM:"0.25",AREATEX_MAX_DISTANCE:"16.0",AREATEX_MAX_DISTANCE_DIAG:"20.0",AREATEX_PIXEL_SIZE:"(1.0 / vec2(160.0, 560.0))",AREATEX_SUBTEX_SIZE:"(1.0 / 7.0)",SEARCHTEX_SIZE:"vec2(66.0, 33.0)",SEARCHTEX_PACKED_SIZE:"vec2(64.0, 16.0)"},uniforms:{inputBuffer:new w.Uniform(null),areaTexture:new w.Uniform(null),searchTexture:new w.Uniform(null),texelSize:new w.Uniform(l),resolution:new w.Uniform(d)},fragmentShader:`#define sampleLevelZeroOffset(t, coord, offset) texture2D(t, coord + offset * texelSize)
#if __VERSION__ < 300
#define round(v) floor(v + 0.5)
#endif
uniform sampler2D inputBuffer;uniform sampler2D areaTexture;uniform sampler2D searchTexture;uniform vec2 texelSize;uniform vec2 resolution;varying vec2 vUv;varying vec4 vOffset[3];varying vec2 vPixCoord;/***Moves values to a target vector based on a given conditional vector.*/void movec(const in bvec2 c,inout vec2 variable,const in vec2 value){if(c.x){variable.x=value.x;}if(c.y){variable.y=value.y;}}void movec(const in bvec4 c,inout vec4 variable,const in vec4 value){movec(c.xy,variable.xy,value.xy);movec(c.zw,variable.zw,value.zw);}/***Allows to decode two binary values from a bilinear-filtered access.**Bilinear access for fetching 'e' have a 0.25 offset,and we are interested*in the R and G edges:**+---G---+-------+*|x o R   x|*+-------+-------+**Then,if one of these edge is enabled:*Red:(0.75*X+0.25*1)=>0.25 or 1.0*Green:(0.75*1+0.25*X)=>0.75 or 1.0**This function will unpack the values(mad+mul+round):*wolframalpha.com: round(x*abs(5*x-5*0.75))plot 0 to 1*/vec2 decodeDiagBilinearAccess(in vec2 e){e.r=e.r*abs(5.0*e.r-5.0*0.75);return round(e);}vec4 decodeDiagBilinearAccess(in vec4 e){e.rb=e.rb*abs(5.0*e.rb-5.0*0.75);return round(e);}/***Diagonal pattern searches.*/vec2 searchDiag1(const in vec2 texCoord,const in vec2 dir,out vec2 e){vec4 coord=vec4(texCoord,-1.0,1.0);vec3 t=vec3(texelSize,1.0);for(int i=0;i<MAX_SEARCH_STEPS_INT;++i){if(!(coord.z<float(MAX_SEARCH_STEPS_DIAG_INT-1)&&coord.w>0.9)){break;}coord.xyz=t*vec3(dir,1.0)+coord.xyz;e=texture2D(inputBuffer,coord.xy).rg;coord.w=dot(e,vec2(0.5));}return coord.zw;}vec2 searchDiag2(const in vec2 texCoord,const in vec2 dir,out vec2 e){vec4 coord=vec4(texCoord,-1.0,1.0);coord.x+=0.25*texelSize.x;vec3 t=vec3(texelSize,1.0);for(int i=0;i<MAX_SEARCH_STEPS_INT;++i){if(!(coord.z<float(MAX_SEARCH_STEPS_DIAG_INT-1)&&coord.w>0.9)){break;}coord.xyz=t*vec3(dir,1.0)+coord.xyz;e=texture2D(inputBuffer,coord.xy).rg;e=decodeDiagBilinearAccess(e);coord.w=dot(e,vec2(0.5));}return coord.zw;}/***Calculates the area corresponding to a certain diagonal distance and crossing*edges 'e'.*/vec2 areaDiag(const in vec2 dist,const in vec2 e,const in float offset){vec2 texCoord=vec2(AREATEX_MAX_DISTANCE_DIAG,AREATEX_MAX_DISTANCE_DIAG)*e+dist;texCoord=AREATEX_PIXEL_SIZE*texCoord+0.5*AREATEX_PIXEL_SIZE;texCoord.x+=0.5;texCoord.y+=AREATEX_SUBTEX_SIZE*offset;return texture2D(areaTexture,texCoord).rg;}/***Searches for diagonal patterns and returns the corresponding weights.*/vec2 calculateDiagWeights(const in vec2 texCoord,const in vec2 e,const in vec4 subsampleIndices){vec2 weights=vec2(0.0);vec4 d;vec2 end;if(e.r>0.0){d.xz=searchDiag1(texCoord,vec2(-1.0,1.0),end);d.x+=float(end.y>0.9);}else{d.xz=vec2(0.0);}d.yw=searchDiag1(texCoord,vec2(1.0,-1.0),end);if(d.x+d.y>2.0){vec4 coords=vec4(-d.x+0.25,d.x,d.y,-d.y-0.25)*texelSize.xyxy+texCoord.xyxy;vec4 c;c.xy=sampleLevelZeroOffset(inputBuffer,coords.xy,vec2(-1,0)).rg;c.zw=sampleLevelZeroOffset(inputBuffer,coords.zw,vec2(1,0)).rg;c.yxwz=decodeDiagBilinearAccess(c.xyzw);vec2 cc=vec2(2.0)*c.xz+c.yw;movec(bvec2(step(0.9,d.zw)),cc,vec2(0.0));weights+=areaDiag(d.xy,cc,subsampleIndices.z);}d.xz=searchDiag2(texCoord,vec2(-1.0,-1.0),end);if(sampleLevelZeroOffset(inputBuffer,texCoord,vec2(1,0)).r>0.0){d.yw=searchDiag2(texCoord,vec2(1.0),end);d.y+=float(end.y>0.9);}else{d.yw=vec2(0.0);}if(d.x+d.y>2.0){vec4 coords=vec4(-d.x,-d.x,d.y,d.y)*texelSize.xyxy+texCoord.xyxy;vec4 c;c.x=sampleLevelZeroOffset(inputBuffer,coords.xy,vec2(-1,0)).g;c.y=sampleLevelZeroOffset(inputBuffer,coords.xy,vec2(0,-1)).r;c.zw=sampleLevelZeroOffset(inputBuffer,coords.zw,vec2(1,0)).gr;vec2 cc=vec2(2.0)*c.xz+c.yw;movec(bvec2(step(0.9,d.zw)),cc,vec2(0.0));weights+=areaDiag(d.xy,cc,subsampleIndices.w).gr;}return weights;}/***Determines how much length should be added in the last step of the searches.**Takes the bilinearly interpolated edge(see @PSEUDO_GATHER4),and adds 0,1*or 2 depending on which edges and crossing edges are active.*/float searchLength(const in vec2 e,const in float offset){/*The texture is flipped vertically,with left and right cases taking halfof the space horizontally.*/vec2 scale=SEARCHTEX_SIZE*vec2(0.5,-1.0);vec2 bias=SEARCHTEX_SIZE*vec2(offset,1.0);scale+=vec2(-1.0,1.0);bias+=vec2(0.5,-0.5);scale*=1.0/SEARCHTEX_PACKED_SIZE;bias*=1.0/SEARCHTEX_PACKED_SIZE;return texture2D(searchTexture,scale*e+bias).r;}/***Horizontal search for the second pass.*/float searchXLeft(in vec2 texCoord,const in float end){/*@PSEUDO_GATHER4This texCoord has been offset by(-0.25,-0.125)in the vertex shader tosample between edges,thus fetching four edges in a row.Sampling with different offsets in each direction allows to disambiguatewhich edges are active from the four fetched ones.*/vec2 e=vec2(0.0,1.0);for(int i=0;i<MAX_SEARCH_STEPS_INT;++i){if(!(texCoord.x>end&&e.g>0.8281&&e.r==0.0)){break;}e=texture2D(inputBuffer,texCoord).rg;texCoord=vec2(-2.0,0.0)*texelSize+texCoord;}float offset=-(255.0/127.0)*searchLength(e,0.0)+3.25;return texelSize.x*offset+texCoord.x;}float searchXRight(vec2 texCoord,const in float end){vec2 e=vec2(0.0,1.0);for(int i=0;i<MAX_SEARCH_STEPS_INT;++i){if(!(texCoord.x<end&&e.g>0.8281&&e.r==0.0)){break;}e=texture2D(inputBuffer,texCoord).rg;texCoord=vec2(2.0,0.0)*texelSize.xy+texCoord;}float offset=-(255.0/127.0)*searchLength(e,0.5)+3.25;return-texelSize.x*offset+texCoord.x;}/***Vertical search for the second pass.*/float searchYUp(vec2 texCoord,const in float end){vec2 e=vec2(1.0,0.0);for(int i=0;i<MAX_SEARCH_STEPS_INT;++i){if(!(texCoord.y>end&&e.r>0.8281&&e.g==0.0)){break;}e=texture2D(inputBuffer,texCoord).rg;texCoord=-vec2(0.0,2.0)*texelSize.xy+texCoord;}float offset=-(255.0/127.0)*searchLength(e.gr,0.0)+3.25;return texelSize.y*offset+texCoord.y;}float searchYDown(vec2 texCoord,const in float end){vec2 e=vec2(1.0,0.0);for(int i=0;i<MAX_SEARCH_STEPS_INT;i++){if(!(texCoord.y<end&&e.r>0.8281&&e.g==0.0)){break;}e=texture2D(inputBuffer,texCoord).rg;texCoord=vec2(0.0,2.0)*texelSize.xy+texCoord;}float offset=-(255.0/127.0)*searchLength(e.gr,0.5)+3.25;return-texelSize.y*offset+texCoord.y;}/***Determines the areas at each side of the current edge.*/vec2 area(const in vec2 dist,const in float e1,const in float e2,const in float offset){vec2 texCoord=vec2(AREATEX_MAX_DISTANCE)*round(4.0*vec2(e1,e2))+dist;texCoord=AREATEX_PIXEL_SIZE*texCoord+0.5*AREATEX_PIXEL_SIZE;texCoord.y=AREATEX_SUBTEX_SIZE*offset+texCoord.y;return texture2D(areaTexture,texCoord).rg;}/***Corner detection.*/void detectHorizontalCornerPattern(inout vec2 weights,const in vec4 texCoord,const in vec2 d){
#if !defined(DISABLE_CORNER_DETECTION)
vec2 leftRight=step(d.xy,d.yx);vec2 rounding=(1.0-CORNER_ROUNDING_NORM)*leftRight;rounding/=leftRight.x+leftRight.y;vec2 factor=vec2(1.0);factor.x-=rounding.x*sampleLevelZeroOffset(inputBuffer,texCoord.xy,vec2(0,1)).r;factor.x-=rounding.y*sampleLevelZeroOffset(inputBuffer,texCoord.zw,vec2(1,1)).r;factor.y-=rounding.x*sampleLevelZeroOffset(inputBuffer,texCoord.xy,vec2(0,-2)).r;factor.y-=rounding.y*sampleLevelZeroOffset(inputBuffer,texCoord.zw,vec2(1,-2)).r;weights*=saturate(factor);
#endif
}void detectVerticalCornerPattern(inout vec2 weights,const in vec4 texCoord,const in vec2 d){
#if !defined(DISABLE_CORNER_DETECTION)
vec2 leftRight=step(d.xy,d.yx);vec2 rounding=(1.0-CORNER_ROUNDING_NORM)*leftRight;rounding/=leftRight.x+leftRight.y;vec2 factor=vec2(1.0);factor.x-=rounding.x*sampleLevelZeroOffset(inputBuffer,texCoord.xy,vec2(1,0)).g;factor.x-=rounding.y*sampleLevelZeroOffset(inputBuffer,texCoord.zw,vec2(1,1)).g;factor.y-=rounding.x*sampleLevelZeroOffset(inputBuffer,texCoord.xy,vec2(-2,0)).g;factor.y-=rounding.y*sampleLevelZeroOffset(inputBuffer,texCoord.zw,vec2(-2,1)).g;weights*=saturate(factor);
#endif
}void main(){vec4 weights=vec4(0.0);vec4 subsampleIndices=vec4(0.0);vec2 e=texture2D(inputBuffer,vUv).rg;if(e.g>0.0){
#if !defined(DISABLE_DIAG_DETECTION)
/*Diagonals have both north and west edges,so searching for them in one ofthe boundaries is enough.*/weights.rg=calculateDiagWeights(vUv,e,subsampleIndices);if(weights.r==-weights.g){
#endif
vec2 d;vec3 coords;coords.x=searchXLeft(vOffset[0].xy,vOffset[2].x);coords.y=vOffset[1].y;d.x=coords.x;/*Now fetch the left crossing edges,two at a time using bilinearfiltering. Sampling at-0.25(see @CROSSING_OFFSET)enables to discern whatvalue each edge has.*/float e1=texture2D(inputBuffer,coords.xy).r;coords.z=searchXRight(vOffset[0].zw,vOffset[2].y);d.y=coords.z;/*Translate distances to pixel units for better interleave arithmetic andmemory accesses.*/d=round(resolution.xx*d+-vPixCoord.xx);vec2 sqrtD=sqrt(abs(d));float e2=sampleLevelZeroOffset(inputBuffer,coords.zy,vec2(1,0)).r;weights.rg=area(sqrtD,e1,e2,subsampleIndices.y);coords.y=vUv.y;detectHorizontalCornerPattern(weights.rg,coords.xyzy,d);
#if !defined(DISABLE_DIAG_DETECTION)
}else{e.r=0.0;}
#endif
}if(e.r>0.0){vec2 d;vec3 coords;coords.y=searchYUp(vOffset[1].xy,vOffset[2].z);coords.x=vOffset[0].x;d.x=coords.y;float e1=texture2D(inputBuffer,coords.xy).g;coords.z=searchYDown(vOffset[1].zw,vOffset[2].w);d.y=coords.z;d=round(resolution.yy*d-vPixCoord.yy);vec2 sqrtD=sqrt(abs(d));float e2=sampleLevelZeroOffset(inputBuffer,coords.xz,vec2(0,1)).g;weights.ba=area(sqrtD,e1,e2,subsampleIndices.x);coords.x=vUv.x;detectVerticalCornerPattern(weights.ba,coords.xyxz,d);}gl_FragColor=weights;}`,vertexShader:"uniform vec2 texelSize;uniform vec2 resolution;varying vec2 vUv;varying vec4 vOffset[3];varying vec2 vPixCoord;void main(){vUv=position.xy*0.5+0.5;vPixCoord=vUv*resolution;vOffset[0]=vUv.xyxy+texelSize.xyxy*vec4(-0.25,-0.125,1.25,-0.125);vOffset[1]=vUv.xyxy+texelSize.xyxy*vec4(-0.125,-0.25,-0.125,1.25);vOffset[2]=vec4(vOffset[0].xz,vOffset[1].yw)+vec4(-2.0,2.0,-2.0,2.0)*texelSize.xxyy*MAX_SEARCH_STEPS_FLOAT;gl_Position=vec4(position.xy,1.0,1.0);}",depthWrite:!1,depthTest:!1}))}return ye(m,C),pe(m,[{key:"setOrthogonalSearchSteps",value:function(l){l=ht(Re(l,0),112),this.defines.MAX_SEARCH_STEPS_INT=l.toFixed("0"),this.defines.MAX_SEARCH_STEPS_FLOAT=l.toFixed("1"),this.needsUpdate=!0}},{key:"setDiagonalSearchSteps",value:function(l){l=ht(Re(l,0),20),this.defines.MAX_SEARCH_STEPS_DIAG_INT=l.toFixed("0"),this.defines.MAX_SEARCH_STEPS_DIAG_FLOAT=l.toFixed("1"),this.needsUpdate=!0}},{key:"setCornerRounding",value:function(l){l=ht(Re(l,0),100),this.defines.CORNER_ROUNDING=l.toFixed("4"),this.defines.CORNER_ROUNDING_NORM=(l/100).toFixed("4"),this.needsUpdate=!0}},{key:"diagonalDetection",get:function(){return this.defines.DISABLE_DIAG_DETECTION===void 0},set:function(l){l?delete this.defines.DISABLE_DIAG_DETECTION:this.defines.DISABLE_DIAG_DETECTION="1",this.needsUpdate=!0}},{key:"cornerRounding",get:function(){return this.defines.DISABLE_CORNER_DETECTION===void 0},set:function(l){l?delete this.defines.DISABLE_CORNER_DETECTION:this.defines.DISABLE_CORNER_DETECTION="1",this.needsUpdate=!0}}]),m}(w.ShaderMaterial),ji=null,Ct=function(){function C(){var m=0<arguments.length&&arguments[0]!==void 0?arguments[0]:"Pass",l=1<arguments.length&&arguments[1]!==void 0?arguments[1]:new w.Scene,d=2<arguments.length&&arguments[2]!==void 0?arguments[2]:new w.OrthographicCamera(-1,1,1,-1,0,1);W(this,C),this.name=m,this.scene=l,this.camera=d,this.screen=null,this.needsSwap=!0,this.needsDepthTexture=!1,this.renderToScreen=!1,this.enabled=!0}return pe(C,[{key:"getFullscreenMaterial",value:function(){return this.screen===null?null:this.screen.material}},{key:"setFullscreenMaterial",value:function(m){var l=this.screen;l===null?(l=new w.Mesh(Gi(),m),l.frustumCulled=!1,this.scene===null&&(this.scene=new w.Scene),this.scene.add(l),this.screen=l):l.material=m}},{key:"getDepthTexture",value:function(){return null}},{key:"setDepthTexture",value:function(){}},{key:"render",value:function(){throw new Error("Render method not implemented!")}},{key:"setSize",value:function(){}},{key:"initialize",value:function(){}},{key:"dispose",value:function(){var m=this.getFullscreenMaterial();m!==null&&m.dispose();for(var l,d=0,g=Object.keys(this);d<g.length;d++)l=g[d],this[l]!==null&&typeof this[l].dispose=="function"&&this[l].dispose()}}]),C}(),en=-1,Gt=function(C){function m(){var l,d=0<arguments.length&&arguments[0]!==void 0?arguments[0]:{},g=d.resolutionScale,A=g===void 0?.5:g,S=d.width,R=S===void 0?en:S,D=d.height,I=D===void 0?en:D,k=d.kernelSize,q=k===void 0?Si.LARGE:k;return W(this,m),l=ie(this,de(m).call(this,"BlurPass")),l.renderTargetX=new w.WebGLRenderTarget(1,1,{minFilter:w.LinearFilter,magFilter:w.LinearFilter,stencilBuffer:!1,depthBuffer:!1}),l.renderTargetX.texture.name="Blur.TargetX",l.renderTargetY=l.renderTargetX.clone(),l.renderTargetY.texture.name="Blur.TargetY",l.originalSize=new w.Vector2,l.resolution=new w.Vector2(R,I),l.resolutionScale=A,l.convolutionMaterial=new ti,l.ditheredConvolutionMaterial=new ti,l.ditheredConvolutionMaterial.dithering=!0,l.dithering=!1,l.kernelSize=q,l}return ye(m,C),pe(m,[{key:"getOriginalSize",value:function(){return this.originalSize}},{key:"getResolutionScale",value:function(){return this.resolutionScale}},{key:"setResolutionScale",value:function(l){this.resolutionScale=l,this.setSize(this.originalSize.x,this.originalSize.y)}},{key:"render",value:function(l,d,g){var A,S,R,D=this.scene,I=this.camera,k=this.renderTargetX,q=this.renderTargetY,Q=this.convolutionMaterial,xe=Q.uniforms,Me=Q.getKernel(),Ue=d;for(this.setFullscreenMaterial(Q),S=0,R=Me.length-1;S<R;++S)A=S%2==0?k:q,xe.kernel.value=Me[S],xe.inputBuffer.value=Ue.texture,l.setRenderTarget(A),l.render(D,I),Ue=A;this.dithering&&(Q=this.ditheredConvolutionMaterial,xe=Q.uniforms,this.setFullscreenMaterial(Q)),xe.kernel.value=Me[S],xe.inputBuffer.value=Ue.texture,l.setRenderTarget(this.renderToScreen?null:g),l.render(D,I)}},{key:"setSize",value:function(l,d){var g=this.resolution,A=l/d;this.originalSize.set(l,d),g.x!==en&&g.y!==en?(l=Re(1,g.x),d=Re(1,g.y)):g.x===en?g.y===en?(l=Re(1,Ae(l*this.resolutionScale)),d=Re(1,Ae(d*this.resolutionScale))):(l=Ae(Re(1,g.y)*A),d=Re(1,g.y)):(l=Re(1,g.x),d=Ae(Re(1,g.y)/A)),this.renderTargetX.setSize(l,d),this.renderTargetY.setSize(l,d),this.convolutionMaterial.setTexelSize(1/l,1/d),this.ditheredConvolutionMaterial.setTexelSize(1/l,1/d)}},{key:"initialize",value:function(l,d){d||(this.renderTargetX.texture.format=w.RGBFormat,this.renderTargetY.texture.format=w.RGBFormat)}},{key:"width",get:function(){return this.renderTargetX.width},set:function(l){this.resolution.x=l,this.setSize(this.originalSize.x,this.originalSize.y)}},{key:"height",get:function(){return this.renderTargetX.height},set:function(l){this.resolution.y=l,this.setSize(this.originalSize.x,this.originalSize.y)}},{key:"scale",get:function(){return this.convolutionMaterial.uniforms.scale.value},set:function(l){this.convolutionMaterial.uniforms.scale.value=l,this.ditheredConvolutionMaterial.uniforms.scale.value=l}},{key:"kernelSize",get:function(){return this.convolutionMaterial.kernelSize},set:function(l){this.convolutionMaterial.kernelSize=l,this.ditheredConvolutionMaterial.kernelSize=l}}],[{key:"AUTO_SIZE",get:function(){return en}}]),m}(Ct),ii=function(C){function m(){var l;return W(this,m),l=ie(this,de(m).call(this,"ClearMaskPass",null,null)),l.needsSwap=!1,l}return ye(m,C),pe(m,[{key:"render",value:function(l){var d=l.state.buffers.stencil;d.setLocked(!1),d.setTest(!1)}}]),m}(Ct),Qt=new w.Color,Tt=function(C){function m(){var l,d=!(0<arguments.length&&arguments[0]!==void 0)||arguments[0],g=!(1<arguments.length&&arguments[1]!==void 0)||arguments[1],A=2<arguments.length&&arguments[2]!==void 0&&arguments[2];return W(this,m),l=ie(this,de(m).call(this,"ClearPass",null,null)),l.needsSwap=!1,l.color=d,l.depth=g,l.stencil=A,l.overrideClearColor=null,l.overrideClearAlpha=-1,l}return ye(m,C),pe(m,[{key:"render",value:function(l,d){var g=this.overrideClearColor,A=this.overrideClearAlpha,S=l.getClearAlpha(),R=g!==null,D=0<=A;R?(Qt.copy(l.getClearColor()),l.setClearColor(g,D?A:S)):D&&l.setClearAlpha(A),l.setRenderTarget(this.renderToScreen?null:d),l.clear(this.color,this.depth,this.stencil),R?l.setClearColor(Qt,S):D&&l.setClearAlpha(S)}}]),m}(Ct),gn=function(C){function m(l,d){var g,A=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;return W(this,m),g=ie(this,de(m).call(this,"RenderPass",l,d)),g.needsSwap=!1,g.overrideMaterial=A,g.clearPass=new Tt,g.depthTexture=null,g}return ye(m,C),pe(m,[{key:"getClearPass",value:function(){return this.clearPass}},{key:"getDepthTexture",value:function(){return this.depthTexture}},{key:"setDepthTexture",value:function(l){this.depthTexture=l}},{key:"render",value:function(l,d,g){var A=this.scene,S=this.renderToScreen?null:d,R=A.overrideMaterial;this.depthTexture===null||this.renderToScreen||(d.depthTexture=this.depthTexture,g.depthTexture=null),this.clear&&(this.clearPass.renderToScreen=this.renderToScreen,this.clearPass.render(l,d)),A.overrideMaterial=this.overrideMaterial,l.setRenderTarget(S),l.render(A,this.camera),A.overrideMaterial=R}},{key:"clear",get:function(){return this.clearPass.enabled},set:function(l){this.clearPass.enabled=l}}]),m}(Ct),Ls=function(C){function m(l,d){var g,A=2<arguments.length&&arguments[2]!==void 0?arguments[2]:{},S=A.resolutionScale,R=S===void 0?1:S,D=A.renderTarget;W(this,m),g=ie(this,de(m).call(this,"DepthPass")),g.needsSwap=!1,g.renderPass=new gn(l,d,new w.MeshDepthMaterial({depthPacking:w.RGBADepthPacking,morphTargets:!0,skinning:!0}));var I=g.renderPass.getClearPass();return I.overrideClearColor=new w.Color(16777215),I.overrideClearAlpha=1,g.renderTarget=D,g.renderTarget===void 0&&(g.renderTarget=new w.WebGLRenderTarget(1,1,{minFilter:w.LinearFilter,magFilter:w.LinearFilter,stencilBuffer:!1}),g.renderTarget.texture.name="DepthPass.Target"),g.resolutionScale=R,g.originalSize=new w.Vector2,g}return ye(m,C),pe(m,[{key:"getResolutionScale",value:function(){return this.resolutionScale}},{key:"setResolutionScale",value:function(l){this.resolutionScale=l,this.setSize(this.originalSize.x,this.originalSize.y)}},{key:"render",value:function(l){var d=this.renderToScreen?null:this.renderTarget;this.renderPass.render(l,d)}},{key:"setSize",value:function(l,d){this.originalSize.set(l,d),this.renderTarget.setSize(Re(1,Ae(l*this.resolutionScale)),Re(1,Ae(d*this.resolutionScale)))}}]),m}(Ct),Ne={SKIP:0,ADD:1,ALPHA:2,AVERAGE:3,COLOR_BURN:4,COLOR_DODGE:5,DARKEN:6,DIFFERENCE:7,EXCLUSION:8,LIGHTEN:9,MULTIPLY:10,DIVIDE:11,NEGATION:12,NORMAL:13,OVERLAY:14,REFLECT:15,SCREEN:16,SOFT_LIGHT:17,SUBTRACT:18},$a=new Map([[Ne.SKIP,null],[Ne.ADD,"vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return min(x+y,1.0)*opacity+x*(1.0-opacity);}"],[Ne.ALPHA,"vec3 blend(const in vec3 x,const in vec3 y,const in float opacity){return y*opacity+x*(1.0-opacity);}vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){float a=min(y.a,opacity);return vec4(blend(x.rgb,y.rgb,a),max(x.a,a));}"],[Ne.AVERAGE,"vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return(x+y)*0.5*opacity+x*(1.0-opacity);}"],[Ne.COLOR_BURN,"float blend(const in float x,const in float y){return(y==0.0)? y : max(1.0-(1.0-x)/y,0.0);}vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 z=vec4(blend(x.r,y.r),blend(x.g,y.g),blend(x.b,y.b),blend(x.a,y.a));return z*opacity+x*(1.0-opacity);}"],[Ne.COLOR_DODGE,"float blend(const in float x,const in float y){return(y==1.0)? y : min(x/(1.0-y),1.0);}vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 z=vec4(blend(x.r,y.r),blend(x.g,y.g),blend(x.b,y.b),blend(x.a,y.a));return z*opacity+x*(1.0-opacity);}"],[Ne.DARKEN,"vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return min(x,y)*opacity+x*(1.0-opacity);}"],[Ne.DIFFERENCE,"vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return abs(x-y)*opacity+x*(1.0-opacity);}"],[Ne.EXCLUSION,"vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return(x+y-2.0*x*y)*opacity+x*(1.0-opacity);}"],[Ne.LIGHTEN,"vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return max(x,y)*opacity+x*(1.0-opacity);}"],[Ne.MULTIPLY,"vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return x*y*opacity+x*(1.0-opacity);}"],[Ne.DIVIDE,"float blend(const in float x,const in float y){return(y>0.0)? min(x/y,1.0): 1.0;}vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 z=vec4(blend(x.r,y.r),blend(x.g,y.g),blend(x.b,y.b),blend(x.a,y.a));return z*opacity+x*(1.0-opacity);}"],[Ne.NEGATION,"vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return(1.0-abs(1.0-x-y))*opacity+x*(1.0-opacity);}"],[Ne.NORMAL,"vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return y*opacity+x*(1.0-opacity);}"],[Ne.OVERLAY,"float blend(const in float x,const in float y){return(x<0.5)?(2.0*x*y):(1.0-2.0*(1.0-x)*(1.0-y));}vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 z=vec4(blend(x.r,y.r),blend(x.g,y.g),blend(x.b,y.b),blend(x.a,y.a));return z*opacity+x*(1.0-opacity);}"],[Ne.REFLECT,"float blend(const in float x,const in float y){return(y==1.0)? y : min(x*x/(1.0-y),1.0);}vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 z=vec4(blend(x.r,y.r),blend(x.g,y.g),blend(x.b,y.b),blend(x.a,y.a));return z*opacity+x*(1.0-opacity);}"],[Ne.SCREEN,"vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return(1.0-(1.0-x)*(1.0-y))*opacity+x*(1.0-opacity);}"],[Ne.SOFT_LIGHT,"float blend(const in float x,const in float y){return(y<0.5)?(2.0*x*y+x*x*(1.0-2.0*y)):(sqrt(x)*(2.0*y-1.0)+2.0*x*(1.0-y));}vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 z=vec4(blend(x.r,y.r),blend(x.g,y.g),blend(x.b,y.b),blend(x.a,y.a));return z*opacity+x*(1.0-opacity);}"],[Ne.SUBTRACT,"vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return max(x+y-1.0,0.0)*opacity+x*(1.0-opacity);}"]]),Ps=function(){function C(m){var l=1<arguments.length&&arguments[1]!==void 0?arguments[1]:1;W(this,C),this.blendFunction=m,this.opacity=new w.Uniform(l)}return pe(C,[{key:"getShaderCode",value:function(){return $a.get(this.blendFunction)}}]),C}(),dt=function(){function C(m,l){var d=2<arguments.length&&arguments[2]!==void 0?arguments[2]:{},g=d.attributes,A=g===void 0?Dt.NONE:g,S=d.blendFunction,R=S===void 0?Ne.SCREEN:S,D=d.defines,I=D===void 0?new Map:D,k=d.uniforms,q=k===void 0?new Map:k,Q=d.extensions,xe=Q===void 0?null:Q,Me=d.vertexShader,Ue=Me===void 0?null:Me;W(this,C),this.name=m,this.attributes=A,this.fragmentShader=l,this.vertexShader=Ue,this.defines=I,this.uniforms=q,this.extensions=xe,this.blendMode=new Ps(R)}return pe(C,[{key:"setDepthTexture",value:function(){}},{key:"update",value:function(){}},{key:"setSize",value:function(){}},{key:"initialize",value:function(){}},{key:"dispose",value:function(){for(var m,l=0,d=Object.keys(this);l<d.length;l++)m=d[l],this[m]!==null&&typeof this[m].dispose=="function"&&this[m].dispose()}}]),C}(),Dt={CONVOLUTION:2,DEPTH:1,NONE:0},ec=function(C){function m(l){var d;W(this,m),d=ie(this,de(m).call(this,"EffectPass")),d.setFullscreenMaterial(new Ss(null,null,null,l));for(var g=arguments.length,A=Array(1<g?g-1:0),S=1;S<g;S++)A[S-1]=arguments[S];return d.effects=A.sort(function(R,D){return D.attributes-R.attributes}),d.skipRendering=!1,d.uniforms=0,d.varyings=0,d.minTime=1,d.maxTime=1e3,d}return ye(m,C),pe(m,[{key:"updateMaterial",value:function(){var l,d=/\bblend\b/g,g=new Map([[rt.FRAGMENT_HEAD,""],[rt.FRAGMENT_MAIN_UV,""],[rt.FRAGMENT_MAIN_IMAGE,""],[rt.VERTEX_HEAD,""],[rt.VERTEX_MAIN_SUPPORT,""]]),A=new Map,S=new Map,R=new Map,D=new Set,I=0,k=0,q=0,Q=!1,xe=!1,Me=!0,Ue=!1,Qe=void 0;try{for(var at,tt,xt=this.effects[Symbol.iterator]();!(Me=(at=xt.next()).done);Me=!0)if(tt=at.value,tt.blendMode.blendFunction===Ne.SKIP)q|=tt.attributes&Dt.DEPTH;else if(q&Dt.CONVOLUTION&&tt.attributes&Dt.CONVOLUTION)console.error("Convolution effects cannot be merged",tt);else if(q|=tt.attributes,l=Hi("e"+I++,tt,g,A,S,R,q),k+=l.varyings.length,Q=Q||l.transformedUv,xe=xe||l.readDepth,tt.extensions!==null){var ct=!0,gt=!1,wt=void 0;try{for(var kt,Bt,Ot=tt.extensions[Symbol.iterator]();!(ct=(kt=Ot.next()).done);ct=!0)Bt=kt.value,D.add(Bt)}catch(qt){gt=!0,wt=qt}finally{try{ct||Ot.return==null||Ot.return()}finally{if(gt)throw wt}}}}catch(qt){Ue=!0,Qe=qt}finally{try{Me||xt.return==null||xt.return()}finally{if(Ue)throw Qe}}var Lt=!0,tn=!1,pn=void 0;try{for(var Ft,$e,At=A.values()[Symbol.iterator]();!(Lt=(Ft=At.next()).done);Lt=!0)$e=Ft.value,g.set(rt.FRAGMENT_HEAD,g.get(rt.FRAGMENT_HEAD)+$e.getShaderCode().replace(d,"blend"+$e.blendFunction)+`
`)}catch(qt){tn=!0,pn=qt}finally{try{Lt||At.return==null||At.return()}finally{if(tn)throw pn}}q&Dt.DEPTH&&(xe&&g.set(rt.FRAGMENT_MAIN_IMAGE,`float depth = readDepth(UV);

	`+g.get(rt.FRAGMENT_MAIN_IMAGE)),this.needsDepthTexture=this.getDepthTexture()===null),Q?(g.set(rt.FRAGMENT_MAIN_UV,`vec2 transformedUv = vUv;
`+g.get(rt.FRAGMENT_MAIN_UV)),S.set("UV","transformedUv")):S.set("UV","vUv"),g.forEach(function(qt,Xi,Li){return Li.set(Xi,qt.trim())}),this.uniforms=R.size,this.varyings=k,this.skipRendering=I===0,this.needsSwap=!this.skipRendering;var ot=this.getFullscreenMaterial();if(ot.setShaderParts(g).setDefines(S).setUniforms(R),ot.extensions={},0<D.size){var Ci=!0,nn=!1,oi=void 0;try{for(var Lr,Pr,Un=D[Symbol.iterator]();!(Ci=(Lr=Un.next()).done);Ci=!0)Pr=Lr.value,ot.extensions[Pr]=!0}catch(qt){nn=!0,oi=qt}finally{try{Ci||Un.return==null||Un.return()}finally{if(nn)throw oi}}}}},{key:"recompile",value:function(){this.updateMaterial()}},{key:"getDepthTexture",value:function(){return this.getFullscreenMaterial().uniforms.depthBuffer.value}},{key:"setDepthTexture",value:function(l){var d=1<arguments.length&&arguments[1]!==void 0?arguments[1]:0,g=this.getFullscreenMaterial();g.uniforms.depthBuffer.value=l,g.depthPacking=d,g.needsUpdate=!0;var A=!0,S=!1,R=void 0;try{for(var D,I,k=this.effects[Symbol.iterator]();!(A=(D=k.next()).done);A=!0)I=D.value,I.setDepthTexture(l,d)}catch(q){S=!0,R=q}finally{try{A||k.return==null||k.return()}finally{if(S)throw R}}}},{key:"render",value:function(l,d,g,A){var S=this.getFullscreenMaterial(),R=S.uniforms.time.value+A,D=!0,I=!1,k=void 0;try{for(var q,Q,xe=this.effects[Symbol.iterator]();!(D=(q=xe.next()).done);D=!0)Q=q.value,Q.update(l,d,A)}catch(Me){I=!0,k=Me}finally{try{D||xe.return==null||xe.return()}finally{if(I)throw k}}(!this.skipRendering||this.renderToScreen)&&(S.uniforms.inputBuffer.value=d.texture,S.uniforms.time.value=R<=this.maxTime?R:this.minTime,l.setRenderTarget(this.renderToScreen?null:g),l.render(this.scene,this.camera))}},{key:"setSize",value:function(l,d){this.getFullscreenMaterial().setSize(l,d);var g=!0,A=!1,S=void 0;try{for(var R,D,I=this.effects[Symbol.iterator]();!(g=(R=I.next()).done);g=!0)D=R.value,D.setSize(l,d)}catch(k){A=!0,S=k}finally{try{g||I.return==null||I.return()}finally{if(A)throw S}}}},{key:"initialize",value:function(l,d){var g=!0,A=!1,S=void 0;try{for(var R,D,I=this.effects[Symbol.iterator]();!(g=(R=I.next()).done);g=!0)D=R.value,D.initialize(l,d)}catch(Q){A=!0,S=Q}finally{try{g||I.return==null||I.return()}finally{if(A)throw S}}this.updateMaterial();var k=l.capabilities,q=ht(k.maxFragmentUniforms,k.maxVertexUniforms);this.uniforms>q&&console.warn("The current rendering context doesn't support more than "+q+" uniforms, but "+this.uniforms+" were defined"),q=k.maxVaryings,this.varyings>q&&console.warn("The current rendering context doesn't support more than "+q+" varyings, but "+this.varyings+" were defined")}},{key:"dispose",value:function(){Ce(de(m.prototype),"dispose",this).call(this);var l=!0,d=!1,g=void 0;try{for(var A,S,R=this.effects[Symbol.iterator]();!(l=(A=R.next()).done);l=!0)S=A.value,S.dispose()}catch(D){d=!0,g=D}finally{try{l||R.return==null||R.return()}finally{if(d)throw g}}}},{key:"size",get:function(){return this.getFullscreenMaterial().uniforms.resolution.value}},{key:"dithering",get:function(){return this.getFullscreenMaterial().dithering},set:function(l){var d=this.getFullscreenMaterial();d.dithering!==l&&(d.dithering=l,d.needsUpdate=!0)}}]),m}(Ct),bs=function(C){function m(l,d){var g;return W(this,m),g=ie(this,de(m).call(this,"MaskPass",l,d)),g.needsSwap=!1,g.clearPass=new Tt(!1,!1,!0),g.inverse=!1,g}return ye(m,C),pe(m,[{key:"render",value:function(l,d,g){var A=l.getContext(),S=l.state.buffers,R=this.scene,D=this.camera,I=this.clearPass,k=this.inverse?0:1;S.color.setMask(!1),S.depth.setMask(!1),S.color.setLocked(!0),S.depth.setLocked(!0),S.stencil.setTest(!0),S.stencil.setOp(A.REPLACE,A.REPLACE,A.REPLACE),S.stencil.setFunc(A.ALWAYS,k,4294967295),S.stencil.setClear(1-k),S.stencil.setLocked(!0),this.clear&&(this.renderToScreen?I.render(l,null):(I.render(l,d),I.render(l,g))),this.renderToScreen?(l.setRenderTarget(null),l.render(R,D)):(l.setRenderTarget(d),l.render(R,D),l.setRenderTarget(g),l.render(R,D)),S.color.setLocked(!1),S.depth.setLocked(!1),S.stencil.setLocked(!1),S.stencil.setFunc(A.EQUAL,1,4294967295),S.stencil.setOp(A.KEEP,A.KEEP,A.KEEP),S.stencil.setLocked(!0)}},{key:"clear",get:function(){return this.clearPass.enabled},set:function(l){this.clearPass.enabled=l}}]),m}(Ct),tc=function(C){function m(l,d){var g,A=2<arguments.length&&arguments[2]!==void 0?arguments[2]:{},S=A.resolutionScale,R=S===void 0?1:S,D=A.renderTarget;W(this,m),g=ie(this,de(m).call(this,"NormalPass")),g.needsSwap=!1,g.renderPass=new gn(l,d,new w.MeshNormalMaterial({morphTargets:!0,skinning:!0}));var I=g.renderPass.getClearPass();return I.overrideClearColor=new w.Color(7829503),I.overrideClearAlpha=1,g.renderTarget=D,g.renderTarget===void 0&&(g.renderTarget=new w.WebGLRenderTarget(1,1,{minFilter:w.LinearFilter,magFilter:w.LinearFilter,format:w.RGBFormat,stencilBuffer:!1}),g.renderTarget.texture.name="NormalPass.Target"),g.resolutionScale=R,g.originalSize=new w.Vector2,g}return ye(m,C),pe(m,[{key:"getResolutionScale",value:function(){return this.resolutionScale}},{key:"setResolutionScale",value:function(l){this.resolutionScale=l,this.setSize(this.originalSize.x,this.originalSize.y)}},{key:"render",value:function(l){var d=this.renderToScreen?null:this.renderTarget;this.renderPass.render(l,d,d)}},{key:"setSize",value:function(l,d){this.originalSize.set(l,d),this.renderTarget.setSize(Re(1,Ae(l*this.resolutionScale)),Re(1,Ae(d*this.resolutionScale)))}}]),m}(Ct),Rs=function(C){function m(l){var d,g=!(1<arguments.length&&arguments[1]!==void 0)||arguments[1];return W(this,m),d=ie(this,de(m).call(this,"SavePass")),d.setFullscreenMaterial(new Tr),d.needsSwap=!1,d.renderTarget=l,l===void 0&&(d.renderTarget=new w.WebGLRenderTarget(1,1,{minFilter:w.LinearFilter,magFilter:w.LinearFilter,stencilBuffer:!1,depthBuffer:!1}),d.renderTarget.texture.name="SavePass.Target"),d.resize=g,d}return ye(m,C),pe(m,[{key:"render",value:function(l,d){this.getFullscreenMaterial().uniforms.inputBuffer.value=d.texture,l.setRenderTarget(this.renderToScreen?null:this.renderTarget),l.render(this.scene,this.camera)}},{key:"setSize",value:function(l,d){this.resize&&(l=Re(1,l),d=Re(1,d),this.renderTarget.setSize(l,d))}}]),m}(Ct),sn=function(C){function m(l){var d,g=1<arguments.length&&arguments[1]!==void 0?arguments[1]:"inputBuffer";return W(this,m),d=ie(this,de(m).call(this,"ShaderPass")),d.setFullscreenMaterial(l),d.uniform=null,d.setInput(g),d}return ye(m,C),pe(m,[{key:"setInput",value:function(l){var d=this.getFullscreenMaterial();if(this.uniform=null,d!==null){var g=d.uniforms;g!==void 0&&g[l]!==void 0&&(this.uniform=g[l])}}},{key:"render",value:function(l,d,g){this.uniform!==null&&(this.uniform.value=d.texture),l.setRenderTarget(this.renderToScreen?null:g),l.render(this.scene,this.camera)}}]),m}(Ct),nc=function(){function C(){var m=0<arguments.length&&arguments[0]!==void 0?arguments[0]:null,l=1<arguments.length&&arguments[1]!==void 0?arguments[1]:{},d=l.depthBuffer,g=l.stencilBuffer;W(this,C),this.renderer=m,this.inputBuffer=null,this.outputBuffer=null,this.renderer!==null&&(this.renderer.autoClear=!1,this.inputBuffer=this.createBuffer(d===void 0||d,g!==void 0&&g),this.outputBuffer=this.inputBuffer.clone()),this.copyPass=new sn(new Tr),this.depthTexture=null,this.passes=[]}return pe(C,[{key:"getRenderer",value:function(){return this.renderer}},{key:"replaceRenderer",value:function(m){var l=!(1<arguments.length&&arguments[1]!==void 0)||arguments[1],d=this.renderer;if(d!==null&&d!==m){var g=d.getSize(new w.Vector2),A=m.getSize(new w.Vector2),S=d.domElement.parentNode;this.renderer=m,this.renderer.autoClear=!1,g.equals(A)||this.setSize(),l&&S!==null&&(S.removeChild(d.domElement),S.appendChild(m.domElement))}return d}},{key:"createDepthTexture",value:function(){var m=this.depthTexture=new w.DepthTexture;return this.inputBuffer.stencilBuffer&&(m.format=w.DepthStencilFormat,m.type=w.UnsignedInt248Type),m}},{key:"createBuffer",value:function(m,l){var d=this.renderer.getDrawingBufferSize(new w.Vector2),g=this.renderer.getContext().getContextAttributes().alpha,A=new w.WebGLRenderTarget(d.width,d.height,{minFilter:w.LinearFilter,magFilter:w.LinearFilter,format:g?w.RGBAFormat:w.RGBFormat,depthBuffer:m,stencilBuffer:l});return A.texture.name="EffectComposer.Buffer",A.texture.generateMipmaps=!1,A}},{key:"addPass",value:function(m,l){var d=this.passes,g=this.renderer,A=g.getDrawingBufferSize(new w.Vector2);if(m.setSize(A.width,A.height),m.initialize(g,g.getContext().getContextAttributes().alpha),l===void 0?d.push(m):d.splice(l,0,m),m.needsDepthTexture||this.depthTexture!==null)if(this.depthTexture===null){var S=this.createDepthTexture(),R=!0,D=!1,I=void 0;try{for(var k,q=d[Symbol.iterator]();!(R=(k=q.next()).done);R=!0)m=k.value,m.setDepthTexture(S)}catch(Q){D=!0,I=Q}finally{try{R||q.return==null||q.return()}finally{if(D)throw I}}}else m.setDepthTexture(this.depthTexture)}},{key:"removePass",value:function(m){var l=this.passes,d=0<l.splice(l.indexOf(m),1).length;if(d&&this.depthTexture!==null){var g=function(q,Q){return q||Q.needsDepthTexture},A=l.reduce(g,!1);if(!A){this.depthTexture.dispose(),this.depthTexture=null,this.inputBuffer.depthTexture=null,this.outputBuffer.depthTexture=null;var S=!0,R=!1,D=void 0;try{for(var I,k=l[Symbol.iterator]();!(S=(I=k.next()).done);S=!0)m=I.value,m.setDepthTexture(null)}catch(q){R=!0,D=q}finally{try{S||k.return==null||k.return()}finally{if(R)throw D}}}}}},{key:"render",value:function(m){var l,d,g,A=this.renderer,S=this.copyPass,R=this.inputBuffer,D=this.outputBuffer,I=!1,k=!0,q=!1,Q=void 0;try{for(var xe,Me,Ue=this.passes[Symbol.iterator]();!(k=(xe=Ue.next()).done);k=!0)Me=xe.value,Me.enabled&&(Me.render(A,R,D,m,I),Me.needsSwap&&(I&&(S.renderToScreen=Me.renderToScreen,l=A.getContext(),d=A.state.buffers.stencil,d.setFunc(l.NOTEQUAL,1,4294967295),S.render(A,R,D,m,I),d.setFunc(l.EQUAL,1,4294967295)),g=R,R=D,D=g),Me instanceof bs?I=!0:Me instanceof ii&&(I=!1))}catch(Qe){q=!0,Q=Qe}finally{try{k||Ue.return==null||Ue.return()}finally{if(q)throw Q}}}},{key:"setSize",value:function(m,l,d){var g=this.renderer;if(m===void 0||l===void 0){var A=g.getSize(new w.Vector2);m=A.width,l=A.height}g.setSize(m,l,d);var S=g.getDrawingBufferSize(new w.Vector2);this.inputBuffer.setSize(S.width,S.height),this.outputBuffer.setSize(S.width,S.height);var R=!0,D=!1,I=void 0;try{for(var k,q,Q=this.passes[Symbol.iterator]();!(R=(k=Q.next()).done);R=!0)q=k.value,q.setSize(S.width,S.height)}catch(xe){D=!0,I=xe}finally{try{R||Q.return==null||Q.return()}finally{if(D)throw I}}}},{key:"reset",value:function(){var m=this.createBuffer(this.inputBuffer.depthBuffer,this.inputBuffer.stencilBuffer);this.dispose(),this.inputBuffer=m,this.outputBuffer=m.clone(),this.depthTexture=null,this.copyPass=new sn(new Tr)}},{key:"dispose",value:function(){var m=!0,l=!1,d=void 0;try{for(var g,A,S=this.passes[Symbol.iterator]();!(m=(g=S.next()).done);m=!0)A=g.value,A.dispose()}catch(R){l=!0,d=R}finally{try{m||S.return==null||S.return()}finally{if(l)throw d}}this.passes=[],this.inputBuffer!==null&&(this.inputBuffer.dispose(),this.inputBuffer=null),this.outputBuffer!==null&&(this.outputBuffer.dispose(),this.outputBuffer=null),this.depthTexture!==null&&this.depthTexture.dispose(),this.copyPass.dispose()}}]),C}(),ic=function(){function C(){W(this,C)}return pe(C,[{key:"setSize",value:function(){}}]),C}(),So=function(C){function m(l){var d,g=1<arguments.length&&arguments[1]!==void 0?arguments[1]:10;return W(this,m),d=ie(this,de(m).call(this)),d.currentLayer=g,l!==void 0&&d.set(l),d}return ye(m,C),pe(m,[{key:"clear",value:function(){var l=this.layer,d=!0,g=!1,A=void 0;try{for(var S,R,D=this[Symbol.iterator]();!(d=(S=D.next()).done);d=!0)R=S.value,R.layers.disable(l)}catch(I){g=!0,A=I}finally{try{d||D.return==null||D.return()}finally{if(g)throw A}}return Ce(de(m.prototype),"clear",this).call(this)}},{key:"set",value:function(l){this.clear();var d=!0,g=!1,A=void 0;try{for(var S,R,D=l[Symbol.iterator]();!(d=(S=D.next()).done);d=!0)R=S.value,this.add(R)}catch(I){g=!0,A=I}finally{try{d||D.return==null||D.return()}finally{if(g)throw A}}return this}},{key:"indexOf",value:function(l){return this.has(l)?0:-1}},{key:"add",value:function(l){return l.layers.enable(this.layer),Ce(de(m.prototype),"add",this).call(this,l),this}},{key:"delete",value:function(l){return this.has(l)&&l.layers.disable(this.layer),Ce(de(m.prototype),"delete",this).call(this,l)}},{key:"setVisible",value:function(l){var d=!0,g=!1,A=void 0;try{for(var S,R,D=this[Symbol.iterator]();!(d=(S=D.next()).done);d=!0)R=S.value,l?R.layers.enable(0):R.layers.disable(0)}catch(I){g=!0,A=I}finally{try{d||D.return==null||D.return()}finally{if(g)throw A}}return this}},{key:"layer",get:function(){return this.currentLayer},set:function(l){var d=this.currentLayer,g=!0,A=!1,S=void 0;try{for(var R,D,I=this[Symbol.iterator]();!(g=(R=I.next()).done);g=!0)D=R.value,D.layers.disable(d),D.layers.enable(l)}catch(k){A=!0,S=k}finally{try{g||I.return==null||I.return()}finally{if(A)throw S}}this.currentLayer=l}}]),m}(zi(Set)),To=`uniform sampler2D texture;
#ifdef ASPECT_CORRECTION
varying vec2 vUv2;
#endif
void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){
#ifdef ASPECT_CORRECTION
outputColor=texture2D(texture,vUv2);
#else
outputColor=texture2D(texture,uv);
#endif
}`,Ds=function(C){function m(){var l,d=0<arguments.length&&arguments[0]!==void 0?arguments[0]:{},g=d.blendFunction,A=g===void 0?Ne.SCREEN:g,S=d.luminanceThreshold,R=S===void 0?.9:S,D=d.luminanceSmoothing,I=D===void 0?.025:D,k=d.resolutionScale,q=k===void 0?.5:k,Q=d.width,xe=Q===void 0?Gt.AUTO_SIZE:Q,Me=d.height,Ue=Me===void 0?Gt.AUTO_SIZE:Me,Qe=d.kernelSize,at=Qe===void 0?Si.LARGE:Qe;return W(this,m),l=ie(this,de(m).call(this,"BloomEffect",To,{blendFunction:A,uniforms:new Map([["texture",new w.Uniform(null)]])})),l.renderTarget=new w.WebGLRenderTarget(1,1,{minFilter:w.LinearFilter,magFilter:w.LinearFilter,stencilBuffer:!1,depthBuffer:!1}),l.renderTarget.texture.name="Bloom.Target",l.renderTarget.texture.generateMipmaps=!1,l.uniforms.get("texture").value=l.renderTarget.texture,l.blurPass=new Gt({resolutionScale:q,width:xe,height:Ue,kernelSize:at}),l.luminancePass=new sn(new Eo(!0)),l.luminanceMaterial.threshold=R,l.luminanceMaterial.smoothing=I,l}return ye(m,C),pe(m,[{key:"getResolutionScale",value:function(){return this.blurPass.getResolutionScale()}},{key:"setResolutionScale",value:function(l){var d=this.blurPass;d.setResolutionScale(l),this.renderTarget.setSize(d.width,d.height)}},{key:"update",value:function(l,d){var g=this.renderTarget;this.luminancePass.enabled?(this.luminancePass.render(l,d,g),this.blurPass.render(l,g,g)):this.blurPass.render(l,d,g)}},{key:"setSize",value:function(l,d){var g=this.blurPass;g.setSize(l,d),this.renderTarget.setSize(g.width,g.height)}},{key:"initialize",value:function(l,d){this.blurPass.initialize(l,d),d||(this.renderTarget.texture.format=w.RGBFormat)}},{key:"texture",get:function(){return this.renderTarget.texture}},{key:"luminanceMaterial",get:function(){return this.luminancePass.getFullscreenMaterial()}},{key:"width",get:function(){return this.blurPass.width},set:function(l){this.blurPass.width=l,this.renderTarget.setSize(this.width,this.height)}},{key:"height",get:function(){return this.blurPass.height},set:function(l){this.blurPass.height=l,this.renderTarget.setSize(this.width,this.height)}},{key:"dithering",get:function(){return this.blurPass.dithering},set:function(l){this.blurPass.dithering=l}},{key:"kernelSize",get:function(){return this.blurPass.kernelSize},set:function(l){this.blurPass.kernelSize=l}},{key:"distinction",get:function(){return console.warn(this.name,"The distinction field has been removed, use luminanceMaterial.threshold and luminanceMaterial.smoothing instead."),1},set:function(){console.warn(this.name,"The distinction field has been removed, use luminanceMaterial.threshold and luminanceMaterial.smoothing instead.")}}]),m}(dt),rc=function(C){function m(){var l=0<arguments.length&&arguments[0]!==void 0?arguments[0]:{},d=l.blendFunction,g=d===void 0?Ne.NORMAL:d,A=l.focus,S=A===void 0?.5:A,R=l.dof,D=R===void 0?.02:R,I=l.aperture,k=I===void 0?.015:I,q=l.maxBlur,Q=q===void 0?1:q;return W(this,m),ie(this,de(m).call(this,"BokehEffect","uniform float focus;uniform float dof;uniform float aperture;uniform float maxBlur;void mainImage(const in vec4 inputColor,const in vec2 uv,const in float depth,out vec4 outputColor){vec2 aspectCorrection=vec2(1.0,aspect);float focusNear=clamp(focus-dof,0.0,1.0);float focusFar=clamp(focus+dof,0.0,1.0);float low=step(depth,focusNear);float high=step(focusFar,depth);float factor=(depth-focusNear)*low+(depth-focusFar)*high;vec2 dofBlur=vec2(clamp(factor*aperture,-maxBlur,maxBlur));vec2 dofblur9=dofBlur*0.9;vec2 dofblur7=dofBlur*0.7;vec2 dofblur4=dofBlur*0.4;vec4 color=inputColor;color+=texture2D(inputBuffer,uv+(vec2(0.0,0.4)*aspectCorrection)*dofBlur);color+=texture2D(inputBuffer,uv+(vec2(0.15,0.37)*aspectCorrection)*dofBlur);color+=texture2D(inputBuffer,uv+(vec2(0.29,0.29)*aspectCorrection)*dofBlur);color+=texture2D(inputBuffer,uv+(vec2(-0.37,0.15)*aspectCorrection)*dofBlur);color+=texture2D(inputBuffer,uv+(vec2(0.40,0.0)*aspectCorrection)*dofBlur);color+=texture2D(inputBuffer,uv+(vec2(0.37,-0.15)*aspectCorrection)*dofBlur);color+=texture2D(inputBuffer,uv+(vec2(0.29,-0.29)*aspectCorrection)*dofBlur);color+=texture2D(inputBuffer,uv+(vec2(-0.15,-0.37)*aspectCorrection)*dofBlur);color+=texture2D(inputBuffer,uv+(vec2(0.0,-0.4)*aspectCorrection)*dofBlur);color+=texture2D(inputBuffer,uv+(vec2(-0.15,0.37)*aspectCorrection)*dofBlur);color+=texture2D(inputBuffer,uv+(vec2(-0.29,0.29)*aspectCorrection)*dofBlur);color+=texture2D(inputBuffer,uv+(vec2(0.37,0.15)*aspectCorrection)*dofBlur);color+=texture2D(inputBuffer,uv+(vec2(-0.4,0.0)*aspectCorrection)*dofBlur);color+=texture2D(inputBuffer,uv+(vec2(-0.37,-0.15)*aspectCorrection)*dofBlur);color+=texture2D(inputBuffer,uv+(vec2(-0.29,-0.29)*aspectCorrection)*dofBlur);color+=texture2D(inputBuffer,uv+(vec2(0.15,-0.37)*aspectCorrection)*dofBlur);color+=texture2D(inputBuffer,uv+(vec2(0.15,0.37)*aspectCorrection)*dofblur9);color+=texture2D(inputBuffer,uv+(vec2(-0.37,0.15)*aspectCorrection)*dofblur9);color+=texture2D(inputBuffer,uv+(vec2(0.37,-0.15)*aspectCorrection)*dofblur9);color+=texture2D(inputBuffer,uv+(vec2(-0.15,-0.37)*aspectCorrection)*dofblur9);color+=texture2D(inputBuffer,uv+(vec2(-0.15,0.37)*aspectCorrection)*dofblur9);color+=texture2D(inputBuffer,uv+(vec2(0.37,0.15)*aspectCorrection)*dofblur9);color+=texture2D(inputBuffer,uv+(vec2(-0.37,-0.15)*aspectCorrection)*dofblur9);color+=texture2D(inputBuffer,uv+(vec2(0.15,-0.37)*aspectCorrection)*dofblur9);color+=texture2D(inputBuffer,uv+(vec2(0.29,0.29)*aspectCorrection)*dofblur7);color+=texture2D(inputBuffer,uv+(vec2(0.40,0.0)*aspectCorrection)*dofblur7);color+=texture2D(inputBuffer,uv+(vec2(0.29,-0.29)*aspectCorrection)*dofblur7);color+=texture2D(inputBuffer,uv+(vec2(0.0,-0.4)*aspectCorrection)*dofblur7);color+=texture2D(inputBuffer,uv+(vec2(-0.29,0.29)*aspectCorrection)*dofblur7);color+=texture2D(inputBuffer,uv+(vec2(-0.4,0.0)*aspectCorrection)*dofblur7);color+=texture2D(inputBuffer,uv+(vec2(-0.29,-0.29)*aspectCorrection)*dofblur7);color+=texture2D(inputBuffer,uv+(vec2(0.0,0.4)*aspectCorrection)*dofblur7);color+=texture2D(inputBuffer,uv+(vec2(0.29,0.29)*aspectCorrection)*dofblur4);color+=texture2D(inputBuffer,uv+(vec2(0.4,0.0)*aspectCorrection)*dofblur4);color+=texture2D(inputBuffer,uv+(vec2(0.29,-0.29)*aspectCorrection)*dofblur4);color+=texture2D(inputBuffer,uv+(vec2(0.0,-0.4)*aspectCorrection)*dofblur4);color+=texture2D(inputBuffer,uv+(vec2(-0.29,0.29)*aspectCorrection)*dofblur4);color+=texture2D(inputBuffer,uv+(vec2(-0.4,0.0)*aspectCorrection)*dofblur4);color+=texture2D(inputBuffer,uv+(vec2(-0.29,-0.29)*aspectCorrection)*dofblur4);color+=texture2D(inputBuffer,uv+(vec2(0.0,0.4)*aspectCorrection)*dofblur4);outputColor=color/41.0;}",{blendFunction:g,attributes:Dt.CONVOLUTION|Dt.DEPTH,uniforms:new Map([["focus",new w.Uniform(S)],["dof",new w.Uniform(D)],["aperture",new w.Uniform(k)],["maxBlur",new w.Uniform(Q)]])}))}return ye(m,C),m}(dt),oc=function(C){function m(){var l=0<arguments.length&&arguments[0]!==void 0?arguments[0]:{},d=l.blendFunction,g=d===void 0?Ne.NORMAL:d,A=l.brightness,S=A===void 0?0:A,R=l.contrast,D=R===void 0?0:R;return W(this,m),ie(this,de(m).call(this,"BrightnessContrastEffect","uniform float brightness;uniform float contrast;void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){vec3 color=inputColor.rgb+vec3(brightness-0.5);if(contrast>0.0){color/=vec3(1.0-contrast);}else{color*=vec3(1.0+contrast);}outputColor=vec4(min(color+vec3(0.5),1.0),inputColor.a);}",{blendFunction:g,uniforms:new Map([["brightness",new w.Uniform(S)],["contrast",new w.Uniform(D)]])}))}return ye(m,C),m}(dt),sc=function(C){function m(){var l=0<arguments.length&&arguments[0]!==void 0?arguments[0]:Ne.NORMAL;return W(this,m),ie(this,de(m).call(this,"ColorAverageEffect","void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){float sum=inputColor.r+inputColor.g+inputColor.b;outputColor=vec4(vec3(sum/3.0),inputColor.a);}",{blendFunction:l}))}return ye(m,C),m}(dt),ac=function(C){function m(){var l,d=0<arguments.length&&arguments[0]!==void 0?arguments[0]:{},g=d.blendFunction,A=g===void 0?Ne.NORMAL:g,S=d.bits,R=S===void 0?16:S;return W(this,m),l=ie(this,de(m).call(this,"ColorDepthEffect","uniform float factor;void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){outputColor=vec4(floor(inputColor.rgb*factor+0.5)/factor,inputColor.a);}",{blendFunction:A,uniforms:new Map([["factor",new w.Uniform(1)]])})),l.bits=0,l.setBitDepth(R),l}return ye(m,C),pe(m,[{key:"getBitDepth",value:function(){return this.bits}},{key:"setBitDepth",value:function(l){this.bits=l,this.uniforms.get("factor").value=be(2,l/3)}}]),m}(dt),cc=function(C){function m(){var l=0<arguments.length&&arguments[0]!==void 0?arguments[0]:{},d=l.blendFunction,g=d===void 0?Ne.NORMAL:d,A=l.offset,S=A===void 0?new w.Vector2(.001,5e-4):A;return W(this,m),ie(this,de(m).call(this,"ChromaticAberrationEffect",`varying vec2 vUvR;varying vec2 vUvB;void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){vec4 color=inputColor;
#ifdef ALPHA
vec2 ra=texture2D(inputBuffer,vUvR).ra;vec2 ba=texture2D(inputBuffer,vUvB).ba;color.r=ra.x;color.b=ba.x;color.a=max(max(ra.y,ba.y),inputColor.a);
#else
color.r=texture2D(inputBuffer,vUvR).r;color.b=texture2D(inputBuffer,vUvB).b;
#endif
outputColor=color;}`,{vertexShader:"uniform vec2 offset;varying vec2 vUvR;varying vec2 vUvB;void mainSupport(const in vec2 uv){vUvR=uv+offset;vUvB=uv-offset;}",blendFunction:g,attributes:Dt.CONVOLUTION,uniforms:new Map([["offset",new w.Uniform(S)]])}))}return ye(m,C),pe(m,[{key:"initialize",value:function(l,d){d?this.defines.set("ALPHA","1"):this.defines.delete("ALPHA")}},{key:"offset",get:function(){return this.uniforms.get("offset").value},set:function(l){this.uniforms.get("offset").value=l}}]),m}(dt),lc=function(C){function m(){var l,d=0<arguments.length&&arguments[0]!==void 0?arguments[0]:{},g=d.blendFunction,A=g===void 0?Ne.NORMAL:g,S=d.inverted;return W(this,m),l=ie(this,de(m).call(this,"DepthEffect",`void mainImage(const in vec4 inputColor,const in vec2 uv,const in float depth,out vec4 outputColor){
#ifdef INVERTED
vec3 color=vec3(1.0-depth);
#else
vec3 color=vec3(depth);
#endif
outputColor=vec4(color,inputColor.a);}`,{blendFunction:A,attributes:Dt.DEPTH})),l.inverted=S!==void 0&&S,l}return ye(m,C),pe(m,[{key:"inverted",get:function(){return this.defines.has("INVERTED")},set:function(l){l?this.defines.set("INVERTED","1"):this.defines.delete("INVERTED")}}]),m}(dt),uc=function(C){function m(){var l,d=0<arguments.length&&arguments[0]!==void 0?arguments[0]:{},g=d.blendFunction,A=g===void 0?Ne.NORMAL:g,S=d.angle,R=S===void 0?.5*E:S,D=d.scale,I=D===void 0?1:D;return W(this,m),l=ie(this,de(m).call(this,"DotScreenEffect","uniform vec2 angle;uniform float scale;float pattern(const in vec2 uv){vec2 point=scale*vec2(dot(angle.yx,vec2(uv.x,-uv.y)),dot(angle,uv));return(sin(point.x)*sin(point.y))*4.0;}void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){vec3 color=vec3(inputColor.rgb*10.0-5.0+pattern(uv*resolution));outputColor=vec4(color,inputColor.a);}",{blendFunction:A,uniforms:new Map([["angle",new w.Uniform(new w.Vector2)],["scale",new w.Uniform(I)]])})),l.setAngle(R),l}return ye(m,C),pe(m,[{key:"setAngle",value:function(l){this.uniforms.get("angle").value.set(we(l),G(l))}}]),m}(dt),hc=function(C){function m(){var l=0<arguments.length&&arguments[0]!==void 0?arguments[0]:{},d=l.blendFunction,g=d===void 0?Ne.NORMAL:d,A=l.gamma,S=A===void 0?2:A;return W(this,m),ie(this,de(m).call(this,"GammaCorrectionEffect","uniform float gamma;void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){outputColor=LinearToGamma(max(inputColor,0.0),gamma);}",{blendFunction:g,uniforms:new Map([["gamma",new w.Uniform(S)]])}))}return ye(m,C),m}(dt),Bs="Glitch.Generated",dc=function(C){function m(){var l,d=0<arguments.length&&arguments[0]!==void 0?arguments[0]:{},g=d.blendFunction,A=g===void 0?Ne.NORMAL:g,S=d.chromaticAberrationOffset,R=S===void 0?null:S,D=d.delay,I=D===void 0?new w.Vector2(1.5,3.5):D,k=d.duration,q=k===void 0?new w.Vector2(.6,1):k,Q=d.strength,xe=Q===void 0?new w.Vector2(.3,1):Q,Me=d.columns,Ue=Me===void 0?.05:Me,Qe=d.ratio,at=Qe===void 0?.85:Qe,tt=d.perturbationMap,xt=tt===void 0?null:tt,ct=d.dtSize,gt=ct===void 0?64:ct;return W(this,m),l=ie(this,de(m).call(this,"GlitchEffect","uniform sampler2D perturbationMap;uniform bool active;uniform float columns;uniform float random;uniform vec2 seed;uniform vec2 distortion;void mainUv(inout vec2 uv){if(active){vec4 normal=texture2D(perturbationMap,uv*random*random);if(uv.y<distortion.x+columns&&uv.y>distortion.x-columns*random){float sx=clamp(ceil(seed.x),0.0,1.0);uv.y=sx*(1.0-(uv.y+distortion.y))+(1.0-sx)*distortion.y;}if(uv.x<distortion.y+columns&&uv.x>distortion.y-columns*random){float sy=clamp(ceil(seed.y),0.0,1.0);uv.x=sy*distortion.x+(1.0-sy)*(1.0-(uv.x+distortion.x));}uv.x+=normal.x*seed.x*(random*0.2);uv.y+=normal.y*seed.y*(random*0.2);}}",{blendFunction:A,uniforms:new Map([["perturbationMap",new w.Uniform(null)],["columns",new w.Uniform(Ue)],["active",new w.Uniform(!1)],["random",new w.Uniform(.02)],["seed",new w.Uniform(new w.Vector2)],["distortion",new w.Uniform(new w.Vector2)]])})),l.perturbationMap=null,l.setPerturbationMap(xt===null?l.generatePerturbationMap(gt):xt),l.perturbationMap.generateMipmaps=!1,l.delay=I,l.duration=q,l.breakPoint=new w.Vector2(St(l.delay.x,l.delay.y),St(l.duration.x,l.duration.y)),l.time=0,l.seed=l.uniforms.get("seed").value,l.distortion=l.uniforms.get("distortion").value,l.mode=Ti.SPORADIC,l.strength=xe,l.ratio=at,l.chromaticAberrationOffset=R,l}return ye(m,C),pe(m,[{key:"getPerturbationMap",value:function(){return this.perturbationMap}},{key:"setPerturbationMap",value:function(l){this.perturbationMap!==null&&this.perturbationMap.name===Bs&&this.perturbationMap.dispose(),l.wrapS=l.wrapT=w.RepeatWrapping,l.magFilter=l.minFilter=w.NearestFilter,this.perturbationMap=l,this.uniforms.get("perturbationMap").value=l}},{key:"generatePerturbationMap",value:function(){var l,d,g=0<arguments.length&&arguments[0]!==void 0?arguments[0]:64,A=g*g,S=new Float32Array(3*A);for(l=0;l<A;++l)d=Math.random(),S[3*l]=d,S[3*l+1]=d,S[3*l+2]=d;var R=new w.DataTexture(S,g,g,w.RGBFormat,w.FloatType);return R.name=Bs,R.needsUpdate=!0,R}},{key:"update",value:function(l,d,g){var A,S=this.mode,R=this.breakPoint,D=this.chromaticAberrationOffset,I=this.strength,k=this.time,q=!1,Q=0,xe=0;S!==Ti.DISABLED&&(S===Ti.SPORADIC&&(k+=g,A=k>R.x,k>=R.x+R.y&&(R.set(St(this.delay.x,this.delay.y),St(this.duration.x,this.duration.y)),k=0)),Q=Math.random(),this.uniforms.get("random").value=Q,A&&Q>this.ratio||S===Ti.CONSTANT_WILD?(q=!0,Q*=.03*I.y,xe=St(-E,Math.PI),this.seed.set(St(-I.y,I.y),St(-I.y,I.y)),this.distortion.set(St(0,1),St(0,1))):(A||S===Ti.CONSTANT_MILD)&&(q=!0,Q*=.03*I.x,xe=St(-E,Math.PI),this.seed.set(St(-I.x,I.x),St(-I.x,I.x)),this.distortion.set(St(0,1),St(0,1))),this.time=k),D!==null&&(q?D.set(G(xe),we(xe)).multiplyScalar(Q):D.set(0,0)),this.uniforms.get("active").value=q}},{key:"active",get:function(){return this.uniforms.get("active").value}}]),m}(dt),Ti={DISABLED:0,SPORADIC:1,CONSTANT_MILD:2,CONSTANT_WILD:3},_o=new w.Vector3,Is=new w.Matrix4,pc=function(C){function m(l,d){var g,A=2<arguments.length&&arguments[2]!==void 0?arguments[2]:{},S=A.blendFunction,R=S===void 0?Ne.SCREEN:S,D=A.samples,I=D===void 0?60:D,k=A.density,q=k===void 0?.96:k,Q=A.decay,xe=Q===void 0?.9:Q,Me=A.weight,Ue=Me===void 0?.4:Me,Qe=A.exposure,at=Qe===void 0?.6:Qe,tt=A.clampMax,xt=tt===void 0?1:tt,ct=A.resolutionScale,gt=ct===void 0?.5:ct,wt=A.width,kt=wt===void 0?Gt.AUTO_SIZE:wt,Bt=A.height,Ot=Bt===void 0?Gt.AUTO_SIZE:Bt,Lt=A.kernelSize,tn=Lt===void 0?Si.SMALL:Lt,pn=A.blur;return W(this,m),g=ie(this,de(m).call(this,"GodRaysEffect",To,{blendFunction:R,attributes:Dt.DEPTH,uniforms:new Map([["texture",new w.Uniform(null)]])})),g.camera=l,g.lightSource=d,g.lightSource.material.depthWrite=!1,g.lightSource.material.transparent=!0,g.lightScene=new w.Scene,g.screenPosition=new w.Vector2,g.renderTargetX=new w.WebGLRenderTarget(1,1,{minFilter:w.LinearFilter,magFilter:w.LinearFilter,stencilBuffer:!1,depthBuffer:!1}),g.renderTargetX.texture.name="GodRays.TargetX",g.renderTargetY=g.renderTargetX.clone(),g.renderTargetY.texture.name="GodRays.TargetY",g.uniforms.get("texture").value=g.renderTargetY.texture,g.renderTargetLight=g.renderTargetX.clone(),g.renderTargetLight.texture.name="GodRays.Light",g.renderTargetLight.depthBuffer=!0,g.renderTargetLight.depthTexture=new w.DepthTexture,g.renderPassLight=new gn(g.lightScene,l),g.renderPassLight.getClearPass().overrideClearColor=new w.Color(0),g.clearPass=new Tt(!0,!1,!1),g.blurPass=new Gt({resolutionScale:gt,width:kt,height:Ot,kernelSize:tn}),g.depthMaskPass=new sn(function(Ft){var $e=new Es;return $e.uniforms.depthBuffer1.value=Ft,$e}(g.renderTargetLight.depthTexture)),g.godRaysPass=new sn(function(){var Ft=new Ts(g.screenPosition);return Ft.uniforms.density.value=q,Ft.uniforms.decay.value=xe,Ft.uniforms.weight.value=Ue,Ft.uniforms.exposure.value=at,Ft.uniforms.clampMax.value=xt,Ft}()),g.samples=I,g.blur=pn===void 0||pn,g}return ye(m,C),pe(m,[{key:"getResolutionScale",value:function(){return this.blurPass.getResolutionScale()}},{key:"setResolutionScale",value:function(l){var d=this.blurPass.getOriginalSize();this.blurPass.setResolutionScale(l),this.setSize(d.x,d.y)}},{key:"setDepthTexture",value:function(l){var d=1<arguments.length&&arguments[1]!==void 0?arguments[1]:0,g=this.depthMaskPass.getFullscreenMaterial();g.uniforms.depthBuffer0.value=l,g.defines.DEPTH_PACKING_0=d.toFixed(0)}},{key:"update",value:function(l){var d=this.lightSource,g=d.parent,A=d.matrixAutoUpdate,S=this.renderTargetX,R=this.renderTargetLight;A||Is.copy(d.matrix),d.material.depthWrite=!0,d.matrixAutoUpdate=!1,d.updateWorldMatrix(!0,!1),d.matrix.copy(d.matrixWorld),this.lightScene.add(d),this.renderPassLight.render(l,R),this.clearPass.render(l,S),this.depthMaskPass.render(l,R,S),d.material.depthWrite=!1,d.matrixAutoUpdate=A,A||d.matrix.copy(Is),g!==null&&g.add(d),_o.setFromMatrixPosition(d.matrixWorld).project(this.camera),this.screenPosition.set(Re(0,ht(1,.5*(_o.x+1))),Re(0,ht(1,.5*(_o.y+1)))),this.blur&&this.blurPass.render(l,S,S),this.godRaysPass.render(l,S,this.renderTargetY)}},{key:"setSize",value:function(l,d){this.blurPass.setSize(l,d),this.renderPassLight.setSize(l,d),this.depthMaskPass.setSize(l,d),this.godRaysPass.setSize(l,d),l=this.blurPass.width,d=this.blurPass.height,this.renderTargetX.setSize(l,d),this.renderTargetY.setSize(l,d),this.renderTargetLight.setSize(l,d)}},{key:"initialize",value:function(l,d){this.blurPass.initialize(l,d),this.renderPassLight.initialize(l,d),this.depthMaskPass.initialize(l,d),this.godRaysPass.initialize(l,d),d||(this.renderTargetX.texture.format=w.RGBFormat,this.renderTargetY.texture.format=w.RGBFormat,this.renderTargetLight.texture.format=w.RGBFormat)}},{key:"texture",get:function(){return this.renderTargetY.texture}},{key:"godRaysMaterial",get:function(){return this.godRaysPass.getFullscreenMaterial()}},{key:"width",get:function(){return this.blurPass.width},set:function(l){var d=this.blurPass;d.width=l,this.renderTargetX.setSize(d.width,d.height),this.renderTargetY.setSize(d.width,d.height),this.renderTargetLight.setSize(d.width,d.height)}},{key:"height",get:function(){return this.blurPass.height},set:function(l){var d=this.blurPass;d.height=l,this.renderTargetX.setSize(d.width,d.height),this.renderTargetY.setSize(d.width,d.height),this.renderTargetLight.setSize(d.width,d.height)}},{key:"dithering",get:function(){return this.godRaysMaterial.dithering},set:function(l){var d=this.godRaysMaterial;d.dithering=l,d.needsUpdate=!0}},{key:"blur",get:function(){return this.blurPass.enabled},set:function(l){this.blurPass.enabled=l}},{key:"kernelSize",get:function(){return this.blurPass.kernelSize},set:function(l){this.blurPass.kernelSize=l}},{key:"samples",get:function(){return this.godRaysMaterial.samples},set:function(l){this.godRaysMaterial.samples=l}}]),m}(dt),fc=function(C){function m(){var l,d=0<arguments.length&&arguments[0]!==void 0?arguments[0]:{},g=d.blendFunction,A=g===void 0?Ne.OVERLAY:g,S=d.scale,R=S===void 0?1:S,D=d.lineWidth,I=D===void 0?0:D;return W(this,m),l=ie(this,de(m).call(this,"GridEffect","uniform vec2 scale;uniform float lineWidth;void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){float grid=0.5-max(abs(mod(uv.x*scale.x,1.0)-0.5),abs(mod(uv.y*scale.y,1.0)-0.5));outputColor=vec4(vec3(smoothstep(0.0,lineWidth,grid)),inputColor.a);}",{blendFunction:A,uniforms:new Map([["scale",new w.Uniform(new w.Vector2)],["lineWidth",new w.Uniform(I)]])})),l.resolution=new w.Vector2,l.scale=Re(R,1e-6),l.lineWidth=Re(I,0),l}return ye(m,C),pe(m,[{key:"getScale",value:function(){return this.scale}},{key:"setScale",value:function(l){this.scale=l,this.setSize(this.resolution.x,this.resolution.y)}},{key:"getLineWidth",value:function(){return this.lineWidth}},{key:"setLineWidth",value:function(l){this.lineWidth=l,this.setSize(this.resolution.x,this.resolution.y)}},{key:"setSize",value:function(l,d){this.resolution.set(l,d);var g=this.scale*(.125*d);this.uniforms.get("scale").value.set(l/d*g,g),this.uniforms.get("lineWidth").value=g/d+this.lineWidth}}]),m}(dt),Os=function(C){function m(){var l,d=0<arguments.length&&arguments[0]!==void 0?arguments[0]:{},g=d.blendFunction,A=g===void 0?Ne.NORMAL:g,S=d.hue,R=S===void 0?0:S,D=d.saturation,I=D===void 0?0:D;return W(this,m),l=ie(this,de(m).call(this,"HueSaturationEffect","uniform vec3 hue;uniform float saturation;void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){vec3 color=vec3(dot(inputColor.rgb,hue.xyz),dot(inputColor.rgb,hue.zxy),dot(inputColor.rgb,hue.yzx));float average=(color.r+color.g+color.b)/3.0;vec3 diff=average-color;if(saturation>0.0){color+=diff*(1.0-1.0/(1.001-saturation));}else{color+=diff*-saturation;}outputColor=vec4(min(color,1.0),inputColor.a);}",{blendFunction:A,uniforms:new Map([["hue",new w.Uniform(new w.Vector3)],["saturation",new w.Uniform(I)]])})),l.setHue(R),l}return ye(m,C),pe(m,[{key:"setHue",value:function(l){var d=we(l),g=G(l);this.uniforms.get("hue").value.set(2*g,-Se(3)*d-g,Se(3)*d-g).addScalar(1).divideScalar(3)}}]),m}(dt),Fs=function(C){function m(){var l,d=0<arguments.length&&arguments[0]!==void 0?arguments[0]:{},g=d.blendFunction,A=g===void 0?Ne.SCREEN:g,S=d.premultiply;return W(this,m),l=ie(this,de(m).call(this,"NoiseEffect",`void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){vec3 noise=vec3(rand(uv*time));
#ifdef PREMULTIPLY
outputColor=vec4(inputColor.rgb*noise,inputColor.a);
#else
outputColor=vec4(noise,inputColor.a);
#endif
}`,{blendFunction:A})),l.premultiply=S!==void 0&&S,l}return ye(m,C),pe(m,[{key:"premultiply",get:function(){return this.defines.has("PREMULTIPLY")},set:function(l){l?this.defines.set("PREMULTIPLY","1"):this.defines.delete("PREMULTIPLY")}}]),m}(dt),Fn=function(C){function m(l,d){var g,A=2<arguments.length&&arguments[2]!==void 0?arguments[2]:{},S=A.blendFunction,R=S===void 0?Ne.SCREEN:S,D=A.patternTexture,I=D===void 0?null:D,k=A.edgeStrength,q=k===void 0?1:k,Q=A.pulseSpeed,xe=Q===void 0?0:Q,Me=A.visibleEdgeColor,Ue=Me===void 0?16777215:Me,Qe=A.hiddenEdgeColor,at=Qe===void 0?2230538:Qe,tt=A.resolutionScale,xt=tt===void 0?.5:tt,ct=A.width,gt=ct===void 0?Gt.AUTO_SIZE:ct,wt=A.height,kt=wt===void 0?Gt.AUTO_SIZE:wt,Bt=A.kernelSize,Ot=Bt===void 0?Si.VERY_SMALL:Bt,Lt=A.blur,tn=A.xRay;W(this,m),g=ie(this,de(m).call(this,"OutlineEffect",`uniform sampler2D edgeTexture;uniform sampler2D maskTexture;uniform vec3 visibleEdgeColor;uniform vec3 hiddenEdgeColor;uniform float pulse;uniform float edgeStrength;
#ifdef USE_PATTERN
uniform sampler2D patternTexture;varying vec2 vUvPattern;
#endif
void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){vec2 edge=texture2D(edgeTexture,uv).rg;vec2 mask=texture2D(maskTexture,uv).rg;
#ifndef X_RAY
edge.y=0.0;
#endif
edge*=(edgeStrength*mask.x*pulse);vec3 color=edge.x*visibleEdgeColor+edge.y*hiddenEdgeColor;float visibilityFactor=0.0;
#ifdef USE_PATTERN
vec4 patternColor=texture2D(patternTexture,vUvPattern);
#ifdef X_RAY
float hiddenFactor=0.5;
#else
float hiddenFactor=0.0;
#endif
visibilityFactor=(1.0-mask.y>0.0)? 1.0 : hiddenFactor;visibilityFactor*=(1.0-mask.x)*patternColor.a;color+=visibilityFactor*patternColor.rgb;
#endif
float alpha=max(max(edge.x,edge.y),visibilityFactor);
#ifdef ALPHA
outputColor=vec4(color,alpha);
#else
outputColor=vec4(color,max(alpha,inputColor.a));
#endif
}`,{uniforms:new Map([["maskTexture",new w.Uniform(null)],["edgeTexture",new w.Uniform(null)],["edgeStrength",new w.Uniform(q)],["visibleEdgeColor",new w.Uniform(new w.Color(Ue))],["hiddenEdgeColor",new w.Uniform(new w.Color(at))],["pulse",new w.Uniform(1)]])})),g.blendMode=function(Ft){return new Proxy(g.blendMode,{set:function($e,At,ot){return ot===Ne.ALPHA?Ft.set("ALPHA","1"):Ft.delete("ALPHA"),$e[At]=ot,!0}})}(g.defines),g.blendMode.blendFunction=R,g.setPatternTexture(I),g.xRay=tn===void 0||tn,g.scene=l,g.camera=d,g.renderTargetMask=new w.WebGLRenderTarget(1,1,{minFilter:w.LinearFilter,magFilter:w.LinearFilter,stencilBuffer:!1,format:w.RGBFormat}),g.renderTargetMask.texture.name="Outline.Mask",g.uniforms.get("maskTexture").value=g.renderTargetMask.texture,g.renderTargetEdges=g.renderTargetMask.clone(),g.renderTargetEdges.texture.name="Outline.Edges",g.renderTargetEdges.depthBuffer=!1,g.renderTargetBlurredEdges=g.renderTargetEdges.clone(),g.renderTargetBlurredEdges.texture.name="Outline.BlurredEdges",g.clearPass=new Tt,g.clearPass.overrideClearColor=new w.Color(0),g.clearPass.overrideClearAlpha=1,g.depthPass=new Ls(l,d),g.maskPass=new gn(l,d,new Ms(g.depthPass.renderTarget.texture,d));var pn=g.maskPass.getClearPass();return pn.overrideClearColor=new w.Color(16777215),pn.overrideClearAlpha=1,g.blurPass=new Gt({resolutionScale:xt,width:gt,height:kt,kernelSize:Ot}),g.blur=Lt!==void 0&&Lt,g.outlineEdgesPass=new sn(new _s),g.outlineEdgesPass.getFullscreenMaterial().uniforms.maskTexture.value=g.renderTargetMask.texture,g.time=0,g.selection=new So,g.pulseSpeed=xe,g}return ye(m,C),pe(m,[{key:"setPatternTexture",value:function(l){l===null?(this.defines.delete("USE_PATTERN"),this.uniforms.delete("patternScale"),this.uniforms.delete("patternTexture"),this.vertexShader=null):(l.wrapS=l.wrapT=w.RepeatWrapping,this.defines.set("USE_PATTERN","1"),this.uniforms.set("patternScale",new w.Uniform(1)),this.uniforms.set("patternTexture",new w.Uniform(l)),this.vertexShader="uniform float patternScale;varying vec2 vUvPattern;void mainSupport(const in vec2 uv){vUvPattern=uv*vec2(aspect,1.0)*patternScale;}")}},{key:"getResolutionScale",value:function(){return this.blurPass.getResolutionScale()}},{key:"setResolutionScale",value:function(l){var d=this.blurPass.getOriginalSize();this.blurPass.setResolutionScale(l),this.depthPass.setResolutionScale(l),this.setSize(d.x,d.y)}},{key:"setSelection",value:function(l){return this.selection.set(l),this}},{key:"clearSelection",value:function(){return this.selection.clear(),this}},{key:"selectObject",value:function(l){return this.selection.add(l),this}},{key:"deselectObject",value:function(l){return this.selection.delete(l),this}},{key:"update",value:function(l,d,g){var A=this.scene,S=this.camera,R=this.selection,D=this.uniforms.get("pulse"),I=A.background,k=S.layers.mask;0<R.size?(A.background=null,D.value=1,0<this.pulseSpeed&&(D.value=.625+.375*G(10*(this.time*this.pulseSpeed))),this.time+=g,R.setVisible(!1),this.depthPass.render(l),R.setVisible(!0),S.layers.set(R.layer),this.maskPass.render(l,this.renderTargetMask),S.layers.mask=k,A.background=I,this.outlineEdgesPass.render(l,null,this.renderTargetEdges),this.blur&&this.blurPass.render(l,this.renderTargetEdges,this.renderTargetBlurredEdges)):0<this.time&&(this.clearPass.render(l,this.renderTargetMask),this.time=0)}},{key:"setSize",value:function(l,d){this.renderTargetMask.setSize(l,d),this.depthPass.setSize(l,d),this.blurPass.setSize(l,d),l=this.blurPass.width,d=this.blurPass.height,this.renderTargetEdges.setSize(l,d),this.renderTargetBlurredEdges.setSize(l,d),this.outlineEdgesPass.getFullscreenMaterial().setTexelSize(1/l,1/d)}},{key:"initialize",value:function(l,d){this.blurPass.initialize(l,d),this.depthPass.initialize(l,d),this.maskPass.initialize(l,d)}},{key:"width",get:function(){return this.blurPass.width},set:function(l){var d=this.blurPass;d.width=l,this.renderTargetEdges.setSize(d.width,d.height),this.renderTargetBlurredEdges.setSize(d.width,d.height),this.outlineEdgesPass.getFullscreenMaterial().setTexelSize(1/d.width,1/d.height)}},{key:"height",get:function(){return this.blurPass.height},set:function(l){var d=this.blurPass;d.height=l,this.renderTargetEdges.setSize(d.width,d.height),this.renderTargetBlurredEdges.setSize(d.width,d.height),this.outlineEdgesPass.getFullscreenMaterial().setTexelSize(1/d.width,1/d.height)}},{key:"selectionLayer",get:function(){return this.selection.layer},set:function(l){this.selection.layer=l}},{key:"dithering",get:function(){return this.blurPass.dithering},set:function(l){this.blurPass.dithering=l}},{key:"kernelSize",get:function(){return this.blurPass.kernelSize},set:function(l){this.blurPass.kernelSize=l}},{key:"blur",get:function(){return this.blurPass.enabled},set:function(l){this.blurPass.enabled=l,this.uniforms.get("edgeTexture").value=l?this.renderTargetBlurredEdges.texture:this.renderTargetEdges.texture}},{key:"xRay",get:function(){return this.defines.has("X_RAY")},set:function(l){l?this.defines.set("X_RAY","1"):this.defines.delete("X_RAY")}}]),m}(dt),Ns=function(C){function m(){var l,d=0<arguments.length&&arguments[0]!==void 0?arguments[0]:30;return W(this,m),l=ie(this,de(m).call(this,"PixelationEffect","uniform bool active;uniform vec2 d;void mainUv(inout vec2 uv){if(active){uv=vec2(d.x*(floor(uv.x/d.x)+0.5),d.y*(floor(uv.y/d.y)+0.5));}}",{uniforms:new Map([["active",new w.Uniform(!1)],["d",new w.Uniform(new w.Vector2)]])})),l.resolution=new w.Vector2,l.granularity=d,l}return ye(m,C),pe(m,[{key:"getGranularity",value:function(){return this.granularity}},{key:"setGranularity",value:function(l){l=_e(l),0<l%2&&(l+=1);var d=this.uniforms;d.get("active").value=0<l,d.get("d").value.set(l,l).divide(this.resolution),this.granularity=l}},{key:"setSize",value:function(l,d){this.resolution.set(l,d),this.setGranularity(this.granularity)}}]),m}(dt),Us=function(C){function m(){var l,d=0<arguments.length&&arguments[0]!==void 0?arguments[0]:{},g=d.blendFunction,A=g===void 0?Ne.NORMAL:g,S=d.focus,R=S===void 0?1:S,D=d.focalLength,I=D===void 0?24:D,k=d.luminanceThreshold,q=k===void 0?.5:k,Q=d.luminanceGain,xe=Q===void 0?2:Q,Me=d.bias,Ue=Me===void 0?.5:Me,Qe=d.fringe,at=Qe===void 0?.7:Qe,tt=d.maxBlur,xt=tt===void 0?1:tt,ct=d.rings,gt=ct===void 0?3:ct,wt=d.samples,kt=wt===void 0?2:wt,Bt=d.showFocus,Ot=d.manualDoF,Lt=d.pentagon;return W(this,m),l=ie(this,de(m).call(this,"RealisticBokehEffect",`uniform float focus;uniform float focalLength;uniform float maxBlur;uniform float luminanceThreshold;uniform float luminanceGain;uniform float bias;uniform float fringe;
#ifdef MANUAL_DOF
uniform vec4 dof;
#endif
#ifdef PENTAGON
float pentagon(const in vec2 coords){const vec4 HS0=vec4(1.0,0.0,0.0,1.0);const vec4 HS1=vec4(0.309016994,0.951056516,0.0,1.0);const vec4 HS2=vec4(-0.809016994,0.587785252,0.0,1.0);const vec4 HS3=vec4(-0.809016994,-0.587785252,0.0,1.0);const vec4 HS4=vec4(0.309016994,-0.951056516,0.0,1.0);const vec4 HS5=vec4(0.0,0.0,1.0,1.0);const vec4 ONE=vec4(1.0);const float P_FEATHER=0.4;const float N_FEATHER=-P_FEATHER;float inOrOut=-4.0;vec4 P=vec4(coords,vec2(RINGS_FLOAT-1.3));vec4 dist=vec4(dot(P,HS0),dot(P,HS1),dot(P,HS2),dot(P,HS3));dist=smoothstep(N_FEATHER,P_FEATHER,dist);inOrOut+=dot(dist,ONE);dist.x=dot(P,HS4);dist.y=HS5.w-abs(P.z);dist=smoothstep(N_FEATHER,P_FEATHER,dist);inOrOut+=dist.x;return clamp(inOrOut,0.0,1.0);}
#endif
vec3 processTexel(const in vec2 coords,const in float blur){vec2 scale=texelSize*fringe*blur;vec3 c=vec3(texture2D(inputBuffer,coords+vec2(0.0,1.0)*scale).r,texture2D(inputBuffer,coords+vec2(-0.866,-0.5)*scale).g,texture2D(inputBuffer,coords+vec2(0.866,-0.5)*scale).b);float luminance=linearToRelativeLuminance(c);float threshold=max((luminance-luminanceThreshold)*luminanceGain,0.0);return c+mix(vec3(0.0),c,threshold*blur);}float gather(const in float i,const in float j,const in float ringSamples,const in vec2 uv,const in vec2 blurFactor,const in float blur,inout vec3 color){float step=PI2/ringSamples;vec2 wh=vec2(cos(j*step)*i,sin(j*step)*i);
#ifdef PENTAGON
float p=pentagon(wh);
#else
float p=1.0;
#endif
color+=processTexel(wh*blurFactor+uv,blur)*mix(1.0,i/RINGS_FLOAT,bias)*p;return mix(1.0,i/RINGS_FLOAT,bias)*p;}void mainImage(const in vec4 inputColor,const in vec2 uv,const in float depth,out vec4 outputColor){float linearDepth=(-cameraFar*cameraNear/(depth*(cameraFar-cameraNear)-cameraFar));
#ifdef MANUAL_DOF
float focalPlane=linearDepth-focus;float farDoF=(focalPlane-dof.z)/dof.w;float nearDoF=(-focalPlane-dof.x)/dof.y;float blur=(focalPlane>0.0)? farDoF : nearDoF;
#else
const float CIRCLE_OF_CONFUSION=0.03;float focalPlaneMM=focus*1000.0;float depthMM=linearDepth*1000.0;float focalPlane=(depthMM*focalLength)/(depthMM-focalLength);float farDoF=(focalPlaneMM*focalLength)/(focalPlaneMM-focalLength);float nearDoF=(focalPlaneMM-focalLength)/(focalPlaneMM*focus*CIRCLE_OF_CONFUSION);float blur=abs(focalPlane-farDoF)*nearDoF;
#endif
const int MAX_RING_SAMPLES=RINGS_INT*SAMPLES_INT;blur=clamp(blur,0.0,1.0);vec3 color=inputColor.rgb;if(blur>=0.05){vec2 blurFactor=blur*maxBlur*texelSize;float s=1.0;int ringSamples;for(int i=1;i<=RINGS_INT;i++){ringSamples=i*SAMPLES_INT;for(int j=0;j<MAX_RING_SAMPLES;j++){if(j>=ringSamples){break;}s+=gather(float(i),float(j),float(ringSamples),uv,blurFactor,blur,color);}}color/=s;}
#ifdef SHOW_FOCUS
float edge=0.002*linearDepth;float m=clamp(smoothstep(0.0,edge,blur),0.0,1.0);float e=clamp(smoothstep(1.0-edge,1.0,blur),0.0,1.0);color=mix(color,vec3(1.0,0.5,0.0),(1.0-m)*0.6);color=mix(color,vec3(0.0,0.5,1.0),((1.0-e)-(1.0-m))*0.2);
#endif
outputColor=vec4(color,inputColor.a);}`,{blendFunction:A,attributes:Dt.CONVOLUTION|Dt.DEPTH,uniforms:new Map([["focus",new w.Uniform(R)],["focalLength",new w.Uniform(I)],["luminanceThreshold",new w.Uniform(q)],["luminanceGain",new w.Uniform(xe)],["bias",new w.Uniform(Ue)],["fringe",new w.Uniform(at)],["maxBlur",new w.Uniform(xt)]])})),l.rings=gt,l.samples=kt,l.showFocus=Bt!==void 0&&Bt,l.manualDoF=Ot!==void 0&&Ot,l.pentagon=Lt!==void 0&&Lt,l}return ye(m,C),pe(m,[{key:"rings",get:function(){return je(this.defines.get("RINGS_INT"))},set:function(l){l=_e(l),this.defines.set("RINGS_INT",l.toFixed(0)),this.defines.set("RINGS_FLOAT",l.toFixed(1))}},{key:"samples",get:function(){return je(this.defines.get("SAMPLES_INT"))},set:function(l){l=_e(l),this.defines.set("SAMPLES_INT",l.toFixed(0)),this.defines.set("SAMPLES_FLOAT",l.toFixed(1))}},{key:"showFocus",get:function(){return this.defines.has("SHOW_FOCUS")},set:function(l){l?this.defines.set("SHOW_FOCUS","1"):this.defines.delete("SHOW_FOCUS")}},{key:"manualDoF",get:function(){return this.defines.has("MANUAL_DOF")},set:function(l){l?(this.defines.set("MANUAL_DOF","1"),this.uniforms.set("dof",new w.Uniform(new w.Vector4(.2,1,.2,2)))):(this.defines.delete("MANUAL_DOF"),this.uniforms.delete("dof"))}},{key:"pentagon",get:function(){return this.defines.has("PENTAGON")},set:function(l){l?this.defines.set("PENTAGON","1"):this.defines.delete("PENTAGON")}}]),m}(dt),zs=function(C){function m(){var l,d=0<arguments.length&&arguments[0]!==void 0?arguments[0]:{},g=d.blendFunction,A=g===void 0?Ne.OVERLAY:g,S=d.density,R=S===void 0?1.25:S;return W(this,m),l=ie(this,de(m).call(this,"ScanlineEffect","uniform float count;void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){vec2 sl=vec2(sin(uv.y*count),cos(uv.y*count));vec3 scanlines=vec3(sl.x,sl.y,sl.x);outputColor=vec4(scanlines,inputColor.a);}",{blendFunction:A,uniforms:new Map([["count",new w.Uniform(0)]])})),l.resolution=new w.Vector2,l.density=R,l}return ye(m,C),pe(m,[{key:"getDensity",value:function(){return this.density}},{key:"setDensity",value:function(l){this.density=l,this.setSize(this.resolution.x,this.resolution.y)}},{key:"setSize",value:function(l,d){this.resolution.set(l,d),this.uniforms.get("count").value=Ae(d*this.density)}}]),m}(dt),Nn=new w.Vector3,Gs=new w.Vector3,mc=function(C){function m(l){var d,g=1<arguments.length&&arguments[1]!==void 0?arguments[1]:new w.Vector3,A=2<arguments.length&&arguments[2]!==void 0?arguments[2]:{},S=A.speed,R=S===void 0?2:S,D=A.maxRadius,I=D===void 0?1:D,k=A.waveSize,q=k===void 0?.2:k,Q=A.amplitude,xe=Q===void 0?.05:Q;return W(this,m),d=ie(this,de(m).call(this,"ShockWaveEffect","uniform bool active;uniform vec2 center;uniform float waveSize;uniform float radius;uniform float maxRadius;uniform float amplitude;varying float vSize;void mainUv(inout vec2 uv){if(active){vec2 aspectCorrection=vec2(aspect,1.0);vec2 difference=uv*aspectCorrection-center*aspectCorrection;float distance=sqrt(dot(difference,difference))*vSize;if(distance>radius){if(distance<radius+waveSize){float angle=(distance-radius)*PI2/waveSize;float cosSin=(1.0-cos(angle))*0.5;float extent=maxRadius+waveSize;float decay=max(extent-distance*distance,0.0)/extent;uv-=((cosSin*amplitude*difference)/distance)*decay;}}}}",{vertexShader:"uniform float size;uniform float cameraDistance;varying float vSize;void mainSupport(){vSize=(0.1*cameraDistance)/size;}",uniforms:new Map([["active",new w.Uniform(!1)],["center",new w.Uniform(new w.Vector2(.5,.5))],["cameraDistance",new w.Uniform(1)],["size",new w.Uniform(1)],["radius",new w.Uniform(-q)],["maxRadius",new w.Uniform(I)],["waveSize",new w.Uniform(q)],["amplitude",new w.Uniform(xe)]])})),d.camera=l,d.epicenter=g,d.screenPosition=d.uniforms.get("center").value,d.speed=R,d.time=0,d.active=!1,d}return ye(m,C),pe(m,[{key:"explode",value:function(){this.time=0,this.active=!0,this.uniforms.get("active").value=!0}},{key:"update",value:function(l,d,g){var A,S=this.epicenter,R=this.camera,D=this.uniforms;if(this.active){var I=D.get("waveSize").value;R.getWorldDirection(Nn),Gs.copy(R.position).sub(S),Nn.angleTo(Gs)>.5*E&&(D.get("cameraDistance").value=R.position.distanceTo(S),Nn.copy(S).project(R),this.screenPosition.set(.5*(Nn.x+1),.5*(Nn.y+1))),this.time+=g*this.speed,A=this.time-I,D.get("radius").value=A,A>=2*(D.get("maxRadius").value+I)&&(this.active=!1,D.get("active").value=!1)}}}]),m}(dt),vc=function(C){function m(l,d,g){var A;return W(this,m),A=ie(this,de(m).call(this,g)),A.scene=l,A.camera=d,A.clearPass=new Tt(!0,!0,!1),A.clearPass.overrideClearColor=new w.Color(0),A.renderPass=new gn(l,d),A.renderPass.clear=!1,A.blackoutPass=new gn(l,d,new w.MeshBasicMaterial({color:0})),A.blackoutPass.clear=!1,A.backgroundPass=function(){var S=new w.Scene,R=new gn(S,d);return S.background=l.background,R.clear=!1,R}(),A.renderTargetSelection=new w.WebGLRenderTarget(1,1,{minFilter:w.LinearFilter,magFilter:w.LinearFilter,stencilBuffer:!1,depthBuffer:!0}),A.renderTargetSelection.texture.name="Bloom.Selection",A.renderTargetSelection.texture.generateMipmaps=!1,A.selection=new So,A.inverted=!1,A}return ye(m,C),pe(m,[{key:"update",value:function(l,d,g){var A=this.scene,S=this.camera,R=this.selection,D=this.renderTargetSelection,I=A.background,k=S.layers.mask;this.clearPass.render(l,D),this.ignoreBackground||this.backgroundPass.render(l,D),A.background=null,this.inverted?(S.layers.set(R.layer),this.blackoutPass.render(l,D),S.layers.mask=k,R.setVisible(!1),this.renderPass.render(l,D),R.setVisible(!0)):(R.setVisible(!1),this.blackoutPass.render(l,D),R.setVisible(!0),S.layers.set(R.layer),this.renderPass.render(l,D),S.layers.mask=k),A.background=I,Ce(de(m.prototype),"update",this).call(this,l,D,g)}},{key:"setSize",value:function(l,d){var g=this.blurPass;Ce(de(m.prototype),"setSize",this).call(this,l,d),this.backgroundPass.setSize(l,d),this.blackoutPass.setSize(l,d),this.renderPass.setSize(l,d),this.renderTargetSelection.setSize(g.width,g.height)}},{key:"initialize",value:function(l,d){Ce(de(m.prototype),"initialize",this).call(this,l,d),this.backgroundPass.initialize(l,d),this.blackoutPass.initialize(l,d),this.renderPass.initialize(l,d),d||(this.renderTargetSelection.texture.format=w.RGBFormat)}},{key:"width",get:function(){return Ce(de(m.prototype),"width",this)},set:function(l){Mi(de(m.prototype),"width",l,this,!0),this.renderTargetSelection.setSize(this.width,this.height)}},{key:"height",get:function(){return Ce(de(m.prototype),"height",this)},set:function(l){Mi(de(m.prototype),"height",l,this,!0),this.renderTargetSelection.setSize(this.width,this.height)}},{key:"ignoreBackground",get:function(){return!this.backgroundPass.enabled},set:function(l){this.backgroundPass.enabled=!l}}]),m}(Ds),gc=function(C){function m(){var l=0<arguments.length&&arguments[0]!==void 0?arguments[0]:{},d=l.blendFunction,g=d===void 0?Ne.NORMAL:d,A=l.intensity,S=A===void 0?1:A;return W(this,m),ie(this,de(m).call(this,"SepiaEffect","uniform float intensity;void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){vec3 color=vec3(dot(inputColor.rgb,vec3(1.0-0.607*intensity,0.769*intensity,0.189*intensity)),dot(inputColor.rgb,vec3(0.349*intensity,1.0-0.314*intensity,0.168*intensity)),dot(inputColor.rgb,vec3(0.272*intensity,0.534*intensity,1.0-0.869*intensity)));outputColor=vec4(color,inputColor.a);}",{blendFunction:g,uniforms:new Map([["intensity",new w.Uniform(S)]])}))}return ye(m,C),m}(dt),Wi=function(C){function m(l,d){var g,A=2<arguments.length&&arguments[2]!==void 0?arguments[2]:ri.HIGH;return W(this,m),g=ie(this,de(m).call(this,"SMAAEffect","uniform sampler2D weightMap;varying vec2 vOffset0;varying vec2 vOffset1;/***Moves values to a target vector based on a given conditional vector.*/void movec(const in bvec2 c,inout vec2 variable,const in vec2 value){if(c.x){variable.x=value.x;}if(c.y){variable.y=value.y;}}void movec(const in bvec4 c,inout vec4 variable,const in vec4 value){movec(c.xy,variable.xy,value.xy);movec(c.zw,variable.zw,value.zw);}void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){vec4 a;a.x=texture2D(weightMap,vOffset0).a;a.y=texture2D(weightMap,vOffset1).g;a.wz=texture2D(weightMap,uv).rb;vec4 color=inputColor;if(dot(a,vec4(1.0))>=1e-5){bool h=max(a.x,a.z)>max(a.y,a.w);vec4 blendingOffset=vec4(0.0,a.y,0.0,a.w);vec2 blendingWeight=a.yw;movec(bvec4(h),blendingOffset,vec4(a.x,0.0,a.z,0.0));movec(bvec2(h),blendingWeight,a.xz);blendingWeight/=dot(blendingWeight,vec2(1.0));vec4 blendingCoord=blendingOffset*vec4(texelSize,-texelSize)+uv.xyxy;color=blendingWeight.x*texture2D(inputBuffer,blendingCoord.xy);color+=blendingWeight.y*texture2D(inputBuffer,blendingCoord.zw);}outputColor=color;}",{vertexShader:"varying vec2 vOffset0;varying vec2 vOffset1;void mainSupport(const in vec2 uv){vOffset0=uv+texelSize*vec2(1.0,0.0);vOffset1=uv+texelSize*vec2(0.0,1.0);}",blendFunction:Ne.NORMAL,attributes:Dt.CONVOLUTION,uniforms:new Map([["weightMap",new w.Uniform(null)]])})),g.renderTargetColorEdges=new w.WebGLRenderTarget(1,1,{minFilter:w.LinearFilter,stencilBuffer:!1,depthBuffer:!1,format:w.RGBFormat}),g.renderTargetColorEdges.texture.name="SMAA.ColorEdges",g.renderTargetWeights=g.renderTargetColorEdges.clone(),g.renderTargetWeights.texture.name="SMAA.Weights",g.renderTargetWeights.texture.format=w.RGBAFormat,g.uniforms.get("weightMap").value=g.renderTargetWeights.texture,g.clearPass=new Tt(!0,!1,!1),g.clearPass.overrideClearColor=new w.Color(0),g.clearPass.overrideClearAlpha=1,g.colorEdgesPass=new sn(new As),g.weightsPass=new sn(new Cs),g.weightsPass.getFullscreenMaterial().uniforms.searchTexture.value=function(){var S=new w.Texture(l);return S.name="SMAA.Search",S.magFilter=w.NearestFilter,S.minFilter=w.NearestFilter,S.format=w.RGBAFormat,S.generateMipmaps=!1,S.needsUpdate=!0,S.flipY=!0,S}(),g.weightsPass.getFullscreenMaterial().uniforms.areaTexture.value=function(){var S=new w.Texture(d);return S.name="SMAA.Area",S.minFilter=w.LinearFilter,S.format=w.RGBAFormat,S.generateMipmaps=!1,S.needsUpdate=!0,S.flipY=!1,S}(),g.applyPreset(A),g}return ye(m,C),pe(m,[{key:"setEdgeDetectionThreshold",value:function(l){this.colorEdgesPass.getFullscreenMaterial().setEdgeDetectionThreshold(l)}},{key:"setOrthogonalSearchSteps",value:function(l){this.weightsPass.getFullscreenMaterial().setOrthogonalSearchSteps(l)}},{key:"applyPreset",value:function(l){var d=this.colorEdgesMaterial,g=this.weightsMaterial;l===ri.LOW?(d.setEdgeDetectionThreshold(.15),g.setOrthogonalSearchSteps(4),g.diagonalDetection=!1,g.cornerRounding=!1):l===ri.MEDIUM?(d.setEdgeDetectionThreshold(.1),g.setOrthogonalSearchSteps(8),g.diagonalDetection=!1,g.cornerRounding=!1):l===ri.HIGH?(d.setEdgeDetectionThreshold(.1),g.setOrthogonalSearchSteps(16),g.setDiagonalSearchSteps(8),g.setCornerRounding(25),g.diagonalDetection=!0,g.cornerRounding=!0):l===ri.ULTRA&&(d.setEdgeDetectionThreshold(.05),g.setOrthogonalSearchSteps(32),g.setDiagonalSearchSteps(16),g.setCornerRounding(25),g.diagonalDetection=!0,g.cornerRounding=!0)}},{key:"update",value:function(l,d){this.clearPass.render(l,this.renderTargetColorEdges),this.colorEdgesPass.render(l,d,this.renderTargetColorEdges),this.weightsPass.render(l,this.renderTargetColorEdges,this.renderTargetWeights)}},{key:"setSize",value:function(l,d){var g=this.colorEdgesPass.getFullscreenMaterial(),A=this.weightsPass.getFullscreenMaterial();this.renderTargetColorEdges.setSize(l,d),this.renderTargetWeights.setSize(l,d),A.uniforms.resolution.value.set(l,d),A.uniforms.texelSize.value.set(1/l,1/d),g.uniforms.texelSize.value.copy(A.uniforms.texelSize.value)}},{key:"colorEdgesMaterial",get:function(){return this.colorEdgesPass.getFullscreenMaterial()}},{key:"weightsMaterial",get:function(){return this.weightsPass.getFullscreenMaterial()}}],[{key:"searchImageDataURL",get:function(){return"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAAAQCAYAAACm53kpAAAAeElEQVRYR+2XSwqAMAxEJ168ePEqwRSKhIIiuHjJqiU0gWE+1CQdApcVAMUAuARaMGCX1MIL/Ow13++9lW2s3mW9MWvsnWc/2fvGygwPAN4E8QzAA4CXAB6AHjG4JTHYI1ey3pcx6FHnEfhLDOIBKAmUBK6/ANUDTlROXAHd9EC1AAAAAElFTkSuQmCC"}},{key:"areaImageDataURL",get:function(){return"data:image/png;base64,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"}}]),m}(dt),ri={LOW:0,MEDIUM:1,HIGH:2,ULTRA:3},Hs=function(C){function m(l,d){var g,A=2<arguments.length&&arguments[2]!==void 0?arguments[2]:{},S=A.blendFunction,R=S===void 0?Ne.MULTIPLY:S,D=A.samples,I=D===void 0?11:D,k=A.rings,q=k===void 0?4:k,Q=A.distanceThreshold,xe=Q===void 0?.65:Q,Me=A.distanceFalloff,Ue=Me===void 0?.1:Me,Qe=A.rangeThreshold,at=Qe===void 0?.0015:Qe,tt=A.rangeFalloff,xt=tt===void 0?.01:tt,ct=A.luminanceInfluence,gt=ct===void 0?.7:ct,wt=A.radius,kt=wt===void 0?18.25:wt,Bt=A.scale,Ot=Bt===void 0?1:Bt,Lt=A.bias,tn=Lt===void 0?.5:Lt;return W(this,m),g=ie(this,de(m).call(this,"SSAOEffect",`uniform sampler2D normalBuffer;uniform mat4 cameraProjectionMatrix;uniform mat4 cameraInverseProjectionMatrix;uniform vec2 radiusStep;uniform vec2 distanceCutoff;uniform vec2 proximityCutoff;uniform float seed;uniform float luminanceInfluence;uniform float scale;uniform float bias;float getViewZ(const in float depth){
#ifdef PERSPECTIVE_CAMERA
return perspectiveDepthToViewZ(depth,cameraNear,cameraFar);
#else
return orthographicDepthToViewZ(depth,cameraNear,cameraFar);
#endif
}vec3 getViewPosition(const in vec2 screenPosition,const in float depth,const in float viewZ){float clipW=cameraProjectionMatrix[2][3]*viewZ+cameraProjectionMatrix[3][3];vec4 clipPosition=vec4((vec3(screenPosition,depth)-0.5)*2.0,1.0);clipPosition*=clipW;return(cameraInverseProjectionMatrix*clipPosition).xyz;}float getOcclusion(const in vec3 p,const in vec3 n,const in vec3 sampleViewPosition){vec3 viewDelta=sampleViewPosition-p;float d=length(viewDelta)*scale;return max(0.0,dot(n,viewDelta)/d-bias)/(1.0+pow2(d));}float getAmbientOcclusion(const in vec3 p,const in vec3 n,const in float depth,const in vec2 uv){vec2 radius=radiusStep;float angle=rand(uv+seed)*PI2;float occlusionSum=0.0;for(int i=0;i<SAMPLES_INT;++i){vec2 coord=uv+vec2(cos(angle),sin(angle))*radius;radius+=radiusStep;angle+=ANGLE_STEP;float sampleDepth=readDepth(coord);float proximity=abs(depth-sampleDepth);if(sampleDepth<distanceCutoff.y&&proximity<proximityCutoff.y){float falloff=1.0-smoothstep(proximityCutoff.x,proximityCutoff.y,proximity);vec3 sampleViewPosition=getViewPosition(coord,sampleDepth,getViewZ(sampleDepth));occlusionSum+=getOcclusion(p,n,sampleViewPosition)*falloff;}}return occlusionSum/SAMPLES_FLOAT;}void mainImage(const in vec4 inputColor,const in vec2 uv,const in float depth,out vec4 outputColor){float ao=1.0;if(depth<distanceCutoff.y){vec3 viewPosition=getViewPosition(uv,depth,getViewZ(depth));vec3 viewNormal=unpackRGBToNormal(texture2D(normalBuffer,uv).xyz);ao-=getAmbientOcclusion(viewPosition,viewNormal,depth,uv);float l=linearToRelativeLuminance(inputColor.rgb);ao=mix(ao,1.0,max(l*luminanceInfluence,smoothstep(distanceCutoff.x,distanceCutoff.y,depth)));}outputColor=vec4(vec3(ao),inputColor.a);}`,{blendFunction:R,attributes:Dt.DEPTH,defines:new Map([["RINGS_INT","0"],["SAMPLES_INT","0"],["SAMPLES_FLOAT","0.0"]]),uniforms:new Map([["normalBuffer",new w.Uniform(d)],["cameraInverseProjectionMatrix",new w.Uniform(new w.Matrix4)],["cameraProjectionMatrix",new w.Uniform(new w.Matrix4)],["radiusStep",new w.Uniform(new w.Vector2)],["distanceCutoff",new w.Uniform(new w.Vector2)],["proximityCutoff",new w.Uniform(new w.Vector2)],["seed",new w.Uniform(Math.random())],["luminanceInfluence",new w.Uniform(gt)],["scale",new w.Uniform(Ot)],["bias",new w.Uniform(tn)]])})),g.r=0,g.resolution=new w.Vector2(1,1),g.camera=l,g.samples=I,g.rings=q,g.radius=kt,g.setDistanceCutoff(xe,Ue),g.setProximityCutoff(at,xt),g}return ye(m,C),pe(m,[{key:"updateAngleStep",value:function(){this.defines.set("ANGLE_STEP",(2*E*this.rings/this.samples).toFixed(11))}},{key:"updateRadiusStep",value:function(){var l=this.r/this.samples;this.uniforms.get("radiusStep").value.set(l,l).divide(this.resolution)}},{key:"setDistanceCutoff",value:function(l,d){this.uniforms.get("distanceCutoff").value.set(l,ht(l+d,1-1e-6))}},{key:"setProximityCutoff",value:function(l,d){this.uniforms.get("proximityCutoff").value.set(l,ht(l+d,1-1e-6))}},{key:"setSize",value:function(l,d){this.resolution.set(l,d),this.updateRadiusStep(),this.uniforms.get("cameraInverseProjectionMatrix").value.getInverse(this.camera.projectionMatrix),this.uniforms.get("cameraProjectionMatrix").value.copy(this.camera.projectionMatrix)}},{key:"samples",get:function(){return je(this.defines.get("SAMPLES_INT"))},set:function(l){l=_e(l),this.defines.set("SAMPLES_INT",l.toFixed(0)),this.defines.set("SAMPLES_FLOAT",l.toFixed(1)),this.updateAngleStep(),this.updateRadiusStep()}},{key:"rings",get:function(){return je(this.defines.get("RINGS_INT"))},set:function(l){l=_e(l),this.defines.set("RINGS_INT",l.toFixed(0)),this.updateAngleStep()}},{key:"radius",get:function(){return this.r},set:function(l){this.r=l,this.updateRadiusStep()}}]),m}(dt),Co=function(C){function m(){var l,d=0<arguments.length&&arguments[0]!==void 0?arguments[0]:{},g=d.blendFunction,A=g===void 0?Ne.NORMAL:g,S=d.texture,R=S===void 0?null:S,D=d.aspectCorrection;return W(this,m),l=ie(this,de(m).call(this,"TextureEffect",To,{blendFunction:A,uniforms:new Map([["texture",new w.Uniform(R)]])})),l.aspectCorrection=D!==void 0&&D,l}return ye(m,C),pe(m,[{key:"aspectCorrection",get:function(){return this.defines.has("ASPECT_CORRECTION")},set:function(l){l?(this.defines.set("ASPECT_CORRECTION","1"),this.uniforms.set("scale",new w.Uniform(1)),this.vertexShader="uniform float scale;varying vec2 vUv2;void mainSupport(const in vec2 uv){vUv2=uv*vec2(aspect,1.0)*scale;}"):(this.defines.delete("ASPECT_CORRECTION"),this.uniforms.delete("scale"),this.vertexShader=null)}}]),m}(dt),Vs=function(C){function m(){var l,d=0<arguments.length&&arguments[0]!==void 0?arguments[0]:{},g=d.blendFunction,A=g===void 0?Ne.NORMAL:g,S=d.adaptive,R=d.resolution,D=R===void 0?256:R,I=d.middleGrey,k=I===void 0?.6:I,q=d.maxLuminance,Q=q===void 0?16:q,xe=d.averageLuminance,Me=xe===void 0?1:xe,Ue=d.adaptationRate,Qe=Ue===void 0?2:Ue;W(this,m),l=ie(this,de(m).call(this,"ToneMappingEffect",`uniform sampler2D luminanceMap;uniform float middleGrey;uniform float maxLuminance;uniform float averageLuminance;vec3 toneMap(vec3 c){
#ifdef ADAPTED_LUMINANCE
float lumAvg=texture2D(luminanceMap,vec2(0.5)).r;
#else
float lumAvg=averageLuminance;
#endif
float lumPixel=linearToRelativeLuminance(c);float lumScaled=(lumPixel*middleGrey)/lumAvg;float lumCompressed=(lumScaled*(1.0+(lumScaled/(maxLuminance*maxLuminance))))/(1.0+lumScaled);return lumCompressed*c;}void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){outputColor=vec4(toneMap(inputColor.rgb),inputColor.a);}`,{blendFunction:A,uniforms:new Map([["luminanceMap",new w.Uniform(null)],["middleGrey",new w.Uniform(k)],["maxLuminance",new w.Uniform(Q)],["averageLuminance",new w.Uniform(Me)]])})),l.renderTargetLuminance=new w.WebGLRenderTarget(1,1,{minFilter:w.LinearMipmapLinearFilter===void 0?w.LinearMipMapLinearFilter:w.LinearMipmapLinearFilter,magFilter:w.LinearFilter,stencilBuffer:!1,depthBuffer:!1,format:w.RGBFormat}),l.renderTargetLuminance.texture.name="ToneMapping.Luminance",l.renderTargetLuminance.texture.generateMipmaps=!0,l.renderTargetAdapted=l.renderTargetLuminance.clone(),l.renderTargetAdapted.texture.name="ToneMapping.AdaptedLuminance",l.renderTargetAdapted.texture.generateMipmaps=!1,l.renderTargetAdapted.texture.minFilter=w.LinearFilter,l.renderTargetPrevious=l.renderTargetAdapted.clone(),l.renderTargetPrevious.texture.name="ToneMapping.PreviousLuminance",l.savePass=new Rs(l.renderTargetPrevious,!1),l.luminancePass=new sn(new Eo);var at=l.luminancePass.getFullscreenMaterial();return at.useThreshold=!1,l.adaptiveLuminancePass=new sn(new Sr),l.adaptationRate=Qe,l.resolution=D,l.adaptive=S===void 0||S,l}return ye(m,C),pe(m,[{key:"update",value:function(l,d,g){if(this.adaptive){this.luminancePass.render(l,d,this.renderTargetLuminance);var A=this.adaptiveLuminancePass.getFullscreenMaterial().uniforms;A.previousLuminanceBuffer.value=this.renderTargetPrevious.texture,A.currentLuminanceBuffer.value=this.renderTargetLuminance.texture,A.deltaTime.value=g,this.adaptiveLuminancePass.render(l,null,this.renderTargetAdapted),this.savePass.render(l,this.renderTargetAdapted)}}},{key:"setSize",value:function(l,d){this.savePass.setSize(l,d)}},{key:"initialize",value:function(l){var d=new Tt(!0,!1,!1);d.overrideClearColor=new w.Color(8388607),d.render(l,this.renderTargetPrevious),d.dispose()}},{key:"resolution",get:function(){return this.renderTargetLuminance.width},set:function(l){var d=Math.ceil,g=Math.log2,A=Re(0,d(g(l)));l=be(2,A),this.renderTargetLuminance.setSize(l,l),this.renderTargetPrevious.setSize(l,l),this.renderTargetAdapted.setSize(l,l),this.adaptiveLuminancePass.getFullscreenMaterial().defines.MIP_LEVEL_1X1=A.toFixed(1)}},{key:"adaptive",get:function(){return this.defines.has("ADAPTED_LUMINANCE")},set:function(l){l?(this.defines.set("ADAPTED_LUMINANCE","1"),this.uniforms.get("luminanceMap").value=this.renderTargetAdapted.texture):(this.defines.delete("ADAPTED_LUMINANCE"),this.uniforms.get("luminanceMap").value=null)}},{key:"adaptationRate",get:function(){return this.adaptiveLuminancePass.getFullscreenMaterial().uniforms.tau.value},set:function(l){this.adaptiveLuminancePass.getFullscreenMaterial().uniforms.tau.value=l}},{key:"distinction",get:function(){return console.warn(this.name,"The distinction field has been removed."),1},set:function(){console.warn(this.name,"The distinction field has been removed.")}}]),m}(dt),js=function(C){function m(){var l,d=0<arguments.length&&arguments[0]!==void 0?arguments[0]:{};W(this,m);var g=Object.assign({blendFunction:Ne.NORMAL,eskil:!1,offset:.5,darkness:.5},d);return l=ie(this,de(m).call(this,"VignetteEffect",`uniform float offset;uniform float darkness;void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){const vec2 center=vec2(0.5);vec3 color=inputColor.rgb;
#ifdef ESKIL
vec2 coord=(uv-center)*vec2(offset);color=mix(color,vec3(1.0-darkness),dot(coord,coord));
#else
float d=distance(uv,center);color*=smoothstep(0.8,offset*0.799,d*(darkness+offset));
#endif
outputColor=vec4(color,inputColor.a);}`,{blendFunction:g.blendFunction,uniforms:new Map([["offset",new w.Uniform(g.offset)],["darkness",new w.Uniform(g.darkness)]])})),l.eskil=g.eskil,l}return ye(m,C),pe(m,[{key:"eskil",get:function(){return this.defines.has("ESKIL")},set:function(l){l?this.defines.set("ESKIL","1"):this.defines.delete("ESKIL")}}]),m}(dt),ki=function(){function C(){var m=0<arguments.length&&arguments[0]!==void 0?arguments[0]:0,l=1<arguments.length&&arguments[1]!==void 0?arguments[1]:0,d=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null,g=3<arguments.length&&arguments[3]!==void 0?arguments[3]:4;W(this,C),this.width=m,this.height=l,this.data=d,this.channels=g}return pe(C,[{key:"toCanvas",value:function(){return typeof document>"u"?null:le(this.width,this.height,this.data,this.channels)}}]),C}(),_r=new w.Box2,Yi=new w.Box2,_i=16,Lo=20,Po=new Float32Array([0,-.25,.25,-.125,.125,-.375,.375]),Ws=[new Float32Array([0,0]),new Float32Array([.25,-.25]),new Float32Array([-.25,.25]),new Float32Array([.125,-.125]),new Float32Array([-.125,.125])],yc=[new Uint8Array([0,0]),new Uint8Array([3,0]),new Uint8Array([0,3]),new Uint8Array([3,3]),new Uint8Array([1,0]),new Uint8Array([4,0]),new Uint8Array([1,3]),new Uint8Array([4,3]),new Uint8Array([0,1]),new Uint8Array([3,1]),new Uint8Array([0,4]),new Uint8Array([3,4]),new Uint8Array([1,1]),new Uint8Array([4,1]),new Uint8Array([1,4]),new Uint8Array([4,4])],ks=[new Uint8Array([0,0]),new Uint8Array([1,0]),new Uint8Array([0,2]),new Uint8Array([1,2]),new Uint8Array([2,0]),new Uint8Array([3,0]),new Uint8Array([2,2]),new Uint8Array([3,2]),new Uint8Array([0,1]),new Uint8Array([1,1]),new Uint8Array([0,3]),new Uint8Array([1,3]),new Uint8Array([2,1]),new Uint8Array([3,1]),new Uint8Array([2,3]),new Uint8Array([3,3])],Ys=function(){function C(){W(this,C)}return pe(C,null,[{key:"generate",value:function(){var m,l,d=10*_i,g=5*Po.length*_i,A=new Uint8ClampedArray(2*(d*g)),S=new ki(d,g,A,2),R=be(_i-1,2)+1,D=Lo,I=[],k=[],q=new w.Vector2;for(m=0;16>m;++m)I.push(new ki(R,R,new Uint8ClampedArray(2*(R*R)),2)),k.push(new ki(D,D,new Uint8ClampedArray(2*(D*D)),2));for(m=0,l=Po.length;m<l;++m)zt(I,Po[m],!0),q.set(0,5*_i*m),Rt(q,I,yc,_i,!0,S);for(m=0,l=Ws.length;m<l;++m)zt(k,Ws[m],!1),q.set(5*_i,4*Lo*m),Rt(q,k,ks,Lo,!1,S);return S}}]),C}(),Cr=new Map([[Je([0,0,0,0]),[0,0,0,0]],[Je([0,0,0,1]),[0,0,0,1]],[Je([0,0,1,0]),[0,0,1,0]],[Je([0,0,1,1]),[0,0,1,1]],[Je([0,1,0,0]),[0,1,0,0]],[Je([0,1,0,1]),[0,1,0,1]],[Je([0,1,1,0]),[0,1,1,0]],[Je([0,1,1,1]),[0,1,1,1]],[Je([1,0,0,0]),[1,0,0,0]],[Je([1,0,0,1]),[1,0,0,1]],[Je([1,0,1,0]),[1,0,1,0]],[Je([1,0,1,1]),[1,0,1,1]],[Je([1,1,0,0]),[1,1,0,0]],[Je([1,1,0,1]),[1,1,0,1]],[Je([1,1,1,0]),[1,1,1,0]],[Je([1,1,1,1]),[1,1,1,1]]]),xc=function(){function C(){W(this,C)}return pe(C,null,[{key:"generate",value:function(){var m,l,d,g,A,S,R,D=33,I=64,k=16,q=new Uint8ClampedArray(66*D),Q=new Uint8ClampedArray(I*k);for(l=0;l<D;++l)for(m=0;66>m;++m)d=.03125*m,g=.03125*l,Cr.has(d)&&Cr.has(g)&&(S=Cr.get(d),R=Cr.get(g),q[66*l+m]=127*Ei(S,R),q[66*l+m+33]=127*On(S,R));for(A=0,l=D-k;l<D;++l)for(m=0;m<I;++m,++A)Q[A]=q[66*l+m];return new ki(I,k,Q,1)}}]),C}();f.AdaptiveLuminanceMaterial=Sr,f.BlendFunction=Ne,f.BlendMode=Ps,f.BloomEffect=Ds,f.BlurPass=Gt,f.BokehEffect=rc,f.BrightnessContrastEffect=oc,f.ChromaticAberrationEffect=cc,f.ClearMaskPass=ii,f.ClearPass=Tt,f.ColorAverageEffect=sc,f.ColorDepthEffect=ac,f.ColorEdgesMaterial=As,f.ConvolutionMaterial=ti,f.CopyMaterial=Tr,f.DepthComparisonMaterial=Ms,f.DepthEffect=lc,f.DepthMaskMaterial=Es,f.DepthPass=Ls,f.Disposable=ei,f.DotScreenEffect=uc,f.Effect=dt,f.EffectAttribute=Dt,f.EffectComposer=nc,f.EffectMaterial=Ss,f.EffectPass=ec,f.GammaCorrectionEffect=hc,f.GlitchEffect=dc,f.GlitchMode=Ti,f.GodRaysEffect=pc,f.GodRaysMaterial=Ts,f.GridEffect=fc,f.HueSaturationEffect=Os,f.Initializable=dn,f.KernelSize=Si,f.LuminanceMaterial=Eo,f.MaskPass=bs,f.NoiseEffect=Fs,f.NormalPass=tc,f.OutlineEdgesMaterial=_s,f.OutlineEffect=Fn,f.Pass=Ct,f.PixelationEffect=Ns,f.RawImageData=ki,f.RealisticBokehEffect=Us,f.RenderPass=gn,f.Resizable=ic,f.SMAAAreaImageData=Ys,f.SMAAEffect=Wi,f.SMAAPreset=ri,f.SMAASearchImageData=xc,f.SMAAWeightsMaterial=Cs,f.SSAOEffect=Hs,f.SavePass=Rs,f.ScanlineEffect=zs,f.Selection=So,f.SelectiveBloomEffect=vc,f.SepiaEffect=gc,f.ShaderPass=sn,f.ShockWaveEffect=mc,f.TextureEffect=Co,f.ToneMappingEffect=Vs,f.VignetteEffect=js,f.WebGLExtension={DERIVATIVES:"derivatives",FRAG_DEPTH:"fragDepth",DRAW_BUFFERS:"drawBuffers",SHADER_TEXTURE_LOD:"shaderTextureLOD"},Object.defineProperty(f,"__esModule",{value:!0})});class Jh{constructor(w,G={}){this.options=G,this.options.distortion==null&&(this.options.distortion={uniforms:$h,getDistortion:ed}),this.container=w,this.renderer=new THREE.WebGLRenderer({antialias:!1}),this.renderer.setSize(w.offsetWidth,w.offsetHeight,!1),this.renderer.setPixelRatio(window.devicePixelRatio),this.composer=new POSTPROCESSING.EffectComposer(this.renderer),w.append(this.renderer.domElement),this.camera=new THREE.PerspectiveCamera(G.fov,w.offsetWidth/w.offsetHeight,.1,1e4),this.camera.position.z=-5,this.camera.position.y=8,this.camera.position.x=0,this.scene=new THREE.Scene;const we=new THREE.Fog(G.colors.background,G.length*.2,G.length*500);this.scene.fog=we,this.fogUniforms={fogColor:{type:"c",value:we.color},fogNear:{type:"f",value:we.near},fogFar:{type:"f",value:we.far}},this.clock=new THREE.Clock,this.assets={},this.disposed=!1,this.road=new sd(this,G),this.leftCarLights=new ku(this,G,G.colors.leftCars,G.movingAwaySpeed,new THREE.Vector2(0,1-G.carLightsFade)),this.rightCarLights=new ku(this,G,G.colors.rightCars,G.movingCloserSpeed,new THREE.Vector2(1,0+G.carLightsFade)),this.leftSticks=new id(this,G),this.fovTarget=G.fov,this.speedUpTarget=0,this.speedUp=0,this.timeOffset=0,this.tick=this.tick.bind(this),this.init=this.init.bind(this),this.setSize=this.setSize.bind(this),this.onMouseDown=this.onMouseDown.bind(this),this.onMouseUp=this.onMouseUp.bind(this)}initPasses(){this.renderPass=new POSTPROCESSING.RenderPass(this.scene,this.camera),this.bloomPass=new POSTPROCESSING.EffectPass(this.camera,new POSTPROCESSING.BloomEffect({luminanceThreshold:.2,luminanceSmoothing:0,resolutionScale:1})),console.log(this.assets.smaa,this.camera);const w=new POSTPROCESSING.EffectPass(this.camera,new POSTPROCESSING.SMAAEffect(this.assets.smaa.search,this.assets.smaa.area,POSTPROCESSING.SMAAPreset.MEDIUM));this.renderPass.renderToScreen=!1,this.bloomPass.renderToScreen=!1,w.renderToScreen=!0,this.composer.addPass(this.renderPass),this.composer.addPass(this.bloomPass),this.composer.addPass(w)}loadAssets(){const w=this.assets;return new Promise((G,we)=>{const E=new THREE.LoadingManager(G),be=new Image,Ae=new Image;w.smaa={},be.addEventListener("load",function(){w.smaa.search=this,E.itemEnd("smaa-search")}),Ae.addEventListener("load",function(){w.smaa.area=this,E.itemEnd("smaa-area")}),E.itemStart("smaa-search"),E.itemStart("smaa-area"),be.src=POSTPROCESSING.SMAAEffect.searchImageDataURL,Ae.src=POSTPROCESSING.SMAAEffect.areaImageDataURL})}init(){this.initPasses();const w=this.options;this.road.init(),this.leftCarLights.init(),this.leftCarLights.mesh.position.setX(-w.roadWidth/2-w.islandWidth/2),this.rightCarLights.init(),this.rightCarLights.mesh.position.setX(w.roadWidth/2+w.islandWidth/2),this.leftSticks.init(),this.leftSticks.mesh.position.setX(-(w.roadWidth+w.islandWidth/2)),this.container.addEventListener("mousedown",this.onMouseDown),this.container.addEventListener("mouseup",this.onMouseUp),this.container.addEventListener("mouseout",this.onMouseUp),this.tick()}onMouseDown(w){this.options.onSpeedUp&&this.options.onSpeedUp(w),this.fovTarget=this.options.fovSpeedUp,this.speedUpTarget=this.options.speedUp}onMouseUp(w){this.options.onSlowDown&&this.options.onSlowDown(w),this.fovTarget=this.options.fov,this.speedUpTarget=0}update(w){const G=Math.exp(-(-60*Math.log2(.9))*w);this.speedUp+=Wu(this.speedUp,this.speedUpTarget,G,1e-5),this.timeOffset+=this.speedUp*w;const we=this.clock.elapsedTime+this.timeOffset;this.rightCarLights.update(we),this.leftCarLights.update(we),this.leftSticks.update(we),this.road.update(we);let E=!1;const be=Wu(this.camera.fov,this.fovTarget,G);if(be!==0&&(this.camera.fov+=be*w*6,E=!0),this.options.distortion.getJS){const Ae=this.options.distortion.getJS(.025,we);this.camera.lookAt(new THREE.Vector3(this.camera.position.x+Ae.x,this.camera.position.y+Ae.y,this.camera.position.z+Ae.z)),E=!0}E&&this.camera.updateProjectionMatrix()}render(w){this.composer.render(w)}dispose(){this.disposed=!0}setSize(w,G,we){this.composer.setSize(w,G,we)}tick(){if(this.disposed||!this)return;if(dd(this.renderer,this.setSize)){const G=this.renderer.domElement;this.camera.aspect=G.clientWidth/G.clientHeight,this.camera.updateProjectionMatrix()}const w=this.clock.getDelta();this.render(w),this.update(w),requestAnimationFrame(this.tick)}}const $h={uDistortionX:new THREE.Uniform(new THREE.Vector2(80,3)),uDistortionY:new THREE.Uniform(new THREE.Vector2(-40,2.5))},ed=`
#define PI 3.14159265358979
  uniform vec2 uDistortionX;
  uniform vec2 uDistortionY;
    float nsin(float val){
    return sin(val) * 0.5+0.5;
    }
  vec3 getDistortion(float progress){
        progress = clamp(progress, 0.,1.);
        float xAmp = uDistortionX.r;
        float xFreq = uDistortionX.g;
        float yAmp = uDistortionY.r;
        float yFreq = uDistortionY.g;
        return vec3( 
            xAmp * nsin(progress* PI * xFreq   - PI / 2. ) ,
            yAmp * nsin(progress * PI *yFreq - PI / 2.  ) ,
            0.
        );
    }
`,xi=f=>Array.isArray(f)?Math.random()*(f[1]-f[0])+f[0]:Math.random()*f,Xu=f=>Array.isArray(f)?f[Math.floor(Math.random()*f.length)]:f;function Wu(f,w,G=.1,we=.001){let E=(w-f)*G;return Math.abs(E)<we&&(E=w-f),E}class ku{constructor(w,G,we,E,be){this.webgl=w,this.options=G,this.colors=we,this.speed=E,this.fade=be}init(){const w=this.options,G=new THREE.LineCurve3(new THREE.Vector3(0,0,0),new THREE.Vector3(0,0,-1)),we=new THREE.TubeBufferGeometry(G,40,1,8,!1),E=new THREE.InstancedBufferGeometry().copy(we);E.maxInstancedCount=w.lightPairsPerRoadWay*2;const be=w.roadWidth/w.lanesPerRoad,Ae=[],_e=[],je=[];let Ve=this.colors;Array.isArray(Ve)?Ve=Ve.map(Re=>new THREE.Color(Re)):Ve=new THREE.Color(Ve);for(let Re=0;Re<w.lightPairsPerRoadWay;Re++){const W=xi(w.carLightsRadius),It=xi(w.carLightsLength),pe=xi(this.speed);let ye=Re%3*be-w.roadWidth/2+be/2;const de=xi(w.carWidthPercentage)*be,lt=xi(w.carShiftX)*be;ye+=lt;const ve=xi(w.carFloorSeparation)+W*1.3,Dn=-xi(w.length);Ae.push(ye-de/2),Ae.push(ve),Ae.push(Dn),Ae.push(ye+de/2),Ae.push(ve),Ae.push(Dn),_e.push(W),_e.push(It),_e.push(pe),_e.push(W),_e.push(It),_e.push(pe);const hn=Xu(Ve);je.push(hn.r),je.push(hn.g),je.push(hn.b),je.push(hn.r),je.push(hn.g),je.push(hn.b)}E.addAttribute("aOffset",new THREE.InstancedBufferAttribute(new Float32Array(Ae),3,!1)),E.addAttribute("aMetrics",new THREE.InstancedBufferAttribute(new Float32Array(_e),3,!1)),E.addAttribute("aColor",new THREE.InstancedBufferAttribute(new Float32Array(je),3,!1));const Se=new THREE.ShaderMaterial({fragmentShader:td,vertexShader:nd,transparent:!0,uniforms:Object.assign({uTime:new THREE.Uniform(0),uTravelLength:new THREE.Uniform(w.length),uFade:new THREE.Uniform(this.fade)},this.webgl.fogUniforms,w.distortion.uniforms)});Se.onBeforeCompile=Re=>{Re.vertexShader=Re.vertexShader.replace("#include <getDistortion_vertex>",w.distortion.getDistortion),console.log(Re.vertex)};const ht=new THREE.Mesh(E,Se);ht.frustumCulled=!1,this.webgl.scene.add(ht),this.mesh=ht}update(w){this.mesh.material.uniforms.uTime.value=w}}const td=`
  #define USE_FOG;
  ${THREE.ShaderChunk.fog_pars_fragment}
  varying vec3 vColor;
  varying vec2 vUv; 
  uniform vec2 uFade;
  void main() {
  vec3 color = vec3(vColor);
  float fadeStart = 0.4;
  float maxFade = 0.;
  float alpha = 1.;
  
  alpha = smoothstep(uFade.x, uFade.y, vUv.x);
  gl_FragColor = vec4(color,alpha);
  if (gl_FragColor.a < 0.0001) discard;
  ${THREE.ShaderChunk.fog_fragment}
  }
`,nd=`
  #define USE_FOG;
  ${THREE.ShaderChunk.fog_pars_vertex}
  attribute vec3 aOffset;
  attribute vec3 aMetrics;
  attribute vec3 aColor;
  
  uniform float uTravelLength;
  uniform float uTime;
  uniform float uSpeed;
  varying vec2 vUv; 
  varying vec3 vColor; 
  #include <getDistortion_vertex>
  void main() {
    vec3 transformed = position.xyz;
    float radius = aMetrics.r;
    float myLength = aMetrics.g;
    float speed = aMetrics.b;
    transformed.xy *= radius ;
    transformed.z *= myLength;
  
    // Add my length to make sure it loops after the lights hits the end
    transformed.z += myLength-mod( uTime *speed + aOffset.z, uTravelLength);
    transformed.xy += aOffset.xy;
    float progress = abs(transformed.z / uTravelLength);
    transformed.xyz += getDistortion(progress);
    vec4 mvPosition = modelViewMatrix * vec4(transformed,1.);
    gl_Position = projectionMatrix * mvPosition;
    vUv = uv;
    vColor = aColor;
    ${THREE.ShaderChunk.fog_vertex}
  }`;class id{constructor(w,G){this.webgl=w,this.options=G}init(){const w=this.options,G=new THREE.PlaneBufferGeometry(1,1),we=new THREE.InstancedBufferGeometry().copy(G),E=w.totalSideLightSticks;we.maxInstancedCount=E;const be=w.length/(E-1),Ae=[],_e=[],je=[];let Ve=w.colors.sticks;Array.isArray(Ve)?Ve=Ve.map(Re=>new THREE.Color(Re)):Ve=new THREE.Color(Ve);for(let Re=0;Re<E;Re++){const W=xi(w.lightStickWidth),It=xi(w.lightStickHeight);Ae.push((Re-1)*be*2+be*Math.random());const pe=Xu(Ve);_e.push(pe.r),_e.push(pe.g),_e.push(pe.b),je.push(W),je.push(It)}we.addAttribute("aOffset",new THREE.InstancedBufferAttribute(new Float32Array(Ae),1,!1)),we.addAttribute("aColor",new THREE.InstancedBufferAttribute(new Float32Array(_e),3,!1)),we.addAttribute("aMetrics",new THREE.InstancedBufferAttribute(new Float32Array(je),2,!1));const Se=new THREE.ShaderMaterial({fragmentShader:od,vertexShader:rd,side:THREE.DoubleSide,uniforms:Object.assign({uTravelLength:new THREE.Uniform(w.length),uTime:new THREE.Uniform(0)},this.webgl.fogUniforms,w.distortion.uniforms)});Se.onBeforeCompile=Re=>{Re.vertexShader=Re.vertexShader.replace("#include <getDistortion_vertex>",w.distortion.getDistortion)};const ht=new THREE.Mesh(we,Se);ht.frustumCulled=!1,this.webgl.scene.add(ht),this.mesh=ht}update(w){this.mesh.material.uniforms.uTime.value=w}}const rd=`
#define USE_FOG;
${THREE.ShaderChunk.fog_pars_vertex}
attribute float aOffset;
attribute vec3 aColor;
attribute vec2 aMetrics;
uniform float uTravelLength;
uniform float uTime;
varying vec3 vColor;
mat4 rotationY( in float angle ) {
	return mat4(	cos(angle),		0,		sin(angle),	0,
			 				0,		1.0,			 0,	0,
					-sin(angle),	0,		cos(angle),	0,
							0, 		0,				0,	1);
}
  #include <getDistortion_vertex>
  void main(){
    vec3 transformed = position.xyz;
    float width = aMetrics.x;
    float height = aMetrics.y;
    transformed.xy *= vec2(width,height);
    float time = mod(uTime  * 60. *2. + aOffset , uTravelLength);
    transformed = (rotationY(3.14/2.) * vec4(transformed,1.)).xyz;
    transformed.z +=  - uTravelLength + time;
    float progress = abs(transformed.z / uTravelLength);
    transformed.xyz += getDistortion(progress);
    transformed.y += height /2.;
    transformed.x += -width/2.;
    vec4 mvPosition = modelViewMatrix * vec4(transformed,1.);
    gl_Position = projectionMatrix * mvPosition;
    vColor = aColor;
    ${THREE.ShaderChunk.fog_vertex}
  }
`,od=`
#define USE_FOG;
${THREE.ShaderChunk.fog_pars_fragment}
varying vec3 vColor;
  void main(){
    vec3 color = vec3(vColor);
    gl_FragColor = vec4(color,1.);
    ${THREE.ShaderChunk.fog_fragment}
  }
`;class sd{constructor(w,G){this.webgl=w,this.options=G,this.uTime=new THREE.Uniform(0)}createIsland(){this.options}createPlane(w,G,we){const E=this.options,be=100,Ae=new THREE.PlaneBufferGeometry(we?E.roadWidth:E.islandWidth,E.length,20,be);let _e={uTravelLength:new THREE.Uniform(E.length),uColor:new THREE.Uniform(new THREE.Color(we?E.colors.roadColor:E.colors.islandColor)),uTime:this.uTime};we&&(_e=Object.assign(_e,{uLanes:new THREE.Uniform(E.lanesPerRoad),uBrokenLinesColor:new THREE.Uniform(new THREE.Color(E.colors.brokenLines)),uShoulderLinesColor:new THREE.Uniform(new THREE.Color(E.colors.shoulderLines)),uShoulderLinesWidthPercentage:new THREE.Uniform(E.shoulderLinesWidthPercentage),uBrokenLinesLengthPercentage:new THREE.Uniform(E.brokenLinesLengthPercentage),uBrokenLinesWidthPercentage:new THREE.Uniform(E.brokenLinesWidthPercentage)}));const je=new THREE.ShaderMaterial({fragmentShader:we?ud:ad,vertexShader:hd,side:THREE.DoubleSide,uniforms:Object.assign(_e,this.webgl.fogUniforms,E.distortion.uniforms)});je.onBeforeCompile=Se=>{Se.vertexShader=Se.vertexShader.replace("#include <getDistortion_vertex>",E.distortion.getDistortion)};const Ve=new THREE.Mesh(Ae,je);return Ve.rotation.x=-Math.PI/2,Ve.position.z=-E.length/2,Ve.position.x+=(this.options.islandWidth/2+E.roadWidth/2)*w,this.webgl.scene.add(Ve),Ve}init(){this.leftRoadWay=this.createPlane(-1,this.options.roadWidth,!0),this.rightRoadWay=this.createPlane(1,this.options.roadWidth,!0),this.island=this.createPlane(0,this.options.islandWidth,!1)}update(w){this.uTime.value=w}}const Qu=`
    #define USE_FOG;
    varying vec2 vUv; 
    uniform vec3 uColor;
    uniform float uTime;
    #include <roadMarkings_vars>
    ${THREE.ShaderChunk.fog_pars_fragment}
    void main() {
        vec2 uv = vUv;
        vec3 color = vec3(uColor);
        
        #include <roadMarkings_fragment>
        gl_FragColor = vec4(color,1.);
        ${THREE.ShaderChunk.fog_fragment}
    }
`,ad=Qu.replace("#include <roadMarkings_fragment>","").replace("#include <roadMarkings_vars>",""),cd=`
    uniform float uLanes;
    uniform vec3 uBrokenLinesColor;
    uniform vec3 uShoulderLinesColor;
    uniform float uShoulderLinesWidthPercentage;
    uniform float uBrokenLinesWidthPercentage;
    uniform float uBrokenLinesLengthPercentage;
    highp float random(vec2 co)
    {
        highp float a = 12.9898;
        highp float b = 78.233;
        highp float c = 43758.5453;
        highp float dt= dot(co.xy ,vec2(a,b));
        highp float sn= mod(dt,3.14);
        return fract(sin(sn) * c);
    }
`,ld=`
        uv.y = mod(uv.y + uTime * 0.1,1.);
        float brokenLineWidth = 1. / uLanes * uBrokenLinesWidthPercentage;
        // How much % of the lane's space is empty
        float laneEmptySpace = 1. - uBrokenLinesLengthPercentage;
        // Horizontal * vertical offset
        float brokenLines = step(1.-brokenLineWidth * uLanes,fract(uv.x * uLanes)) * step(laneEmptySpace, fract(uv.y * 100.)) ;
        // Remove right-hand lines on the right-most lane
        brokenLines *= step(uv.x * uLanes,uLanes-1.);
        color = mix(color, uBrokenLinesColor, brokenLines);
        float shoulderLinesWidth = 1. / uLanes * uShoulderLinesWidthPercentage;
        float shoulderLines = step(1.-shoulderLinesWidth, uv.x) + step(uv.x, shoulderLinesWidth);
        color = mix(color, uBrokenLinesColor, shoulderLines);
        vec2 noiseFreq = vec2(4., 7000.);
        float roadNoise = random( floor(uv * noiseFreq)/noiseFreq ) * 0.02 - 0.01; 
        color += roadNoise;
`,ud=Qu.replace("#include <roadMarkings_fragment>",ld).replace("#include <roadMarkings_vars>",cd),hd=`
#define USE_FOG;
uniform float uTime;
${THREE.ShaderChunk.fog_pars_vertex}
uniform float uTravelLength;
varying vec2 vUv; 
  #include <getDistortion_vertex>
void main() {
  vec3 transformed = position.xyz;
    vec3 distortion  = getDistortion((transformed.y + uTravelLength / 2.) / uTravelLength);
    transformed.x += distortion.x;
    transformed.z += distortion.y;
  transformed.y += -1.*distortion.z;  
  
  vec4 mvPosition = modelViewMatrix * vec4(transformed,1.);
  gl_Position = projectionMatrix * mvPosition;
  vUv = uv;
  ${THREE.ShaderChunk.fog_vertex}
}`;function dd(f,w){const G=f.domElement,we=G.clientWidth,E=G.clientHeight,be=G.width!==we||G.height!==E;return be&&w(we,E,!1),be}new THREE.Uniform(new THREE.Vector3(3,6,10)),new THREE.Uniform(new THREE.Vector3(30,30,20));new THREE.Uniform(new THREE.Vector2(5,2)),new THREE.Uniform(new THREE.Vector2(25,15));new THREE.Uniform(new THREE.Vector2(2,3)),new THREE.Uniform(new THREE.Vector2(35,10));const Sl={uFreq:new THREE.Uniform(new THREE.Vector4(4,8,8,1)),uAmp:new THREE.Uniform(new THREE.Vector4(25,5,10,10))};new THREE.Uniform(new THREE.Vector2(4,8)),new THREE.Uniform(new THREE.Vector2(10,20)),new THREE.Uniform(new THREE.Vector2(20,2));const Yu=f=>Math.sin(f)*.5+.5,pd={uniforms:Sl,getDistortion:`
          uniform vec4 uFreq;
          uniform vec4 uAmp;
          float nsin(float val){
          return sin(val) * 0.5+0.5;
          }
      
                  #define PI 3.14159265358979
          float getDistortionX(float progress){
              return 
                      (
                          cos( PI * progress * uFreq.r + uTime) * uAmp.r +
                          pow(cos(PI * progress * uFreq.g + uTime * (uFreq.g / uFreq.r)),2. )* uAmp.g
                      
                      );
          }
          float getDistortionY(float progress){
              return 
                      (
                          -nsin( PI * progress * uFreq.b + uTime) * uAmp.b +
                          -pow(nsin(PI * progress * uFreq.a + uTime / (uFreq.b / uFreq.a) ),5.) * uAmp.a
                      
                      );
          }
          vec3 getDistortion(float progress){
              return vec3(
                  getDistortionX(progress)-getDistortionX(0.0125) ,
                  getDistortionY(progress)- getDistortionY(0.0125),
                  0.
              );
          }
      `,getJS:(f,w)=>{const G=Sl.uFreq.value,we=Sl.uAmp.value,E=Ve=>Math.cos(Math.PI*Ve*G.x+w)*we.x+Math.pow(Math.cos(Math.PI*Ve*G.y+w*(G.y/G.x)),2)*we.y,be=Ve=>-Yu(Math.PI*Ve*G.z+w)*we.z-Math.pow(Yu(Math.PI*Ve*G.w+w/(G.z/G.w)),5)*we.w,Ae=new THREE.Vector3(E(f)-E(f+.007),be(f)-be(f+.007),0),_e=new THREE.Vector3(-2,-5,0),je=new THREE.Vector3(0,0,-10);return Ae.multiply(_e).add(je)}},fd=(f,w=500)=>{let G=null;return function(){G!==null&&clearTimeout(G),G=window?.setTimeout(f,w)}},md=f=>(kh("data-v-6a9a0a4b"),f=f(),Yh(),f),vd={class:"view-login"},gd={class:"login-form"},yd=md(()=>Tl("h3",null,"登录",-1)),xd=qh("登录"),wd=zh({__name:"index",setup(f){const w=Zh(),G=Gh(),we=El(!1),E=El(),be=Hh({username:"admin",password:"123456"}),Ae=async Re=>{if(!await E.value.validate())return;we.value=!0;const It=await G.login(be);It&&w.success({message:It.realName,description:"欢迎回来"}),we.value=!1},_e={onSpeedUp:()=>{},onSlowDown:()=>{},distortion:pd,length:400,roadWidth:10,islandWidth:2,lanesPerRoad:3,fov:90,fovSpeedUp:150,speedUp:2,carLightsFade:.4,totalSideLightSticks:20,lightPairsPerRoadWay:40,shoulderLinesWidthPercentage:.05,brokenLinesWidthPercentage:.1,brokenLinesLengthPercentage:.5,lightStickWidth:[.12,.5],lightStickHeight:[1.3,1.7],movingAwaySpeed:[60,80],movingCloserSpeed:[-120,-160],carLightsLength:[400*.03,400*.2],carLightsRadius:[.05,.14],carWidthPercentage:[.3,.5],carShiftX:[-.8,.8],carFloorSeparation:[0,5],colors:{roadColor:526344,islandColor:657930,background:0,shoulderLines:1250072,brokenLines:1250072,leftCars:[14177983,6770850,12732332],rightCars:[242627,941733,3294549],sticks:242627}};let je=null;const Ve=El(),Se=()=>{je=new Jh(Ve.value,_e),je.loadAssets().then(je.init)},ht=fd(()=>{Xh(()=>{const Re=window.innerHeight,W=window.innerWidth;je?.setSize(W,Re,!0)})});return Vh(()=>{Se(),window.addEventListener("resize",ht)}),jh(()=>{window.removeEventListener("resize",ht)}),(Re,W)=>{const It=ys("a-input"),pe=ys("a-form-item"),wi=ys("a-input-password"),ye=ys("a-button"),de=ys("a-form");return Qh(),Wh("div",vd,[Tl("div",{id:"container",ref_key:"container",ref:Ve},null,512),Tl("div",gd,[yd,Er(de,{ref_key:"formRef",ref:E,model:be,name:"basic",autocomplete:"off",onFinish:Ae},{default:gs(()=>[Er(pe,{name:"username",rules:[{required:!0,message:"Please input your username!"}]},{default:gs(()=>[Er(It,{value:be.username,"onUpdate:value":W[0]||(W[0]=lt=>be.username=lt),placeholder:"admin"},null,8,["value"])]),_:1}),Er(pe,{name:"password",rules:[{required:!0,message:"Please input your password!"}]},{default:gs(()=>[Er(wi,{value:be.password,"onUpdate:value":W[1]||(W[1]=lt=>be.password=lt),placeholder:"123456"},null,8,["value"])]),_:1}),Er(pe,null,{default:gs(()=>[Er(ye,{loading:we.value,type:"primary",block:"","html-type":"submit"},{default:gs(()=>[xd]),_:1},8,["loading"])]),_:1})]),_:1},8,["model"])])])}}});const Sd=Kh(wd,[["__scopeId","data-v-6a9a0a4b"]]);export{Sd as default};
